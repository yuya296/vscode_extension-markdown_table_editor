"use strict";(()=>{var X0=Object.create;var Ru=Object.defineProperty;var Z0=Object.getOwnPropertyDescriptor;var Q0=Object.getOwnPropertyNames;var q0=Object.getPrototypeOf,J0=Object.prototype.hasOwnProperty;var _u=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,n)=>(typeof require<"u"?require:t)[n]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var jn=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var $0=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Q0(t))!J0.call(e,a)&&a!==n&&Ru(e,a,{get:()=>t[a],enumerable:!(o=Z0(t,a))||o.enumerable});return e};var kn=(e,t,n)=>(n=e!=null?X0(q0(e)):{},$0(t||!e||!e.__esModule?Ru(n,"default",{value:e,enumerable:!0}):n,e));var Qu=jn(rt=>{"use strict";var bo=Symbol.for("react.element"),K0=Symbol.for("react.portal"),eh=Symbol.for("react.fragment"),th=Symbol.for("react.strict_mode"),nh=Symbol.for("react.profiler"),rh=Symbol.for("react.provider"),oh=Symbol.for("react.context"),ih=Symbol.for("react.forward_ref"),lh=Symbol.for("react.suspense"),ah=Symbol.for("react.memo"),sh=Symbol.for("react.lazy"),Hu=Symbol.iterator;function uh(e){return e===null||typeof e!="object"?null:(e=Hu&&e[Hu]||e["@@iterator"],typeof e=="function"?e:null)}var Bu={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Vu=Object.assign,Uu={};function _r(e,t,n){this.props=e,this.context=t,this.refs=Uu,this.updater=n||Bu}_r.prototype.isReactComponent={};_r.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};_r.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Yu(){}Yu.prototype=_r.prototype;function ia(e,t,n){this.props=e,this.context=t,this.refs=Uu,this.updater=n||Bu}var la=ia.prototype=new Yu;la.constructor=ia;Vu(la,_r.prototype);la.isPureReactComponent=!0;var Pu=Array.isArray,Wu=Object.prototype.hasOwnProperty,aa={current:null},Gu={key:!0,ref:!0,__self:!0,__source:!0};function Xu(e,t,n){var o,a={},d=null,E=null;if(t!=null)for(o in t.ref!==void 0&&(E=t.ref),t.key!==void 0&&(d=""+t.key),t)Wu.call(t,o)&&!Gu.hasOwnProperty(o)&&(a[o]=t[o]);var u=arguments.length-2;if(u===1)a.children=n;else if(1<u){for(var s=Array(u),m=0;m<u;m++)s[m]=arguments[m+2];a.children=s}if(e&&e.defaultProps)for(o in u=e.defaultProps,u)a[o]===void 0&&(a[o]=u[o]);return{$$typeof:bo,type:e,key:d,ref:E,props:a,_owner:aa.current}}function ch(e,t){return{$$typeof:bo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function sa(e){return typeof e=="object"&&e!==null&&e.$$typeof===bo}function dh(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var zu=/\/+/g;function oa(e,t){return typeof e=="object"&&e!==null&&e.key!=null?dh(""+e.key):t.toString(36)}function wi(e,t,n,o,a){var d=typeof e;(d==="undefined"||d==="boolean")&&(e=null);var E=!1;if(e===null)E=!0;else switch(d){case"string":case"number":E=!0;break;case"object":switch(e.$$typeof){case bo:case K0:E=!0}}if(E)return E=e,a=a(E),e=o===""?"."+oa(E,0):o,Pu(a)?(n="",e!=null&&(n=e.replace(zu,"$&/")+"/"),wi(a,t,n,"",function(m){return m})):a!=null&&(sa(a)&&(a=ch(a,n+(!a.key||E&&E.key===a.key?"":(""+a.key).replace(zu,"$&/")+"/")+e)),t.push(a)),1;if(E=0,o=o===""?".":o+":",Pu(e))for(var u=0;u<e.length;u++){d=e[u];var s=o+oa(d,u);E+=wi(d,t,n,s,a)}else if(s=uh(e),typeof s=="function")for(e=s.call(e),u=0;!(d=e.next()).done;)d=d.value,s=o+oa(d,u++),E+=wi(d,t,n,s,a);else if(d==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return E}function xi(e,t,n){if(e==null)return e;var o=[],a=0;return wi(e,o,"","",function(d){return t.call(n,d,a++)}),o}function fh(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Wt={current:null},Ci={transition:null},ph={ReactCurrentDispatcher:Wt,ReactCurrentBatchConfig:Ci,ReactCurrentOwner:aa};function Zu(){throw Error("act(...) is not supported in production builds of React.")}rt.Children={map:xi,forEach:function(e,t,n){xi(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return xi(e,function(){t++}),t},toArray:function(e){return xi(e,function(t){return t})||[]},only:function(e){if(!sa(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};rt.Component=_r;rt.Fragment=eh;rt.Profiler=nh;rt.PureComponent=ia;rt.StrictMode=th;rt.Suspense=lh;rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ph;rt.act=Zu;rt.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=Vu({},e.props),a=e.key,d=e.ref,E=e._owner;if(t!=null){if(t.ref!==void 0&&(d=t.ref,E=aa.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(s in t)Wu.call(t,s)&&!Gu.hasOwnProperty(s)&&(o[s]=t[s]===void 0&&u!==void 0?u[s]:t[s])}var s=arguments.length-2;if(s===1)o.children=n;else if(1<s){u=Array(s);for(var m=0;m<s;m++)u[m]=arguments[m+2];o.children=u}return{$$typeof:bo,type:e.type,key:a,ref:d,props:o,_owner:E}};rt.createContext=function(e){return e={$$typeof:oh,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:rh,_context:e},e.Consumer=e};rt.createElement=Xu;rt.createFactory=function(e){var t=Xu.bind(null,e);return t.type=e,t};rt.createRef=function(){return{current:null}};rt.forwardRef=function(e){return{$$typeof:ih,render:e}};rt.isValidElement=sa;rt.lazy=function(e){return{$$typeof:sh,_payload:{_status:-1,_result:e},_init:fh}};rt.memo=function(e,t){return{$$typeof:ah,type:e,compare:t===void 0?null:t}};rt.startTransition=function(e){var t=Ci.transition;Ci.transition={};try{e()}finally{Ci.transition=t}};rt.unstable_act=Zu;rt.useCallback=function(e,t){return Wt.current.useCallback(e,t)};rt.useContext=function(e){return Wt.current.useContext(e)};rt.useDebugValue=function(){};rt.useDeferredValue=function(e){return Wt.current.useDeferredValue(e)};rt.useEffect=function(e,t){return Wt.current.useEffect(e,t)};rt.useId=function(){return Wt.current.useId()};rt.useImperativeHandle=function(e,t,n){return Wt.current.useImperativeHandle(e,t,n)};rt.useInsertionEffect=function(e,t){return Wt.current.useInsertionEffect(e,t)};rt.useLayoutEffect=function(e,t){return Wt.current.useLayoutEffect(e,t)};rt.useMemo=function(e,t){return Wt.current.useMemo(e,t)};rt.useReducer=function(e,t,n){return Wt.current.useReducer(e,t,n)};rt.useRef=function(e){return Wt.current.useRef(e)};rt.useState=function(e){return Wt.current.useState(e)};rt.useSyncExternalStore=function(e,t,n){return Wt.current.useSyncExternalStore(e,t,n)};rt.useTransition=function(){return Wt.current.useTransition()};rt.version="18.3.1"});var jo=jn((Lm,qu)=>{"use strict";qu.exports=Qu()});var lc=jn(ft=>{"use strict";function fa(e,t){var n=e.length;e.push(t);e:for(;0<n;){var o=n-1>>>1,a=e[o];if(0<Ei(a,t))e[o]=t,e[n]=a,n=o;else break e}}function yn(e){return e.length===0?null:e[0]}function Si(e){if(e.length===0)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var o=0,a=e.length,d=a>>>1;o<d;){var E=2*(o+1)-1,u=e[E],s=E+1,m=e[s];if(0>Ei(u,n))s<a&&0>Ei(m,u)?(e[o]=m,e[s]=n,o=s):(e[o]=u,e[E]=n,o=E);else if(s<a&&0>Ei(m,n))e[o]=m,e[s]=n,o=s;else break e}}return t}function Ei(e,t){var n=e.sortIndex-t.sortIndex;return n!==0?n:e.id-t.id}typeof performance=="object"&&typeof performance.now=="function"?(Ju=performance,ft.unstable_now=function(){return Ju.now()}):(ua=Date,$u=ua.now(),ft.unstable_now=function(){return ua.now()-$u});var Ju,ua,$u,Mn=[],Qn=[],hh=1,dn=null,Ht=3,Li=!1,yr=!1,xo=!1,tc=typeof setTimeout=="function"?setTimeout:null,nc=typeof clearTimeout=="function"?clearTimeout:null,Ku=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function pa(e){for(var t=yn(Qn);t!==null;){if(t.callback===null)Si(Qn);else if(t.startTime<=e)Si(Qn),t.sortIndex=t.expirationTime,fa(Mn,t);else break;t=yn(Qn)}}function ha(e){if(xo=!1,pa(e),!yr)if(yn(Mn)!==null)yr=!0,ma(ga);else{var t=yn(Qn);t!==null&&va(ha,t.startTime-e)}}function ga(e,t){yr=!1,xo&&(xo=!1,nc(wo),wo=-1),Li=!0;var n=Ht;try{for(pa(t),dn=yn(Mn);dn!==null&&(!(dn.expirationTime>t)||e&&!ic());){var o=dn.callback;if(typeof o=="function"){dn.callback=null,Ht=dn.priorityLevel;var a=o(dn.expirationTime<=t);t=ft.unstable_now(),typeof a=="function"?dn.callback=a:dn===yn(Mn)&&Si(Mn),pa(t)}else Si(Mn);dn=yn(Mn)}if(dn!==null)var d=!0;else{var E=yn(Qn);E!==null&&va(ha,E.startTime-t),d=!1}return d}finally{dn=null,Ht=n,Li=!1}}var Ni=!1,Ai=null,wo=-1,rc=5,oc=-1;function ic(){return!(ft.unstable_now()-oc<rc)}function ca(){if(Ai!==null){var e=ft.unstable_now();oc=e;var t=!0;try{t=Ai(!0,e)}finally{t?yo():(Ni=!1,Ai=null)}}else Ni=!1}var yo;typeof Ku=="function"?yo=function(){Ku(ca)}:typeof MessageChannel<"u"?(da=new MessageChannel,ec=da.port2,da.port1.onmessage=ca,yo=function(){ec.postMessage(null)}):yo=function(){tc(ca,0)};var da,ec;function ma(e){Ai=e,Ni||(Ni=!0,yo())}function va(e,t){wo=tc(function(){e(ft.unstable_now())},t)}ft.unstable_IdlePriority=5;ft.unstable_ImmediatePriority=1;ft.unstable_LowPriority=4;ft.unstable_NormalPriority=3;ft.unstable_Profiling=null;ft.unstable_UserBlockingPriority=2;ft.unstable_cancelCallback=function(e){e.callback=null};ft.unstable_continueExecution=function(){yr||Li||(yr=!0,ma(ga))};ft.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):rc=0<e?Math.floor(1e3/e):5};ft.unstable_getCurrentPriorityLevel=function(){return Ht};ft.unstable_getFirstCallbackNode=function(){return yn(Mn)};ft.unstable_next=function(e){switch(Ht){case 1:case 2:case 3:var t=3;break;default:t=Ht}var n=Ht;Ht=t;try{return e()}finally{Ht=n}};ft.unstable_pauseExecution=function(){};ft.unstable_requestPaint=function(){};ft.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=Ht;Ht=e;try{return t()}finally{Ht=n}};ft.unstable_scheduleCallback=function(e,t,n){var o=ft.unstable_now();switch(typeof n=="object"&&n!==null?(n=n.delay,n=typeof n=="number"&&0<n?o+n:o):n=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return a=n+a,e={id:hh++,callback:t,priorityLevel:e,startTime:n,expirationTime:a,sortIndex:-1},n>o?(e.sortIndex=n,fa(Qn,e),yn(Mn)===null&&e===yn(Qn)&&(xo?(nc(wo),wo=-1):xo=!0,va(ha,n-o))):(e.sortIndex=a,fa(Mn,e),yr||Li||(yr=!0,ma(ga))),e};ft.unstable_shouldYield=ic;ft.unstable_wrapCallback=function(e){var t=Ht;return function(){var n=Ht;Ht=t;try{return e.apply(this,arguments)}finally{Ht=n}}}});var sc=jn((km,ac)=>{"use strict";ac.exports=lc()});var pp=jn(un=>{"use strict";var gh=jo(),an=sc();function Le(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var gd=new Set,Yo={};function Dr(e,t){oo(e,t),oo(e+"Capture",t)}function oo(e,t){for(Yo[e]=t,e=0;e<t.length;e++)gd.add(t[e])}var Bn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),za=Object.prototype.hasOwnProperty,mh=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uc={},cc={};function vh(e){return za.call(cc,e)?!0:za.call(uc,e)?!1:mh.test(e)?cc[e]=!0:(uc[e]=!0,!1)}function bh(e,t,n,o){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return o?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function jh(e,t,n,o){if(t===null||typeof t>"u"||bh(e,t,n,o))return!0;if(o)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Zt(e,t,n,o,a,d,E){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=o,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=d,this.removeEmptyString=E}var Rt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Rt[e]=new Zt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Rt[t]=new Zt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Rt[e]=new Zt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Rt[e]=new Zt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Rt[e]=new Zt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Rt[e]=new Zt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Rt[e]=new Zt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Rt[e]=new Zt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Rt[e]=new Zt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ts=/[\-:]([a-z])/g;function Ds(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ts,Ds);Rt[t]=new Zt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ts,Ds);Rt[t]=new Zt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ts,Ds);Rt[t]=new Zt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Rt[e]=new Zt(e,1,!1,e.toLowerCase(),null,!1,!1)});Rt.xlinkHref=new Zt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Rt[e]=new Zt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Os(e,t,n,o){var a=Rt.hasOwnProperty(t)?Rt[t]:null;(a!==null?a.type!==0:o||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(jh(t,n,a,o)&&(n=null),o||a===null?vh(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,o=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,o?e.setAttributeNS(o,t,n):e.setAttribute(t,n))))}var Wn=gh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ki=Symbol.for("react.element"),zr=Symbol.for("react.portal"),Br=Symbol.for("react.fragment"),Fs=Symbol.for("react.strict_mode"),Ba=Symbol.for("react.profiler"),md=Symbol.for("react.provider"),vd=Symbol.for("react.context"),Rs=Symbol.for("react.forward_ref"),Va=Symbol.for("react.suspense"),Ua=Symbol.for("react.suspense_list"),_s=Symbol.for("react.memo"),Jn=Symbol.for("react.lazy");Symbol.for("react.scope");Symbol.for("react.debug_trace_mode");var bd=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden");Symbol.for("react.cache");Symbol.for("react.tracing_marker");var dc=Symbol.iterator;function Co(e){return e===null||typeof e!="object"?null:(e=dc&&e[dc]||e["@@iterator"],typeof e=="function"?e:null)}var wt=Object.assign,ba;function Io(e){if(ba===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);ba=t&&t[1]||""}return`
`+ba+e}var ja=!1;function ya(e,t){if(!e||ja)return"";ja=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(m){var o=m}Reflect.construct(e,[],t)}else{try{t.call()}catch(m){o=m}e.call(t.prototype)}else{try{throw Error()}catch(m){o=m}e()}}catch(m){if(m&&o&&typeof m.stack=="string"){for(var a=m.stack.split(`
`),d=o.stack.split(`
`),E=a.length-1,u=d.length-1;1<=E&&0<=u&&a[E]!==d[u];)u--;for(;1<=E&&0<=u;E--,u--)if(a[E]!==d[u]){if(E!==1||u!==1)do if(E--,u--,0>u||a[E]!==d[u]){var s=`
`+a[E].replace(" at new "," at ");return e.displayName&&s.includes("<anonymous>")&&(s=s.replace("<anonymous>",e.displayName)),s}while(1<=E&&0<=u);break}}}finally{ja=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Io(e):""}function yh(e){switch(e.tag){case 5:return Io(e.type);case 16:return Io("Lazy");case 13:return Io("Suspense");case 19:return Io("SuspenseList");case 0:case 2:case 15:return e=ya(e.type,!1),e;case 11:return e=ya(e.type.render,!1),e;case 1:return e=ya(e.type,!0),e;default:return""}}function Ya(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Br:return"Fragment";case zr:return"Portal";case Ba:return"Profiler";case Fs:return"StrictMode";case Va:return"Suspense";case Ua:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case vd:return(e.displayName||"Context")+".Consumer";case md:return(e._context.displayName||"Context")+".Provider";case Rs:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case _s:return t=e.displayName||null,t!==null?t:Ya(e.type)||"Memo";case Jn:t=e._payload,e=e._init;try{return Ya(e(t))}catch{}}return null}function xh(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ya(t);case 8:return t===Fs?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function dr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function jd(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function wh(e){var t=jd(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,d=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(E){o=""+E,d.call(this,E)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return o},setValue:function(E){o=""+E},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Mi(e){e._valueTracker||(e._valueTracker=wh(e))}function yd(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),o="";return e&&(o=jd(e)?e.checked?"true":"false":e.value),e=o,e!==n?(t.setValue(e),!0):!1}function il(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Wa(e,t){var n=t.checked;return wt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function fc(e,t){var n=t.defaultValue==null?"":t.defaultValue,o=t.checked!=null?t.checked:t.defaultChecked;n=dr(t.value!=null?t.value:n),e._wrapperState={initialChecked:o,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function xd(e,t){t=t.checked,t!=null&&Os(e,"checked",t,!1)}function Ga(e,t){xd(e,t);var n=dr(t.value),o=t.type;if(n!=null)o==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(o==="submit"||o==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Xa(e,t.type,n):t.hasOwnProperty("defaultValue")&&Xa(e,t.type,dr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function pc(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var o=t.type;if(!(o!=="submit"&&o!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Xa(e,t,n){(t!=="number"||il(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var To=Array.isArray;function $r(e,t,n,o){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&o&&(e[n].defaultSelected=!0)}else{for(n=""+dr(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,o&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Za(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Le(91));return wt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hc(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Le(92));if(To(n)){if(1<n.length)throw Error(Le(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:dr(n)}}function wd(e,t){var n=dr(t.value),o=dr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),o!=null&&(e.defaultValue=""+o)}function gc(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Cd(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Qa(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Cd(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ii,Ed=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,o,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,o,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ii=Ii||document.createElement("div"),Ii.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ii.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Wo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Fo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ch=["Webkit","ms","Moz","O"];Object.keys(Fo).forEach(function(e){Ch.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Fo[t]=Fo[e]})});function Ad(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Fo.hasOwnProperty(e)&&Fo[e]?(""+t).trim():t+"px"}function Sd(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var o=n.indexOf("--")===0,a=Ad(n,t[n],o);n==="float"&&(n="cssFloat"),o?e.setProperty(n,a):e[n]=a}}var Eh=wt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qa(e,t){if(t){if(Eh[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Le(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Le(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Le(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Le(62))}}function Ja(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $a=null;function Hs(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ka=null,Kr=null,eo=null;function mc(e){if(e=ui(e)){if(typeof Ka!="function")throw Error(Le(280));var t=e.stateNode;t&&(t=Dl(t),Ka(e.stateNode,e.type,t))}}function Ld(e){Kr?eo?eo.push(e):eo=[e]:Kr=e}function Nd(){if(Kr){var e=Kr,t=eo;if(eo=Kr=null,mc(e),t)for(e=0;e<t.length;e++)mc(t[e])}}function kd(e,t){return e(t)}function Md(){}var xa=!1;function Id(e,t,n){if(xa)return e(t,n);xa=!0;try{return kd(e,t,n)}finally{xa=!1,(Kr!==null||eo!==null)&&(Md(),Nd())}}function Go(e,t){var n=e.stateNode;if(n===null)return null;var o=Dl(n);if(o===null)return null;n=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Le(231,t,typeof n));return n}var es=!1;if(Bn)try{Hr={},Object.defineProperty(Hr,"passive",{get:function(){es=!0}}),window.addEventListener("test",Hr,Hr),window.removeEventListener("test",Hr,Hr)}catch{es=!1}var Hr;function Ah(e,t,n,o,a,d,E,u,s){var m=Array.prototype.slice.call(arguments,3);try{t.apply(n,m)}catch(T){this.onError(T)}}var Ro=!1,ll=null,al=!1,ts=null,Sh={onError:function(e){Ro=!0,ll=e}};function Lh(e,t,n,o,a,d,E,u,s){Ro=!1,ll=null,Ah.apply(Sh,arguments)}function Nh(e,t,n,o,a,d,E,u,s){if(Lh.apply(this,arguments),Ro){if(Ro){var m=ll;Ro=!1,ll=null}else throw Error(Le(198));al||(al=!0,ts=m)}}function Or(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Td(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function vc(e){if(Or(e)!==e)throw Error(Le(188))}function kh(e){var t=e.alternate;if(!t){if(t=Or(e),t===null)throw Error(Le(188));return t!==e?null:e}for(var n=e,o=t;;){var a=n.return;if(a===null)break;var d=a.alternate;if(d===null){if(o=a.return,o!==null){n=o;continue}break}if(a.child===d.child){for(d=a.child;d;){if(d===n)return vc(a),e;if(d===o)return vc(a),t;d=d.sibling}throw Error(Le(188))}if(n.return!==o.return)n=a,o=d;else{for(var E=!1,u=a.child;u;){if(u===n){E=!0,n=a,o=d;break}if(u===o){E=!0,o=a,n=d;break}u=u.sibling}if(!E){for(u=d.child;u;){if(u===n){E=!0,n=d,o=a;break}if(u===o){E=!0,o=d,n=a;break}u=u.sibling}if(!E)throw Error(Le(189))}}if(n.alternate!==o)throw Error(Le(190))}if(n.tag!==3)throw Error(Le(188));return n.stateNode.current===n?e:t}function Dd(e){return e=kh(e),e!==null?Od(e):null}function Od(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Od(e);if(t!==null)return t;e=e.sibling}return null}var Fd=an.unstable_scheduleCallback,bc=an.unstable_cancelCallback,Mh=an.unstable_shouldYield,Ih=an.unstable_requestPaint,St=an.unstable_now,Th=an.unstable_getCurrentPriorityLevel,Ps=an.unstable_ImmediatePriority,Rd=an.unstable_UserBlockingPriority,sl=an.unstable_NormalPriority,Dh=an.unstable_LowPriority,_d=an.unstable_IdlePriority,kl=null,On=null;function Oh(e){if(On&&typeof On.onCommitFiberRoot=="function")try{On.onCommitFiberRoot(kl,e,void 0,(e.current.flags&128)===128)}catch{}}var An=Math.clz32?Math.clz32:_h,Fh=Math.log,Rh=Math.LN2;function _h(e){return e>>>=0,e===0?32:31-(Fh(e)/Rh|0)|0}var Ti=64,Di=4194304;function Do(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ul(e,t){var n=e.pendingLanes;if(n===0)return 0;var o=0,a=e.suspendedLanes,d=e.pingedLanes,E=n&268435455;if(E!==0){var u=E&~a;u!==0?o=Do(u):(d&=E,d!==0&&(o=Do(d)))}else E=n&~a,E!==0?o=Do(E):d!==0&&(o=Do(d));if(o===0)return 0;if(t!==0&&t!==o&&(t&a)===0&&(a=o&-o,d=t&-t,a>=d||a===16&&(d&4194240)!==0))return t;if((o&4)!==0&&(o|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=o;0<t;)n=31-An(t),a=1<<n,o|=e[n],t&=~a;return o}function Hh(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ph(e,t){for(var n=e.suspendedLanes,o=e.pingedLanes,a=e.expirationTimes,d=e.pendingLanes;0<d;){var E=31-An(d),u=1<<E,s=a[E];s===-1?((u&n)===0||(u&o)!==0)&&(a[E]=Hh(u,t)):s<=t&&(e.expiredLanes|=u),d&=~u}}function ns(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Hd(){var e=Ti;return Ti<<=1,(Ti&4194240)===0&&(Ti=64),e}function wa(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ai(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-An(t),e[t]=n}function zh(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-An(n),d=1<<a;t[a]=0,o[a]=-1,e[a]=-1,n&=~d}}function zs(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var o=31-An(n),a=1<<o;a&t|e[o]&t&&(e[o]|=t),n&=~a}}var ut=0;function Pd(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var zd,Bs,Bd,Vd,Ud,rs=!1,Oi=[],rr=null,or=null,ir=null,Xo=new Map,Zo=new Map,Kn=[],Bh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jc(e,t){switch(e){case"focusin":case"focusout":rr=null;break;case"dragenter":case"dragleave":or=null;break;case"mouseover":case"mouseout":ir=null;break;case"pointerover":case"pointerout":Xo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zo.delete(t.pointerId)}}function Eo(e,t,n,o,a,d){return e===null||e.nativeEvent!==d?(e={blockedOn:t,domEventName:n,eventSystemFlags:o,nativeEvent:d,targetContainers:[a]},t!==null&&(t=ui(t),t!==null&&Bs(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Vh(e,t,n,o,a){switch(t){case"focusin":return rr=Eo(rr,e,t,n,o,a),!0;case"dragenter":return or=Eo(or,e,t,n,o,a),!0;case"mouseover":return ir=Eo(ir,e,t,n,o,a),!0;case"pointerover":var d=a.pointerId;return Xo.set(d,Eo(Xo.get(d)||null,e,t,n,o,a)),!0;case"gotpointercapture":return d=a.pointerId,Zo.set(d,Eo(Zo.get(d)||null,e,t,n,o,a)),!0}return!1}function Yd(e){var t=Cr(e.target);if(t!==null){var n=Or(t);if(n!==null){if(t=n.tag,t===13){if(t=Td(n),t!==null){e.blockedOn=t,Ud(e.priority,function(){Bd(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Zi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=os(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var o=new n.constructor(n.type,n);$a=o,n.target.dispatchEvent(o),$a=null}else return t=ui(n),t!==null&&Bs(t),e.blockedOn=n,!1;t.shift()}return!0}function yc(e,t,n){Zi(e)&&n.delete(t)}function Uh(){rs=!1,rr!==null&&Zi(rr)&&(rr=null),or!==null&&Zi(or)&&(or=null),ir!==null&&Zi(ir)&&(ir=null),Xo.forEach(yc),Zo.forEach(yc)}function Ao(e,t){e.blockedOn===t&&(e.blockedOn=null,rs||(rs=!0,an.unstable_scheduleCallback(an.unstable_NormalPriority,Uh)))}function Qo(e){function t(a){return Ao(a,e)}if(0<Oi.length){Ao(Oi[0],e);for(var n=1;n<Oi.length;n++){var o=Oi[n];o.blockedOn===e&&(o.blockedOn=null)}}for(rr!==null&&Ao(rr,e),or!==null&&Ao(or,e),ir!==null&&Ao(ir,e),Xo.forEach(t),Zo.forEach(t),n=0;n<Kn.length;n++)o=Kn[n],o.blockedOn===e&&(o.blockedOn=null);for(;0<Kn.length&&(n=Kn[0],n.blockedOn===null);)Yd(n),n.blockedOn===null&&Kn.shift()}var to=Wn.ReactCurrentBatchConfig,cl=!0;function Yh(e,t,n,o){var a=ut,d=to.transition;to.transition=null;try{ut=1,Vs(e,t,n,o)}finally{ut=a,to.transition=d}}function Wh(e,t,n,o){var a=ut,d=to.transition;to.transition=null;try{ut=4,Vs(e,t,n,o)}finally{ut=a,to.transition=d}}function Vs(e,t,n,o){if(cl){var a=os(e,t,n,o);if(a===null)ka(e,t,o,dl,n),jc(e,o);else if(Vh(a,e,t,n,o))o.stopPropagation();else if(jc(e,o),t&4&&-1<Bh.indexOf(e)){for(;a!==null;){var d=ui(a);if(d!==null&&zd(d),d=os(e,t,n,o),d===null&&ka(e,t,o,dl,n),d===a)break;a=d}a!==null&&o.stopPropagation()}else ka(e,t,o,null,n)}}var dl=null;function os(e,t,n,o){if(dl=null,e=Hs(o),e=Cr(e),e!==null)if(t=Or(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Td(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return dl=e,null}function Wd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Th()){case Ps:return 1;case Rd:return 4;case sl:case Dh:return 16;case _d:return 536870912;default:return 16}default:return 16}}var tr=null,Us=null,Qi=null;function Gd(){if(Qi)return Qi;var e,t=Us,n=t.length,o,a="value"in tr?tr.value:tr.textContent,d=a.length;for(e=0;e<n&&t[e]===a[e];e++);var E=n-e;for(o=1;o<=E&&t[n-o]===a[d-o];o++);return Qi=a.slice(e,1<o?1-o:void 0)}function qi(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Fi(){return!0}function xc(){return!1}function sn(e){function t(n,o,a,d,E){this._reactName=n,this._targetInst=a,this.type=o,this.nativeEvent=d,this.target=E,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(n=e[u],this[u]=n?n(d):d[u]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?Fi:xc,this.isPropagationStopped=xc,this}return wt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Fi)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Fi)},persist:function(){},isPersistent:Fi}),t}var fo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ys=sn(fo),si=wt({},fo,{view:0,detail:0}),Gh=sn(si),Ca,Ea,So,Ml=wt({},si,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ws,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==So&&(So&&e.type==="mousemove"?(Ca=e.screenX-So.screenX,Ea=e.screenY-So.screenY):Ea=Ca=0,So=e),Ca)},movementY:function(e){return"movementY"in e?e.movementY:Ea}}),wc=sn(Ml),Xh=wt({},Ml,{dataTransfer:0}),Zh=sn(Xh),Qh=wt({},si,{relatedTarget:0}),Aa=sn(Qh),qh=wt({},fo,{animationName:0,elapsedTime:0,pseudoElement:0}),Jh=sn(qh),$h=wt({},fo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Kh=sn($h),eg=wt({},fo,{data:0}),Cc=sn(eg),tg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ng={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function og(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=rg[e])?!!t[e]:!1}function Ws(){return og}var ig=wt({},si,{key:function(e){if(e.key){var t=tg[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=qi(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ng[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ws,charCode:function(e){return e.type==="keypress"?qi(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?qi(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),lg=sn(ig),ag=wt({},Ml,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ec=sn(ag),sg=wt({},si,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ws}),ug=sn(sg),cg=wt({},fo,{propertyName:0,elapsedTime:0,pseudoElement:0}),dg=sn(cg),fg=wt({},Ml,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),pg=sn(fg),hg=[9,13,27,32],Gs=Bn&&"CompositionEvent"in window,_o=null;Bn&&"documentMode"in document&&(_o=document.documentMode);var gg=Bn&&"TextEvent"in window&&!_o,Xd=Bn&&(!Gs||_o&&8<_o&&11>=_o),Ac=" ",Sc=!1;function Zd(e,t){switch(e){case"keyup":return hg.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Vr=!1;function mg(e,t){switch(e){case"compositionend":return Qd(t);case"keypress":return t.which!==32?null:(Sc=!0,Ac);case"textInput":return e=t.data,e===Ac&&Sc?null:e;default:return null}}function vg(e,t){if(Vr)return e==="compositionend"||!Gs&&Zd(e,t)?(e=Gd(),Qi=Us=tr=null,Vr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Xd&&t.locale!=="ko"?null:t.data;default:return null}}var bg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!bg[e.type]:t==="textarea"}function qd(e,t,n,o){Ld(o),t=fl(t,"onChange"),0<t.length&&(n=new Ys("onChange","change",null,n,o),e.push({event:n,listeners:t}))}var Ho=null,qo=null;function jg(e){sf(e,0)}function Il(e){var t=Wr(e);if(yd(t))return e}function yg(e,t){if(e==="change")return t}var Jd=!1;Bn&&(Bn?(_i="oninput"in document,_i||(Sa=document.createElement("div"),Sa.setAttribute("oninput","return;"),_i=typeof Sa.oninput=="function"),Ri=_i):Ri=!1,Jd=Ri&&(!document.documentMode||9<document.documentMode));var Ri,_i,Sa;function Nc(){Ho&&(Ho.detachEvent("onpropertychange",$d),qo=Ho=null)}function $d(e){if(e.propertyName==="value"&&Il(qo)){var t=[];qd(t,qo,e,Hs(e)),Id(jg,t)}}function xg(e,t,n){e==="focusin"?(Nc(),Ho=t,qo=n,Ho.attachEvent("onpropertychange",$d)):e==="focusout"&&Nc()}function wg(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Il(qo)}function Cg(e,t){if(e==="click")return Il(t)}function Eg(e,t){if(e==="input"||e==="change")return Il(t)}function Ag(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ln=typeof Object.is=="function"?Object.is:Ag;function Jo(e,t){if(Ln(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(o=0;o<n.length;o++){var a=n[o];if(!za.call(t,a)||!Ln(e[a],t[a]))return!1}return!0}function kc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Mc(e,t){var n=kc(e);e=0;for(var o;n;){if(n.nodeType===3){if(o=e+n.textContent.length,e<=t&&o>=t)return{node:n,offset:t-e};e=o}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=kc(n)}}function Kd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Kd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ef(){for(var e=window,t=il();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=il(e.document)}return t}function Xs(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Sg(e){var t=ef(),n=e.focusedElem,o=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Kd(n.ownerDocument.documentElement,n)){if(o!==null&&Xs(n)){if(t=o.start,e=o.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,d=Math.min(o.start,a);o=o.end===void 0?d:Math.min(o.end,a),!e.extend&&d>o&&(a=o,o=d,d=a),a=Mc(n,d);var E=Mc(n,o);a&&E&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==E.node||e.focusOffset!==E.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),d>o?(e.addRange(t),e.extend(E.node,E.offset)):(t.setEnd(E.node,E.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Lg=Bn&&"documentMode"in document&&11>=document.documentMode,Ur=null,is=null,Po=null,ls=!1;function Ic(e,t,n){var o=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ls||Ur==null||Ur!==il(o)||(o=Ur,"selectionStart"in o&&Xs(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Po&&Jo(Po,o)||(Po=o,o=fl(is,"onSelect"),0<o.length&&(t=new Ys("onSelect","select",null,t,n),e.push({event:t,listeners:o}),t.target=Ur)))}function Hi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Yr={animationend:Hi("Animation","AnimationEnd"),animationiteration:Hi("Animation","AnimationIteration"),animationstart:Hi("Animation","AnimationStart"),transitionend:Hi("Transition","TransitionEnd")},La={},tf={};Bn&&(tf=document.createElement("div").style,"AnimationEvent"in window||(delete Yr.animationend.animation,delete Yr.animationiteration.animation,delete Yr.animationstart.animation),"TransitionEvent"in window||delete Yr.transitionend.transition);function Tl(e){if(La[e])return La[e];if(!Yr[e])return e;var t=Yr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in tf)return La[e]=t[n];return e}var nf=Tl("animationend"),rf=Tl("animationiteration"),of=Tl("animationstart"),lf=Tl("transitionend"),af=new Map,Tc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function pr(e,t){af.set(e,t),Dr(t,[e])}for(Pi=0;Pi<Tc.length;Pi++)zi=Tc[Pi],Dc=zi.toLowerCase(),Oc=zi[0].toUpperCase()+zi.slice(1),pr(Dc,"on"+Oc);var zi,Dc,Oc,Pi;pr(nf,"onAnimationEnd");pr(rf,"onAnimationIteration");pr(of,"onAnimationStart");pr("dblclick","onDoubleClick");pr("focusin","onFocus");pr("focusout","onBlur");pr(lf,"onTransitionEnd");oo("onMouseEnter",["mouseout","mouseover"]);oo("onMouseLeave",["mouseout","mouseover"]);oo("onPointerEnter",["pointerout","pointerover"]);oo("onPointerLeave",["pointerout","pointerover"]);Dr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Dr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Dr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Dr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Dr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Dr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ng=new Set("cancel close invalid load scroll toggle".split(" ").concat(Oo));function Fc(e,t,n){var o=e.type||"unknown-event";e.currentTarget=n,Nh(o,t,void 0,e),e.currentTarget=null}function sf(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var o=e[n],a=o.event;o=o.listeners;e:{var d=void 0;if(t)for(var E=o.length-1;0<=E;E--){var u=o[E],s=u.instance,m=u.currentTarget;if(u=u.listener,s!==d&&a.isPropagationStopped())break e;Fc(a,u,m),d=s}else for(E=0;E<o.length;E++){if(u=o[E],s=u.instance,m=u.currentTarget,u=u.listener,s!==d&&a.isPropagationStopped())break e;Fc(a,u,m),d=s}}}if(al)throw e=ts,al=!1,ts=null,e}function ht(e,t){var n=t[ds];n===void 0&&(n=t[ds]=new Set);var o=e+"__bubble";n.has(o)||(uf(t,e,2,!1),n.add(o))}function Na(e,t,n){var o=0;t&&(o|=4),uf(n,e,o,t)}var Bi="_reactListening"+Math.random().toString(36).slice(2);function $o(e){if(!e[Bi]){e[Bi]=!0,gd.forEach(function(n){n!=="selectionchange"&&(Ng.has(n)||Na(n,!1,e),Na(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Bi]||(t[Bi]=!0,Na("selectionchange",!1,t))}}function uf(e,t,n,o){switch(Wd(t)){case 1:var a=Yh;break;case 4:a=Wh;break;default:a=Vs}n=a.bind(null,t,n,e),a=void 0,!es||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),o?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function ka(e,t,n,o,a){var d=o;if((t&1)===0&&(t&2)===0&&o!==null)e:for(;;){if(o===null)return;var E=o.tag;if(E===3||E===4){var u=o.stateNode.containerInfo;if(u===a||u.nodeType===8&&u.parentNode===a)break;if(E===4)for(E=o.return;E!==null;){var s=E.tag;if((s===3||s===4)&&(s=E.stateNode.containerInfo,s===a||s.nodeType===8&&s.parentNode===a))return;E=E.return}for(;u!==null;){if(E=Cr(u),E===null)return;if(s=E.tag,s===5||s===6){o=d=E;continue e}u=u.parentNode}}o=o.return}Id(function(){var m=d,T=Hs(n),M=[];e:{var g=af.get(e);if(g!==void 0){var p=Ys,b=e;switch(e){case"keypress":if(qi(n)===0)break e;case"keydown":case"keyup":p=lg;break;case"focusin":b="focus",p=Aa;break;case"focusout":b="blur",p=Aa;break;case"beforeblur":case"afterblur":p=Aa;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=wc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Zh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=ug;break;case nf:case rf:case of:p=Jh;break;case lf:p=dg;break;case"scroll":p=Gh;break;case"wheel":p=pg;break;case"copy":case"cut":case"paste":p=Kh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Ec}var j=(t&4)!==0,v=!j&&e==="scroll",C=j?g!==null?g+"Capture":null:g;j=[];for(var A=m,S;A!==null;){S=A;var D=S.stateNode;if(S.tag===5&&D!==null&&(S=D,C!==null&&(D=Go(A,C),D!=null&&j.push(Ko(A,D,S)))),v)break;A=A.return}0<j.length&&(g=new p(g,b,null,n,T),M.push({event:g,listeners:j}))}}if((t&7)===0){e:{if(g=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",g&&n!==$a&&(b=n.relatedTarget||n.fromElement)&&(Cr(b)||b[Vn]))break e;if((p||g)&&(g=T.window===T?T:(g=T.ownerDocument)?g.defaultView||g.parentWindow:window,p?(b=n.relatedTarget||n.toElement,p=m,b=b?Cr(b):null,b!==null&&(v=Or(b),b!==v||b.tag!==5&&b.tag!==6)&&(b=null)):(p=null,b=m),p!==b)){if(j=wc,D="onMouseLeave",C="onMouseEnter",A="mouse",(e==="pointerout"||e==="pointerover")&&(j=Ec,D="onPointerLeave",C="onPointerEnter",A="pointer"),v=p==null?g:Wr(p),S=b==null?g:Wr(b),g=new j(D,A+"leave",p,n,T),g.target=v,g.relatedTarget=S,D=null,Cr(T)===m&&(j=new j(C,A+"enter",b,n,T),j.target=S,j.relatedTarget=v,D=j),v=D,p&&b)t:{for(j=p,C=b,A=0,S=j;S;S=Pr(S))A++;for(S=0,D=C;D;D=Pr(D))S++;for(;0<A-S;)j=Pr(j),A--;for(;0<S-A;)C=Pr(C),S--;for(;A--;){if(j===C||C!==null&&j===C.alternate)break t;j=Pr(j),C=Pr(C)}j=null}else j=null;p!==null&&Rc(M,g,p,j,!1),b!==null&&v!==null&&Rc(M,v,b,j,!0)}}e:{if(g=m?Wr(m):window,p=g.nodeName&&g.nodeName.toLowerCase(),p==="select"||p==="input"&&g.type==="file")var F=yg;else if(Lc(g))if(Jd)F=Eg;else{F=wg;var N=xg}else(p=g.nodeName)&&p.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(F=Cg);if(F&&(F=F(e,m))){qd(M,F,n,T);break e}N&&N(e,g,m),e==="focusout"&&(N=g._wrapperState)&&N.controlled&&g.type==="number"&&Xa(g,"number",g.value)}switch(N=m?Wr(m):window,e){case"focusin":(Lc(N)||N.contentEditable==="true")&&(Ur=N,is=m,Po=null);break;case"focusout":Po=is=Ur=null;break;case"mousedown":ls=!0;break;case"contextmenu":case"mouseup":case"dragend":ls=!1,Ic(M,n,T);break;case"selectionchange":if(Lg)break;case"keydown":case"keyup":Ic(M,n,T)}var _;if(Gs)e:{switch(e){case"compositionstart":var G="onCompositionStart";break e;case"compositionend":G="onCompositionEnd";break e;case"compositionupdate":G="onCompositionUpdate";break e}G=void 0}else Vr?Zd(e,n)&&(G="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(G="onCompositionStart");G&&(Xd&&n.locale!=="ko"&&(Vr||G!=="onCompositionStart"?G==="onCompositionEnd"&&Vr&&(_=Gd()):(tr=T,Us="value"in tr?tr.value:tr.textContent,Vr=!0)),N=fl(m,G),0<N.length&&(G=new Cc(G,e,null,n,T),M.push({event:G,listeners:N}),_?G.data=_:(_=Qd(n),_!==null&&(G.data=_)))),(_=gg?mg(e,n):vg(e,n))&&(m=fl(m,"onBeforeInput"),0<m.length&&(T=new Cc("onBeforeInput","beforeinput",null,n,T),M.push({event:T,listeners:m}),T.data=_))}sf(M,t)})}function Ko(e,t,n){return{instance:e,listener:t,currentTarget:n}}function fl(e,t){for(var n=t+"Capture",o=[];e!==null;){var a=e,d=a.stateNode;a.tag===5&&d!==null&&(a=d,d=Go(e,n),d!=null&&o.unshift(Ko(e,d,a)),d=Go(e,t),d!=null&&o.push(Ko(e,d,a))),e=e.return}return o}function Pr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Rc(e,t,n,o,a){for(var d=t._reactName,E=[];n!==null&&n!==o;){var u=n,s=u.alternate,m=u.stateNode;if(s!==null&&s===o)break;u.tag===5&&m!==null&&(u=m,a?(s=Go(n,d),s!=null&&E.unshift(Ko(n,s,u))):a||(s=Go(n,d),s!=null&&E.push(Ko(n,s,u)))),n=n.return}E.length!==0&&e.push({event:t,listeners:E})}var kg=/\r\n?/g,Mg=/\u0000|\uFFFD/g;function _c(e){return(typeof e=="string"?e:""+e).replace(kg,`
`).replace(Mg,"")}function Vi(e,t,n){if(t=_c(t),_c(e)!==t&&n)throw Error(Le(425))}function pl(){}var as=null,ss=null;function us(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var cs=typeof setTimeout=="function"?setTimeout:void 0,Ig=typeof clearTimeout=="function"?clearTimeout:void 0,Hc=typeof Promise=="function"?Promise:void 0,Tg=typeof queueMicrotask=="function"?queueMicrotask:typeof Hc<"u"?function(e){return Hc.resolve(null).then(e).catch(Dg)}:cs;function Dg(e){setTimeout(function(){throw e})}function Ma(e,t){var n=t,o=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(o===0){e.removeChild(a),Qo(t);return}o--}else n!=="$"&&n!=="$?"&&n!=="$!"||o++;n=a}while(n);Qo(t)}function lr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Pc(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var po=Math.random().toString(36).slice(2),Dn="__reactFiber$"+po,ei="__reactProps$"+po,Vn="__reactContainer$"+po,ds="__reactEvents$"+po,Og="__reactListeners$"+po,Fg="__reactHandles$"+po;function Cr(e){var t=e[Dn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Vn]||n[Dn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Pc(e);e!==null;){if(n=e[Dn])return n;e=Pc(e)}return t}e=n,n=e.parentNode}return null}function ui(e){return e=e[Dn]||e[Vn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Wr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Le(33))}function Dl(e){return e[ei]||null}var fs=[],Gr=-1;function hr(e){return{current:e}}function gt(e){0>Gr||(e.current=fs[Gr],fs[Gr]=null,Gr--)}function pt(e,t){Gr++,fs[Gr]=e.current,e.current=t}var fr={},Vt=hr(fr),Kt=hr(!1),Nr=fr;function io(e,t){var n=e.type.contextTypes;if(!n)return fr;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===t)return o.__reactInternalMemoizedMaskedChildContext;var a={},d;for(d in n)a[d]=t[d];return o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function en(e){return e=e.childContextTypes,e!=null}function hl(){gt(Kt),gt(Vt)}function zc(e,t,n){if(Vt.current!==fr)throw Error(Le(168));pt(Vt,t),pt(Kt,n)}function cf(e,t,n){var o=e.stateNode;if(t=t.childContextTypes,typeof o.getChildContext!="function")return n;o=o.getChildContext();for(var a in o)if(!(a in t))throw Error(Le(108,xh(e)||"Unknown",a));return wt({},n,o)}function gl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||fr,Nr=Vt.current,pt(Vt,e),pt(Kt,Kt.current),!0}function Bc(e,t,n){var o=e.stateNode;if(!o)throw Error(Le(169));n?(e=cf(e,t,Nr),o.__reactInternalMemoizedMergedChildContext=e,gt(Kt),gt(Vt),pt(Vt,e)):gt(Kt),pt(Kt,n)}var _n=null,Ol=!1,Ia=!1;function df(e){_n===null?_n=[e]:_n.push(e)}function Rg(e){Ol=!0,df(e)}function gr(){if(!Ia&&_n!==null){Ia=!0;var e=0,t=ut;try{var n=_n;for(ut=1;e<n.length;e++){var o=n[e];do o=o(!0);while(o!==null)}_n=null,Ol=!1}catch(a){throw _n!==null&&(_n=_n.slice(e+1)),Fd(Ps,gr),a}finally{ut=t,Ia=!1}}return null}var Xr=[],Zr=0,ml=null,vl=0,fn=[],pn=0,kr=null,Hn=1,Pn="";function xr(e,t){Xr[Zr++]=vl,Xr[Zr++]=ml,ml=e,vl=t}function ff(e,t,n){fn[pn++]=Hn,fn[pn++]=Pn,fn[pn++]=kr,kr=e;var o=Hn;e=Pn;var a=32-An(o)-1;o&=~(1<<a),n+=1;var d=32-An(t)+a;if(30<d){var E=a-a%5;d=(o&(1<<E)-1).toString(32),o>>=E,a-=E,Hn=1<<32-An(t)+a|n<<a|o,Pn=d+e}else Hn=1<<d|n<<a|o,Pn=e}function Zs(e){e.return!==null&&(xr(e,1),ff(e,1,0))}function Qs(e){for(;e===ml;)ml=Xr[--Zr],Xr[Zr]=null,vl=Xr[--Zr],Xr[Zr]=null;for(;e===kr;)kr=fn[--pn],fn[pn]=null,Pn=fn[--pn],fn[pn]=null,Hn=fn[--pn],fn[pn]=null}var ln=null,on=null,mt=!1,En=null;function pf(e,t){var n=hn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Vc(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ln=e,on=lr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ln=e,on=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=kr!==null?{id:Hn,overflow:Pn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=hn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,ln=e,on=null,!0):!1;default:return!1}}function ps(e){return(e.mode&1)!==0&&(e.flags&128)===0}function hs(e){if(mt){var t=on;if(t){var n=t;if(!Vc(e,t)){if(ps(e))throw Error(Le(418));t=lr(n.nextSibling);var o=ln;t&&Vc(e,t)?pf(o,n):(e.flags=e.flags&-4097|2,mt=!1,ln=e)}}else{if(ps(e))throw Error(Le(418));e.flags=e.flags&-4097|2,mt=!1,ln=e}}}function Uc(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ln=e}function Ui(e){if(e!==ln)return!1;if(!mt)return Uc(e),mt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!us(e.type,e.memoizedProps)),t&&(t=on)){if(ps(e))throw hf(),Error(Le(418));for(;t;)pf(e,t),t=lr(t.nextSibling)}if(Uc(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Le(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){on=lr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}on=null}}else on=ln?lr(e.stateNode.nextSibling):null;return!0}function hf(){for(var e=on;e;)e=lr(e.nextSibling)}function lo(){on=ln=null,mt=!1}function qs(e){En===null?En=[e]:En.push(e)}var _g=Wn.ReactCurrentBatchConfig;function Lo(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Le(309));var o=n.stateNode}if(!o)throw Error(Le(147,e));var a=o,d=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===d?t.ref:(t=function(E){var u=a.refs;E===null?delete u[d]:u[d]=E},t._stringRef=d,t)}if(typeof e!="string")throw Error(Le(284));if(!n._owner)throw Error(Le(290,e))}return e}function Yi(e,t){throw e=Object.prototype.toString.call(t),Error(Le(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Yc(e){var t=e._init;return t(e._payload)}function gf(e){function t(C,A){if(e){var S=C.deletions;S===null?(C.deletions=[A],C.flags|=16):S.push(A)}}function n(C,A){if(!e)return null;for(;A!==null;)t(C,A),A=A.sibling;return null}function o(C,A){for(C=new Map;A!==null;)A.key!==null?C.set(A.key,A):C.set(A.index,A),A=A.sibling;return C}function a(C,A){return C=cr(C,A),C.index=0,C.sibling=null,C}function d(C,A,S){return C.index=S,e?(S=C.alternate,S!==null?(S=S.index,S<A?(C.flags|=2,A):S):(C.flags|=2,A)):(C.flags|=1048576,A)}function E(C){return e&&C.alternate===null&&(C.flags|=2),C}function u(C,A,S,D){return A===null||A.tag!==6?(A=Ha(S,C.mode,D),A.return=C,A):(A=a(A,S),A.return=C,A)}function s(C,A,S,D){var F=S.type;return F===Br?T(C,A,S.props.children,D,S.key):A!==null&&(A.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Jn&&Yc(F)===A.type)?(D=a(A,S.props),D.ref=Lo(C,A,S),D.return=C,D):(D=ol(S.type,S.key,S.props,null,C.mode,D),D.ref=Lo(C,A,S),D.return=C,D)}function m(C,A,S,D){return A===null||A.tag!==4||A.stateNode.containerInfo!==S.containerInfo||A.stateNode.implementation!==S.implementation?(A=Pa(S,C.mode,D),A.return=C,A):(A=a(A,S.children||[]),A.return=C,A)}function T(C,A,S,D,F){return A===null||A.tag!==7?(A=Lr(S,C.mode,D,F),A.return=C,A):(A=a(A,S),A.return=C,A)}function M(C,A,S){if(typeof A=="string"&&A!==""||typeof A=="number")return A=Ha(""+A,C.mode,S),A.return=C,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case ki:return S=ol(A.type,A.key,A.props,null,C.mode,S),S.ref=Lo(C,null,A),S.return=C,S;case zr:return A=Pa(A,C.mode,S),A.return=C,A;case Jn:var D=A._init;return M(C,D(A._payload),S)}if(To(A)||Co(A))return A=Lr(A,C.mode,S,null),A.return=C,A;Yi(C,A)}return null}function g(C,A,S,D){var F=A!==null?A.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return F!==null?null:u(C,A,""+S,D);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ki:return S.key===F?s(C,A,S,D):null;case zr:return S.key===F?m(C,A,S,D):null;case Jn:return F=S._init,g(C,A,F(S._payload),D)}if(To(S)||Co(S))return F!==null?null:T(C,A,S,D,null);Yi(C,S)}return null}function p(C,A,S,D,F){if(typeof D=="string"&&D!==""||typeof D=="number")return C=C.get(S)||null,u(A,C,""+D,F);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case ki:return C=C.get(D.key===null?S:D.key)||null,s(A,C,D,F);case zr:return C=C.get(D.key===null?S:D.key)||null,m(A,C,D,F);case Jn:var N=D._init;return p(C,A,S,N(D._payload),F)}if(To(D)||Co(D))return C=C.get(S)||null,T(A,C,D,F,null);Yi(A,D)}return null}function b(C,A,S,D){for(var F=null,N=null,_=A,G=A=0,U=null;_!==null&&G<S.length;G++){_.index>G?(U=_,_=null):U=_.sibling;var re=g(C,_,S[G],D);if(re===null){_===null&&(_=U);break}e&&_&&re.alternate===null&&t(C,_),A=d(re,A,G),N===null?F=re:N.sibling=re,N=re,_=U}if(G===S.length)return n(C,_),mt&&xr(C,G),F;if(_===null){for(;G<S.length;G++)_=M(C,S[G],D),_!==null&&(A=d(_,A,G),N===null?F=_:N.sibling=_,N=_);return mt&&xr(C,G),F}for(_=o(C,_);G<S.length;G++)U=p(_,C,G,S[G],D),U!==null&&(e&&U.alternate!==null&&_.delete(U.key===null?G:U.key),A=d(U,A,G),N===null?F=U:N.sibling=U,N=U);return e&&_.forEach(function(fe){return t(C,fe)}),mt&&xr(C,G),F}function j(C,A,S,D){var F=Co(S);if(typeof F!="function")throw Error(Le(150));if(S=F.call(S),S==null)throw Error(Le(151));for(var N=F=null,_=A,G=A=0,U=null,re=S.next();_!==null&&!re.done;G++,re=S.next()){_.index>G?(U=_,_=null):U=_.sibling;var fe=g(C,_,re.value,D);if(fe===null){_===null&&(_=U);break}e&&_&&fe.alternate===null&&t(C,_),A=d(fe,A,G),N===null?F=fe:N.sibling=fe,N=fe,_=U}if(re.done)return n(C,_),mt&&xr(C,G),F;if(_===null){for(;!re.done;G++,re=S.next())re=M(C,re.value,D),re!==null&&(A=d(re,A,G),N===null?F=re:N.sibling=re,N=re);return mt&&xr(C,G),F}for(_=o(C,_);!re.done;G++,re=S.next())re=p(_,C,G,re.value,D),re!==null&&(e&&re.alternate!==null&&_.delete(re.key===null?G:re.key),A=d(re,A,G),N===null?F=re:N.sibling=re,N=re);return e&&_.forEach(function(ae){return t(C,ae)}),mt&&xr(C,G),F}function v(C,A,S,D){if(typeof S=="object"&&S!==null&&S.type===Br&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case ki:e:{for(var F=S.key,N=A;N!==null;){if(N.key===F){if(F=S.type,F===Br){if(N.tag===7){n(C,N.sibling),A=a(N,S.props.children),A.return=C,C=A;break e}}else if(N.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Jn&&Yc(F)===N.type){n(C,N.sibling),A=a(N,S.props),A.ref=Lo(C,N,S),A.return=C,C=A;break e}n(C,N);break}else t(C,N);N=N.sibling}S.type===Br?(A=Lr(S.props.children,C.mode,D,S.key),A.return=C,C=A):(D=ol(S.type,S.key,S.props,null,C.mode,D),D.ref=Lo(C,A,S),D.return=C,C=D)}return E(C);case zr:e:{for(N=S.key;A!==null;){if(A.key===N)if(A.tag===4&&A.stateNode.containerInfo===S.containerInfo&&A.stateNode.implementation===S.implementation){n(C,A.sibling),A=a(A,S.children||[]),A.return=C,C=A;break e}else{n(C,A);break}else t(C,A);A=A.sibling}A=Pa(S,C.mode,D),A.return=C,C=A}return E(C);case Jn:return N=S._init,v(C,A,N(S._payload),D)}if(To(S))return b(C,A,S,D);if(Co(S))return j(C,A,S,D);Yi(C,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,A!==null&&A.tag===6?(n(C,A.sibling),A=a(A,S),A.return=C,C=A):(n(C,A),A=Ha(S,C.mode,D),A.return=C,C=A),E(C)):n(C,A)}return v}var ao=gf(!0),mf=gf(!1),bl=hr(null),jl=null,Qr=null,Js=null;function $s(){Js=Qr=jl=null}function Ks(e){var t=bl.current;gt(bl),e._currentValue=t}function gs(e,t,n){for(;e!==null;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,o!==null&&(o.childLanes|=t)):o!==null&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===n)break;e=e.return}}function no(e,t){jl=e,Js=Qr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&($t=!0),e.firstContext=null)}function mn(e){var t=e._currentValue;if(Js!==e)if(e={context:e,memoizedValue:t,next:null},Qr===null){if(jl===null)throw Error(Le(308));Qr=e,jl.dependencies={lanes:0,firstContext:e}}else Qr=Qr.next=e;return t}var Er=null;function eu(e){Er===null?Er=[e]:Er.push(e)}function vf(e,t,n,o){var a=t.interleaved;return a===null?(n.next=n,eu(t)):(n.next=a.next,a.next=n),t.interleaved=n,Un(e,o)}function Un(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var $n=!1;function tu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bf(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function zn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ar(e,t,n){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,(lt&2)!==0){var a=o.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),o.pending=t,Un(e,n)}return a=o.interleaved,a===null?(t.next=t,eu(o)):(t.next=a.next,a.next=t),o.interleaved=t,Un(e,n)}function Ji(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var o=t.lanes;o&=e.pendingLanes,n|=o,t.lanes=n,zs(e,n)}}function Wc(e,t){var n=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,n===o)){var a=null,d=null;if(n=n.firstBaseUpdate,n!==null){do{var E={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};d===null?a=d=E:d=d.next=E,n=n.next}while(n!==null);d===null?a=d=t:d=d.next=t}else a=d=t;n={baseState:o.baseState,firstBaseUpdate:a,lastBaseUpdate:d,shared:o.shared,effects:o.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function yl(e,t,n,o){var a=e.updateQueue;$n=!1;var d=a.firstBaseUpdate,E=a.lastBaseUpdate,u=a.shared.pending;if(u!==null){a.shared.pending=null;var s=u,m=s.next;s.next=null,E===null?d=m:E.next=m,E=s;var T=e.alternate;T!==null&&(T=T.updateQueue,u=T.lastBaseUpdate,u!==E&&(u===null?T.firstBaseUpdate=m:u.next=m,T.lastBaseUpdate=s))}if(d!==null){var M=a.baseState;E=0,T=m=s=null,u=d;do{var g=u.lane,p=u.eventTime;if((o&g)===g){T!==null&&(T=T.next={eventTime:p,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var b=e,j=u;switch(g=t,p=n,j.tag){case 1:if(b=j.payload,typeof b=="function"){M=b.call(p,M,g);break e}M=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=j.payload,g=typeof b=="function"?b.call(p,M,g):b,g==null)break e;M=wt({},M,g);break e;case 2:$n=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,g=a.effects,g===null?a.effects=[u]:g.push(u))}else p={eventTime:p,lane:g,tag:u.tag,payload:u.payload,callback:u.callback,next:null},T===null?(m=T=p,s=M):T=T.next=p,E|=g;if(u=u.next,u===null){if(u=a.shared.pending,u===null)break;g=u,u=g.next,g.next=null,a.lastBaseUpdate=g,a.shared.pending=null}}while(!0);if(T===null&&(s=M),a.baseState=s,a.firstBaseUpdate=m,a.lastBaseUpdate=T,t=a.shared.interleaved,t!==null){a=t;do E|=a.lane,a=a.next;while(a!==t)}else d===null&&(a.shared.lanes=0);Ir|=E,e.lanes=E,e.memoizedState=M}}function Gc(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var o=e[t],a=o.callback;if(a!==null){if(o.callback=null,o=n,typeof a!="function")throw Error(Le(191,a));a.call(o)}}}var ci={},Fn=hr(ci),ti=hr(ci),ni=hr(ci);function Ar(e){if(e===ci)throw Error(Le(174));return e}function nu(e,t){switch(pt(ni,t),pt(ti,e),pt(Fn,ci),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Qa(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Qa(t,e)}gt(Fn),pt(Fn,t)}function so(){gt(Fn),gt(ti),gt(ni)}function jf(e){Ar(ni.current);var t=Ar(Fn.current),n=Qa(t,e.type);t!==n&&(pt(ti,e),pt(Fn,n))}function ru(e){ti.current===e&&(gt(Fn),gt(ti))}var yt=hr(0);function xl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ta=[];function ou(){for(var e=0;e<Ta.length;e++)Ta[e]._workInProgressVersionPrimary=null;Ta.length=0}var $i=Wn.ReactCurrentDispatcher,Da=Wn.ReactCurrentBatchConfig,Mr=0,xt=null,Nt=null,Mt=null,wl=!1,zo=!1,ri=0,Hg=0;function Pt(){throw Error(Le(321))}function iu(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ln(e[n],t[n]))return!1;return!0}function lu(e,t,n,o,a,d){if(Mr=d,xt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,$i.current=e===null||e.memoizedState===null?Vg:Ug,e=n(o,a),zo){d=0;do{if(zo=!1,ri=0,25<=d)throw Error(Le(301));d+=1,Mt=Nt=null,t.updateQueue=null,$i.current=Yg,e=n(o,a)}while(zo)}if($i.current=Cl,t=Nt!==null&&Nt.next!==null,Mr=0,Mt=Nt=xt=null,wl=!1,t)throw Error(Le(300));return e}function au(){var e=ri!==0;return ri=0,e}function Tn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mt===null?xt.memoizedState=Mt=e:Mt=Mt.next=e,Mt}function vn(){if(Nt===null){var e=xt.alternate;e=e!==null?e.memoizedState:null}else e=Nt.next;var t=Mt===null?xt.memoizedState:Mt.next;if(t!==null)Mt=t,Nt=e;else{if(e===null)throw Error(Le(310));Nt=e,e={memoizedState:Nt.memoizedState,baseState:Nt.baseState,baseQueue:Nt.baseQueue,queue:Nt.queue,next:null},Mt===null?xt.memoizedState=Mt=e:Mt=Mt.next=e}return Mt}function oi(e,t){return typeof t=="function"?t(e):t}function Oa(e){var t=vn(),n=t.queue;if(n===null)throw Error(Le(311));n.lastRenderedReducer=e;var o=Nt,a=o.baseQueue,d=n.pending;if(d!==null){if(a!==null){var E=a.next;a.next=d.next,d.next=E}o.baseQueue=a=d,n.pending=null}if(a!==null){d=a.next,o=o.baseState;var u=E=null,s=null,m=d;do{var T=m.lane;if((Mr&T)===T)s!==null&&(s=s.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),o=m.hasEagerState?m.eagerState:e(o,m.action);else{var M={lane:T,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};s===null?(u=s=M,E=o):s=s.next=M,xt.lanes|=T,Ir|=T}m=m.next}while(m!==null&&m!==d);s===null?E=o:s.next=u,Ln(o,t.memoizedState)||($t=!0),t.memoizedState=o,t.baseState=E,t.baseQueue=s,n.lastRenderedState=o}if(e=n.interleaved,e!==null){a=e;do d=a.lane,xt.lanes|=d,Ir|=d,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Fa(e){var t=vn(),n=t.queue;if(n===null)throw Error(Le(311));n.lastRenderedReducer=e;var o=n.dispatch,a=n.pending,d=t.memoizedState;if(a!==null){n.pending=null;var E=a=a.next;do d=e(d,E.action),E=E.next;while(E!==a);Ln(d,t.memoizedState)||($t=!0),t.memoizedState=d,t.baseQueue===null&&(t.baseState=d),n.lastRenderedState=d}return[d,o]}function yf(){}function xf(e,t){var n=xt,o=vn(),a=t(),d=!Ln(o.memoizedState,a);if(d&&(o.memoizedState=a,$t=!0),o=o.queue,su(Ef.bind(null,n,o,e),[e]),o.getSnapshot!==t||d||Mt!==null&&Mt.memoizedState.tag&1){if(n.flags|=2048,ii(9,Cf.bind(null,n,o,a,t),void 0,null),It===null)throw Error(Le(349));(Mr&30)!==0||wf(n,t,a)}return a}function wf(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=xt.updateQueue,t===null?(t={lastEffect:null,stores:null},xt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Cf(e,t,n,o){t.value=n,t.getSnapshot=o,Af(t)&&Sf(e)}function Ef(e,t,n){return n(function(){Af(t)&&Sf(e)})}function Af(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ln(e,n)}catch{return!0}}function Sf(e){var t=Un(e,1);t!==null&&Sn(t,e,1,-1)}function Xc(e){var t=Tn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:e},t.queue=e,e=e.dispatch=Bg.bind(null,xt,e),[t.memoizedState,e]}function ii(e,t,n,o){return e={tag:e,create:t,destroy:n,deps:o,next:null},t=xt.updateQueue,t===null?(t={lastEffect:null,stores:null},xt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(o=n.next,n.next=e,e.next=o,t.lastEffect=e)),e}function Lf(){return vn().memoizedState}function Ki(e,t,n,o){var a=Tn();xt.flags|=e,a.memoizedState=ii(1|t,n,void 0,o===void 0?null:o)}function Fl(e,t,n,o){var a=vn();o=o===void 0?null:o;var d=void 0;if(Nt!==null){var E=Nt.memoizedState;if(d=E.destroy,o!==null&&iu(o,E.deps)){a.memoizedState=ii(t,n,d,o);return}}xt.flags|=e,a.memoizedState=ii(1|t,n,d,o)}function Zc(e,t){return Ki(8390656,8,e,t)}function su(e,t){return Fl(2048,8,e,t)}function Nf(e,t){return Fl(4,2,e,t)}function kf(e,t){return Fl(4,4,e,t)}function Mf(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function If(e,t,n){return n=n!=null?n.concat([e]):null,Fl(4,4,Mf.bind(null,t,e),n)}function uu(){}function Tf(e,t){var n=vn();t=t===void 0?null:t;var o=n.memoizedState;return o!==null&&t!==null&&iu(t,o[1])?o[0]:(n.memoizedState=[e,t],e)}function Df(e,t){var n=vn();t=t===void 0?null:t;var o=n.memoizedState;return o!==null&&t!==null&&iu(t,o[1])?o[0]:(e=e(),n.memoizedState=[e,t],e)}function Of(e,t,n){return(Mr&21)===0?(e.baseState&&(e.baseState=!1,$t=!0),e.memoizedState=n):(Ln(n,t)||(n=Hd(),xt.lanes|=n,Ir|=n,e.baseState=!0),t)}function Pg(e,t){var n=ut;ut=n!==0&&4>n?n:4,e(!0);var o=Da.transition;Da.transition={};try{e(!1),t()}finally{ut=n,Da.transition=o}}function Ff(){return vn().memoizedState}function zg(e,t,n){var o=ur(e);if(n={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null},Rf(e))_f(t,n);else if(n=vf(e,t,n,o),n!==null){var a=Xt();Sn(n,e,o,a),Hf(n,t,o)}}function Bg(e,t,n){var o=ur(e),a={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null};if(Rf(e))_f(t,a);else{var d=e.alternate;if(e.lanes===0&&(d===null||d.lanes===0)&&(d=t.lastRenderedReducer,d!==null))try{var E=t.lastRenderedState,u=d(E,n);if(a.hasEagerState=!0,a.eagerState=u,Ln(u,E)){var s=t.interleaved;s===null?(a.next=a,eu(t)):(a.next=s.next,s.next=a),t.interleaved=a;return}}catch{}finally{}n=vf(e,t,a,o),n!==null&&(a=Xt(),Sn(n,e,o,a),Hf(n,t,o))}}function Rf(e){var t=e.alternate;return e===xt||t!==null&&t===xt}function _f(e,t){zo=wl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Hf(e,t,n){if((n&4194240)!==0){var o=t.lanes;o&=e.pendingLanes,n|=o,t.lanes=n,zs(e,n)}}var Cl={readContext:mn,useCallback:Pt,useContext:Pt,useEffect:Pt,useImperativeHandle:Pt,useInsertionEffect:Pt,useLayoutEffect:Pt,useMemo:Pt,useReducer:Pt,useRef:Pt,useState:Pt,useDebugValue:Pt,useDeferredValue:Pt,useTransition:Pt,useMutableSource:Pt,useSyncExternalStore:Pt,useId:Pt,unstable_isNewReconciler:!1},Vg={readContext:mn,useCallback:function(e,t){return Tn().memoizedState=[e,t===void 0?null:t],e},useContext:mn,useEffect:Zc,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Ki(4194308,4,Mf.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ki(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ki(4,2,e,t)},useMemo:function(e,t){var n=Tn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var o=Tn();return t=n!==void 0?n(t):t,o.memoizedState=o.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},o.queue=e,e=e.dispatch=zg.bind(null,xt,e),[o.memoizedState,e]},useRef:function(e){var t=Tn();return e={current:e},t.memoizedState=e},useState:Xc,useDebugValue:uu,useDeferredValue:function(e){return Tn().memoizedState=e},useTransition:function(){var e=Xc(!1),t=e[0];return e=Pg.bind(null,e[1]),Tn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var o=xt,a=Tn();if(mt){if(n===void 0)throw Error(Le(407));n=n()}else{if(n=t(),It===null)throw Error(Le(349));(Mr&30)!==0||wf(o,t,n)}a.memoizedState=n;var d={value:n,getSnapshot:t};return a.queue=d,Zc(Ef.bind(null,o,d,e),[e]),o.flags|=2048,ii(9,Cf.bind(null,o,d,n,t),void 0,null),n},useId:function(){var e=Tn(),t=It.identifierPrefix;if(mt){var n=Pn,o=Hn;n=(o&~(1<<32-An(o)-1)).toString(32)+n,t=":"+t+"R"+n,n=ri++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Hg++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Ug={readContext:mn,useCallback:Tf,useContext:mn,useEffect:su,useImperativeHandle:If,useInsertionEffect:Nf,useLayoutEffect:kf,useMemo:Df,useReducer:Oa,useRef:Lf,useState:function(){return Oa(oi)},useDebugValue:uu,useDeferredValue:function(e){var t=vn();return Of(t,Nt.memoizedState,e)},useTransition:function(){var e=Oa(oi)[0],t=vn().memoizedState;return[e,t]},useMutableSource:yf,useSyncExternalStore:xf,useId:Ff,unstable_isNewReconciler:!1},Yg={readContext:mn,useCallback:Tf,useContext:mn,useEffect:su,useImperativeHandle:If,useInsertionEffect:Nf,useLayoutEffect:kf,useMemo:Df,useReducer:Fa,useRef:Lf,useState:function(){return Fa(oi)},useDebugValue:uu,useDeferredValue:function(e){var t=vn();return Nt===null?t.memoizedState=e:Of(t,Nt.memoizedState,e)},useTransition:function(){var e=Fa(oi)[0],t=vn().memoizedState;return[e,t]},useMutableSource:yf,useSyncExternalStore:xf,useId:Ff,unstable_isNewReconciler:!1};function wn(e,t){if(e&&e.defaultProps){t=wt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function ms(e,t,n,o){t=e.memoizedState,n=n(o,t),n=n==null?t:wt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Rl={isMounted:function(e){return(e=e._reactInternals)?Or(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var o=Xt(),a=ur(e),d=zn(o,a);d.payload=t,n!=null&&(d.callback=n),t=ar(e,d,a),t!==null&&(Sn(t,e,a,o),Ji(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var o=Xt(),a=ur(e),d=zn(o,a);d.tag=1,d.payload=t,n!=null&&(d.callback=n),t=ar(e,d,a),t!==null&&(Sn(t,e,a,o),Ji(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Xt(),o=ur(e),a=zn(n,o);a.tag=2,t!=null&&(a.callback=t),t=ar(e,a,o),t!==null&&(Sn(t,e,o,n),Ji(t,e,o))}};function Qc(e,t,n,o,a,d,E){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,d,E):t.prototype&&t.prototype.isPureReactComponent?!Jo(n,o)||!Jo(a,d):!0}function Pf(e,t,n){var o=!1,a=fr,d=t.contextType;return typeof d=="object"&&d!==null?d=mn(d):(a=en(t)?Nr:Vt.current,o=t.contextTypes,d=(o=o!=null)?io(e,a):fr),t=new t(n,d),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Rl,e.stateNode=t,t._reactInternals=e,o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=d),t}function qc(e,t,n,o){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,o),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,o),t.state!==e&&Rl.enqueueReplaceState(t,t.state,null)}function vs(e,t,n,o){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},tu(e);var d=t.contextType;typeof d=="object"&&d!==null?a.context=mn(d):(d=en(t)?Nr:Vt.current,a.context=io(e,d)),a.state=e.memoizedState,d=t.getDerivedStateFromProps,typeof d=="function"&&(ms(e,t,d,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Rl.enqueueReplaceState(a,a.state,null),yl(e,n,a,o),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function uo(e,t){try{var n="",o=t;do n+=yh(o),o=o.return;while(o);var a=n}catch(d){a=`
Error generating stack: `+d.message+`
`+d.stack}return{value:e,source:t,stack:a,digest:null}}function Ra(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function bs(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Wg=typeof WeakMap=="function"?WeakMap:Map;function zf(e,t,n){n=zn(-1,n),n.tag=3,n.payload={element:null};var o=t.value;return n.callback=function(){Al||(Al=!0,Ns=o),bs(e,t)},n}function Bf(e,t,n){n=zn(-1,n),n.tag=3;var o=e.type.getDerivedStateFromError;if(typeof o=="function"){var a=t.value;n.payload=function(){return o(a)},n.callback=function(){bs(e,t)}}var d=e.stateNode;return d!==null&&typeof d.componentDidCatch=="function"&&(n.callback=function(){bs(e,t),typeof o!="function"&&(sr===null?sr=new Set([this]):sr.add(this));var E=t.stack;this.componentDidCatch(t.value,{componentStack:E!==null?E:""})}),n}function Jc(e,t,n){var o=e.pingCache;if(o===null){o=e.pingCache=new Wg;var a=new Set;o.set(t,a)}else a=o.get(t),a===void 0&&(a=new Set,o.set(t,a));a.has(n)||(a.add(n),e=im.bind(null,e,t,n),t.then(e,e))}function $c(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Kc(e,t,n,o,a){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=zn(-1,1),t.tag=2,ar(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var Gg=Wn.ReactCurrentOwner,$t=!1;function Gt(e,t,n,o){t.child=e===null?mf(t,null,n,o):ao(t,e.child,n,o)}function ed(e,t,n,o,a){n=n.render;var d=t.ref;return no(t,a),o=lu(e,t,n,o,d,a),n=au(),e!==null&&!$t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Yn(e,t,a)):(mt&&n&&Zs(t),t.flags|=1,Gt(e,t,o,a),t.child)}function td(e,t,n,o,a){if(e===null){var d=n.type;return typeof d=="function"&&!vu(d)&&d.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=d,Vf(e,t,d,o,a)):(e=ol(n.type,null,o,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(d=e.child,(e.lanes&a)===0){var E=d.memoizedProps;if(n=n.compare,n=n!==null?n:Jo,n(E,o)&&e.ref===t.ref)return Yn(e,t,a)}return t.flags|=1,e=cr(d,o),e.ref=t.ref,e.return=t,t.child=e}function Vf(e,t,n,o,a){if(e!==null){var d=e.memoizedProps;if(Jo(d,o)&&e.ref===t.ref)if($t=!1,t.pendingProps=o=d,(e.lanes&a)!==0)(e.flags&131072)!==0&&($t=!0);else return t.lanes=e.lanes,Yn(e,t,a)}return js(e,t,n,o,a)}function Uf(e,t,n){var o=t.pendingProps,a=o.children,d=e!==null?e.memoizedState:null;if(o.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},pt(Jr,rn),rn|=n;else{if((n&1073741824)===0)return e=d!==null?d.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,pt(Jr,rn),rn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=d!==null?d.baseLanes:n,pt(Jr,rn),rn|=o}else d!==null?(o=d.baseLanes|n,t.memoizedState=null):o=n,pt(Jr,rn),rn|=o;return Gt(e,t,a,n),t.child}function Yf(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function js(e,t,n,o,a){var d=en(n)?Nr:Vt.current;return d=io(t,d),no(t,a),n=lu(e,t,n,o,d,a),o=au(),e!==null&&!$t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Yn(e,t,a)):(mt&&o&&Zs(t),t.flags|=1,Gt(e,t,n,a),t.child)}function nd(e,t,n,o,a){if(en(n)){var d=!0;gl(t)}else d=!1;if(no(t,a),t.stateNode===null)tl(e,t),Pf(t,n,o),vs(t,n,o,a),o=!0;else if(e===null){var E=t.stateNode,u=t.memoizedProps;E.props=u;var s=E.context,m=n.contextType;typeof m=="object"&&m!==null?m=mn(m):(m=en(n)?Nr:Vt.current,m=io(t,m));var T=n.getDerivedStateFromProps,M=typeof T=="function"||typeof E.getSnapshotBeforeUpdate=="function";M||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(u!==o||s!==m)&&qc(t,E,o,m),$n=!1;var g=t.memoizedState;E.state=g,yl(t,o,E,a),s=t.memoizedState,u!==o||g!==s||Kt.current||$n?(typeof T=="function"&&(ms(t,n,T,o),s=t.memoizedState),(u=$n||Qc(t,n,u,o,g,s,m))?(M||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(t.flags|=4194308)):(typeof E.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=s),E.props=o,E.state=s,E.context=m,o=u):(typeof E.componentDidMount=="function"&&(t.flags|=4194308),o=!1)}else{E=t.stateNode,bf(e,t),u=t.memoizedProps,m=t.type===t.elementType?u:wn(t.type,u),E.props=m,M=t.pendingProps,g=E.context,s=n.contextType,typeof s=="object"&&s!==null?s=mn(s):(s=en(n)?Nr:Vt.current,s=io(t,s));var p=n.getDerivedStateFromProps;(T=typeof p=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(u!==M||g!==s)&&qc(t,E,o,s),$n=!1,g=t.memoizedState,E.state=g,yl(t,o,E,a);var b=t.memoizedState;u!==M||g!==b||Kt.current||$n?(typeof p=="function"&&(ms(t,n,p,o),b=t.memoizedState),(m=$n||Qc(t,n,m,o,g,b,s)||!1)?(T||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(o,b,s),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(o,b,s)),typeof E.componentDidUpdate=="function"&&(t.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof E.componentDidUpdate!="function"||u===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=b),E.props=o,E.state=b,E.context=s,o=m):(typeof E.componentDidUpdate!="function"||u===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),o=!1)}return ys(e,t,n,o,d,a)}function ys(e,t,n,o,a,d){Yf(e,t);var E=(t.flags&128)!==0;if(!o&&!E)return a&&Bc(t,n,!1),Yn(e,t,d);o=t.stateNode,Gg.current=t;var u=E&&typeof n.getDerivedStateFromError!="function"?null:o.render();return t.flags|=1,e!==null&&E?(t.child=ao(t,e.child,null,d),t.child=ao(t,null,u,d)):Gt(e,t,u,d),t.memoizedState=o.state,a&&Bc(t,n,!0),t.child}function Wf(e){var t=e.stateNode;t.pendingContext?zc(e,t.pendingContext,t.pendingContext!==t.context):t.context&&zc(e,t.context,!1),nu(e,t.containerInfo)}function rd(e,t,n,o,a){return lo(),qs(a),t.flags|=256,Gt(e,t,n,o),t.child}var xs={dehydrated:null,treeContext:null,retryLane:0};function ws(e){return{baseLanes:e,cachePool:null,transitions:null}}function Gf(e,t,n){var o=t.pendingProps,a=yt.current,d=!1,E=(t.flags&128)!==0,u;if((u=E)||(u=e!==null&&e.memoizedState===null?!1:(a&2)!==0),u?(d=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),pt(yt,a&1),e===null)return hs(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(E=o.children,e=o.fallback,d?(o=t.mode,d=t.child,E={mode:"hidden",children:E},(o&1)===0&&d!==null?(d.childLanes=0,d.pendingProps=E):d=Pl(E,o,0,null),e=Lr(e,o,n,null),d.return=t,e.return=t,d.sibling=e,t.child=d,t.child.memoizedState=ws(n),t.memoizedState=xs,e):cu(t,E));if(a=e.memoizedState,a!==null&&(u=a.dehydrated,u!==null))return Xg(e,t,E,o,u,a,n);if(d){d=o.fallback,E=t.mode,a=e.child,u=a.sibling;var s={mode:"hidden",children:o.children};return(E&1)===0&&t.child!==a?(o=t.child,o.childLanes=0,o.pendingProps=s,t.deletions=null):(o=cr(a,s),o.subtreeFlags=a.subtreeFlags&14680064),u!==null?d=cr(u,d):(d=Lr(d,E,n,null),d.flags|=2),d.return=t,o.return=t,o.sibling=d,t.child=o,o=d,d=t.child,E=e.child.memoizedState,E=E===null?ws(n):{baseLanes:E.baseLanes|n,cachePool:null,transitions:E.transitions},d.memoizedState=E,d.childLanes=e.childLanes&~n,t.memoizedState=xs,o}return d=e.child,e=d.sibling,o=cr(d,{mode:"visible",children:o.children}),(t.mode&1)===0&&(o.lanes=n),o.return=t,o.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function cu(e,t){return t=Pl({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Wi(e,t,n,o){return o!==null&&qs(o),ao(t,e.child,null,n),e=cu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Xg(e,t,n,o,a,d,E){if(n)return t.flags&256?(t.flags&=-257,o=Ra(Error(Le(422))),Wi(e,t,E,o)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(d=o.fallback,a=t.mode,o=Pl({mode:"visible",children:o.children},a,0,null),d=Lr(d,a,E,null),d.flags|=2,o.return=t,d.return=t,o.sibling=d,t.child=o,(t.mode&1)!==0&&ao(t,e.child,null,E),t.child.memoizedState=ws(E),t.memoizedState=xs,d);if((t.mode&1)===0)return Wi(e,t,E,null);if(a.data==="$!"){if(o=a.nextSibling&&a.nextSibling.dataset,o)var u=o.dgst;return o=u,d=Error(Le(419)),o=Ra(d,o,void 0),Wi(e,t,E,o)}if(u=(E&e.childLanes)!==0,$t||u){if(o=It,o!==null){switch(E&-E){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=(a&(o.suspendedLanes|E))!==0?0:a,a!==0&&a!==d.retryLane&&(d.retryLane=a,Un(e,a),Sn(o,e,a,-1))}return mu(),o=Ra(Error(Le(421))),Wi(e,t,E,o)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=lm.bind(null,e),a._reactRetry=t,null):(e=d.treeContext,on=lr(a.nextSibling),ln=t,mt=!0,En=null,e!==null&&(fn[pn++]=Hn,fn[pn++]=Pn,fn[pn++]=kr,Hn=e.id,Pn=e.overflow,kr=t),t=cu(t,o.children),t.flags|=4096,t)}function od(e,t,n){e.lanes|=t;var o=e.alternate;o!==null&&(o.lanes|=t),gs(e.return,t,n)}function _a(e,t,n,o,a){var d=e.memoizedState;d===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:n,tailMode:a}:(d.isBackwards=t,d.rendering=null,d.renderingStartTime=0,d.last=o,d.tail=n,d.tailMode=a)}function Xf(e,t,n){var o=t.pendingProps,a=o.revealOrder,d=o.tail;if(Gt(e,t,o.children,n),o=yt.current,(o&2)!==0)o=o&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&od(e,n,t);else if(e.tag===19)od(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(pt(yt,o),(t.mode&1)===0)t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&xl(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),_a(t,!1,a,n,d);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&xl(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}_a(t,!0,n,null,d);break;case"together":_a(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function tl(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Yn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ir|=t.lanes,(n&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(Le(153));if(t.child!==null){for(e=t.child,n=cr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=cr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Zg(e,t,n){switch(t.tag){case 3:Wf(t),lo();break;case 5:jf(t);break;case 1:en(t.type)&&gl(t);break;case 4:nu(t,t.stateNode.containerInfo);break;case 10:var o=t.type._context,a=t.memoizedProps.value;pt(bl,o._currentValue),o._currentValue=a;break;case 13:if(o=t.memoizedState,o!==null)return o.dehydrated!==null?(pt(yt,yt.current&1),t.flags|=128,null):(n&t.child.childLanes)!==0?Gf(e,t,n):(pt(yt,yt.current&1),e=Yn(e,t,n),e!==null?e.sibling:null);pt(yt,yt.current&1);break;case 19:if(o=(n&t.childLanes)!==0,(e.flags&128)!==0){if(o)return Xf(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),pt(yt,yt.current),o)break;return null;case 22:case 23:return t.lanes=0,Uf(e,t,n)}return Yn(e,t,n)}var Zf,Cs,Qf,qf;Zf=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Cs=function(){};Qf=function(e,t,n,o){var a=e.memoizedProps;if(a!==o){e=t.stateNode,Ar(Fn.current);var d=null;switch(n){case"input":a=Wa(e,a),o=Wa(e,o),d=[];break;case"select":a=wt({},a,{value:void 0}),o=wt({},o,{value:void 0}),d=[];break;case"textarea":a=Za(e,a),o=Za(e,o),d=[];break;default:typeof a.onClick!="function"&&typeof o.onClick=="function"&&(e.onclick=pl)}qa(n,o);var E;n=null;for(m in a)if(!o.hasOwnProperty(m)&&a.hasOwnProperty(m)&&a[m]!=null)if(m==="style"){var u=a[m];for(E in u)u.hasOwnProperty(E)&&(n||(n={}),n[E]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(Yo.hasOwnProperty(m)?d||(d=[]):(d=d||[]).push(m,null));for(m in o){var s=o[m];if(u=a?.[m],o.hasOwnProperty(m)&&s!==u&&(s!=null||u!=null))if(m==="style")if(u){for(E in u)!u.hasOwnProperty(E)||s&&s.hasOwnProperty(E)||(n||(n={}),n[E]="");for(E in s)s.hasOwnProperty(E)&&u[E]!==s[E]&&(n||(n={}),n[E]=s[E])}else n||(d||(d=[]),d.push(m,n)),n=s;else m==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,u=u?u.__html:void 0,s!=null&&u!==s&&(d=d||[]).push(m,s)):m==="children"?typeof s!="string"&&typeof s!="number"||(d=d||[]).push(m,""+s):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(Yo.hasOwnProperty(m)?(s!=null&&m==="onScroll"&&ht("scroll",e),d||u===s||(d=[])):(d=d||[]).push(m,s))}n&&(d=d||[]).push("style",n);var m=d;(t.updateQueue=m)&&(t.flags|=4)}};qf=function(e,t,n,o){n!==o&&(t.flags|=4)};function No(e,t){if(!mt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function zt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,o=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,o|=a.subtreeFlags&14680064,o|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,o|=a.subtreeFlags,o|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=o,e.childLanes=n,t}function Qg(e,t,n){var o=t.pendingProps;switch(Qs(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zt(t),null;case 1:return en(t.type)&&hl(),zt(t),null;case 3:return o=t.stateNode,so(),gt(Kt),gt(Vt),ou(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(e===null||e.child===null)&&(Ui(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,En!==null&&(Is(En),En=null))),Cs(e,t),zt(t),null;case 5:ru(t);var a=Ar(ni.current);if(n=t.type,e!==null&&t.stateNode!=null)Qf(e,t,n,o,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!o){if(t.stateNode===null)throw Error(Le(166));return zt(t),null}if(e=Ar(Fn.current),Ui(t)){o=t.stateNode,n=t.type;var d=t.memoizedProps;switch(o[Dn]=t,o[ei]=d,e=(t.mode&1)!==0,n){case"dialog":ht("cancel",o),ht("close",o);break;case"iframe":case"object":case"embed":ht("load",o);break;case"video":case"audio":for(a=0;a<Oo.length;a++)ht(Oo[a],o);break;case"source":ht("error",o);break;case"img":case"image":case"link":ht("error",o),ht("load",o);break;case"details":ht("toggle",o);break;case"input":fc(o,d),ht("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!d.multiple},ht("invalid",o);break;case"textarea":hc(o,d),ht("invalid",o)}qa(n,d),a=null;for(var E in d)if(d.hasOwnProperty(E)){var u=d[E];E==="children"?typeof u=="string"?o.textContent!==u&&(d.suppressHydrationWarning!==!0&&Vi(o.textContent,u,e),a=["children",u]):typeof u=="number"&&o.textContent!==""+u&&(d.suppressHydrationWarning!==!0&&Vi(o.textContent,u,e),a=["children",""+u]):Yo.hasOwnProperty(E)&&u!=null&&E==="onScroll"&&ht("scroll",o)}switch(n){case"input":Mi(o),pc(o,d,!0);break;case"textarea":Mi(o),gc(o);break;case"select":case"option":break;default:typeof d.onClick=="function"&&(o.onclick=pl)}o=a,t.updateQueue=o,o!==null&&(t.flags|=4)}else{E=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Cd(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=E.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof o.is=="string"?e=E.createElement(n,{is:o.is}):(e=E.createElement(n),n==="select"&&(E=e,o.multiple?E.multiple=!0:o.size&&(E.size=o.size))):e=E.createElementNS(e,n),e[Dn]=t,e[ei]=o,Zf(e,t,!1,!1),t.stateNode=e;e:{switch(E=Ja(n,o),n){case"dialog":ht("cancel",e),ht("close",e),a=o;break;case"iframe":case"object":case"embed":ht("load",e),a=o;break;case"video":case"audio":for(a=0;a<Oo.length;a++)ht(Oo[a],e);a=o;break;case"source":ht("error",e),a=o;break;case"img":case"image":case"link":ht("error",e),ht("load",e),a=o;break;case"details":ht("toggle",e),a=o;break;case"input":fc(e,o),a=Wa(e,o),ht("invalid",e);break;case"option":a=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},a=wt({},o,{value:void 0}),ht("invalid",e);break;case"textarea":hc(e,o),a=Za(e,o),ht("invalid",e);break;default:a=o}qa(n,a),u=a;for(d in u)if(u.hasOwnProperty(d)){var s=u[d];d==="style"?Sd(e,s):d==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,s!=null&&Ed(e,s)):d==="children"?typeof s=="string"?(n!=="textarea"||s!=="")&&Wo(e,s):typeof s=="number"&&Wo(e,""+s):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Yo.hasOwnProperty(d)?s!=null&&d==="onScroll"&&ht("scroll",e):s!=null&&Os(e,d,s,E))}switch(n){case"input":Mi(e),pc(e,o,!1);break;case"textarea":Mi(e),gc(e);break;case"option":o.value!=null&&e.setAttribute("value",""+dr(o.value));break;case"select":e.multiple=!!o.multiple,d=o.value,d!=null?$r(e,!!o.multiple,d,!1):o.defaultValue!=null&&$r(e,!!o.multiple,o.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=pl)}switch(n){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return zt(t),null;case 6:if(e&&t.stateNode!=null)qf(e,t,e.memoizedProps,o);else{if(typeof o!="string"&&t.stateNode===null)throw Error(Le(166));if(n=Ar(ni.current),Ar(Fn.current),Ui(t)){if(o=t.stateNode,n=t.memoizedProps,o[Dn]=t,(d=o.nodeValue!==n)&&(e=ln,e!==null))switch(e.tag){case 3:Vi(o.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Vi(o.nodeValue,n,(e.mode&1)!==0)}d&&(t.flags|=4)}else o=(n.nodeType===9?n:n.ownerDocument).createTextNode(o),o[Dn]=t,t.stateNode=o}return zt(t),null;case 13:if(gt(yt),o=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(mt&&on!==null&&(t.mode&1)!==0&&(t.flags&128)===0)hf(),lo(),t.flags|=98560,d=!1;else if(d=Ui(t),o!==null&&o.dehydrated!==null){if(e===null){if(!d)throw Error(Le(318));if(d=t.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(Le(317));d[Dn]=t}else lo(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;zt(t),d=!1}else En!==null&&(Is(En),En=null),d=!0;if(!d)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=n,t):(o=o!==null,o!==(e!==null&&e.memoizedState!==null)&&o&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(yt.current&1)!==0?kt===0&&(kt=3):mu())),t.updateQueue!==null&&(t.flags|=4),zt(t),null);case 4:return so(),Cs(e,t),e===null&&$o(t.stateNode.containerInfo),zt(t),null;case 10:return Ks(t.type._context),zt(t),null;case 17:return en(t.type)&&hl(),zt(t),null;case 19:if(gt(yt),d=t.memoizedState,d===null)return zt(t),null;if(o=(t.flags&128)!==0,E=d.rendering,E===null)if(o)No(d,!1);else{if(kt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(E=xl(e),E!==null){for(t.flags|=128,No(d,!1),o=E.updateQueue,o!==null&&(t.updateQueue=o,t.flags|=4),t.subtreeFlags=0,o=n,n=t.child;n!==null;)d=n,e=o,d.flags&=14680066,E=d.alternate,E===null?(d.childLanes=0,d.lanes=e,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=E.childLanes,d.lanes=E.lanes,d.child=E.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=E.memoizedProps,d.memoizedState=E.memoizedState,d.updateQueue=E.updateQueue,d.type=E.type,e=E.dependencies,d.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return pt(yt,yt.current&1|2),t.child}e=e.sibling}d.tail!==null&&St()>co&&(t.flags|=128,o=!0,No(d,!1),t.lanes=4194304)}else{if(!o)if(e=xl(E),e!==null){if(t.flags|=128,o=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),No(d,!0),d.tail===null&&d.tailMode==="hidden"&&!E.alternate&&!mt)return zt(t),null}else 2*St()-d.renderingStartTime>co&&n!==1073741824&&(t.flags|=128,o=!0,No(d,!1),t.lanes=4194304);d.isBackwards?(E.sibling=t.child,t.child=E):(n=d.last,n!==null?n.sibling=E:t.child=E,d.last=E)}return d.tail!==null?(t=d.tail,d.rendering=t,d.tail=t.sibling,d.renderingStartTime=St(),t.sibling=null,n=yt.current,pt(yt,o?n&1|2:n&1),t):(zt(t),null);case 22:case 23:return gu(),o=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==o&&(t.flags|=8192),o&&(t.mode&1)!==0?(rn&1073741824)!==0&&(zt(t),t.subtreeFlags&6&&(t.flags|=8192)):zt(t),null;case 24:return null;case 25:return null}throw Error(Le(156,t.tag))}function qg(e,t){switch(Qs(t),t.tag){case 1:return en(t.type)&&hl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return so(),gt(Kt),gt(Vt),ou(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return ru(t),null;case 13:if(gt(yt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Le(340));lo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return gt(yt),null;case 4:return so(),null;case 10:return Ks(t.type._context),null;case 22:case 23:return gu(),null;case 24:return null;default:return null}}var Gi=!1,Bt=!1,Jg=typeof WeakSet=="function"?WeakSet:Set,He=null;function qr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(o){At(e,t,o)}else n.current=null}function Es(e,t,n){try{n()}catch(o){At(e,t,o)}}var id=!1;function $g(e,t){if(as=cl,e=ef(),Xs(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var o=n.getSelection&&n.getSelection();if(o&&o.rangeCount!==0){n=o.anchorNode;var a=o.anchorOffset,d=o.focusNode;o=o.focusOffset;try{n.nodeType,d.nodeType}catch{n=null;break e}var E=0,u=-1,s=-1,m=0,T=0,M=e,g=null;t:for(;;){for(var p;M!==n||a!==0&&M.nodeType!==3||(u=E+a),M!==d||o!==0&&M.nodeType!==3||(s=E+o),M.nodeType===3&&(E+=M.nodeValue.length),(p=M.firstChild)!==null;)g=M,M=p;for(;;){if(M===e)break t;if(g===n&&++m===a&&(u=E),g===d&&++T===o&&(s=E),(p=M.nextSibling)!==null)break;M=g,g=M.parentNode}M=p}n=u===-1||s===-1?null:{start:u,end:s}}else n=null}n=n||{start:0,end:0}}else n=null;for(ss={focusedElem:e,selectionRange:n},cl=!1,He=t;He!==null;)if(t=He,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,He=e;else for(;He!==null;){t=He;try{var b=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var j=b.memoizedProps,v=b.memoizedState,C=t.stateNode,A=C.getSnapshotBeforeUpdate(t.elementType===t.type?j:wn(t.type,j),v);C.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var S=t.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Le(163))}}catch(D){At(t,t.return,D)}if(e=t.sibling,e!==null){e.return=t.return,He=e;break}He=t.return}return b=id,id=!1,b}function Bo(e,t,n){var o=t.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var a=o=o.next;do{if((a.tag&e)===e){var d=a.destroy;a.destroy=void 0,d!==void 0&&Es(t,n,d)}a=a.next}while(a!==o)}}function _l(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var o=n.create;n.destroy=o()}n=n.next}while(n!==t)}}function As(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Jf(e){var t=e.alternate;t!==null&&(e.alternate=null,Jf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Dn],delete t[ei],delete t[ds],delete t[Og],delete t[Fg])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function $f(e){return e.tag===5||e.tag===3||e.tag===4}function ld(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||$f(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ss(e,t,n){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=pl));else if(o!==4&&(e=e.child,e!==null))for(Ss(e,t,n),e=e.sibling;e!==null;)Ss(e,t,n),e=e.sibling}function Ls(e,t,n){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(o!==4&&(e=e.child,e!==null))for(Ls(e,t,n),e=e.sibling;e!==null;)Ls(e,t,n),e=e.sibling}var Ot=null,Cn=!1;function qn(e,t,n){for(n=n.child;n!==null;)Kf(e,t,n),n=n.sibling}function Kf(e,t,n){if(On&&typeof On.onCommitFiberUnmount=="function")try{On.onCommitFiberUnmount(kl,n)}catch{}switch(n.tag){case 5:Bt||qr(n,t);case 6:var o=Ot,a=Cn;Ot=null,qn(e,t,n),Ot=o,Cn=a,Ot!==null&&(Cn?(e=Ot,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Ot.removeChild(n.stateNode));break;case 18:Ot!==null&&(Cn?(e=Ot,n=n.stateNode,e.nodeType===8?Ma(e.parentNode,n):e.nodeType===1&&Ma(e,n),Qo(e)):Ma(Ot,n.stateNode));break;case 4:o=Ot,a=Cn,Ot=n.stateNode.containerInfo,Cn=!0,qn(e,t,n),Ot=o,Cn=a;break;case 0:case 11:case 14:case 15:if(!Bt&&(o=n.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){a=o=o.next;do{var d=a,E=d.destroy;d=d.tag,E!==void 0&&((d&2)!==0||(d&4)!==0)&&Es(n,t,E),a=a.next}while(a!==o)}qn(e,t,n);break;case 1:if(!Bt&&(qr(n,t),o=n.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=n.memoizedProps,o.state=n.memoizedState,o.componentWillUnmount()}catch(u){At(n,t,u)}qn(e,t,n);break;case 21:qn(e,t,n);break;case 22:n.mode&1?(Bt=(o=Bt)||n.memoizedState!==null,qn(e,t,n),Bt=o):qn(e,t,n);break;default:qn(e,t,n)}}function ad(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Jg),t.forEach(function(o){var a=am.bind(null,e,o);n.has(o)||(n.add(o),o.then(a,a))})}}function xn(e,t){var n=t.deletions;if(n!==null)for(var o=0;o<n.length;o++){var a=n[o];try{var d=e,E=t,u=E;e:for(;u!==null;){switch(u.tag){case 5:Ot=u.stateNode,Cn=!1;break e;case 3:Ot=u.stateNode.containerInfo,Cn=!0;break e;case 4:Ot=u.stateNode.containerInfo,Cn=!0;break e}u=u.return}if(Ot===null)throw Error(Le(160));Kf(d,E,a),Ot=null,Cn=!1;var s=a.alternate;s!==null&&(s.return=null),a.return=null}catch(m){At(a,t,m)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)ep(t,e),t=t.sibling}function ep(e,t){var n=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(xn(t,e),In(e),o&4){try{Bo(3,e,e.return),_l(3,e)}catch(j){At(e,e.return,j)}try{Bo(5,e,e.return)}catch(j){At(e,e.return,j)}}break;case 1:xn(t,e),In(e),o&512&&n!==null&&qr(n,n.return);break;case 5:if(xn(t,e),In(e),o&512&&n!==null&&qr(n,n.return),e.flags&32){var a=e.stateNode;try{Wo(a,"")}catch(j){At(e,e.return,j)}}if(o&4&&(a=e.stateNode,a!=null)){var d=e.memoizedProps,E=n!==null?n.memoizedProps:d,u=e.type,s=e.updateQueue;if(e.updateQueue=null,s!==null)try{u==="input"&&d.type==="radio"&&d.name!=null&&xd(a,d),Ja(u,E);var m=Ja(u,d);for(E=0;E<s.length;E+=2){var T=s[E],M=s[E+1];T==="style"?Sd(a,M):T==="dangerouslySetInnerHTML"?Ed(a,M):T==="children"?Wo(a,M):Os(a,T,M,m)}switch(u){case"input":Ga(a,d);break;case"textarea":wd(a,d);break;case"select":var g=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!d.multiple;var p=d.value;p!=null?$r(a,!!d.multiple,p,!1):g!==!!d.multiple&&(d.defaultValue!=null?$r(a,!!d.multiple,d.defaultValue,!0):$r(a,!!d.multiple,d.multiple?[]:"",!1))}a[ei]=d}catch(j){At(e,e.return,j)}}break;case 6:if(xn(t,e),In(e),o&4){if(e.stateNode===null)throw Error(Le(162));a=e.stateNode,d=e.memoizedProps;try{a.nodeValue=d}catch(j){At(e,e.return,j)}}break;case 3:if(xn(t,e),In(e),o&4&&n!==null&&n.memoizedState.isDehydrated)try{Qo(t.containerInfo)}catch(j){At(e,e.return,j)}break;case 4:xn(t,e),In(e);break;case 13:xn(t,e),In(e),a=e.child,a.flags&8192&&(d=a.memoizedState!==null,a.stateNode.isHidden=d,!d||a.alternate!==null&&a.alternate.memoizedState!==null||(pu=St())),o&4&&ad(e);break;case 22:if(T=n!==null&&n.memoizedState!==null,e.mode&1?(Bt=(m=Bt)||T,xn(t,e),Bt=m):xn(t,e),In(e),o&8192){if(m=e.memoizedState!==null,(e.stateNode.isHidden=m)&&!T&&(e.mode&1)!==0)for(He=e,T=e.child;T!==null;){for(M=He=T;He!==null;){switch(g=He,p=g.child,g.tag){case 0:case 11:case 14:case 15:Bo(4,g,g.return);break;case 1:qr(g,g.return);var b=g.stateNode;if(typeof b.componentWillUnmount=="function"){o=g,n=g.return;try{t=o,b.props=t.memoizedProps,b.state=t.memoizedState,b.componentWillUnmount()}catch(j){At(o,n,j)}}break;case 5:qr(g,g.return);break;case 22:if(g.memoizedState!==null){ud(M);continue}}p!==null?(p.return=g,He=p):ud(M)}T=T.sibling}e:for(T=null,M=e;;){if(M.tag===5){if(T===null){T=M;try{a=M.stateNode,m?(d=a.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none"):(u=M.stateNode,s=M.memoizedProps.style,E=s!=null&&s.hasOwnProperty("display")?s.display:null,u.style.display=Ad("display",E))}catch(j){At(e,e.return,j)}}}else if(M.tag===6){if(T===null)try{M.stateNode.nodeValue=m?"":M.memoizedProps}catch(j){At(e,e.return,j)}}else if((M.tag!==22&&M.tag!==23||M.memoizedState===null||M===e)&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===e)break e;for(;M.sibling===null;){if(M.return===null||M.return===e)break e;T===M&&(T=null),M=M.return}T===M&&(T=null),M.sibling.return=M.return,M=M.sibling}}break;case 19:xn(t,e),In(e),o&4&&ad(e);break;case 21:break;default:xn(t,e),In(e)}}function In(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if($f(n)){var o=n;break e}n=n.return}throw Error(Le(160))}switch(o.tag){case 5:var a=o.stateNode;o.flags&32&&(Wo(a,""),o.flags&=-33);var d=ld(e);Ls(e,d,a);break;case 3:case 4:var E=o.stateNode.containerInfo,u=ld(e);Ss(e,u,E);break;default:throw Error(Le(161))}}catch(s){At(e,e.return,s)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Kg(e,t,n){He=e,tp(e,t,n)}function tp(e,t,n){for(var o=(e.mode&1)!==0;He!==null;){var a=He,d=a.child;if(a.tag===22&&o){var E=a.memoizedState!==null||Gi;if(!E){var u=a.alternate,s=u!==null&&u.memoizedState!==null||Bt;u=Gi;var m=Bt;if(Gi=E,(Bt=s)&&!m)for(He=a;He!==null;)E=He,s=E.child,E.tag===22&&E.memoizedState!==null?cd(a):s!==null?(s.return=E,He=s):cd(a);for(;d!==null;)He=d,tp(d,t,n),d=d.sibling;He=a,Gi=u,Bt=m}sd(e,t,n)}else(a.subtreeFlags&8772)!==0&&d!==null?(d.return=a,He=d):sd(e,t,n)}}function sd(e){for(;He!==null;){var t=He;if((t.flags&8772)!==0){var n=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:Bt||_l(5,t);break;case 1:var o=t.stateNode;if(t.flags&4&&!Bt)if(n===null)o.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:wn(t.type,n.memoizedProps);o.componentDidUpdate(a,n.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var d=t.updateQueue;d!==null&&Gc(t,d,o);break;case 3:var E=t.updateQueue;if(E!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Gc(t,E,n)}break;case 5:var u=t.stateNode;if(n===null&&t.flags&4){n=u;var s=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":s.autoFocus&&n.focus();break;case"img":s.src&&(n.src=s.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var m=t.alternate;if(m!==null){var T=m.memoizedState;if(T!==null){var M=T.dehydrated;M!==null&&Qo(M)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Le(163))}Bt||t.flags&512&&As(t)}catch(g){At(t,t.return,g)}}if(t===e){He=null;break}if(n=t.sibling,n!==null){n.return=t.return,He=n;break}He=t.return}}function ud(e){for(;He!==null;){var t=He;if(t===e){He=null;break}var n=t.sibling;if(n!==null){n.return=t.return,He=n;break}He=t.return}}function cd(e){for(;He!==null;){var t=He;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{_l(4,t)}catch(s){At(t,n,s)}break;case 1:var o=t.stateNode;if(typeof o.componentDidMount=="function"){var a=t.return;try{o.componentDidMount()}catch(s){At(t,a,s)}}var d=t.return;try{As(t)}catch(s){At(t,d,s)}break;case 5:var E=t.return;try{As(t)}catch(s){At(t,E,s)}}}catch(s){At(t,t.return,s)}if(t===e){He=null;break}var u=t.sibling;if(u!==null){u.return=t.return,He=u;break}He=t.return}}var em=Math.ceil,El=Wn.ReactCurrentDispatcher,du=Wn.ReactCurrentOwner,gn=Wn.ReactCurrentBatchConfig,lt=0,It=null,Lt=null,Ft=0,rn=0,Jr=hr(0),kt=0,li=null,Ir=0,Hl=0,fu=0,Vo=null,Jt=null,pu=0,co=1/0,Rn=null,Al=!1,Ns=null,sr=null,Xi=!1,nr=null,Sl=0,Uo=0,ks=null,nl=-1,rl=0;function Xt(){return(lt&6)!==0?St():nl!==-1?nl:nl=St()}function ur(e){return(e.mode&1)===0?1:(lt&2)!==0&&Ft!==0?Ft&-Ft:_g.transition!==null?(rl===0&&(rl=Hd()),rl):(e=ut,e!==0||(e=window.event,e=e===void 0?16:Wd(e.type)),e)}function Sn(e,t,n,o){if(50<Uo)throw Uo=0,ks=null,Error(Le(185));ai(e,n,o),((lt&2)===0||e!==It)&&(e===It&&((lt&2)===0&&(Hl|=n),kt===4&&er(e,Ft)),tn(e,o),n===1&&lt===0&&(t.mode&1)===0&&(co=St()+500,Ol&&gr()))}function tn(e,t){var n=e.callbackNode;Ph(e,t);var o=ul(e,e===It?Ft:0);if(o===0)n!==null&&bc(n),e.callbackNode=null,e.callbackPriority=0;else if(t=o&-o,e.callbackPriority!==t){if(n!=null&&bc(n),t===1)e.tag===0?Rg(dd.bind(null,e)):df(dd.bind(null,e)),Tg(function(){(lt&6)===0&&gr()}),n=null;else{switch(Pd(o)){case 1:n=Ps;break;case 4:n=Rd;break;case 16:n=sl;break;case 536870912:n=_d;break;default:n=sl}n=up(n,np.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function np(e,t){if(nl=-1,rl=0,(lt&6)!==0)throw Error(Le(327));var n=e.callbackNode;if(ro()&&e.callbackNode!==n)return null;var o=ul(e,e===It?Ft:0);if(o===0)return null;if((o&30)!==0||(o&e.expiredLanes)!==0||t)t=Ll(e,o);else{t=o;var a=lt;lt|=2;var d=op();(It!==e||Ft!==t)&&(Rn=null,co=St()+500,Sr(e,t));do try{rm();break}catch(u){rp(e,u)}while(!0);$s(),El.current=d,lt=a,Lt!==null?t=0:(It=null,Ft=0,t=kt)}if(t!==0){if(t===2&&(a=ns(e),a!==0&&(o=a,t=Ms(e,a))),t===1)throw n=li,Sr(e,0),er(e,o),tn(e,St()),n;if(t===6)er(e,o);else{if(a=e.current.alternate,(o&30)===0&&!tm(a)&&(t=Ll(e,o),t===2&&(d=ns(e),d!==0&&(o=d,t=Ms(e,d))),t===1))throw n=li,Sr(e,0),er(e,o),tn(e,St()),n;switch(e.finishedWork=a,e.finishedLanes=o,t){case 0:case 1:throw Error(Le(345));case 2:wr(e,Jt,Rn);break;case 3:if(er(e,o),(o&130023424)===o&&(t=pu+500-St(),10<t)){if(ul(e,0)!==0)break;if(a=e.suspendedLanes,(a&o)!==o){Xt(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=cs(wr.bind(null,e,Jt,Rn),t);break}wr(e,Jt,Rn);break;case 4:if(er(e,o),(o&4194240)===o)break;for(t=e.eventTimes,a=-1;0<o;){var E=31-An(o);d=1<<E,E=t[E],E>a&&(a=E),o&=~d}if(o=a,o=St()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*em(o/1960))-o,10<o){e.timeoutHandle=cs(wr.bind(null,e,Jt,Rn),o);break}wr(e,Jt,Rn);break;case 5:wr(e,Jt,Rn);break;default:throw Error(Le(329))}}}return tn(e,St()),e.callbackNode===n?np.bind(null,e):null}function Ms(e,t){var n=Vo;return e.current.memoizedState.isDehydrated&&(Sr(e,t).flags|=256),e=Ll(e,t),e!==2&&(t=Jt,Jt=n,t!==null&&Is(t)),e}function Is(e){Jt===null?Jt=e:Jt.push.apply(Jt,e)}function tm(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var o=0;o<n.length;o++){var a=n[o],d=a.getSnapshot;a=a.value;try{if(!Ln(d(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function er(e,t){for(t&=~fu,t&=~Hl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-An(t),o=1<<n;e[n]=-1,t&=~o}}function dd(e){if((lt&6)!==0)throw Error(Le(327));ro();var t=ul(e,0);if((t&1)===0)return tn(e,St()),null;var n=Ll(e,t);if(e.tag!==0&&n===2){var o=ns(e);o!==0&&(t=o,n=Ms(e,o))}if(n===1)throw n=li,Sr(e,0),er(e,t),tn(e,St()),n;if(n===6)throw Error(Le(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wr(e,Jt,Rn),tn(e,St()),null}function hu(e,t){var n=lt;lt|=1;try{return e(t)}finally{lt=n,lt===0&&(co=St()+500,Ol&&gr())}}function Tr(e){nr!==null&&nr.tag===0&&(lt&6)===0&&ro();var t=lt;lt|=1;var n=gn.transition,o=ut;try{if(gn.transition=null,ut=1,e)return e()}finally{ut=o,gn.transition=n,lt=t,(lt&6)===0&&gr()}}function gu(){rn=Jr.current,gt(Jr)}function Sr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Ig(n)),Lt!==null)for(n=Lt.return;n!==null;){var o=n;switch(Qs(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&hl();break;case 3:so(),gt(Kt),gt(Vt),ou();break;case 5:ru(o);break;case 4:so();break;case 13:gt(yt);break;case 19:gt(yt);break;case 10:Ks(o.type._context);break;case 22:case 23:gu()}n=n.return}if(It=e,Lt=e=cr(e.current,null),Ft=rn=t,kt=0,li=null,fu=Hl=Ir=0,Jt=Vo=null,Er!==null){for(t=0;t<Er.length;t++)if(n=Er[t],o=n.interleaved,o!==null){n.interleaved=null;var a=o.next,d=n.pending;if(d!==null){var E=d.next;d.next=a,o.next=E}n.pending=o}Er=null}return e}function rp(e,t){do{var n=Lt;try{if($s(),$i.current=Cl,wl){for(var o=xt.memoizedState;o!==null;){var a=o.queue;a!==null&&(a.pending=null),o=o.next}wl=!1}if(Mr=0,Mt=Nt=xt=null,zo=!1,ri=0,du.current=null,n===null||n.return===null){kt=1,li=t,Lt=null;break}e:{var d=e,E=n.return,u=n,s=t;if(t=Ft,u.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){var m=s,T=u,M=T.tag;if((T.mode&1)===0&&(M===0||M===11||M===15)){var g=T.alternate;g?(T.updateQueue=g.updateQueue,T.memoizedState=g.memoizedState,T.lanes=g.lanes):(T.updateQueue=null,T.memoizedState=null)}var p=$c(E);if(p!==null){p.flags&=-257,Kc(p,E,u,d,t),p.mode&1&&Jc(d,m,t),t=p,s=m;var b=t.updateQueue;if(b===null){var j=new Set;j.add(s),t.updateQueue=j}else b.add(s);break e}else{if((t&1)===0){Jc(d,m,t),mu();break e}s=Error(Le(426))}}else if(mt&&u.mode&1){var v=$c(E);if(v!==null){(v.flags&65536)===0&&(v.flags|=256),Kc(v,E,u,d,t),qs(uo(s,u));break e}}d=s=uo(s,u),kt!==4&&(kt=2),Vo===null?Vo=[d]:Vo.push(d),d=E;do{switch(d.tag){case 3:d.flags|=65536,t&=-t,d.lanes|=t;var C=zf(d,s,t);Wc(d,C);break e;case 1:u=s;var A=d.type,S=d.stateNode;if((d.flags&128)===0&&(typeof A.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(sr===null||!sr.has(S)))){d.flags|=65536,t&=-t,d.lanes|=t;var D=Bf(d,u,t);Wc(d,D);break e}}d=d.return}while(d!==null)}lp(n)}catch(F){t=F,Lt===n&&n!==null&&(Lt=n=n.return);continue}break}while(!0)}function op(){var e=El.current;return El.current=Cl,e===null?Cl:e}function mu(){(kt===0||kt===3||kt===2)&&(kt=4),It===null||(Ir&268435455)===0&&(Hl&268435455)===0||er(It,Ft)}function Ll(e,t){var n=lt;lt|=2;var o=op();(It!==e||Ft!==t)&&(Rn=null,Sr(e,t));do try{nm();break}catch(a){rp(e,a)}while(!0);if($s(),lt=n,El.current=o,Lt!==null)throw Error(Le(261));return It=null,Ft=0,kt}function nm(){for(;Lt!==null;)ip(Lt)}function rm(){for(;Lt!==null&&!Mh();)ip(Lt)}function ip(e){var t=sp(e.alternate,e,rn);e.memoizedProps=e.pendingProps,t===null?lp(e):Lt=t,du.current=null}function lp(e){var t=e;do{var n=t.alternate;if(e=t.return,(t.flags&32768)===0){if(n=Qg(n,t,rn),n!==null){Lt=n;return}}else{if(n=qg(n,t),n!==null){n.flags&=32767,Lt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{kt=6,Lt=null;return}}if(t=t.sibling,t!==null){Lt=t;return}Lt=t=e}while(t!==null);kt===0&&(kt=5)}function wr(e,t,n){var o=ut,a=gn.transition;try{gn.transition=null,ut=1,om(e,t,n,o)}finally{gn.transition=a,ut=o}return null}function om(e,t,n,o){do ro();while(nr!==null);if((lt&6)!==0)throw Error(Le(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Le(177));e.callbackNode=null,e.callbackPriority=0;var d=n.lanes|n.childLanes;if(zh(e,d),e===It&&(Lt=It=null,Ft=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||Xi||(Xi=!0,up(sl,function(){return ro(),null})),d=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||d){d=gn.transition,gn.transition=null;var E=ut;ut=1;var u=lt;lt|=4,du.current=null,$g(e,n),ep(n,e),Sg(ss),cl=!!as,ss=as=null,e.current=n,Kg(n,e,a),Ih(),lt=u,ut=E,gn.transition=d}else e.current=n;if(Xi&&(Xi=!1,nr=e,Sl=a),d=e.pendingLanes,d===0&&(sr=null),Oh(n.stateNode,o),tn(e,St()),t!==null)for(o=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],o(a.value,{componentStack:a.stack,digest:a.digest});if(Al)throw Al=!1,e=Ns,Ns=null,e;return(Sl&1)!==0&&e.tag!==0&&ro(),d=e.pendingLanes,(d&1)!==0?e===ks?Uo++:(Uo=0,ks=e):Uo=0,gr(),null}function ro(){if(nr!==null){var e=Pd(Sl),t=gn.transition,n=ut;try{if(gn.transition=null,ut=16>e?16:e,nr===null)var o=!1;else{if(e=nr,nr=null,Sl=0,(lt&6)!==0)throw Error(Le(331));var a=lt;for(lt|=4,He=e.current;He!==null;){var d=He,E=d.child;if((He.flags&16)!==0){var u=d.deletions;if(u!==null){for(var s=0;s<u.length;s++){var m=u[s];for(He=m;He!==null;){var T=He;switch(T.tag){case 0:case 11:case 15:Bo(8,T,d)}var M=T.child;if(M!==null)M.return=T,He=M;else for(;He!==null;){T=He;var g=T.sibling,p=T.return;if(Jf(T),T===m){He=null;break}if(g!==null){g.return=p,He=g;break}He=p}}}var b=d.alternate;if(b!==null){var j=b.child;if(j!==null){b.child=null;do{var v=j.sibling;j.sibling=null,j=v}while(j!==null)}}He=d}}if((d.subtreeFlags&2064)!==0&&E!==null)E.return=d,He=E;else e:for(;He!==null;){if(d=He,(d.flags&2048)!==0)switch(d.tag){case 0:case 11:case 15:Bo(9,d,d.return)}var C=d.sibling;if(C!==null){C.return=d.return,He=C;break e}He=d.return}}var A=e.current;for(He=A;He!==null;){E=He;var S=E.child;if((E.subtreeFlags&2064)!==0&&S!==null)S.return=E,He=S;else e:for(E=A;He!==null;){if(u=He,(u.flags&2048)!==0)try{switch(u.tag){case 0:case 11:case 15:_l(9,u)}}catch(F){At(u,u.return,F)}if(u===E){He=null;break e}var D=u.sibling;if(D!==null){D.return=u.return,He=D;break e}He=u.return}}if(lt=a,gr(),On&&typeof On.onPostCommitFiberRoot=="function")try{On.onPostCommitFiberRoot(kl,e)}catch{}o=!0}return o}finally{ut=n,gn.transition=t}}return!1}function fd(e,t,n){t=uo(n,t),t=zf(e,t,1),e=ar(e,t,1),t=Xt(),e!==null&&(ai(e,1,t),tn(e,t))}function At(e,t,n){if(e.tag===3)fd(e,e,n);else for(;t!==null;){if(t.tag===3){fd(t,e,n);break}else if(t.tag===1){var o=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(sr===null||!sr.has(o))){e=uo(n,e),e=Bf(t,e,1),t=ar(t,e,1),e=Xt(),t!==null&&(ai(t,1,e),tn(t,e));break}}t=t.return}}function im(e,t,n){var o=e.pingCache;o!==null&&o.delete(t),t=Xt(),e.pingedLanes|=e.suspendedLanes&n,It===e&&(Ft&n)===n&&(kt===4||kt===3&&(Ft&130023424)===Ft&&500>St()-pu?Sr(e,0):fu|=n),tn(e,t)}function ap(e,t){t===0&&((e.mode&1)===0?t=1:(t=Di,Di<<=1,(Di&130023424)===0&&(Di=4194304)));var n=Xt();e=Un(e,t),e!==null&&(ai(e,t,n),tn(e,n))}function lm(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),ap(e,n)}function am(e,t){var n=0;switch(e.tag){case 13:var o=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(Le(314))}o!==null&&o.delete(t),ap(e,n)}var sp;sp=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Kt.current)$t=!0;else{if((e.lanes&n)===0&&(t.flags&128)===0)return $t=!1,Zg(e,t,n);$t=(e.flags&131072)!==0}else $t=!1,mt&&(t.flags&1048576)!==0&&ff(t,vl,t.index);switch(t.lanes=0,t.tag){case 2:var o=t.type;tl(e,t),e=t.pendingProps;var a=io(t,Vt.current);no(t,n),a=lu(null,t,o,e,a,n);var d=au();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,en(o)?(d=!0,gl(t)):d=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,tu(t),a.updater=Rl,t.stateNode=a,a._reactInternals=t,vs(t,o,e,n),t=ys(null,t,o,!0,d,n)):(t.tag=0,mt&&d&&Zs(t),Gt(null,t,a,n),t=t.child),t;case 16:o=t.elementType;e:{switch(tl(e,t),e=t.pendingProps,a=o._init,o=a(o._payload),t.type=o,a=t.tag=um(o),e=wn(o,e),a){case 0:t=js(null,t,o,e,n);break e;case 1:t=nd(null,t,o,e,n);break e;case 11:t=ed(null,t,o,e,n);break e;case 14:t=td(null,t,o,wn(o.type,e),n);break e}throw Error(Le(306,o,""))}return t;case 0:return o=t.type,a=t.pendingProps,a=t.elementType===o?a:wn(o,a),js(e,t,o,a,n);case 1:return o=t.type,a=t.pendingProps,a=t.elementType===o?a:wn(o,a),nd(e,t,o,a,n);case 3:e:{if(Wf(t),e===null)throw Error(Le(387));o=t.pendingProps,d=t.memoizedState,a=d.element,bf(e,t),yl(t,o,null,n);var E=t.memoizedState;if(o=E.element,d.isDehydrated)if(d={element:o,isDehydrated:!1,cache:E.cache,pendingSuspenseBoundaries:E.pendingSuspenseBoundaries,transitions:E.transitions},t.updateQueue.baseState=d,t.memoizedState=d,t.flags&256){a=uo(Error(Le(423)),t),t=rd(e,t,o,n,a);break e}else if(o!==a){a=uo(Error(Le(424)),t),t=rd(e,t,o,n,a);break e}else for(on=lr(t.stateNode.containerInfo.firstChild),ln=t,mt=!0,En=null,n=mf(t,null,o,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(lo(),o===a){t=Yn(e,t,n);break e}Gt(e,t,o,n)}t=t.child}return t;case 5:return jf(t),e===null&&hs(t),o=t.type,a=t.pendingProps,d=e!==null?e.memoizedProps:null,E=a.children,us(o,a)?E=null:d!==null&&us(o,d)&&(t.flags|=32),Yf(e,t),Gt(e,t,E,n),t.child;case 6:return e===null&&hs(t),null;case 13:return Gf(e,t,n);case 4:return nu(t,t.stateNode.containerInfo),o=t.pendingProps,e===null?t.child=ao(t,null,o,n):Gt(e,t,o,n),t.child;case 11:return o=t.type,a=t.pendingProps,a=t.elementType===o?a:wn(o,a),ed(e,t,o,a,n);case 7:return Gt(e,t,t.pendingProps,n),t.child;case 8:return Gt(e,t,t.pendingProps.children,n),t.child;case 12:return Gt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(o=t.type._context,a=t.pendingProps,d=t.memoizedProps,E=a.value,pt(bl,o._currentValue),o._currentValue=E,d!==null)if(Ln(d.value,E)){if(d.children===a.children&&!Kt.current){t=Yn(e,t,n);break e}}else for(d=t.child,d!==null&&(d.return=t);d!==null;){var u=d.dependencies;if(u!==null){E=d.child;for(var s=u.firstContext;s!==null;){if(s.context===o){if(d.tag===1){s=zn(-1,n&-n),s.tag=2;var m=d.updateQueue;if(m!==null){m=m.shared;var T=m.pending;T===null?s.next=s:(s.next=T.next,T.next=s),m.pending=s}}d.lanes|=n,s=d.alternate,s!==null&&(s.lanes|=n),gs(d.return,n,t),u.lanes|=n;break}s=s.next}}else if(d.tag===10)E=d.type===t.type?null:d.child;else if(d.tag===18){if(E=d.return,E===null)throw Error(Le(341));E.lanes|=n,u=E.alternate,u!==null&&(u.lanes|=n),gs(E,n,t),E=d.sibling}else E=d.child;if(E!==null)E.return=d;else for(E=d;E!==null;){if(E===t){E=null;break}if(d=E.sibling,d!==null){d.return=E.return,E=d;break}E=E.return}d=E}Gt(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,o=t.pendingProps.children,no(t,n),a=mn(a),o=o(a),t.flags|=1,Gt(e,t,o,n),t.child;case 14:return o=t.type,a=wn(o,t.pendingProps),a=wn(o.type,a),td(e,t,o,a,n);case 15:return Vf(e,t,t.type,t.pendingProps,n);case 17:return o=t.type,a=t.pendingProps,a=t.elementType===o?a:wn(o,a),tl(e,t),t.tag=1,en(o)?(e=!0,gl(t)):e=!1,no(t,n),Pf(t,o,a),vs(t,o,a,n),ys(null,t,o,!0,e,n);case 19:return Xf(e,t,n);case 22:return Uf(e,t,n)}throw Error(Le(156,t.tag))};function up(e,t){return Fd(e,t)}function sm(e,t,n,o){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hn(e,t,n,o){return new sm(e,t,n,o)}function vu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function um(e){if(typeof e=="function")return vu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Rs)return 11;if(e===_s)return 14}return 2}function cr(e,t){var n=e.alternate;return n===null?(n=hn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ol(e,t,n,o,a,d){var E=2;if(o=e,typeof e=="function")vu(e)&&(E=1);else if(typeof e=="string")E=5;else e:switch(e){case Br:return Lr(n.children,a,d,t);case Fs:E=8,a|=8;break;case Ba:return e=hn(12,n,t,a|2),e.elementType=Ba,e.lanes=d,e;case Va:return e=hn(13,n,t,a),e.elementType=Va,e.lanes=d,e;case Ua:return e=hn(19,n,t,a),e.elementType=Ua,e.lanes=d,e;case bd:return Pl(n,a,d,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case md:E=10;break e;case vd:E=9;break e;case Rs:E=11;break e;case _s:E=14;break e;case Jn:E=16,o=null;break e}throw Error(Le(130,e==null?e:typeof e,""))}return t=hn(E,n,t,a),t.elementType=e,t.type=o,t.lanes=d,t}function Lr(e,t,n,o){return e=hn(7,e,o,t),e.lanes=n,e}function Pl(e,t,n,o){return e=hn(22,e,o,t),e.elementType=bd,e.lanes=n,e.stateNode={isHidden:!1},e}function Ha(e,t,n){return e=hn(6,e,null,t),e.lanes=n,e}function Pa(e,t,n){return t=hn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function cm(e,t,n,o,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wa(0),this.expirationTimes=wa(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wa(0),this.identifierPrefix=o,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function bu(e,t,n,o,a,d,E,u,s){return e=new cm(e,t,n,u,s),t===1?(t=1,d===!0&&(t|=8)):t=0,d=hn(3,null,null,t),e.current=d,d.stateNode=e,d.memoizedState={element:o,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},tu(d),e}function dm(e,t,n){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zr,key:o==null?null:""+o,children:e,containerInfo:t,implementation:n}}function cp(e){if(!e)return fr;e=e._reactInternals;e:{if(Or(e)!==e||e.tag!==1)throw Error(Le(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(en(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Le(171))}if(e.tag===1){var n=e.type;if(en(n))return cf(e,n,t)}return t}function dp(e,t,n,o,a,d,E,u,s){return e=bu(n,o,!0,e,a,d,E,u,s),e.context=cp(null),n=e.current,o=Xt(),a=ur(n),d=zn(o,a),d.callback=t??null,ar(n,d,a),e.current.lanes=a,ai(e,a,o),tn(e,o),e}function zl(e,t,n,o){var a=t.current,d=Xt(),E=ur(a);return n=cp(n),t.context===null?t.context=n:t.pendingContext=n,t=zn(d,E),t.payload={element:e},o=o===void 0?null:o,o!==null&&(t.callback=o),e=ar(a,t,E),e!==null&&(Sn(e,a,E,d),Ji(e,a,E)),E}function Nl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function pd(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function ju(e,t){pd(e,t),(e=e.alternate)&&pd(e,t)}function fm(){return null}var fp=typeof reportError=="function"?reportError:function(e){console.error(e)};function yu(e){this._internalRoot=e}Bl.prototype.render=yu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Le(409));zl(e,t,null,null)};Bl.prototype.unmount=yu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Tr(function(){zl(null,e,null,null)}),t[Vn]=null}};function Bl(e){this._internalRoot=e}Bl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Vd();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Kn.length&&t!==0&&t<Kn[n].priority;n++);Kn.splice(n,0,e),n===0&&Yd(e)}};function xu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Vl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function hd(){}function pm(e,t,n,o,a){if(a){if(typeof o=="function"){var d=o;o=function(){var m=Nl(E);d.call(m)}}var E=dp(t,o,e,0,null,!1,!1,"",hd);return e._reactRootContainer=E,e[Vn]=E.current,$o(e.nodeType===8?e.parentNode:e),Tr(),E}for(;a=e.lastChild;)e.removeChild(a);if(typeof o=="function"){var u=o;o=function(){var m=Nl(s);u.call(m)}}var s=bu(e,0,!1,null,null,!1,!1,"",hd);return e._reactRootContainer=s,e[Vn]=s.current,$o(e.nodeType===8?e.parentNode:e),Tr(function(){zl(t,s,n,o)}),s}function Ul(e,t,n,o,a){var d=n._reactRootContainer;if(d){var E=d;if(typeof a=="function"){var u=a;a=function(){var s=Nl(E);u.call(s)}}zl(t,E,e,a)}else E=pm(n,t,e,a,o);return Nl(E)}zd=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Do(t.pendingLanes);n!==0&&(zs(t,n|1),tn(t,St()),(lt&6)===0&&(co=St()+500,gr()))}break;case 13:Tr(function(){var o=Un(e,1);if(o!==null){var a=Xt();Sn(o,e,1,a)}}),ju(e,1)}};Bs=function(e){if(e.tag===13){var t=Un(e,134217728);if(t!==null){var n=Xt();Sn(t,e,134217728,n)}ju(e,134217728)}};Bd=function(e){if(e.tag===13){var t=ur(e),n=Un(e,t);if(n!==null){var o=Xt();Sn(n,e,t,o)}ju(e,t)}};Vd=function(){return ut};Ud=function(e,t){var n=ut;try{return ut=e,t()}finally{ut=n}};Ka=function(e,t,n){switch(t){case"input":if(Ga(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var o=n[t];if(o!==e&&o.form===e.form){var a=Dl(o);if(!a)throw Error(Le(90));yd(o),Ga(o,a)}}}break;case"textarea":wd(e,n);break;case"select":t=n.value,t!=null&&$r(e,!!n.multiple,t,!1)}};kd=hu;Md=Tr;var hm={usingClientEntryPoint:!1,Events:[ui,Wr,Dl,Ld,Nd,hu]},ko={findFiberByHostInstance:Cr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},gm={bundleType:ko.bundleType,version:ko.version,rendererPackageName:ko.rendererPackageName,rendererConfig:ko.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Wn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Dd(e),e===null?null:e.stateNode},findFiberByHostInstance:ko.findFiberByHostInstance||fm,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&(Mo=__REACT_DEVTOOLS_GLOBAL_HOOK__,!Mo.isDisabled&&Mo.supportsFiber))try{kl=Mo.inject(gm),On=Mo}catch{}var Mo;un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hm;un.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xu(t))throw Error(Le(200));return dm(e,t,null,n)};un.createRoot=function(e,t){if(!xu(e))throw Error(Le(299));var n=!1,o="",a=fp;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=bu(e,1,!1,null,null,n,!1,o,a),e[Vn]=t.current,$o(e.nodeType===8?e.parentNode:e),new yu(t)};un.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Le(188)):(e=Object.keys(e).join(","),Error(Le(268,e)));return e=Dd(t),e=e===null?null:e.stateNode,e};un.flushSync=function(e){return Tr(e)};un.hydrate=function(e,t,n){if(!Vl(t))throw Error(Le(200));return Ul(null,e,t,!0,n)};un.hydrateRoot=function(e,t,n){if(!xu(e))throw Error(Le(405));var o=n!=null&&n.hydratedSources||null,a=!1,d="",E=fp;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(d=n.identifierPrefix),n.onRecoverableError!==void 0&&(E=n.onRecoverableError)),t=dp(t,null,e,1,n??null,a,!1,d,E),e[Vn]=t.current,$o(e),o)for(e=0;e<o.length;e++)n=o[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Bl(t)};un.render=function(e,t,n){if(!Vl(t))throw Error(Le(200));return Ul(null,e,t,!1,n)};un.unmountComponentAtNode=function(e){if(!Vl(e))throw Error(Le(40));return e._reactRootContainer?(Tr(function(){Ul(null,null,e,!1,function(){e._reactRootContainer=null,e[Vn]=null})}),!0):!1};un.unstable_batchedUpdates=hu;un.unstable_renderSubtreeIntoContainer=function(e,t,n,o){if(!Vl(n))throw Error(Le(200));if(e==null||e._reactInternals===void 0)throw Error(Le(38));return Ul(e,t,n,!1,o)};un.version="18.3.1-next-f1338f8080-20240426"});var mp=jn((Im,gp)=>{"use strict";function hp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hp)}catch(e){console.error(e)}}hp(),gp.exports=pp()});var bp=jn(wu=>{"use strict";var vp=mp();wu.createRoot=vp.createRoot,wu.hydrateRoot=vp.hydrateRoot;var Tm});var jp=jn((Cu,Eu)=>{(function(e,t){typeof Cu=="object"&&typeof Eu<"u"?Eu.exports=t():typeof define=="function"&&define.amd?define(t):e.jSuites=t()})(Cu,function(){var e;return function(){var t={195:function(d){(function(E,u){d.exports=u()})(this,function(){return function(W){function u(Oe,Ie){this.highOrder=Oe,this.lowOrder=Ie}var s=[new u(1779033703,4089235720),new u(3144134277,2227873595),new u(1013904242,4271175723),new u(2773480762,1595750129),new u(1359893119,2917565137),new u(2600822924,725511199),new u(528734635,4215389547),new u(1541459225,327033209)],m=[new u(1116352408,3609767458),new u(1899447441,602891725),new u(3049323471,3964484399),new u(3921009573,2173295548),new u(961987163,4081628472),new u(1508970993,3053834265),new u(2453635748,2937671579),new u(2870763221,3664609560),new u(3624381080,2734883394),new u(310598401,1164996542),new u(607225278,1323610764),new u(1426881987,3590304994),new u(1925078388,4068182383),new u(2162078206,991336113),new u(2614888103,633803317),new u(3248222580,3479774868),new u(3835390401,2666613458),new u(4022224774,944711139),new u(264347078,2341262773),new u(604807628,2007800933),new u(770255983,1495990901),new u(1249150122,1856431235),new u(1555081692,3175218132),new u(1996064986,2198950837),new u(2554220882,3999719339),new u(2821834349,766784016),new u(2952996808,2566594879),new u(3210313671,3203337956),new u(3336571891,1034457026),new u(3584528711,2466948901),new u(113926993,3758326383),new u(338241895,168717936),new u(666307205,1188179964),new u(773529912,1546045734),new u(1294757372,1522805485),new u(1396182291,2643833823),new u(1695183700,2343527390),new u(1986661051,1014477480),new u(2177026350,1206759142),new u(2456956037,344077627),new u(2730485921,1290863460),new u(2820302411,3158454273),new u(3259730800,3505952657),new u(3345764771,106217008),new u(3516065817,3606008344),new u(3600352804,1432725776),new u(4094571909,1467031594),new u(275423344,851169720),new u(430227734,3100823752),new u(506948616,1363258195),new u(659060556,3750685593),new u(883997877,3785050280),new u(958139571,3318307427),new u(1322822218,3812723403),new u(1537002063,2003034995),new u(1747873779,3602036899),new u(1955562222,1575990012),new u(2024104815,1125592928),new u(2227730452,2716904306),new u(2361852424,442776044),new u(2428436474,593698344),new u(2756734187,3733110249),new u(3204031479,2999351573),new u(3329325298,3815920427),new u(3391569614,3928383900),new u(3515267271,566280711),new u(3940187606,3454069534),new u(4118630271,4000239992),new u(116418474,1914138554),new u(174292421,2731055270),new u(289380356,3203993006),new u(460393269,320620315),new u(685471733,587496836),new u(852142971,1086792851),new u(1017036298,365543100),new u(1126000580,2618297676),new u(1288033470,3409855158),new u(1501505948,4234509866),new u(1607167915,987167468),new u(1816402316,1246189591)],T=new Array(64),M,g,p,b,j,v,C,A,S,D,F,N,_=8;function G(Oe){return unescape(encodeURIComponent(Oe))}function U(Oe){for(var Ie=[],Fe=(1<<_)-1,Be=Oe.length*_,Ke=0;Ke<Be;Ke+=_)Ie[Ke>>5]|=(Oe.charCodeAt(Ke/_)&Fe)<<32-_-Ke%32;return Ie}function re(Oe){for(var Ie="0123456789abcdef",Fe="",Be=Oe.length*4,Ke,et=0;et<Be;et+=1)Ke=Oe[et>>2]>>(3-et%4)*8,Fe+=Ie.charAt(Ke>>4&15)+Ie.charAt(Ke&15);return Fe}function fe(Oe,Ie){var Fe,Be,Ke,et;return Fe=(Oe.lowOrder&65535)+(Ie.lowOrder&65535),Be=(Oe.lowOrder>>>16)+(Ie.lowOrder>>>16)+(Fe>>>16),Ke=(Be&65535)<<16|Fe&65535,Fe=(Oe.highOrder&65535)+(Ie.highOrder&65535)+(Be>>>16),Be=(Oe.highOrder>>>16)+(Ie.highOrder>>>16)+(Fe>>>16),et=(Be&65535)<<16|Fe&65535,new u(et,Ke)}function ae(Oe,Ie,Fe,Be){var Ke,et,bt,Tt;return Ke=(Oe.lowOrder&65535)+(Ie.lowOrder&65535)+(Fe.lowOrder&65535)+(Be.lowOrder&65535),et=(Oe.lowOrder>>>16)+(Ie.lowOrder>>>16)+(Fe.lowOrder>>>16)+(Be.lowOrder>>>16)+(Ke>>>16),bt=(et&65535)<<16|Ke&65535,Ke=(Oe.highOrder&65535)+(Ie.highOrder&65535)+(Fe.highOrder&65535)+(Be.highOrder&65535)+(et>>>16),et=(Oe.highOrder>>>16)+(Ie.highOrder>>>16)+(Fe.highOrder>>>16)+(Be.highOrder>>>16)+(Ke>>>16),Tt=(et&65535)<<16|Ke&65535,new u(Tt,bt)}function ye(Oe,Ie,Fe,Be,Ke){var et,bt,Tt,jt;return et=(Oe.lowOrder&65535)+(Ie.lowOrder&65535)+(Fe.lowOrder&65535)+(Be.lowOrder&65535)+(Ke.lowOrder&65535),bt=(Oe.lowOrder>>>16)+(Ie.lowOrder>>>16)+(Fe.lowOrder>>>16)+(Be.lowOrder>>>16)+(Ke.lowOrder>>>16)+(et>>>16),Tt=(bt&65535)<<16|et&65535,et=(Oe.highOrder&65535)+(Ie.highOrder&65535)+(Fe.highOrder&65535)+(Be.highOrder&65535)+(Ke.highOrder&65535)+(bt>>>16),bt=(Oe.highOrder>>>16)+(Ie.highOrder>>>16)+(Fe.highOrder>>>16)+(Be.highOrder>>>16)+(Ke.highOrder>>>16)+(et>>>16),jt=(bt&65535)<<16|et&65535,new u(jt,Tt)}function Ne(Oe,Ie,Fe){return new u(Oe.highOrder&Ie.highOrder^Oe.highOrder&Fe.highOrder^Ie.highOrder&Fe.highOrder,Oe.lowOrder&Ie.lowOrder^Oe.lowOrder&Fe.lowOrder^Ie.lowOrder&Fe.lowOrder)}function be(Oe,Ie,Fe){return new u(Oe.highOrder&Ie.highOrder^~Oe.highOrder&Fe.highOrder,Oe.lowOrder&Ie.lowOrder^~Oe.lowOrder&Fe.lowOrder)}function le(Oe,Ie){return Ie<=32?new u(Oe.highOrder>>>Ie|Oe.lowOrder<<32-Ie,Oe.lowOrder>>>Ie|Oe.highOrder<<32-Ie):new u(Oe.lowOrder>>>Ie|Oe.highOrder<<32-Ie,Oe.highOrder>>>Ie|Oe.lowOrder<<32-Ie)}function Ye(Oe){var Ie=le(Oe,28),Fe=le(Oe,34),Be=le(Oe,39);return new u(Ie.highOrder^Fe.highOrder^Be.highOrder,Ie.lowOrder^Fe.lowOrder^Be.lowOrder)}function $e(Oe){var Ie=le(Oe,14),Fe=le(Oe,18),Be=le(Oe,41);return new u(Ie.highOrder^Fe.highOrder^Be.highOrder,Ie.lowOrder^Fe.lowOrder^Be.lowOrder)}function Ge(Oe){var Ie=le(Oe,1),Fe=le(Oe,8),Be=vt(Oe,7);return new u(Ie.highOrder^Fe.highOrder^Be.highOrder,Ie.lowOrder^Fe.lowOrder^Be.lowOrder)}function ze(Oe){var Ie=le(Oe,19),Fe=le(Oe,61),Be=vt(Oe,6);return new u(Ie.highOrder^Fe.highOrder^Be.highOrder,Ie.lowOrder^Fe.lowOrder^Be.lowOrder)}function vt(Oe,Ie){return Ie<=32?new u(Oe.highOrder>>>Ie,Oe.lowOrder>>>Ie|Oe.highOrder<<32-Ie):new u(0,Oe.highOrder<<32-Ie)}var W=G(W),ke=W.length*_;W=U(W),W[ke>>5]|=128<<24-ke%32,W[(ke+128>>10<<5)+31]=ke;for(var S=0;S<W.length;S+=32){M=s[0],g=s[1],p=s[2],b=s[3],j=s[4],v=s[5],C=s[6],A=s[7];for(var D=0;D<80;D++)D<16?T[D]=new u(W[D*2+S],W[D*2+S+1]):T[D]=ae(ze(T[D-2]),T[D-7],Ge(T[D-15]),T[D-16]),F=ye(A,$e(j),be(j,v,C),m[D],T[D]),N=fe(Ye(M),Ne(M,g,p)),A=C,C=v,v=j,j=fe(b,F),b=p,p=g,g=M,M=fe(F,N);s[0]=fe(M,s[0]),s[1]=fe(g,s[1]),s[2]=fe(p,s[2]),s[3]=fe(b,s[3]),s[4]=fe(j,s[4]),s[5]=fe(v,s[5]),s[6]=fe(C,s[6]),s[7]=fe(A,s[7])}for(var Ze=[],S=0;S<s.length;S++)Ze.push(s[S].highOrder),Ze.push(s[S].lowOrder);return re(Ze)}})}},n={};function o(d){var E=n[d];if(E!==void 0)return E.exports;var u=n[d]={exports:{}};return t[d].call(u.exports,u,u.exports,o),u.exports}(function(){o.n=function(d){var E=d&&d.__esModule?function(){return d.default}:function(){return d};return o.d(E,{a:E}),E}})(),function(){o.d=function(d,E){for(var u in E)o.o(E,u)&&!o.o(d,u)&&Object.defineProperty(d,u,{enumerable:!0,get:E[u]})}}(),function(){o.o=function(d,E){return Object.prototype.hasOwnProperty.call(d,E)}}();var a={};(function(){"use strict";o.d(a,{default:function(){return Rr}});var d=function(L){document.dictionary||(document.dictionary={});var I=null,h=null,c=Object.keys(L);for(h=0;h<c.length;h++)document.dictionary[c[h]]=L[c[h]]},E=function(L){return typeof document<"u"&&document.dictionary&&document.dictionary[L]||L},u={setDictionary:d,translate:E},m=function(L,I){if(I===!0)window.jSuitesStateControl=window.jSuitesStateControl.filter(function(c){return c!==null}),setTimeout(function(){window.jSuitesStateControl.push(L)},0);else{var h=window.jSuitesStateControl.indexOf(L);h>=0&&window.jSuitesStateControl.splice(h,1)}},T={};T.two=function(L){return L=""+L,L.length==1&&(L="0"+L),L},T.focus=function(L){if(L.innerText.length){var I=document.createRange(),h=window.getSelection(),c=L.childNodes[L.childNodes.length-1];I.setStart(c,c.length),I.collapse(!0),h.removeAllRanges(),h.addRange(I),L.scrollLeft=L.scrollWidth}},T.isNumeric=function(L){return typeof L=="string"&&(L=L.trim()),!isNaN(L)&&L!==null&&L!==""},T.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(L){var I=Math.random()*16|0,h=L=="x"?I:I&3|8;return h.toString(16)})},T.getNode=function(){var L=document.getSelection().anchorNode;return L?L.nodeType==3?L.parentNode:L:null},T.hash=function(L){var I=0,h,c;if(L.length===0)return I;for(h=0;h<L.length;h++)c=L.charCodeAt(h),c>32&&(I=(I<<5)-I+c,I|=0);return I},T.randomColor=function(L){var I=-.25,h=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");h.length<6&&(h=h[0]+h[0]+h[1]+h[1]+h[2]+h[2]);var c=[],B,K;for(K=0;K<3;K++)B=parseInt(h.substr(K*2,2),16),B=Math.round(Math.min(Math.max(0,B+B*I),255)).toString(16),c.push(("00"+B).substr(B.length));return L==!0?"#"+T.two(c[0].toString(16))+T.two(c[1].toString(16))+T.two(c[2].toString(16)):c},T.getWindowWidth=function(){var L=window,I=document,h=I.documentElement,c=I.getElementsByTagName("body")[0],B=L.innerWidth||h.clientWidth||c.clientWidth;return B},T.getWindowHeight=function(){var L=window,I=document,h=I.documentElement,c=I.getElementsByTagName("body")[0],B=L.innerHeight||h.clientHeight||c.clientHeight;return B},T.getPosition=function(L){if(L.changedTouches&&L.changedTouches[0])var I=L.changedTouches[0].pageX,h=L.changedTouches[0].pageY;else var I=window.Event?L.pageX:L.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),h=window.Event?L.pageY:L.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[I,h]},T.click=function(L){if(L.click)L.click();else{var I=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});L.dispatchEvent(I)}},T.findElement=function(L,I){var h=!1;function c(B){B&&!h&&(typeof I=="function"?h=I(B):typeof I=="string"&&B.classList&&B.classList.contains(I)&&(h=B)),B.parentNode&&!h&&c(B.parentNode)}return c(L),h};var M=T;function g(L,I,h){if(L=L.split("."),L.length){let c=this,B=null;for(;L.length>1;)if(B=L.shift(),c.hasOwnProperty(B))c=c[B];else{if(typeof I>"u")return;c[B]={},c=c[B]}if(B=L.shift(),typeof I<"u")return h===!0?delete c[B]:c[B]=I,!0;if(c)return c[B]}return!1}function p(L,I){var h={};h.options={};var c={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},B=null;for(var K in c)I&&I.hasOwnProperty(K)?h.options[K]=I[K]:h.options[K]=c[K];L.classList.add("jsorting"),L.addEventListener("dragstart",function(H){let z=H.target;if(z.nodeType===3)if(z.parentNode.getAttribute("draggable")==="true")z=z.parentNode;else{H.preventDefault(),H.stopPropagation();return}if(z.getAttribute("draggable")==="true"){let X=Array.prototype.indexOf.call(z.parentNode.children,z);B={element:z,o:X,d:X},z.style.opacity="0.25",typeof h.options.ondragstart=="function"&&h.options.ondragstart(L,z,H),H.dataTransfer.setDragImage(z,0,0)}}),L.addEventListener("dragover",function(H){if(H.preventDefault(),B&&ee(H.target)&&H.target.getAttribute("draggable")=="true"&&B.element!=H.target){if(h.options.direction)var z=H.target.clientWidth/2>H.offsetX;else var z=H.target.clientHeight/2>H.offsetY;z?H.target.parentNode.insertBefore(B.element,H.target):H.target.parentNode.insertBefore(B.element,H.target.nextSibling),B.d=Array.prototype.indexOf.call(H.target.parentNode.children,B.element)}}),L.addEventListener("dragleave",function(H){H.preventDefault()}),L.addEventListener("dragend",function(H){H.preventDefault(),B&&(typeof h.options.ondragend=="function"&&h.options.ondragend(L,B.element,H),B.o<B.d?H.target.parentNode.insertBefore(B.element,H.target.parentNode.children[B.o]):H.target.parentNode.insertBefore(B.element,H.target.parentNode.children[B.o].nextSibling),B.element.style.opacity="",B=null)}),L.addEventListener("drop",function(H){H.preventDefault(),B&&(B.o!==B.d&&typeof h.options.ondrop=="function"&&h.options.ondrop(L,B.o,B.d,B.element,H.target,H),B.element.style.opacity="",B=null)});for(var ee=function(H){var z=!1;function X(ie){ie.className&&ie.classList.contains("jsorting")&&(z=!0),z||X(ie.parentNode)}return X(H),z},P=0;P<L.children.length;P++)L.children[P].hasAttribute("draggable")||L.children[P].setAttribute("draggable","true");return L.val=function(){for(var H=null,z=[],X=0;X<L.children.length;X++)(H=L.children[X].getAttribute("data-id"))&&z.push(H);return z},L}function b(L,I){var h={};(!I.loadUp||typeof I.loadUp!="function")&&(I.loadUp=function(){return!1}),(!I.loadDown||typeof I.loadDown!="function")&&(I.loadDown=function(){return!1}),I.timer||(I.timer=100);var c=null,B=function(K){if(c==null){var ee=!1,P=L.scrollTop;L.scrollTop+L.clientHeight*2>=L.scrollHeight?I.loadDown()&&(P==L.scrollTop&&(L.scrollTop=L.scrollTop-L.clientHeight),ee=!0):L.scrollTop<=L.clientHeight&&I.loadUp()&&(P==L.scrollTop&&(L.scrollTop=L.scrollTop+L.clientHeight),ee=!0),c=setTimeout(function(){c=null},I.timer),ee&&typeof I.onupdate=="function"&&I.onupdate()}};return L.onscroll=function(K){B(K)},L.onwheel=function(K){B(K)},h}function j(){var L=function(I,h){if(Array.isArray(I)){var c={instance:[],complete:h};if(I.length>0)for(var B=0;B<I.length;B++)I[B].multiple=c,c.instance.push(L(I[B]));return c}if(I.data||(I.data={}),I.type&&(I.method=I.type),I.method||(I.method="GET"),I.dataType||(I.dataType="json"),I.data){var K=function(ie,me){var se=[];if(ie){var ce=Object.keys(ie);if(ce.length)for(var Me=0;Me<ce.length;Me++){if(me)var Se=me+"["+ce[Me]+"]";else var Se=ce[Me];if(ie[Se]instanceof FileList)se[Se]=ie[ce[Me]];else if(ie[ce[Me]]===null||ie[ce[Me]]===void 0)se[Se]="";else if(typeof ie[ce[Me]]=="object")for(var Te=K(ie[ce[Me]],Se),Xe=Object.keys(Te),tt=0;tt<Xe.length;tt++)se[Xe[tt]]=Te[Xe[tt]];else se[Se]=ie[ce[Me]]}}return se},ee=K(I.data),P=Object.keys(ee);if(I.method=="GET"){if(P.length){for(var H=[],B=0;B<P.length;B++)H.push(P[B]+"="+encodeURIComponent(ee[P[B]]));I.url.indexOf("?")<0&&(I.url+="?"),I.url+=H.join("&")}}else for(var H=new FormData,B=0;B<P.length;B++)if(ee[P[B]]instanceof FileList){if(ee[P[B]].length)for(var z=0;z<ee[P[B]].length;z++)H.append(P[B],ee[P[B]][z],ee[P[B]][z].name)}else H.append(P[B],ee[P[B]])}var X=new XMLHttpRequest;return X.open(I.method,I.url,!0),I.requestedWith?X.setRequestHeader("X-Requested-With",I.requestedWith):I.requestedWith!==!1&&X.setRequestHeader("X-Requested-With","XMLHttpRequest"),I.contentType&&X.setRequestHeader("Content-Type",I.contentType),I.method==="POST"?X.setRequestHeader("Accept","application/json"):I.dataType==="blob"?X.responseType="blob":I.contentType||(I.dataType==="json"?X.setRequestHeader("Content-Type","text/json"):I.dataType==="html"&&X.setRequestHeader("Content-Type","text/html")),I.cache!==!0&&(X.setRequestHeader("pragma","no-cache"),X.setRequestHeader("cache-control","no-cache")),I.withCredentials===!0&&(X.withCredentials=!0),typeof I.beforeSend=="function"&&I.beforeSend(X),typeof L.beforeSend=="function"&&L.beforeSend(X),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(X),X.onerror=function(){I.error&&typeof I.error=="function"&&I.error({message:"Network error: Unable to reach the server.",status:0})},X.ontimeout=function(){I.error&&typeof I.error=="function"&&I.error({message:"Request timed out after "+X.timeout+"ms.",status:0})},X.onload=function(){if(X.status>=200&&X.status<300)if(I.dataType==="json")try{var ie=JSON.parse(X.responseText);I.success&&typeof I.success=="function"&&I.success(ie)}catch(se){I.error&&typeof I.error=="function"&&I.error(se,ie)}else{if(I.dataType==="blob")var ie=X.response;else var ie=X.responseText;I.success&&typeof I.success=="function"&&I.success(ie)}else I.error&&typeof I.error=="function"&&I.error(X.responseText,X.status);if(L.queue&&L.queue.length>0&&L.send(L.queue.shift()),L.requests&&L.requests.length){var me=L.requests.indexOf(X);if(L.requests.splice(me,1),L.requests.length||I.complete&&typeof I.complete=="function"&&I.complete(ie),I.group&&L.oncomplete&&typeof L.oncomplete[I.group]=="function"&&(L.pending(I.group)||(L.oncomplete[I.group](),L.oncomplete[I.group]=null)),I.multiple&&I.multiple.instance){var me=I.multiple.instance.indexOf(X);I.multiple.instance.splice(me,1),I.multiple.instance.length||I.multiple.complete&&typeof I.multiple.complete=="function"&&I.multiple.complete(ie)}}},X.options=I,X.data=H,I.queue===!0&&L.requests.length>0?L.queue.push(X):L.send(X),X};return L.send=function(I){I.data?Array.isArray(I.data)?I.send(I.data.join("&")):I.send(I.data):I.send(),L.requests.push(I)},L.exists=function(I,h){var c=new XMLHttpRequest;c.open("HEAD",I,!1),c.send(),c.status&&h(c.status)},L.pending=function(I){var h=0,c=L.requests;if(c&&c.length)for(var B=0;B<c.length;B++)(!I||I==c[B].options.group)&&h++;return h},L.oncomplete={},L.requests=[],L.queue=[],L}var v=j();function C(){let L={loading:{}};return L.loading.show=function(I){L.loading.element||(L.loading.element=document.createElement("div"),L.loading.element.className="jloading"),document.body.appendChild(L.loading.element),I>0&&setTimeout(function(){L.loading.hide()},I*1e3)},L.loading.hide=function(){L.loading.element&&L.loading.element.parentNode&&document.body.removeChild(L.loading.element)},L.slideLeft=function(I,h,c){h==!0?(I.classList.add("jslide-left-in"),setTimeout(function(){I.classList.remove("jslide-left-in"),typeof c=="function"&&c()},400)):(I.classList.add("jslide-left-out"),setTimeout(function(){I.classList.remove("jslide-left-out"),typeof c=="function"&&c()},400))},L.slideRight=function(I,h,c){h===!0?(I.classList.add("jslide-right-in"),setTimeout(function(){I.classList.remove("jslide-right-in"),typeof c=="function"&&c()},400)):(I.classList.add("jslide-right-out"),setTimeout(function(){I.classList.remove("jslide-right-out"),typeof c=="function"&&c()},400))},L.slideTop=function(I,h,c){h===!0?(I.classList.add("jslide-top-in"),setTimeout(function(){I.classList.remove("jslide-top-in"),typeof c=="function"&&c()},400)):(I.classList.add("jslide-top-out"),setTimeout(function(){I.classList.remove("jslide-top-out"),typeof c=="function"&&c()},400))},L.slideBottom=function(I,h,c){h===!0?(I.classList.add("jslide-bottom-in"),setTimeout(function(){I.classList.remove("jslide-bottom-in"),typeof c=="function"&&c()},400)):(I.classList.add("jslide-bottom-out"),setTimeout(function(){I.classList.remove("jslide-bottom-out"),typeof c=="function"&&c()},100))},L.fadeIn=function(I,h){I.style.display="",I.classList.add("jfade-in"),setTimeout(function(){I.classList.remove("jfade-in"),typeof h=="function"&&h()},2e3)},L.fadeOut=function(I,h){I.classList.add("jfade-out"),setTimeout(function(){I.style.display="none",I.classList.remove("jfade-out"),typeof h=="function"&&h()},1e3)},L}var A=C();function S(){var L={};L.now=function(ee,P){var H=null,z=null,X=null,ie=null,me=null,se=null;return Array.isArray(ee)?(H=ee[0],z=ee[1],X=ee[2],ie=ee[3],me=ee[4],se=ee[5]):(ee||(ee=new Date),H=ee.getFullYear(),z=ee.getMonth()+1,X=ee.getDate(),ie=ee.getHours(),me=ee.getMinutes(),se=ee.getSeconds()),P==!0?M.two(H)+"-"+M.two(z)+"-"+M.two(X):M.two(H)+"-"+M.two(z)+"-"+M.two(X)+" "+M.two(ie)+":"+M.two(me)+":"+M.two(se)},L.toArray=function(ee){var H=ee.split(ee.indexOf("T")!==-1?"T":" "),P=H[1],H=H[0].split("-"),z=parseInt(H[0]),X=parseInt(H[1]),ie=parseInt(H[2]),me=0,se=0;return P&&(P=P.split(":"),me=parseInt(P[0]),se=parseInt(P[1])),[z,X,ie,me,se,0]};var I=Date.UTC(1900,0,0),h=Date.UTC(1900,1,29),c=864e5;L.dateToNum=function(ee){typeof ee=="string"&&(ee=new Date(ee+"  GMT+0"));var P=ee.getTime();return P>=h&&(P+=c),P-=I,P/c},L.numToDate=function(ee){var P=I+ee*c;P>=h&&(P-=c);let H=new Date(P);var z=[H.getUTCFullYear(),H.getUTCMonth()+1,H.getUTCDate(),H.getUTCHours(),H.getUTCMinutes(),H.getUTCSeconds()];return L.now(z)};let B=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],K=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(L,"weekdays",{get:function(){return B.map(function(ee){return u.translate(ee)})}}),Object.defineProperty(L,"weekdaysShort",{get:function(){return B.map(function(ee){return u.translate(ee).substring(0,3)})}}),Object.defineProperty(L,"months",{get:function(){return K.map(function(ee){return u.translate(ee)})}}),Object.defineProperty(L,"monthsShort",{get:function(){return K.map(function(ee){return u.translate(ee).substring(0,3)})}}),L}var D=S();function F(){var L={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},I=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var k=0;this.date[4]&&(k=parseFloat(this.date[4]/60));var R=parseInt(this.date[3])+k;R/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?R=M.two(this.date[3])+":"+M.two(this.date[4])+":"+M.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),R=M.two(this.date[0])+"-"+M.two(this.date[1])+"-"+M.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(R+=" "+M.two(this.date[3])+":"+M.two(this.date[4])+":"+M.two(this.date[5])));return R},h=function(){var k="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)k=parseInt(this.date[3]);else{let Z=parseInt(this.date[3]);Z<13&&this.values.indexOf("PM")!==-1?k=(Z+12)%24:k=Z%24}this.date[4]&&(k+=parseFloat(this.date[4]/60)),this.date[5]&&(k+=parseFloat(this.date[5]/3600)),k/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var R=D.now(this.date);k=D.dateToNum(R)}return isNaN(k)&&(k=""),k},c=function(k){return k===null||k===""||k===void 0},B=function(k){var R=(""+k)[0];return R=="="},K=function(k){return k==="currency"||k==="percentage"||k==="scientific"||k==="numeric"},ee=function(k){if(k&&Number(k)==k)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var R=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=R[1]}else{k||(k=this.mask);var Z=new RegExp("0{1}(.{1})0+","ig"),R=Z.exec(k);if(R&&R[1]&&R[1].length==1)return this.options.decimal=R[1],R[1];var Z=new RegExp("#{1}(.{1})#+","ig"),R=Z.exec(k);R&&R[1]&&R[1].length==1?R[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},P=function(k,R){if(k=="")return"";R||(R=ee.call(this)),k=(""+k).split(R);var Z=k[0].match(/[-]+/g);if(Z&&Z.length?Z=!0:Z=!1,k[0]=k[0].match(/[0-9]+/g),k[0]?(Z&&k[0].unshift("-"),k[0]=k[0].join("")):Z&&(k[0]="-"),k[0]||k[1])k[1]!==void 0&&(k[1]=k[1].match(/[0-9]+/g),k[1]?k[1]=k[1].join(""):k[1]="");else return"";return k},H=function(k,R){if(k==="")return"";var Z=ee.call(this),de=this.options;if(k=P.call(this,k),k==="")return"";var ne=null;if(k[0]&&(de.style==="percent"?ne=parseFloat(k[0])/100:ne=parseFloat(k[0]+".1")),(k[0]==="-"||k[0]==="-00")&&!k[1]&&R&&R.inputType=="deleteContentBackward")return"";var J=new Intl.NumberFormat(this.locale,de).format(ne);if(J=J.split(Z),de.style==="percent"&&J[0].indexOf("%")!==-1&&(J[0]=J[0].replace("%",""),J[2]="%"),typeof J[1]<"u"){var ve=J[1].replace(/[0-9]*/g,"");ve&&(J[2]=ve)}return k[1]!==void 0?J[1]=Z+k[1]:J[1]="",J.join("")},z=function(k,R){var Z=me.call(k);if(Z){var de=H.call(this,Z,R),ne=de.length-Z.length,J=ie.call(k)+ne;me.call(k,de,J,!0)}},X=function(k){var R=P.call(this,k);return R?(R[0]==="-"&&(R[0]="-0"),parseFloat(R.join("."))):null},ie=function(k,R){if(k===void 0)if(this.tagName=="DIV"){var Z=0,de=window.getSelection();if(de&&de.rangeCount!==0){var ne=de.getRangeAt(0),J=ne.cloneRange();J.selectNodeContents(this),J.setEnd(ne.endContainer,ne.endOffset),Z=J.toString().length}return Z}else return this.selectionStart;else{var ve=me.call(this);if(R){for(var J=null,xe=0;xe<ve.length;xe++)(ve[xe].match(/[\-0-9]/g)||ve[xe]==="."||ve[xe]===",")&&(J=xe);J===null&&(J=ve.indexOf(" ")),k>=J&&(k=J+1)}if(k>ve.length&&(k=ve.length),k)if(this.tagName=="DIV"){var de=window.getSelection(),ne=document.createRange();this.childNodes[0]&&(ne.setStart(this.childNodes[0],k),de.removeAllRanges(),de.addRange(ne))}else this.selectionStart=k,this.selectionEnd=k}},me=function(k,R,Z){if(this.tagName=="DIV")if(k===void 0){var k=this.innerText;return this.value&&this.value.length>k.length&&(k=this.value),k}else this.innerText!==k&&(this.innerText=k,R&&ie.call(this,R,Z));else{if(k===void 0)return this.value;this.value!==k&&(this.value=k,R&&ie.call(this,R,Z))}},se=D.weekdays,ce=D.weekdaysShort,Me=D.months,Se=D.monthsShort,Te={YEAR:function(k,R){var Z=""+new Date().getFullYear();if(typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(k)>=0&&parseInt(k)<=10&&this.values[this.index].length<R&&(this.values[this.index]+=k),this.values[this.index].length==R){if(R==2)var Z=Z.substr(0,2)+this.values[this.index];else if(R==3)var Z=Z.substr(0,1)+this.values[this.index];else if(R==4)var Z=this.values[this.index];this.date[0]=Z,this.index++}},YYYY:function(k){Te.YEAR.call(this,k,4)},YYY:function(k){Te.YEAR.call(this,k,3)},YY:function(k){Te.YEAR.call(this,k,2)},FIND:function(k,R){if(c(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=k;return}for(var Z=0,de=0,ne=(this.values[this.index]+k).toLowerCase(),J=0;J<R.length;J++)R[J].toLowerCase().indexOf(ne)==0&&(Z=J,de++);if(de>1)this.values[this.index]+=k;else if(de==1){var ve=R[Z].length-this.values[this.index].length-1;return this.position+=ve,this.values[this.index]=R[Z],this.index++,Z}},MMM:function(k){var R=Te.FIND.call(this,k,Se);R!==void 0&&(this.date[1]=R+1)},MON:function(k){Te.MMM.call(this,k)},MMMM:function(k){var R=Te.FIND.call(this,k,Me);R!==void 0&&(this.date[1]=R+1)},MONTH:function(k){Te.MMMM.call(this,k)},MMMMM:function(k){c(this.values[this.index])&&(this.values[this.index]="");for(var R=0,Z=0,de=(this.values[this.index]+k).toLowerCase(),ne=0;ne<Me.length;ne++)if(Me[ne][0].toLowerCase().indexOf(de)==0){this.values[this.index]=Me[ne][0],this.date[1]=ne+1,this.index++;break}},MM:function(k){c(this.values[this.index])?parseInt(k)>1&&parseInt(k)<10?(this.date[1]=this.values[this.index]="0"+k,this.index++):parseInt(k)<2&&(this.values[this.index]=k):this.values[this.index]==1&&parseInt(k)<3?(this.date[1]=this.values[this.index]+=k,this.index++):this.values[this.index]==0&&parseInt(k)>0&&parseInt(k)<10&&(this.date[1]=this.values[this.index]+=k,this.index++)},M:function(k){var R=!1;if(parseInt(k)>=0&&parseInt(k)<10)if(c(this.values[this.index]))this.values[this.index]=k,k>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(k)<3)this.date[1]=this.values[this.index]+=k,this.index++;else if(this.values[this.index]==0&&parseInt(k)>0)this.date[1]=this.values[this.index]+=k,this.index++;else var R=!0;else var R=!0;if(R==!0){var Z=parseInt(this.values[this.index]);Z>0&&Z<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(k){var R=!1;if(parseInt(k)>=0&&parseInt(k)<10)if(c(this.values[this.index]))this.values[this.index]=k,parseInt(k)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(k)<2)this.date[2]=this.values[this.index]+=k,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=k,this.index++;else if(this.values[this.index]==0&&parseInt(k)>0)this.date[2]=this.values[this.index]+=k,this.index++;else var R=!0;else var R=!0;if(R==!0){var Z=parseInt(this.values[this.index]);Z>0&&Z<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(k){c(this.values[this.index])?parseInt(k)>3&&parseInt(k)<10?(this.date[2]=this.values[this.index]="0"+k,this.index++):parseInt(k)<10&&(this.values[this.index]=k):this.values[this.index]==3&&parseInt(k)<2?(this.date[2]=this.values[this.index]+=k,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(k)<10?(this.date[2]=this.values[this.index]+=k,this.index++):this.values[this.index]==0&&parseInt(k)>0&&parseInt(k)<10&&(this.date[2]=this.values[this.index]+=k,this.index++)},DDD:function(k){Te.FIND.call(this,k,ce)},DY:function(k){Te.DDD.call(this,k)},DDDD:function(k){Te.FIND.call(this,k,se)},DAY:function(k){Te.DDDD.call(this,k)},HH12:function(k,R){c(this.values[this.index])?parseInt(k)>1&&parseInt(k)<10?(R&&(k=0+k),this.date[3]=this.values[this.index]=k,this.index++):parseInt(k)<10&&(this.values[this.index]=k):this.values[this.index]==1&&parseInt(k)<3?(this.date[3]=this.values[this.index]+=k,this.index++):this.values[this.index]<1&&parseInt(k)<10&&(this.date[3]=this.values[this.index]+=k,this.index++)},HH24:function(k,R){parseInt(k)>=0&&parseInt(k)<10&&(this.values[this.index]==null||this.values[this.index]==""?parseInt(k)>2&&parseInt(k)<10?(R&&(k=0+k),this.date[3]=this.values[this.index]=k,this.index++):parseInt(k)<10&&(this.values[this.index]=k):this.values[this.index]==2&&parseInt(k)<4?(!R&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=k,this.index++):this.values[this.index]<2&&parseInt(k)<10&&(!R&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=k,this.index++))},HH:function(k){Te.HH24.call(this,k,1)},H:function(k){Te.HH24.call(this,k,0)},"\\[H\\]":function(k){this.values[this.index]==null&&(this.values[this.index]=""),k.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=k:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(k,R){this.values[this.index]==null||this.values[this.index]==""?parseInt(k)>5&&parseInt(k)<10?(this.date[R]=this.values[this.index]="0"+k,this.index++):parseInt(k)<10&&(this.values[this.index]=k):parseInt(k)<10&&(this.date[R]=this.values[this.index]+=k,this.index++)},MI:function(k){Te.N60.call(this,k,4)},SS:function(k){Te.N60.call(this,k,5)},"AM/PM":function(k){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),this.values[this.index]===""?k.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":k.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(k){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(k)>=0&&parseInt(k)<7&&(this.values[this.index]=k),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(k){var R=ee.call(this),Z=!1;c(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(Z=!0);var de=P.call(this,this.values[this.index],R);de&&(this.values[this.index]=de.join(R)),parseInt(k)>=0&&parseInt(k)<10?(this.values[this.index]=="0"&&k>0?this.values[this.index]="":this.values[this.index]=="-0"&&k>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||k==R)&&(this.values[this.index]+=k)):R&&k==R?this.values[this.index].indexOf(R)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=k):k=="-"&&(Z=!0),Z===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(k){Te["0{1}(.{1}0+)?"].call(this,k)},"0{1}(.{1}0+)?%":function(k){Te["0{1}(.{1}0+)?"].call(this,k),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(k){Te["0{1}(.{1}0+)?"].call(this,k);var R=ee.call(this),Z=this.tokens[this.index].substr(1,1),de=this.values[this.index][0]==="-",ne=P.call(this,this.values[this.index],R);if(ne!==""){var J=ne[0].match(/[0-9]/g);if(J){J=J.join("");for(var ve=[],xe=0,Ce=J.length-1;Ce>=0;Ce--)ve.push(J[Ce]),xe++,xe%3||ve.push(Z);ve=ve.reverse(),ne[0]=ve.join(""),ne[0].substr(0,1)==Z&&(ne[0]=ne[0].substr(1))}else ne[0]="";this.values[this.index]=ne.join(R),de&&(this.values[this.index]="-"+this.values[this.index])}},0:function(k){k.match(/[0-9]/g)&&(this.values[this.index]=k,this.index++)},"[0-9a-zA-Z$]+":function(k){c(this.values[this.index])&&(this.values[this.index]="");var R=this.tokens[this.index],Z=this.values[this.index],de=Z.length;R[de]==k?(this.values[this.index]+=k,this.values[this.index]==R&&this.index++):(this.values[this.index]=R,this.index++,k.match(/[\-0-9]/g)&&this.position--)},A:function(k){k.match(/[a-zA-Z]/gi)&&(this.values[this.index]=k,this.index++)},".":function(k){Te["[0-9a-zA-Z$]+"].call(this,k)},"@":function(k){c(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=k}},Xe=function(k){if(this.type=="general")var R=[].concat(L.general);else var R=[].concat(L.currency,L.datetime,L.percentage,L.scientific,L.numeric,L.text,L.general);var Z=new RegExp(R.join("|"),"gi");return k.match(Z)},tt=function(k){if(this.type)if(this.type=="text")var R=["text"];else if(this.type=="general")var R=["general"];else if(this.type=="datetime")var R=["numeric","datetime","general"];else var R=["currency","percentage","scientific","numeric","general"];else var R=Object.keys(L);for(var Z=0;Z<R.length;Z++)for(var de=R[Z],ne=0;ne<L[de].length;ne++){var J=new RegExp(L[de][ne],"gi"),ve=k.match(J);if(ve)return{type:de,method:L[de][ne]}}},he=function(k){for(var R=[],Z=0;Z<k.length;Z++){var de=tt.call(this,k[Z]);de?R.push(de.method):R.push(null)}for(var Z=0;Z<R.length;Z++)R[Z]=="MM"&&(R[Z-1]&&R[Z-1].indexOf("H")>=0||R[Z-2]&&R[Z-2].indexOf("H")>=0||R[Z+1]&&R[Z+1].indexOf("S")>=0||R[Z+2]&&R[Z+2].indexOf("S")>=0)&&(R[Z]="MI");return R},ue=function(k){var R=tt.call(this,k);if(R)var Z=R.type;if(Z){for(var de=0,ne=Xe.call(this,k),J=0;J<ne.length;J++)R=tt.call(this,ne[J]),R&&K(R.type)&&de++;de>1&&(Z="general")}return Z},je=function(){typeof Te[this.methods[this.index]]=="function"?(Te[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},Y=function(k){return(""+ +k).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(R,Z,de,ne,J){return J<0?Z+"0."+Array(1-J-de.length).join(0)+de+ne:Z+de+ne+Array(J-ne.length+1).join(0)})},q=function(k,R,Z){var de=null,ne=null,J={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof k=="object"){if(J.input=k.target,J.value=me.call(k.target),J.caret=ie.call(k.target),(ne=k.target.getAttribute("data-mask"))&&(J.mask=ne),(ne=k.target.getAttribute("data-type"))&&(J.type=ne),k.target.mask?(k.target.mask.options&&(J.options=k.target.mask.options),k.target.mask.locale&&(J.locale=k.target.mask.locale)):(ne=k.target.getAttribute("data-locale"))&&(J.locale=ne,J.mask&&(J.options.style=J.mask)),k.target.attributes&&k.target.attributes.length)for(var ve=0;ve<k.target.attributes.length;ve++){var xe=k.target.attributes[ve].name,Ce=k.target.attributes[ve].value;xe.substr(0,4)=="data"&&(J.options[xe.substr(5)]=Ce)}}else{if(typeof R=="string")J.mask=R;else for(var xe=Object.keys(R),ve=0;ve<xe.length;ve++)J[xe[ve]]=R[xe[ve]];typeof k=="number"&&(ee.call(J,J.mask),k=(""+k).replace(".",J.options.decimal)),J.value=k,J.input&&(me.call(J.input,k),M.focus(J.input),J.caret=ie.call(J.input))}if(!B(J.value)&&(J.mask||J.locale)){if(J.mask){if(J.mask=J.mask.replace(new RegExp(/\[h]/),"|h|"),J.mask=J.mask.replace(new RegExp(/\[.*?\]/),""),J.mask=J.mask.replace(new RegExp(/\|h\|/),"[h]"),J.mask.indexOf(";")!==-1){var ne=J.mask.split(";");J.mask=ne[0]}if(J.mask.indexOf("##")!==-1){var Ae=J.mask.split(";");Ae[0]&&(typeof k=="object"&&(Ae[0]=Ae[0].replace(new RegExp(/_\)/g),""),Ae[0]=Ae[0].replace(new RegExp(/_\(/g),"")),Ae[0]=Ae[0].replace("*","	"),Ae[0]=Ae[0].replace(new RegExp(/_-/g),""),Ae[0]=Ae[0].replace(new RegExp(/_/g),""),Ae[0]=Ae[0].replace(new RegExp(/"/g),""),Ae[0]=Ae[0].replace("##0.###","##0.000"),Ae[0]=Ae[0].replace("##0.##","##0.00"),Ae[0]=Ae[0].replace("##0.#","##0.0"),Ae[0]=Ae[0].replace("##0,###","##0,000"),Ae[0]=Ae[0].replace("##0,##","##0,00"),Ae[0]=Ae[0].replace("##0,#","##0,0")),J.mask=Ae[0]}if(J.mask.indexOf("\\")!==-1){var Ae=J.mask.split(";");Ae[0]=Ae[0].replace(new RegExp(/\\/g),""),J.mask=Ae[0]}J.type||(J.type=ue.call(J,J.mask)),J.tokens=Xe.call(J,J.mask)}if(typeof k!="object"||!k.inputType||!k.inputType.indexOf("insert")||!k.inputType.indexOf("delete"))if(J.locale)if(J.input)z.call(J,J.input,k);else var _e=H.call(J,J.value);else{for(J.methods=he.call(J,J.tokens),J.event=k;J.position<J.value.length&&typeof J.tokens[J.index]<"u";)je.call(J);var _e=J.values.join("");if(K(J.type)&&_e!==""){for(;typeof J.tokens[J.index]<"u";){var ne=tt.call(J,J.tokens[J.index]);ne&&ne.type=="general"&&(J.values[J.index]=J.tokens[J.index]),J.index++}var We=!0}else var We=!1;if(_e=J.values.join(""),J.input){if(ne=_e.length-J.value.length,ne>0)var nt=J.caret+ne;else var nt=J.caret;me.call(J.input,_e,nt,We)}}if(J.input){var te=null;if(K(J.type)){let ge=me.call(J.input);J.number=X.call(J,ge),J.type=="percentage"&&(""+ge).indexOf("%")!==-1?te=q.adjustPrecision(J.number/100):te=J.number}else J.type=="datetime"&&(te=I.call(J),J.date[0]&&J.date[1]&&J.date[2]&&J.input.setAttribute("data-completed",!0));te&&J.input.setAttribute("data-value",te)}if(_e!==void 0)return Z?J:_e}};return q.adjustPrecision=function(k){if(typeof k=="number"&&!Number.isInteger(k)){let R=k.toString().split(".");if(R[1]&&R[1].length>10){let Z=0,de=R[1][R[1].length-2];if(de==0||de==9){for(let ne=R[1].length-2;ne>0;ne--)if(Z>=0&&R[1][ne]==de){if(Z++,Z>6)break}else{Z=0;break}if(Z)return parseFloat(parseFloat(k).toFixed(R[1].length-1))}}}return k},q.getType=ue,q.prepare=function(k,R){return R||(R={}),Xe.call(R,k)},q.apply=function(k){var R=me.call(k.target);k.key.length==1&&(R+=k.key),me.call(k.target,q(R,k.target.getAttribute("data-mask")))},q.run=function(k,R,Z){return q(k,{mask:R,decimal:Z})},q.extract=function(k,R,Z){if(c(k)||typeof R!="object")return k;if(R=Object.assign({},R),R.options||(R.options={}),!R.mask&&R.format&&(R.mask=R.format),R.mask){if(R.mask.indexOf(";")!==-1){var de=R.mask.split(";");R.mask=de[0]}R.mask=R.mask.replace(new RegExp(/\[h]/),"|h|"),R.mask=R.mask.replace(new RegExp(/\[.*?\]/),""),R.mask=R.mask.replace(new RegExp(/\|h\|/),"[h]")}ee.call(R,R.mask);var ne=null,J=null;if(R.type=="percent"||R.options.style=="percent"?ne="percentage":R.mask&&(ne=ue.call(R,R.mask)),ne==="text"){var ve={};J=k}else if(ne==="general"){var ve=q(k,R,!0);J=k}else if(ne==="datetime"){k instanceof Date&&(k=q.getDateString(k,R.mask));var ve=q(k,R,!0);M.isNumeric(k)?J=k:J=h.call(ve)}else if(ne==="scientific"){J=k,typeof k=="string"&&(J=Number(J));var ve=R}else{J=X.call(R,k),ne==="percentage"&&(""+k).indexOf("%")!==-1&&(J/=100);var ve=R}return ve.value=J,!ve.type&&ne&&(ve.type=ne),Z?ve:J},q.render=function(k,R,Z,de){if(c(k)||typeof R!="object")return k;if(R=Object.assign({},R),R.options||(R.options={}),!R.mask&&R.format&&(R.mask=R.format),R.mask){if(R.mask.indexOf(";")!==-1){var ne=R.mask.split(";");Z||(ne[0]=ne[0].replace(new RegExp(/_\)/g),""),ne[0]=ne[0].replace(new RegExp(/_\(/g),"")),R.mask=ne[0]}R.mask=R.mask.replace(new RegExp(/\[h]/),"|h|"),R.mask=R.mask.replace(new RegExp(/\[.*?\]/),""),R.mask=R.mask.replace(new RegExp(/\|h\|/),"[h]")}var J=null;R.type=="percent"||R.options.style=="percent"?J="percentage":R.mask?J=ue.call(R,R.mask):k instanceof Date&&(J="datetime");var ve=!1;if(J=="datetime"||R.type=="calendar"){var ne=q.getDateString(k,R.mask);ne&&(k=ne),R.mask&&Z&&(ve=!0)}else if(J==="text")typeof k=="number"&&(k=k.toString());else if(typeof k=="string"&&e.isNumeric(k)&&(k=Number(k)),J==="percentage"&&(k=q.adjustPrecision(k*100)),typeof k=="number"){var ne=null;if(R.mask&&Z){var xe=ee.call(R,R.mask);if(J==="scientific")if(R.mask.indexOf(xe)!==-1){let ge=R.mask.split("E");ge=ge[0].split(xe),ge=""+ge[1].match(/[0-9]+/g),ge=ge.length,ne=k.toExponential(ge)}else ne=k.toExponential(0);else{if(R.mask.indexOf(xe)!==-1){xe=R.mask.split(xe),xe=""+xe[1].match(/[0-9]+/g),xe=xe.length,ne=k.toFixed(xe);let ge=k.toString().split("."),Ee=ge[1];Ee&&Ee.length>xe&&Ee[Ee.length-1]==="5"&&(ne=parseFloat(ge[0]+"."+Ee+"1").toFixed(xe))}else ne=k.toFixed(0);(""+ne).indexOf("e")!==-1&&(ne=Y(ne))}}else if(R.locale&&Z){var xe=(""+k).split(".");if(R.options){typeof xe[1]>"u"&&(xe[1]="");var Ae=xe[1].length;if(R.options.minimumFractionDigits>Ae)for(var Ce=0;Ce<R.options.minimumFractionDigits-Ae;Ce++)xe[1]+="0"}xe[1].length?ne=xe.join("."):ne=xe[0];var Ae=xe[1].length;R.options&&R.options.maximumFractionDigits<Ae&&(ne=parseFloat(ne).toFixed(R.options.maximumFractionDigits))}else ne=Y(k);ne!==null&&(k=ne,ee.call(R,R.mask),R.options.decimal&&(k=k.replace(".",R.options.decimal)))}else R.mask&&Z&&(ve=!0);if(ve){var _e=R.mask.length-k.length;if(_e>0)for(var Ce=0;Ce<_e;Ce++)k+=" "}if(J==="scientific")if(!Z)k=Y(k);else return k;if(J==="numeric"&&de===!1&&typeof k=="string")return k;if(k=q(k,R),Z&&J==="numeric"){var We=R.mask.match(new RegExp(/^[0]+$/gm));if(We&&We.length===1){var nt=We[0].length;if(nt>3)for(k=""+k;k.length<nt;)k="0"+k}}return k},q.set=function(k,R){if(R){k.setAttribute("data-mask",R);var Z=new Event("input",{bubbles:!0,cancelable:!0});k.dispatchEvent(Z)}},q.extractDateFromString=function(k,R){var Z=q(k,{mask:R},!0);if(k>0&&Number(k)==k&&(Z.values.join("")!==Z.value||Z.type=="numeric")){var de=new Date(Math.round((k-25569)*86400*1e3));return de.getFullYear()+"-"+M.two(de.getMonth())+"-"+M.two(de.getDate())+" 00:00:00"}var ne=!1;return Z.values&&Z.values.length===Z.tokens.length&&Z.values[Z.values.length-1].length>=Z.tokens[Z.tokens.length-1].length&&(ne=!0),Z.date[0]&&Z.date[1]&&(Z.date[2]||ne)?(Z.date[2]||(Z.date[2]=1),Z.date[0]+"-"+M.two(Z.date[1])+"-"+M.two(Z.date[2])+" "+M.two(Z.date[3])+":"+M.two(Z.date[4])+":"+M.two(Z.date[5])):""},q.getDateString=function(k,R){if(!R)var R={};if(R&&typeof R=="object"){if(R.format)var Z=R.format;else if(R.mask)var Z=R.mask}else var Z=R;if(Z||(Z="YYYY-MM-DD"),Z.indexOf("[h]")>=0){var de=0;if(k&&M.isNumeric(k)&&(de=parseFloat(24*Number(k)),Z.indexOf("mm")>=0)){var ne=(""+de).split(".");if(ne[1]){var J=60*parseFloat("0."+ne[1]);J=parseFloat(J.toFixed(2))}else var J=0;de=parseInt(ne[0])+":"+M.two(J)}return de}k instanceof Date?k=D.now(k):k&&M.isNumeric(k)&&(k=D.numToDate(k));for(var ve=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],xe=new RegExp(ve.join("|"),"gi"),Ce=Z.match(xe),Ae=0;Ae<Ce.length;Ae++)Ce[Ae].toUpperCase()=="MM"&&(Ce[Ae-1]&&Ce[Ae-1].toUpperCase().indexOf("H")>=0||Ce[Ae-2]&&Ce[Ae-2].toUpperCase().indexOf("H")>=0||Ce[Ae+1]&&Ce[Ae+1].toUpperCase().indexOf("S")>=0||Ce[Ae+2]&&Ce[Ae+2].toUpperCase().indexOf("S")>=0)&&(Ce[Ae]="mi");var _e={tokens:Ce};if(k){var J=""+k,We=J.indexOf("T")!==-1?"T":" ";J=J.split(We);var ne=0,nt=0,te=0;J[1]&&(ne=J[1].split(":"),nt=ne[1]?ne[1]:0,te=ne[2]?ne[2]:0,ne=ne[0]?ne[0]:0),J=J[0].split("-");let Qe=new Date(J[0],J[1],0).getDate();if(J[0]&&J[1]&&J[2]&&J[0]>0&&J[1]>0&&J[1]<13&&J[2]>0&&J[2]<=Qe){_e.data=[J[0],J[1],J[2],ne,nt,te],_e.value=[];for(var ge=new Date(_e.data[0],_e.data[1]-1,_e.data[2],_e.data[3],_e.data[4],_e.data[5]),Ee=function(st){var Ct=this.tokens[st],qe=Ct.toUpperCase(),Ve=null;qe==="YYYY"?Ve=this.data[0]:qe==="YYY"?Ve=this.data[0].substring(1,4):qe==="YY"?Ve=this.data[0].substring(2,4):qe==="Y"?Ve=this.data[0].substring(3,4):Ct==="MON"?Ve=D.months[ge.getMonth()].substr(0,3).toUpperCase():Ct==="mon"?Ve=D.months[ge.getMonth()].substr(0,3).toLowerCase():Ct==="MONTH"?Ve=D.months[ge.getMonth()].toUpperCase():Ct==="month"?Ve=D.months[ge.getMonth()].toLowerCase():qe==="MMMMM"?Ve=D.months[ge.getMonth()].substr(0,1):qe==="MMMM"||Ct==="Month"?Ve=D.months[ge.getMonth()]:qe==="MMM"||Ct=="Mon"?Ve=D.months[ge.getMonth()].substr(0,3):qe==="MM"?Ve=M.two(this.data[1]):qe==="M"?Ve=ge.getMonth()+1:Ct==="DAY"?Ve=D.weekdays[ge.getDay()].toUpperCase():Ct==="day"?Ve=D.weekdays[ge.getDay()].toLowerCase():qe==="DDDD"||Ct=="Day"?Ve=D.weekdays[ge.getDay()]:qe==="DDD"?Ve=D.weekdays[ge.getDay()].substr(0,3):qe==="DD"?Ve=M.two(this.data[2]):qe==="D"?Ve=parseInt(this.data[2]):qe==="Q"?Ve=Math.floor((ge.getMonth()+3)/3):qe==="HH24"||qe==="HH"?(Ve=this.data[3],Ve>12&&this.tokens.indexOf("am/pm")!==-1&&(Ve-=12),Ve=M.two(Ve)):qe==="HH12"?this.data[3]>12?Ve=M.two(this.data[3]-12):Ve=M.two(this.data[3]):qe==="H"?(Ve=this.data[3],Ve>12&&this.tokens.indexOf("am/pm")!==-1&&(Ve-=12,Ve=M.two(Ve))):qe==="MI"?Ve=M.two(this.data[4]):qe==="SS"?Ve=M.two(this.data[5]):qe==="MS"?Ve=ge.getMilliseconds():qe==="AM/PM"?this.data[3]>=12?Ve="PM":Ve="AM":qe==="WD"&&(Ve=D.weekdays[ge.getDay()]),Ve===null?this.value[st]=this.tokens[st]:this.value[st]=Ve},Ae=0;Ae<_e.tokens.length;Ae++)Ee.call(_e,Ae);k=_e.value.join("")}else k=""}return k},q}var N=F();function _(){var L=function(I,h){if(I.calendar)return I.calendar.setOptions(h,!0);var c={type:"calendar"};c.options={},c.date=null,c.setOptions=function(Y,q){var k={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:D.monthsShort,monthsFull:D.months,weekdays:D.weekdays,textDone:u.translate("Done"),textReset:u.translate("Reset"),textUpdate:u.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var R in k)Y&&Y.hasOwnProperty(R)?c.options[R]=Y[R]:(typeof c.options[R]>"u"||q===!0)&&(c.options[R]=k[R]);if(c.options.resetButton==!1?H.style.display="none":H.style.display="",c.options.readonly?I.setAttribute("readonly","readonly"):I.removeAttribute("readonly"),c.options.placeholder?I.setAttribute("placeholder",c.options.placeholder):I.removeAttribute("placeholder"),M.isNumeric(c.options.value)&&c.options.value>0&&(c.options.value=L.numToDate(c.options.value),c.options.dataType="numeric"),H.innerHTML=c.options.textReset,z.innerHTML=c.options.textDone,tt.innerHTML=c.options.textUpdate,c.options.format&&I.setAttribute("data-mask",c.options.format.toLowerCase()),!c.options.value&&c.options.today)var Z=L.now();else var Z=c.options.value;return Z&&(c.options.value=null,c.setValue(Z)),c},c.open=function(Y){if(!P.classList.contains("jcalendar-focus")&&!P.classList.contains("jcalendar-inline")){if(L.current=c,m(c,!0),c.getDays(),c.options.type=="year-month-picker"&&c.getMonths(),c.options.time&&(he.value=c.date[3],ue.value=c.date[4]),P.classList.add("jcalendar-focus"),M.getWindowWidth()<800||c.options.fullscreen)P.classList.add("jcalendar-fullsize"),A.slideBottom(ie,1);else{P.classList.remove("jcalendar-fullsize");var q=I.getBoundingClientRect(),k=ie.getBoundingClientRect();if(c.options.position)X.style.position="fixed",window.innerHeight<q.bottom+k.height?X.style.top=q.top-(k.height+2)+"px":X.style.top=q.top+q.height+2+"px",X.style.left=q.left+"px";else{if(window.innerHeight<q.bottom+k.height){var R=-1*(q.height+k.height+2);R+q.top<0&&(R=-1*(q.top+q.height)),X.style.top=R+"px"}else X.style.top="2px";if(window.innerWidth<q.left+k.width){var R=window.innerWidth-(q.left+k.width+20);X.style.left=R+"px"}else X.style.left="0px"}}typeof c.options.onopen=="function"&&c.options.onopen(I)}},c.close=function(Y,q){if(c.options.autoSelect!==!0&&typeof q>"u"&&(q=!1),P.classList.contains("jcalendar-focus")){if(q!==!1){var k=P.querySelector(".jcalendar-selected");if(typeof q=="string")var R=q;else if(!k||k.classList.contains("jcalendar-disabled"))var R=c.options.value;else var R=c.getValue();c.setValue(R)}else{let Z=c.options.value||"";c.options.value=null,c.setValue(Z)}!Y&&typeof c.options.onclose=="function"&&c.options.onclose(I),P.classList.remove("jcalendar-focus"),m(c,!1),L.current=null}return c.options.value},c.prev=function(){c.options.mode=="years"?(c.date[0]=c.date[0]-12,c.getYears()):c.options.mode=="months"?(c.date[0]=parseInt(c.date[0])-1,c.getMonths()):(c.date[1]<2?(c.date[0]=c.date[0]-1,c.date[1]=12):c.date[1]=c.date[1]-1,c.getDays())},c.next=function(){c.options.mode=="years"?(c.date[0]=parseInt(c.date[0])+12,c.getYears()):c.options.mode=="months"?(c.date[0]=parseInt(c.date[0])+1,c.getMonths()):(c.date[1]>11?(c.date[0]=parseInt(c.date[0])+1,c.date[1]=1):c.date[1]=parseInt(c.date[1])+1,c.getDays())},c.setToday=function(){var Y=new Date().toISOString().substr(0,10);return c.setValue(Y),Y},c.setValue=function(Y){Y||(Y=""+Y);var q=Y,k=c.options.value;if(k!=q){if(q){var R=c.setLabel(q,c.options),de=q.split(" ");de[1]||(de[1]="00:00:00");var Z=de[1].split(":"),de=de[0].split("-"),ne=parseInt(de[0]),J=parseInt(de[1]),ve=parseInt(de[2]),xe=parseInt(Z[0]),Ce=parseInt(Z[1]);c.date=[ne,J,ve,xe,Ce,0];var Y=c.setLabel(q,c.options),Ae=L.now(new Date(ne,J-1,ve),!0);if(c.options.validRange){if(!c.options.validRange[0]||Ae>=c.options.validRange[0])var _e=!0;else var _e=!1;if(!c.options.validRange[1]||Ae<=c.options.validRange[1])var We=!0;else var We=!1;_e&&We?(I.classList.remove("jcalendar_warning"),I.title=""):(I.classList.add("jcalendar_warning"),I.title=u.translate("Date outside the valid range"))}else I.classList.remove("jcalendar_warning"),I.title=""}else{c.date=null;var Y="";I.classList.remove("jcalendar_warning"),I.title=""}c.options.value=q,typeof c.options.onchange=="function"&&c.options.onchange(I,q,k),I.value!=Y&&(I.value=Y,typeof I.oninput=="function"&&I.oninput({type:"input",target:I,value:I.value}))}c.date&&(c.getDays(),c.options.type=="year-month-picker"&&c.getMonths())},c.getValue=function(){return c.date?c.options.time?M.two(c.date[0])+"-"+M.two(c.date[1])+"-"+M.two(c.date[2])+" "+M.two(c.date[3])+":"+M.two(c.date[4])+":"+M.two(0):M.two(c.date[0])+"-"+M.two(c.date[1])+"-"+M.two(c.date[2])+" "+M.two(0)+":"+M.two(0)+":"+M.two(0):""},c.update=function(Y,q){if(!Y.classList.contains("jcalendar-disabled")){var k=P.querySelector(".jcalendar-selected");k&&k.classList.remove("jcalendar-selected"),Y.classList.add("jcalendar-selected"),Y.classList.contains("jcalendar-set-month")?(c.date[1]=q,c.date[2]=1):c.date[2]=Y.innerText,c.options.time?(c.date[3]=he.value,c.date[4]=ue.value):c.close(null,!0)}ee()},c.reset=function(){c.setValue(""),c.date=null,c.close(!1,!1)},c.getDays=function(){c.options.mode="days";var ve=new Date,Y=c.date&&M.isNumeric(c.date[0])?c.date[0]:parseInt(ve.getFullYear()),q=c.date&&M.isNumeric(c.date[1])?c.date[1]:parseInt(ve.getMonth())+1,k=c.date&&M.isNumeric(c.date[2])?c.date[2]:parseInt(ve.getDate()),R=c.date&&M.isNumeric(c.date[3])?c.date[3]:parseInt(ve.getHours()),Z=c.date&&M.isNumeric(c.date[4])?c.date[4]:parseInt(ve.getMinutes());c.date=[Y,q,k,R,Z,0],me.innerHTML=Y,se.innerHTML=c.options.months[q-1];var de=ve.getMonth()==q-1&&ve.getFullYear()==Y,ne=ve.getDate(),ve=new Date(Y,q,0,0,0),J=ve.getDate(),ve=new Date(Y,q-1,0,0,0),xe=ve.getDay()+1,We=c.options.startingDay||0;xe=xe-We,Me.innerHTML="";var Ce=document.createElement("tr");Ce.setAttribute("align","center"),Me.appendChild(Ce);for(var Ae=0;Ae<7;Ae++){var _e=document.createElement("td");_e.classList.add("jcalendar-weekday"),_e.innerHTML=c.options.weekdays[We].substr(0,1),Ce.appendChild(_e),We++,We>6&&(We=0)}for(var We=0,nt=0,te=0;te<6;te++){var Ce=document.createElement("tr");Ce.setAttribute("align","center"),Ce.style.height="34px";for(var Ae=0;Ae<7;Ae++){var _e=document.createElement("td");if(_e.classList.add("jcalendar-set-day"),We>=xe&&We<xe+J){nt++,_e.innerHTML=nt,nt==k&&_e.classList.add("jcalendar-selected"),de&&ne==nt&&(_e.style.fontWeight="bold");var ge=L.now(new Date(Y,q-1,nt),!0);if(c.options.validRange){if(!c.options.validRange[0]||ge>=c.options.validRange[0])var Ee=!0;else var Ee=!1;if(!c.options.validRange[1]||ge<=c.options.validRange[1])var Re=!0;else var Re=!1;Ee&&Re||_e.classList.add("jcalendar-disabled")}}Ce.appendChild(_e),We++}Me.appendChild(Ce)}c.options.time?Te.style.display="":Te.style.display="none",ee()},c.getMonths=function(){c.options.mode="months";var Y=c.options.months,q=c.options.value,k=new Date,R=parseInt(k.getFullYear()),Z=parseInt(k.getMonth())+1,de=c.date&&M.isNumeric(c.date[0])?c.date[0]:R,ne=c.date&&M.isNumeric(c.date[1])?c.date[1]:Z;me.innerHTML=c.date[0],se.innerHTML=Y[ne-1];var J=document.createElement("table");J.setAttribute("width","100%");for(var ve=null,xe=0;xe<12;xe++){if(!(xe%4)){var ve=document.createElement("tr");ve.setAttribute("align","center"),J.appendChild(ve)}var Ce=document.createElement("td");if(Ce.classList.add("jcalendar-set-month"),Ce.setAttribute("data-value",xe+1),Ce.innerText=Y[xe],c.options.validRange){var Ae=de+"-"+M.two(xe+1);if(!c.options.validRange[0]||Ae>=c.options.validRange[0].substr(0,7))var _e=!0;else var _e=!1;if(!c.options.validRange[1]||Ae<=c.options.validRange[1].substr(0,7))var We=!0;else var We=!1;_e&&We||Ce.classList.add("jcalendar-disabled")}xe+1==ne&&Ce.classList.add("jcalendar-selected"),R==de&&xe+1==Z&&(Ce.style.fontWeight="bold"),ve.appendChild(Ce)}Me.innerHTML='<tr><td colspan="7"></td></tr>',Me.children[0].children[0].appendChild(J),ee()},c.getYears=function(){c.options.mode="years";for(var Y=new Date,q=Y.getFullYear(),k=c.date&&M.isNumeric(c.date[0])?c.date[0]:parseInt(Y.getFullYear()),R=[],Z=0;Z<25;Z++)R[Z]=parseInt(c.date[0])+(Z-12);var de=document.createElement("table");de.setAttribute("width","100%");for(var Z=0;Z<25;Z++){if(!(Z%5)){var ne=document.createElement("tr");ne.setAttribute("align","center"),de.appendChild(ne)}var J=document.createElement("td");J.classList.add("jcalendar-set-year"),J.innerText=R[Z],k==R[Z]&&J.classList.add("jcalendar-selected"),q==R[Z]&&(J.style.fontWeight="bold"),ne.appendChild(J)}Me.innerHTML='<tr><td colspan="7"></td></tr>',Me.firstChild.firstChild.appendChild(de),ee()},c.setLabel=function(Y,q){return L.getDateString(Y,q)},c.fromFormatted=function(Y,q){return L.extractDateFromString(Y,q)};var B=function(Y){var q=M.findElement(Y.target,"jcalendar-container");if(q){var k=Y.target.className;if(k=="jcalendar-prev")c.prev();else if(k=="jcalendar-next")c.next();else if(k=="jcalendar-month")c.getMonths();else if(k=="jcalendar-year")c.getYears();else if(k=="jcalendar-set-year")c.date[0]=Y.target.innerText,c.options.type=="year-month-picker"?c.getMonths():c.getDays();else if(Y.target.classList.contains("jcalendar-set-month")){var R=parseInt(Y.target.getAttribute("data-value"));c.options.type=="year-month-picker"?c.update(Y.target,R):(c.date[1]=R,c.getDays())}else k=="jcalendar-confirm"||k=="jcalendar-update"||k=="jcalendar-close"?c.close(null,!0):k=="jcalendar-backdrop"?c.close(!1,!1):k=="jcalendar-reset"?c.reset():Y.target.classList.contains("jcalendar-set-day")&&Y.target.innerText&&c.update(Y.target)}else c.close(!1,!1)},K=function(Y){if(Y.target.value&&Y.target.value.length>3){var q=L.extractDateFromString(Y.target.value,c.options.format);q&&c.setValue(q)}},ee=function(){var Y=P.querySelector(".jcalendar-selected");Y&&Y.classList.contains("jcalendar-disabled")?(tt.setAttribute("disabled","disabled"),he.setAttribute("disabled","disabled"),ue.setAttribute("disabled","disabled")):(tt.removeAttribute("disabled"),he.removeAttribute("disabled"),ue.removeAttribute("disabled")),typeof c.options.onupdate=="function"&&c.options.onupdate(I,c.getValue())},P=null,H=null,z=null,X=null,ie=null,me=null,se=null,ce=null,Me=null,Se=null,Te=null,Xe=null,tt=null,he=null,ue=null,je=function(){I.tagName=="INPUT"&&I.value&&(h.value=I.value),H=document.createElement("div"),H.className="jcalendar-reset",z=document.createElement("div"),z.className="jcalendar-confirm",Se=document.createElement("div"),Se.className="jcalendar-controls",Se.style.borderBottom="1px solid #ddd",Se.appendChild(H),Se.appendChild(z),X=document.createElement("div"),X.className="jcalendar-container",ie=document.createElement("div"),ie.className="jcalendar-content",X.appendChild(ie),I.tagName=="DIV"?(P=I,P.classList.add("jcalendar-inline")):(ie.appendChild(Se),P=document.createElement("div"),P.className="jcalendar"),P.classList.add("jcalendar-container"),P.appendChild(X);var Y=document.createElement("div");Y.className="jcalendar-table",ie.appendChild(Y);var q=document.createElement("td");q.setAttribute("colspan","2"),q.className="jcalendar-prev",me=document.createElement("span"),me.className="jcalendar-year",se=document.createElement("span"),se.className="jcalendar-month";var k=document.createElement("td");k.className="jcalendar-header",k.setAttribute("colspan","3"),k.appendChild(se),k.appendChild(me);var R=document.createElement("td");R.setAttribute("colspan","2"),R.className="jcalendar-next";var Z=document.createElement("thead"),de=document.createElement("tr");de.appendChild(q),de.appendChild(k),de.appendChild(R),Z.appendChild(de),ce=document.createElement("table"),Me=document.createElement("tbody"),ce.setAttribute("cellpadding","0"),ce.setAttribute("cellspacing","0"),ce.appendChild(Z),ce.appendChild(Me),Y.appendChild(ce),he=document.createElement("select"),he.className="jcalendar-select",he.onchange=function(){c.date[3]=this.value,typeof c.options.onupdate=="function"&&c.options.onupdate(I,c.getValue())};for(var ne=0;ne<24;ne++){var J=document.createElement("option");J.value=ne,J.innerHTML=M.two(ne),he.appendChild(J)}ue=document.createElement("select"),ue.className="jcalendar-select",ue.onchange=function(){c.date[4]=this.value,typeof c.options.onupdate=="function"&&c.options.onupdate(I,c.getValue())};for(var ne=0;ne<60;ne++){var J=document.createElement("option");J.value=ne,J.innerHTML=M.two(ne),ue.appendChild(J)}var ve=document.createElement("div");ve.className="jcalendar-controls",Te=document.createElement("div"),Te.className="jcalendar-time",Te.style.maxWidth="140px",Te.appendChild(he),Te.appendChild(ue),tt=document.createElement("button"),tt.setAttribute("type","button"),tt.className="jcalendar-update",Xe=document.createElement("div"),Xe.style.flexGrow="10",Xe.appendChild(tt),ve.appendChild(Te),I.tagName=="INPUT"&&ve.appendChild(Xe),ie.appendChild(ve);var xe=document.createElement("div");xe.className="jcalendar-backdrop",P.appendChild(xe),I.addEventListener("keyup",K),P.addEventListener("swipeleft",function(Ce){A.slideLeft(ce,0,function(){c.next(),A.slideRight(ce,1)}),Ce.preventDefault(),Ce.stopPropagation()}),P.addEventListener("swiperight",function(Ce){A.slideRight(ce,0,function(){c.prev(),A.slideLeft(ce,1)}),Ce.preventDefault(),Ce.stopPropagation()}),"ontouchend"in document.documentElement?(P.addEventListener("touchend",B),I.addEventListener("touchend",c.open)):(P.addEventListener("mouseup",B),I.addEventListener("mouseup",c.open)),L.hasEvents||(L.hasEvents=!0,document.addEventListener("keydown",L.keydown)),c.setOptions(h),I.tagName=="INPUT"?(I.parentNode.insertBefore(P,I.nextSibling),I.setAttribute("autocomplete","off"),I.classList.add("jcalendar-input"),I.value=c.setLabel(c.getValue(),c.options)):(c.getDays(),c.options.time&&(he.value=c.date[3],ue.value=c.date[4])),c.options.opened==!0&&c.open(),c.options.controls==!1&&X.classList.add("jcalendar-hide-controls"),I.change=c.setValue,I.val=function(Ce){if(Ce===void 0)return c.getValue();c.setValue(Ce)},I.calendar=P.calendar=c};return je(),c};return L.keydown=function(I){var h=null;(h=L.current)&&(I.which==13?h.close(!1,!0):I.which==27&&h.close(!1,!1))},L.prettify=function(I,h){if(!h)var h={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};I.indexOf("GMT")===-1&&I.indexOf("Z")===-1&&(I+=" GMT");var c=new Date,B=new Date(I),K=parseInt((c-B)/1e3/60);if(String.prototype.format=function(P){return this.replace("{0}",P)},K==0)var ee=h.justNow;else if(K<90)var ee=h.xMinutesAgo.format(K);else if(K<1440)var ee=h.xHoursAgo.format(Math.round(K/60));else if(K<20160)var ee=h.xDaysAgo.format(Math.round(K/1440));else if(K<43200)var ee=h.xWeeksAgo.format(Math.round(K/10080));else if(K<1036800)var ee=h.xMonthsAgo.format(Math.round(K/43200));else var ee=h.xYearsAgo.format(Math.round(K/525600));return ee},L.prettifyAll=function(){for(var I=document.querySelectorAll(".prettydate"),h=0;h<I.length;h++)I[h].getAttribute("data-date")?I[h].innerHTML=L.prettify(I[h].getAttribute("data-date")):I[h].innerHTML&&(I[h].setAttribute("title",I[h].innerHTML),I[h].setAttribute("data-date",I[h].innerHTML),I[h].innerHTML=L.prettify(I[h].innerHTML))},L.now=D.now,L.toArray=D.toArray,L.dateToNum=D.dateToNum,L.numToDate=D.numToDate,L.weekdays=D.weekdays,L.months=D.months,L.weekdaysShort=D.weekdaysShort,L.monthsShort=D.monthsShort,L.extractDateFromString=N.extractDateFromString,L.getDateString=N.getDateString,L}var G=_();function U(){var L={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},I=function(h){return L[h]?L[h]:L.material};return I.get=function(h){return L[h]?L[h]:L},I.set=function(h,c){L[h]=c},I}var re=U();function fe(L,I){var h={};h.options={};var c={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var B in c)I&&I.hasOwnProperty(B)?h.options[B]=I[B]:h.options[B]=c[B];L.classList.add("jtabs");var K=null,ee=null,P=null;let H=function(se){h.options.animation&&setTimeout(function(){let ce=h.headers.children[se].getBoundingClientRect();h.options.palette==="modern"?(P.style.width=ce.width-4+"px",P.style.left=h.headers.children[se].offsetLeft+2+"px"):(P.style.width=ce.width+"px",P.style.left=h.headers.children[se].offsetLeft+"px"),h.options.position==="bottom"?P.style.top="0px":P.style.bottom="0px"},50)};var z=function(se){typeof h.headers.scrollTo=="function"?h.headers.scrollTo({left:se,behavior:"smooth"}):h.headers.scrollLeft=se,se<=1?K.classList.add("disabled"):K.classList.remove("disabled"),se>=h.headers.scrollWidth-h.headers.offsetWidth?ee.classList.add("disabled"):ee.classList.remove("disabled"),h.headers.scrollWidth<=h.headers.offsetWidth?(K.style.display="none",ee.style.display="none"):(K.style.display="",ee.style.display="")};if(h.setBorder=H,h.open=function(se){let ce=Array.from(h.content.children);if(h.content.children[se]){for(var Me=null,Se=0;Se<h.headers.children.length;Se++)h.headers.children[Se].classList.contains("jtabs-selected")&&(Me=Se),h.headers.children[Se].classList.remove("jtabs-selected"),h.headers.children[Se].removeAttribute("aria-selected"),h.content.children[Se]&&h.content.children[Se].classList.remove("jtabs-selected");if(h.headers.children[se].classList.add("jtabs-selected"),h.headers.children[se].setAttribute("aria-selected","true"),h.content.children[se]&&h.content.children[se].classList.add("jtabs-selected"),Me!=se&&typeof h.options.onchange=="function"&&h.content.children[se]&&h.options.onchange(L,h,se,h.headers.children[se],h.content.children[se]),h.options.hideHeaders==!0&&h.headers.children.length<3&&h.options.allowCreate==!1)h.headers.parentNode.style.display="none";else{h.headers.parentNode.style.display="";var Te=h.headers.children[se].offsetLeft,Xe=Te+h.headers.children[se].offsetWidth,tt=h.headers.scrollLeft,he=tt+h.headers.offsetWidth;tt<=Te&&he>=Xe||z(Te-1),H(se)}}},h.selectIndex=function(se){var ce=Array.prototype.indexOf.call(h.headers.children,se);return ce>=0&&h.open(ce),ce},h.rename=function(se,ce){ce||(ce=prompt("New title",h.headers.children[se].innerText)),h.headers.children[se].innerText=ce,H(h.getActive())},h.create=function(se,ce){if(typeof h.options.onbeforecreate=="function"){var Me=h.options.onbeforecreate(L,se);if(Me===!1)return!1;se=Me}var Se=h.appendElement(se);return typeof h.options.oncreate=="function"&&h.options.oncreate(L,Se),H(h.getActive()),Se},h.remove=function(se){return h.deleteElement(se)},h.nextNumber=function(){for(var se=0,ce=0;ce<h.headers.children.length;ce++){var Me=h.headers.children[ce].innerText.match(/[0-9].*/);Me>se&&(se=parseInt(Me))}return se?se++:se=1,se},h.deleteElement=function(se){let ce=h.getActive();if(h.headers.children[se])h.headers.removeChild(h.headers.children[se]),h.content.removeChild(h.content.children[se]);else return!1;if(ce===se)h.open(0);else{let Me=h.getActive()||0;H(Me)}typeof h.options.ondelete=="function"&&h.options.ondelete(L,se)},h.appendElement=function(se,ce,Me,Se){if(!se)var se=prompt("Title?","");if(se){let tt=M.guid(),he=M.guid();var Te=document.createElement("div");Te.setAttribute("id",he),Te.setAttribute("role","tabpanel"),Te.setAttribute("aria-labelledby",tt);var Xe=document.createElement("div");if(Xe.setAttribute("id",tt),Xe.setAttribute("role","tab"),Xe.setAttribute("aria-controls",he),Xe.innerHTML=se,Xe.content=Te,typeof Se>"u")h.content.appendChild(Te),h.headers.insertBefore(Xe,h.headers.lastChild);else{let ue=h.content.children[Se];ue?h.content.insertBefore(Te,ue):h.content.appendChild(Te),ue=h.headers.children[Se]||h.headers.lastChild,h.headers.insertBefore(Xe,ue)}return h.options.allowChangePosition&&Xe.setAttribute("draggable","true"),Me!==!1&&h.selectIndex(Xe),typeof ce=="function"&&ce(Te,Xe),Te}},h.getActive=function(){for(var se=0;se<h.headers.children.length;se++)if(h.headers.children[se].classList.contains("jtabs-selected"))return se;return!1},h.updateContent=function(se,ce){if(typeof ce!="string")var Me=ce;else{var Me=document.createElement("div");Me.innerHTML=ce}h.content.children[se].classList.contains("jtabs-selected")&&ce.classList.add("jtabs-selected"),h.content.replaceChild(ce,h.content.children[se]),H()},h.updatePosition=function(se,ce,Me,Se){if(se>ce?h.content.insertBefore(h.content.children[se],h.content.children[ce]):h.content.insertBefore(h.content.children[se],h.content.children[ce].nextSibling),Se!==!1)h.open(ce);else{let Te=h.getActive();ce<Te&&h.setBorder(Te)}!Me&&typeof h.options.onchangeposition=="function"&&h.options.onchangeposition(h.headers,se,ce)},h.move=function(se,ce,Me,Se){se>ce?h.headers.insertBefore(h.headers.children[se],h.headers.children[ce]):h.headers.insertBefore(h.headers.children[se],h.headers.children[ce].nextSibling),h.updatePosition(se,ce,Me,Se)},h.setBorder=H,h.init=function(){L.innerHTML="",h.headers=document.createElement("div"),h.content=document.createElement("div"),h.headers.classList.add("jtabs-headers"),h.headers.setAttribute("role","tablist"),h.content.classList.add("jtabs-content"),h.content.setAttribute("role","region"),h.content.setAttribute("aria-label","Tab Panels"),h.options.palette?L.classList.add("jtabs-modern"):L.classList.remove("jtabs-modern"),h.options.padding&&(h.content.style.padding=parseInt(h.options.padding)+"px");var se=document.createElement("div");se.className="jtabs-headers-container",se.appendChild(h.headers),h.options.maxWidth&&(se.style.maxWidth=parseInt(h.options.maxWidth)+"px");var ce=document.createElement("div");if(ce.className="jtabs-controls",ce.setAttribute("draggable","false"),se.appendChild(ce),h.options.position=="bottom"?(L.appendChild(h.content),L.appendChild(se)):(L.appendChild(se),L.appendChild(h.content)),h.options.allowCreate==!0){var Me=document.createElement("div");Me.className="jtabs-add",Me.onclick=function(){h.create()},ce.appendChild(Me)}K=document.createElement("div"),K.className="jtabs-prev",K.onclick=function(){z(h.headers.scrollLeft-h.headers.offsetWidth)},ce.appendChild(K),ee=document.createElement("div"),ee.className="jtabs-next",ee.onclick=function(){z(h.headers.scrollLeft+h.headers.offsetWidth)},ce.appendChild(ee);for(var Se=0;Se<h.options.data.length;Se++){if(h.options.data[Se].titleElement)var Te=h.options.data[Se].titleElement;else var Te=document.createElement("div");if(h.options.data[Se].icon){var Xe=document.createElement("div"),tt=document.createElement("i");tt.classList.add("material-icons"),tt.innerHTML=h.options.data[Se].icon,Xe.appendChild(tt),Te.appendChild(Xe)}if(h.options.data[Se].title){var he=document.createTextNode(h.options.data[Se].title);Te.appendChild(he)}if(h.options.data[Se].width&&(Te.style.width=h.options.data[Se].width),h.options.data[Se].contentElement)var ue=h.options.data[Se].contentElement;else{var ue=document.createElement("div");ue.innerHTML=h.options.data[Se].content}h.headers.appendChild(Te),h.content.appendChild(ue)}P=document.createElement("div"),P.className="jtabs-border",h.headers.appendChild(P),h.options.animation&&L.classList.add("jtabs-animation"),h.headers.addEventListener("click",function(je){if(je.target.parentNode.classList.contains("jtabs-headers"))var Y=je.target;else if(je.target.tagName=="I")var Y=je.target.parentNode.parentNode;else var Y=je.target.parentNode;var q=h.selectIndex(Y);typeof h.options.onclick=="function"&&h.options.onclick(L,h,q,h.headers.children[q],h.content.children[q])}),h.headers.addEventListener("contextmenu",function(je){h.selectIndex(je.target)}),h.headers.children.length&&h.open(0),z(0),h.options.allowChangePosition==!0&&p(h.headers,{direction:1,ondrop:function(je,Y,q){h.updatePosition(Y,q)}}),typeof h.options.onload=="function"&&h.options.onload(L,h)},L.children[0]&&L.children[0].children.length)for(var X=0;X<L.children[0].children.length;X++){var ie=h.options.data&&h.options.data[X]?h.options.data[X]:{};L.children[1]&&L.children[1].children[X]?(ie.titleElement=L.children[0].children[X],ie.contentElement=L.children[1].children[X]):ie.contentElement=L.children[0].children[X],h.options.data[X]=ie}var me=!1;if(h.options.data)for(var X=0;X<h.options.data.length;X++)h.options.data[X].url&&(v({url:h.options.data[X].url,type:"GET",dataType:"text/html",index:X,success:function(ce){h.options.data[this.index].content=ce},complete:function(){h.init()}}),me=!0);return me||h.init(),L.tabs=h,h}function ae(L,I){if(L.color)return L.color.setOptions(I,!0);var h={type:"color"};h.options={};var c=null,B=null,K=null,ee=null,P=null,H=null,z=null;h.setOptions=function(R,Z){var de={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};R||(R={}),R&&!R.palette&&(R.palette=re());for(var ne in de)R&&R.hasOwnProperty(ne)?h.options[ne]=R[ne]:(typeof h.options[ne]>"u"||Z===!0)&&(h.options[ne]=de[ne]);return ee&&(ee.innerHTML=h.options.resetLabel),P&&(P.innerHTML=h.options.doneLabel),h.options.palette&&z&&z.updateContent(0,Me()),typeof h.options.value=="string"&&(L.value=h.options.value,L.tagName==="INPUT"&&(L.style.color=L.value,L.style.backgroundColor=L.value)),h.options.placeholder?L.setAttribute("placeholder",h.options.placeholder):L.getAttribute("placeholder")&&L.removeAttribute("placeholder"),h},h.select=function(R){var Z=c.querySelector(".jcolor-selected");Z&&Z.classList.remove("jcolor-selected"),h.values[R]&&h.values[R].classList.add("jcolor-selected"),h.options.value=R},h.open=function(){if(!c.classList.contains("jcolor-focus")){m(h,!0),c.classList.add("jcolor-focus"),h.options.value&&h.select(h.options.value),K.style.marginTop="",K.style.marginLeft="";var R=K.getBoundingClientRect(),Z=M.getWindowWidth(),de=M.getWindowHeight();if(Z<800||h.options.fullscreen==!0?(K.classList.add("jcolor-fullscreen"),A.slideBottom(K,1),B.style.display="block"):(K.classList.contains("jcolor-fullscreen")&&(K.classList.remove("jcolor-fullscreen"),B.style.display=""),h.options.position?K.style.position="fixed":K.style.position="",R.left+R.width>Z&&(K.style.marginLeft=-1*(R.left+R.width-(Z-20))+"px"),R.top+R.height>de&&(K.style.marginTop=-1*(R.top+R.height-(de-20))+"px")),typeof h.options.onopen=="function"&&h.options.onopen(L,h),z.setBorder(z.getActive()),h.options.value){var ne=ce(h.options.value);je.forEach(function(J,ve){J.value=ne[ve],J.dispatchEvent(new Event("input"))})}}},h.close=function(R){return c.classList.contains("jcolor-focus")&&(c.classList.remove("jcolor-focus"),B.style.display="",!R&&typeof h.options.onclose=="function"&&h.options.onclose(L,h),m(h,!1)),h.options.value},h.setValue=function(R){R||(R=""),R!=h.options.value&&(h.options.value=R,ue=R,h.select(R),typeof h.options.onchange=="function"&&h.options.onchange(L,R,h),L.value!=h.options.value&&(L.value=h.options.value,L.tagName==="INPUT"&&(L.style.color=L.value,L.style.backgroundColor=L.value),typeof L.oninput=="function"&&L.oninput({type:"input",target:L,value:L.value})),h.options.closeOnChange==!0&&h.close())},h.getValue=function(){return h.options.value};var X=!1,ie=function(R){var Z=R.toString(16);return Z.length===1?"0"+Z:Z},me=function(R,Z,de){return"#"+ie(R)+ie(Z)+ie(de)},se=function(R){return parseInt("0x"+R)},ce=function(R){return[se(R.substr(1,2)),se(R.substr(3,2)),se(R.substr(5,2))]},Me=function(){var R=document.createElement("div");R.className="jcolor-grid",h.values=[];var Z=document.createElement("table");Z.setAttribute("cellpadding","7"),Z.setAttribute("cellspacing","0");for(var de=0;de<h.options.palette.length;de++){for(var ne=document.createElement("tr"),J=0;J<h.options.palette[de].length;J++){var ve=document.createElement("td"),xe=h.options.palette[de][J];xe.length<7&&xe.substr(0,1)!=="#"&&(xe="#"+xe),ve.style.backgroundColor=xe,ve.setAttribute("data-value",xe),ve.innerHTML="",ne.appendChild(ve),h.options.value==xe&&ve.classList.add("jcolor-selected"),h.values[xe]=ve}Z.appendChild(ne)}return R.appendChild(Z),R},Se=document.createElement("canvas");Se.width=200,Se.height=160;var Te=Se.getContext("2d"),Xe=function(){var R=H.firstChild.getBoundingClientRect();Se.width=R.width-14,tt()},tt=function(){var R=Te.createLinearGradient(0,0,Se.width,0);R.addColorStop(0,"rgb(255,0,0)"),R.addColorStop(.15,"rgb(255,0,255)"),R.addColorStop(.33,"rgb(0,0,255)"),R.addColorStop(.49,"rgb(0,255,255)"),R.addColorStop(.67,"rgb(0,255,0)"),R.addColorStop(.84,"rgb(255,255,0)"),R.addColorStop(1,"rgb(255,0,0)"),Te.fillStyle=R,Te.fillRect(0,0,Se.width,Se.height),R=Te.createLinearGradient(0,0,0,Se.height),R.addColorStop(0,"rgba(255,255,255,1)"),R.addColorStop(.5,"rgba(255,255,255,0)"),R.addColorStop(.5,"rgba(0,0,0,0)"),R.addColorStop(1,"rgba(0,0,0,1)"),Te.fillStyle=R,Te.fillRect(0,0,Se.width,Se.height)},he=function(){var R=document.createElement("div");R.className="jcolor-hsl";var Z=document.createElement("div");Z.className="jcolor-point";var de=document.createElement("div");de.appendChild(Se),de.appendChild(Z),R.appendChild(de);var ne=function(J,ve,xe){if(J===1){var Ce=R.getBoundingClientRect(),Ae=ve-Ce.left,_e=xe-Ce.top;Ae<0&&(Ae=0),_e<0&&(_e=0),Ae>Ce.width&&(Ae=Ce.width),_e>Ce.height&&(_e=Ce.height),Z.style.left=Ae+"px",Z.style.top=_e+"px";var We=Te.getImageData(Ae,_e,1,1).data;ue=me(We[0],We[1],We[2])}};return R.addEventListener("mousedown",function(J){ne(J.buttons,J.clientX,J.clientY)}),R.addEventListener("mousemove",function(J){ne(J.buttons,J.clientX,J.clientY)}),R.addEventListener("touchmove",function(J){ne(1,J.changedTouches[0].clientX,J.changedTouches[0].clientY)}),R},ue="",je=[],Y=function(){if(ue!=="")for(var R=0;R<je.length;R++){var Z=ce(ue);Z[R]=0;var de="linear-gradient(90deg, rgb(";de+=Z.join(", "),de+="), rgb(",Z[R]=255,de+=Z.join(", "),de+="))",je[R].style.backgroundImage=de}},q=function(){var R=document.createElement("div");R.className="jcolor-sliders";var Z=document.createElement("div"),de=function(xe){var Ce=document.createElement("div");Ce.className="jcolor-sliders-input-container";var Ae=document.createElement("label");Ae.innerText=xe;var _e=document.createElement("div");_e.className="jcolor-sliders-input-subcontainer";var We=document.createElement("input");We.type="range",We.min=0,We.max=255,We.value=0,We.setAttribute("aria-label","Color value"),We.setAttribute("aria-valuemin","0"),We.setAttribute("aria-valuemax","255"),We.setAttribute("aria-valuenow","0"),Ce.appendChild(Ae),_e.appendChild(We);var nt=document.createElement("div");return nt.innerText=We.value,We.addEventListener("input",function(){nt.innerText=We.value}),_e.appendChild(nt),Ce.appendChild(_e),Z.appendChild(Ce),We};je=[de("Red"),de("Green"),de("Blue")],R.appendChild(Z);var ne=document.createElement("div");ne.className="jcolor-sliders-final-color";var J=document.createElement("div");J.style.visibility="hidden",J.innerText="a",ne.appendChild(J);var ve=function(){var xe=me(parseInt(je[0].value),parseInt(je[1].value),parseInt(je[2].value));J.innerText=xe,J.style.color=xe,J.style.removeProperty("visibility"),ue=xe};return je.forEach(function(xe){xe.addEventListener("input",function(){ve(),Y()})}),R.appendChild(ne),R},k=function(){h.setOptions(I),L.tagName=="INPUT"&&(L.classList.add("jcolor-input"),L.readOnly=!0),c=document.createElement("div"),c.className="jcolor",B=document.createElement("div"),B.className="jcolor-backdrop",c.appendChild(B),K=document.createElement("div"),K.className="jcolor-content";var R=document.createElement("div");R.className="jcolor-controls",K.appendChild(R),ee=document.createElement("div"),ee.className="jcolor-reset",ee.innerHTML=h.options.resetLabel,R.appendChild(ee),P=document.createElement("div"),P.className="jcolor-close",P.innerHTML=h.options.doneLabel,R.appendChild(P),H=document.createElement("div"),K.appendChild(H),z=fe(H,{animation:!0,data:[{title:"Grid",contentElement:Me()},{title:"Spectrum",contentElement:he()},{title:"Sliders",contentElement:q()}],onchange:function(Z,de,ne){if(ne===1)Xe();else{var J=ue!==""?ue:h.getValue();if(ne===2&&J){var ve=ce(J);je.forEach(function(xe,Ce){xe.value=ve[Ce],xe.dispatchEvent(new Event("input"))})}}},palette:"modern"}),c.appendChild(K),L.tagName=="INPUT"?L.parentNode.insertBefore(c,L.nextSibling):L.appendChild(c),c.addEventListener("click",function(Z){if(Z.target.tagName=="TD"){var de=Z.target.getAttribute("data-value");de&&h.setValue(de)}else Z.target.classList.contains("jcolor-reset")?(h.setValue(""),h.close()):Z.target.classList.contains("jcolor-close")?(z.getActive()>0&&h.setValue(ue),h.close()):Z.target.classList.contains("jcolor-backdrop")?h.close():h.open()}),L.addEventListener("mouseup",function(Z){h.open()}),window.addEventListener("resize",function(){c.classList.contains("jcolor-focus")&&z.getActive()==1&&Xe()}),h.options.opened==!0&&h.open(),L.change=h.setValue,L.val=function(Z){if(Z===void 0)return h.getValue();h.setValue(Z)},L.color=h,c.color=h};return h.toHex=function(R){var Z=function(de){return("0"+parseInt(de).toString(16)).slice(-2)};if(R)return/^#[0-9A-F]{6}$/i.test(R)?R:(R=R.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),R&&R.length?"#"+Z(R[1])+Z(R[2])+Z(R[3]):"")},k(),h}function ye(){var L=function(I,h){var c={type:"contextmenu"};c.options={};var B={items:null,onclick:null};for(var K in B)h&&h.hasOwnProperty(K)?c.options[K]=h[K]:c.options[K]=B[K];I.classList.add("jcontextmenu"),c.open=function(H,z){if(z&&(c.options.items=z,c.create(z)),L.current&&L.current.close(),m(c,!0),I.classList.add("jcontextmenu-focus"),L.current=c,c.options.items&&c.options.items.length>0||I.children.length){if(H.target)if(H.changedTouches&&H.changedTouches[0])X=H.changedTouches[0].clientX,ie=H.changedTouches[0].clientY;else var X=H.clientX,ie=H.clientY;else var X=H.x,ie=H.y;var me=I.getBoundingClientRect();if(window.innerHeight<ie+me.height){var se=ie-me.height;se<0&&(se=0),I.style.top=se+"px"}else I.style.top=ie+"px";window.innerWidth<X+me.width?X-me.width>0?I.style.left=X-me.width+"px":I.style.left="10px":I.style.left=X+"px"}},c.isOpened=function(){return!!I.classList.contains("jcontextmenu-focus")},c.close=function(){I.classList.contains("jcontextmenu-focus")&&I.classList.remove("jcontextmenu-focus"),m(c,!1)},c.create=function(H){I.innerHTML="";var z=ee();I.appendChild(z);for(var X=0;X<H.length;X++){var ie=P(H[X]);I.appendChild(ie)}};function ee(){var H=document.createElement("div");H.classList.add("header"),H.addEventListener("click",function(ie){ie.preventDefault(),ie.stopPropagation()});var z=document.createElement("a");z.classList.add("title"),z.innerHTML=u.translate("Menu"),H.appendChild(z);var X=document.createElement("a");return X.classList.add("close"),X.innerHTML=u.translate("close"),X.addEventListener("click",function(ie){c.close()}),H.appendChild(X),H}function P(H){if(H.type&&(H.type=="line"||H.type=="divisor"))var z=document.createElement("hr");else{var z=document.createElement("div"),X=document.createElement("a");if(X.innerHTML=H.title,H.tooltip&&z.setAttribute("title",H.tooltip),H.icon&&z.setAttribute("data-icon",H.icon),H.id&&(z.id=H.id),H.disabled?z.className="jcontextmenu-disabled":H.onclick&&(z.method=H.onclick,z.addEventListener("mousedown",function(Xe){Xe.preventDefault()}),z.addEventListener("mouseup",function(Xe){this.method(this,Xe)})),z.appendChild(X),H.submenu){var ie=document.createElement("span");ie.innerHTML="&#9658;",z.appendChild(ie),z.classList.add("jcontexthassubmenu");var me=document.createElement("div");me.classList.add("jcontextmenu"),me.setAttribute("tabindex","900");for(var se=H.submenu,ce=0;ce<se.length;ce++){var Me=P(se[ce]);me.appendChild(Me)}z.appendChild(me)}else if(H.shortcut){var Se=document.createElement("span");Se.innerHTML=H.shortcut,z.appendChild(Se)}}return z}return typeof c.options.onclick=="function"&&I.addEventListener("click",function(H){c.options.onclick(c,H)}),c.options.items&&c.create(c.options.items),window.addEventListener("mousewheel",function(){c.close()}),I.contextmenu=c,c};return L}var Ne=ye();function be(){var L=function(I,h){if(I.dropdown)return I.dropdown.setOptions(h,!0);var c={type:"dropdown"};c.options={};var B=function(Y,q){Y&&Y.length&&(c.options.sortResults!==!1&&(typeof c.options.sortResults=="function"?Y.sort(c.options.sortResults):Y.sort(K)),c.setData(Y)),typeof c.options.onload=="function"&&c.options.onload(I,c,Y,q),q&&P(q),q==null&&(c.options.value=""),I.value=c.options.value,c.options.opened==!0&&c.open()},K=function(Y,q){var k,R;return typeof Y=="string"?k=Y:Y.text?k=Y.text:Y.name&&(k=Y.name),typeof q=="string"?R=q:q.text?R=q.text:q.name&&(R=q.name),typeof k=="string"||typeof R=="string"?(typeof k!="string"&&(k=""+k),typeof R!="string"&&(R=""+R),k.localeCompare(R)):k-R},ee=function(){c.value={};for(var Y=0;Y<c.items.length;Y++)c.items[Y].selected==!0&&(c.items[Y].element&&c.items[Y].element.classList.remove("jdropdown-selected"),c.items[Y].selected=null);c.options.value="",I.value=""},P=function(Y){if(ee(),Y!==null)if(!Y)typeof c.value[""]<"u"&&(c.value[""]="");else{Array.isArray(Y)||(Y=(""+Y).split(";"));for(var q=0;q<Y.length;q++)c.value[Y[q]]=""}for(var q=0;q<c.items.length;q++)typeof c.value[H(q)]<"u"&&(c.items[q].element&&c.items[q].element.classList.add("jdropdown-selected"),c.items[q].selected=!0,c.value[H(q)]=z(q));c.options.value=Object.keys(c.value).join(";"),c.header.value=c.getText()},H=function(Y,q){if(c.options.format)var k="id";else var k="value";return c.items[Y]?q!==void 0?c.items[Y].data[k]=q:c.items[Y].data[k]:""},z=function(Y,q){if(c.options.format)var k="name";else var k="text";return c.items[Y]?q!==void 0?c.items[Y].data[k]=q:c.items[Y].data[k]:""},X=function(){return Object.keys(c.value)},ie=function(){for(var Y=[],q=Object.keys(c.value),k=0;k<q.length;k++)Y.push(c.value[q[k]]);return Y};c.setOptions=function(Y,q){Y||(Y={});var k={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null,allowEmpty:!0};for(var R in k)Y&&Y.hasOwnProperty(R)?c.options[R]=Y[R]:(typeof c.options[R]>"u"||q===!0)&&(c.options[R]=k[R]);return(c.options.remoteSearch==!0||c.options.type==="searchbar")&&(c.options.autocomplete=!0),c.options.newOptions==!0?c.header.classList.add("jdropdown-add"):c.header.classList.remove("jdropdown-add"),c.options.autocomplete==!0?c.header.removeAttribute("readonly"):c.header.setAttribute("readonly","readonly"),c.options.placeholder?c.header.setAttribute("placeholder",c.options.placeholder):c.header.removeAttribute("placeholder"),I.classList.remove("jdropdown-searchbar"),I.classList.remove("jdropdown-picker"),I.classList.remove("jdropdown-list"),c.options.type=="searchbar"?I.classList.add("jdropdown-searchbar"):c.options.type=="list"?I.classList.add("jdropdown-list"):c.options.type=="picker"?I.classList.add("jdropdown-picker"):M.getWindowWidth()<800?c.options.autocomplete?(I.classList.add("jdropdown-searchbar"),c.options.type="searchbar"):(I.classList.add("jdropdown-picker"),c.options.type="picker"):(c.options.width?(I.style.width=c.options.width,I.style.minWidth=c.options.width):(I.style.removeProperty("width"),I.style.removeProperty("min-width")),I.classList.add("jdropdown-default"),c.options.type="default"),c.options.type=="searchbar"?me.appendChild(Me):se.insertBefore(Me,se.firstChild),c.options.url&&!Y.data?v({url:c.options.url,method:"GET",dataType:"json",success:function(Z){Z&&B(Z,c.options.value)}}):B(c.options.data,c.options.value),c};var me=null,se=null,ce=null,Me=null,Se=null,Te=null,Xe=null,tt=function(){if(h||(h={}),I.tagName=="SELECT"){var Y=L.extractFromDom(I,h);I=Y.el,h=Y.options}!h.placeholder&&I.getAttribute("placeholder")&&(h.placeholder=I.getAttribute("placeholder")),c.value={},c.items=[],c.groups=[],c.search="",c.results=null,I.classList.add("jdropdown"),me=document.createElement("div"),me.className="jdropdown-container-header",c.header=document.createElement("input"),c.header.className="jdropdown-header jss_object",c.header.type="text",c.header.setAttribute("autocomplete","off"),c.header.onfocus=function(){typeof c.options.onfocus=="function"&&c.options.onfocus(I)},c.header.onblur=function(){typeof c.options.onblur=="function"&&c.options.onblur(I)},c.header.onkeyup=function(q){c.options.autocomplete==!0&&!Xe?(c.search!=c.header.value.trim()&&(Xe=setTimeout(function(){c.find(c.header.value.trim()),Xe=null},400)),I.classList.contains("jdropdown-focus")||c.open()):c.options.autocomplete||c.next(q.key)},L.hasEvents||(L.hasEvents=!0,document.addEventListener("keydown",L.keydown)),se=document.createElement("div"),se.className="jdropdown-container",ce=document.createElement("div"),ce.className="jdropdown-content",Me=document.createElement("div"),Me.className="jdropdown-close",Me.textContent="Done",Se=document.createElement("div"),Se.className="jdropdown-reset",Se.textContent="x",Se.onclick=function(){c.reset(),c.close()},Te=document.createElement("div"),Te.className="jdropdown-backdrop",me.appendChild(c.header),se.appendChild(ce),I.appendChild(me),I.appendChild(se),I.appendChild(Te),c.setOptions(h),"ontouchsend"in document.documentElement?I.addEventListener("touchsend",L.mouseup):I.addEventListener("mouseup",L.mouseup),c.options.lazyLoading==!0&&b(ce,{loadUp:c.loadUp,loadDown:c.loadDown}),ce.onwheel=function(q){q.stopPropagation()},I.change=c.setValue,I.val=function(q){if(q===void 0)return c.getValue(!!c.options.multiple);c.setValue(q)},I.dropdown=c};c.getUrl=function(){return c.options.url},c.setUrl=function(Y,q){c.options.url=Y,v({url:c.options.url,method:"GET",dataType:"json",success:function(k){c.setData(k),typeof q=="function"&&q(c)}})},c.setId=function(Y,q){if(c.options.format)var k="id";else var k="value";typeof Y=="object"?Y[k]=q:c.items[Y].data[k]=q};let he=function(Y,q){if(!Y){let Z=c.options.autocomplete==!0?c.header.value:"";if(Y=prompt(u.translate("Add A New Option"),Z),!Y)return!1}if(q||(q=M.guid()),c.options.format)var k={id:q,name:Y};else var k={value:q,text:Y};if(typeof c.options.onbeforeinsert=="function"){let Z=c.options.onbeforeinsert(c,k);if(Z===!1)return!1;Z&&(k=Z)}c.options.data.push(k);var R=c.createItem(k);return ce.appendChild(R.element),typeof c.options.oninsert=="function"&&c.options.oninsert(c,k,R),ce.style.display=="none"&&(ce.style.display=""),c.results&&c.results.push(R),k};c.add=function(Y,q){return typeof c.options.prompt=="function"?c.options.prompt.call(c,he):he(Y,q)},c.createItem=function(Y,q,k){c.options.format?(!Y.id&&Y.value!==void 0&&(Y.id=Y.value),!Y.name&&Y.text!==void 0&&(Y.name=Y.text)):(!Y.value&&Y.id!==void 0&&(Y.value=Y.id),!Y.text&&Y.name!==void 0&&(Y.text=Y.name));var R={};if(R.element=document.createElement("div"),R.element.className="jdropdown-item",R.element.indexValue=c.items.length,R.data=Y,q&&(R.group=q),Y.id&&R.element.setAttribute("id",Y.id),Y.disabled==!0&&R.element.setAttribute("data-disabled",!0),Y.tooltip&&R.element.setAttribute("title",Y.tooltip),Y.image){var Z=document.createElement("img");Z.className="jdropdown-image",Z.src=Y.image,Y.title||Z.classList.add("jdropdown-image-small"),R.element.appendChild(Z)}else if(Y.icon){var de=document.createElement("span");de.className="jdropdown-icon material-icons",de.innerText=Y.icon,Y.title||de.classList.add("jdropdown-icon-small"),Y.color&&(de.style.color=Y.color),R.element.appendChild(de)}else if(Y.color){var ne=document.createElement("div");ne.className="jdropdown-color",ne.style.backgroundColor=Y.color,R.element.appendChild(ne)}if(c.options.format)var J=Y.name;else var J=Y.text;var ve=document.createElement("div");if(ve.className="jdropdown-description",ve.textContent=J||"&nbsp;",Y.title){var xe=document.createElement("div");xe.className="jdropdown-title",xe.innerText=Y.title,ve.appendChild(xe)}if(c.options.format)var Ce=Y.id;else var Ce=Y.value;return c.value[Ce]&&(R.element.classList.add("jdropdown-selected"),R.selected=!0),c.items.push(R),R.element.appendChild(ve),R},c.appendData=function(Y){if(Y.length){for(var q=[],k=[],R=0;R<Y.length;R++)Y[R].group?(k[Y[R].group]||(k[Y[R].group]=[]),k[Y[R].group].push(R)):q.push(R);var Z=0,de=Object.keys(k);if(de.length>0)for(var R=0;R<de.length;R++){var ne=document.createElement("div");ne.className="jdropdown-group";var J=document.createElement("div");J.className="jdropdown-group-name",J.textContent=de[R];var ve=document.createElement("i");ve.className="jdropdown-group-arrow jdropdown-group-arrow-down",J.appendChild(ve);var xe=document.createElement("div");xe.className="jdropdown-group-items";for(var Ce=0;Ce<k[de[R]].length;Ce++){var Ae=c.createItem(Y[k[de[R]][Ce]],ne,de[R]);(c.options.lazyLoading==!1||Z<200)&&(xe.appendChild(Ae.element),Z++)}ne.appendChild(J),ne.appendChild(xe),c.groups.push(ne),xe.children.length>0&&ce.appendChild(ne)}if(q.length)for(var R=0;R<q.length;R++){var Ae=c.createItem(Y[q[R]]);(c.options.lazyLoading==!1||Z<200)&&(ce.appendChild(Ae.element),Z++)}}},c.setData=function(Y){if(ee(),ce.textContent="",c.header.value="",c.items=[],Y&&Y.length){for(var q=0;q<Y.length;q++)typeof Y[q]!="object"&&(c.options.format?Y[q]={id:Y[q],name:Y[q]}:Y[q]={value:Y[q],text:Y[q]});c.appendData(Y),c.options.data=Y}else c.options.data=[];c.close()},c.getData=function(){return c.options.data},c.getPosition=function(Y){for(var q=0;q<c.items.length;q++)if(H(q)==Y)return q;return!1},c.getText=function(Y){var q=ie();return Y?q:q.join("; ")},c.getValue=function(Y){var q=X();return Y?q:q.join(";")};var ue=function(Y){I.value!=c.options.value&&(I.value=c.options.value,typeof I.oninput=="function"&&I.oninput({type:"input",target:I,value:I.value})),typeof c.options.onchange=="function"&&c.options.onchange(I,c,Y,c.options.value)};c.setValue=function(Y){var q=c.getValue();Array.isArray(Y)&&(Y=Y.join(";")),q!==Y&&(P(Y),ue(q))},c.resetSelected=function(){c.setValue(null)},c.selectIndex=function(k,q){var k=parseInt(k);if(c.items&&c.items[k]&&(q===!0||c.items[k].data.disabled!==!0))if(c.setCursor(k,!1),!c.options.multiple)c.items[k].selected?c.options.allowEmpty!==!1&&c.setValue(null):c.setValue(H(k)),c.close();else{var R=c.options.value;c.items[k].selected?(c.items[k].element.classList.remove("jdropdown-selected"),c.items[k].selected=!1,delete c.value[H(k)]):(c.items[k].element.classList.add("jdropdown-selected"),c.items[k].selected=!0,c.value[H(k)]=z(k)),c.options.value=Object.keys(c.value).join(";"),c.options.autocomplete==!1&&(c.header.value=ie().join("; ")),ue(R)}},c.selectItem=function(Y){c.selectIndex(Y.indexValue)};var je=function(Y,q){for(var k=0;k<q.length;k++)if(c.options.format){if(q[k].id==Y)return!0}else if(q[k].value==Y)return!0;return!1};return c.find=function(Y){if(c.search==Y.trim())return!1;if(c.search=Y,c.setCursor(),c.groups.length)for(var q=0;q<c.groups.length;q++)c.groups[q].lastChild.textContent="";if(ce.textContent="",c.options.remoteSearch==!0){c.results=null;var k=c.options.url;let xe={url:k,method:"GET",data:{q:Y},dataType:"json",success:function(Ce){c.items=[];var Ae=Object.keys(c.value);if(Ae.length)for(var _e=0;_e<Ae.length;_e++)je(Ae[_e],Ce)||(c.options.format?Ce.unshift({id:Ae[_e],name:c.value[Ae[_e]]}):Ce.unshift({value:Ae[_e],text:c.value[Ae[_e]]}));c.appendData(Ce),Ce.length?ce.style.display="":ce.style.display="none",typeof c.options.onsearch=="function"&&c.options.onsearch(c,Ce)}};if(typeof c.options.onbeforesearch=="function"){let Ce=c.options.onbeforesearch(c,xe);if(Ce===!1)return;typeof Ce=="object"&&(xe=Ce)}v(xe)}else{Y=new RegExp(Y,"gi");for(var R=[],q=0;q<c.items.length;q++){var Z=z(q),de=c.items[q].data.title||"",ne=c.items[q].data.group||"",J=c.items[q].data.synonym||"";J&&(J=J.join(" ")),(Y==null||c.items[q].selected==!0||Z.toString().match(Y)||de.match(Y)||ne.match(Y)||J.match(Y))&&R.push(c.items[q])}if(!R.length)ce.style.display="none",c.results=null;else{ce.style.display="",c.results=R;var ve=R.length||0;c.options.lazyLoading==!0&&ve>200&&(ve=200);for(var q=0;q<ve;q++)c.results[q].group?(c.results[q].group.parentNode||ce.appendChild(c.results[q].group),c.results[q].group.lastChild.appendChild(c.results[q].element)):ce.appendChild(c.results[q].element)}}c.options.autofocus==!0&&c.first()},c.open=function(){if(!I.classList.contains("jdropdown-focus")){L.current=c,m(c,!0),I.classList.add("jdropdown-focus"),M.getWindowWidth()<800&&(c.options.type==null||c.options.type=="picker")&&A.slideBottom(se,1),c.options.autocomplete==!0&&(c.header.value=c.search,c.header.focus());var Y=X();if(Y[0]){var q=c.getPosition(Y[0]);q!==!1&&c.setCursor(q)}if(!c.options.type||c.options.type=="default"){var k=I.getBoundingClientRect(),R=se.getBoundingClientRect();c.options.position?(se.style.position="fixed",window.innerHeight<k.bottom+R.height?(se.style.top="",se.style.bottom=window.innerHeight-k.top+1+"px"):(se.style.top=k.bottom+"px",se.style.bottom=""),se.style.left=k.left+"px"):window.innerHeight<k.bottom+R.height?(se.style.top="",se.style.bottom=k.height+1+"px"):(se.style.top="",se.style.bottom=""),se.style.minWidth=k.width+"px",c.options.maxWidth&&(se.style.maxWidth=c.options.maxWidth),!c.items.length&&c.options.autocomplete==!0?ce.style.display="none":ce.style.display=""}}typeof c.options.onopen=="function"&&c.options.onopen(I)},c.close=function(Y){return I.classList.contains("jdropdown-focus")&&(c.header.value=c.getText(),c.setCursor(),!Y&&typeof c.options.onclose=="function"&&c.options.onclose(I),c.header.blur&&c.header.blur(),I.classList.remove("jdropdown-focus"),m(c,!1),L.current=null),c.getValue()},c.setCursor=function(Y,q){if(c.currentIndex!=null&&c.items&&c.items[c.currentIndex]&&c.items[c.currentIndex].element.classList.remove("jdropdown-cursor"),Y==null)c.currentIndex=null;else if(Y=parseInt(Y),c.items[Y].element.parentNode&&(c.items[Y].element.classList.add("jdropdown-cursor"),c.currentIndex=Y,q!==!1&&c.items[c.currentIndex].element)){var k=ce.scrollTop,R=c.items[c.currentIndex].element;ce.scrollTop=R.offsetTop-R.scrollTop+R.clientTop-95}},c.resetCursor=c.setCursor,c.updateCursor=c.setCursor,c.reset=function(){c.setCursor(),c.setValue(null)},c.first=function(){c.options.lazyLoading===!0&&c.loadFirst();var Y=ce.querySelectorAll(".jdropdown-item");if(Y.length){var q=Y[0].indexValue;c.setCursor(q)}},c.last=function(){c.options.lazyLoading===!0&&c.loadLast();var Y=ce.querySelectorAll(".jdropdown-item");if(Y.length){var q=Y[Y.length-1].indexValue;c.setCursor(q)}},c.next=function(Y){var q=null;if(Y){if(Y.length==1){var k=c.currentIndex||-1;Y=Y.toLowerCase();var R=null,Z=null,de=ce.querySelectorAll(".jdropdown-item");if(de.length){for(var ne=0;ne<de.length;ne++)if(de[ne].indexValue>k&&(R=c.items[de[ne].indexValue])&&(Z=R.element.innerText[0])&&(Z=Z.toLowerCase(),Y==Z)){q=de[ne].indexValue;break}c.setCursor(q)}}}else if(c.currentIndex==null||c.currentIndex==null)c.first();else{var J=c.items[c.currentIndex].element,ve=J.nextElementSibling;ve?(ve.classList.contains("jdropdown-group")&&(ve=ve.lastChild.firstChild),q=ve.indexValue):J.parentNode.classList.contains("jdropdown-group-items")&&((ve=J.parentNode.parentNode.nextElementSibling)&&(ve.classList.contains("jdropdown-group")?ve=ve.lastChild.firstChild:ve.classList.contains("jdropdown-item")?q=ve.indexValue:ve=null),ve&&(q=ve.indexValue)),q!==null&&c.setCursor(q)}},c.prev=function(){var Y=null;if(c.currentIndex===null)c.first();else{var q=c.items[c.currentIndex].element,k=q.previousElementSibling;k?(k.classList.contains("jdropdown-group")&&(k=k.lastChild.lastChild),Y=k.indexValue):q.parentNode.classList.contains("jdropdown-group-items")&&((k=q.parentNode.parentNode.previousElementSibling)&&(k.classList.contains("jdropdown-group")?k=k.lastChild.lastChild:k.classList.contains("jdropdown-item")?Y=k.indexValue:k=null),k&&(Y=k.indexValue))}Y!==null&&c.setCursor(Y)},c.loadFirst=function(){if(c.results)var Y=c.results;else var Y=c.items;var q=Y.length||0;c.options.lazyLoading==!0&&q>200&&(q=200),ce.textContent="";for(var k=0;k<q;k++)Y[k].group?(Y[k].group.parentNode||ce.appendChild(Y[k].group),Y[k].group.lastChild.appendChild(Y[k].element)):ce.appendChild(Y[k].element);ce.scrollTop=0},c.loadLast=function(){if(c.results)var Y=c.results;else var Y=c.items;var q=Y.length;if(q>200){q=q-200,ce.textContent="";for(var k=q;k<Y.length;k++)Y[k].group?(Y[k].group.parentNode||ce.appendChild(Y[k].group),Y[k].group.lastChild.appendChild(Y[k].element)):ce.appendChild(Y[k].element);ce.scrollTop=ce.scrollHeight}},c.loadUp=function(){var Y=!1;if(c.results)var q=c.results;else var q=c.items;var k=ce.querySelectorAll(".jdropdown-item"),R=k[0].indexValue;R=c.items[R];var Z=q.indexOf(R)-1;if(Z>0){for(var de=0;Z>0&&q[Z]&&de<200;)q[Z].group?(q[Z].group.parentNode||ce.insertBefore(q[Z].group,ce.firstChild),q[Z].group.lastChild.insertBefore(q[Z].element,q[Z].group.lastChild.firstChild)):ce.insertBefore(q[Z].element,ce.firstChild),Z--,de++;Y=!0}return Y},c.loadDown=function(){var Y=!1;if(c.results)var q=c.results;else var q=c.items;var k=ce.querySelectorAll(".jdropdown-item"),R=k[k.length-1].indexValue;R=c.items[R];var Z=q.indexOf(R)+1;if(Z<q.length){for(var de=0;Z<q.length&&q[Z]&&de<200;)q[Z].group?(q[Z].group.parentNode||ce.appendChild(q[Z].group),q[Z].group.lastChild.appendChild(q[Z].element)):ce.appendChild(q[Z].element),Z++,de++;Y=!0}return Y},tt(),c};return L.keydown=function(I){var h=null;if(h=L.current){if(I.which==13||I.which==9)h.header.value&&h.currentIndex==null&&h.options.newOptions?h.add():(h.currentIndex==null&&h.options.autocomplete==!0&&h.header.value!=""&&h.find(h.header.value),h.selectIndex(h.currentIndex));else if(I.which==38)h.currentIndex==null?h.first():h.currentIndex>0&&h.prev(),I.preventDefault();else if(I.which==40)h.currentIndex==null?h.first():h.currentIndex+1<h.items.length&&h.next(),I.preventDefault();else if(I.which==36)h.first(),I.target.classList.contains("jdropdown-header")||I.preventDefault();else if(I.which==35)h.last(),I.target.classList.contains("jdropdown-header")||I.preventDefault();else if(I.which==27)h.close();else if(I.which==33){if(h.currentIndex==null)h.first();else if(h.currentIndex>0)for(var c=0;c<7;c++)h.prev();I.preventDefault()}else if(I.which==34){if(h.currentIndex==null)h.first();else if(h.currentIndex+1<h.items.length)for(var c=0;c<7;c++)h.next();I.preventDefault()}}},L.mouseup=function(I){var h=M.findElement(I.target,"jdropdown");if(h){var c=h.dropdown;if(I.target.classList.contains("jdropdown-header"))if(h.classList.contains("jdropdown-focus")&&h.classList.contains("jdropdown-default")){var B=h.getBoundingClientRect();if(I.changedTouches&&I.changedTouches[0])var K=I.changedTouches[0].clientX,ee=I.changedTouches[0].clientY;else var K=I.clientX,ee=I.clientY;B.width-(K-B.left)<30?I.target.classList.contains("jdropdown-add")?c.add():c.close():c.options.autocomplete==!1&&c.close()}else c.open();else if(I.target.classList.contains("jdropdown-group-name")){var P=I.target.nextSibling.children;if(I.target.nextSibling.style.display!="none")for(var H=0;H<P.length;H++)P[H].style.display!="none"&&c.selectItem(P[H])}else I.target.classList.contains("jdropdown-group-arrow")?I.target.classList.contains("jdropdown-group-arrow-down")?(I.target.classList.remove("jdropdown-group-arrow-down"),I.target.classList.add("jdropdown-group-arrow-up"),I.target.parentNode.nextSibling.style.display="none"):(I.target.classList.remove("jdropdown-group-arrow-up"),I.target.classList.add("jdropdown-group-arrow-down"),I.target.parentNode.nextSibling.style.display=""):I.target.classList.contains("jdropdown-item")?c.selectItem(I.target):I.target.classList.contains("jdropdown-image")||I.target.classList.contains("jdropdown-description")?c.selectItem(I.target.parentNode):I.target.classList.contains("jdropdown-title")?c.selectItem(I.target.parentNode.parentNode):(I.target.classList.contains("jdropdown-close")||I.target.classList.contains("jdropdown-backdrop"))&&c.close()}},L.extractFromDom=function(I,h){var c=I;if(h||(h={}),I.getAttribute("multiple")&&(!h||h.multiple==null)&&(h.multiple=!0),I.getAttribute("placeholder")&&(!h||h.placeholder==null)&&(h.placeholder=I.getAttribute("placeholder")),I.getAttribute("data-autocomplete")&&(!h||h.autocomplete==null)&&(h.autocomplete=!0),(!h||h.width==null)&&(h.width=I.offsetWidth),I.value&&(!h||h.value==null)&&(h.value=I.value),!h||h.data==null){h.data=[];for(var B=0;B<I.children.length;B++)if(I.children[B].tagName=="OPTGROUP")for(var K=0;K<I.children[B].children.length;K++)h.data.push({value:I.children[B].children[K].value,text:I.children[B].children[K].textContent,group:I.children[B].getAttribute("label")});else h.data.push({value:I.children[B].value,text:I.children[B].textContent})}(!h||h.onchange==null)&&(h.onchange=function(P,H,z,X){h.multiple==!0?obj.items[H].classList.contains("jdropdown-selected")?c.options[H].setAttribute("selected","selected"):c.options[H].removeAttribute("selected"):c.value=X});var ee=document.createElement("div");return I.parentNode.insertBefore(ee,I),I.style.display="none",I=ee,{el:I,options:h}},L}var le=be();function Ye(L,I){if(L.picker)return L.picker.setOptions(I,!0);var h={type:"picker"};h.options={};var c=null,B=null,K=function(H){return H instanceof Element||H instanceof HTMLDocument},ee=function(){B.innerHTML="";for(var H=Object.keys(h.options.data),z=0;z<H.length;z++){var X=document.createElement("div");X.classList.add("jpicker-item"),X.setAttribute("role","option"),X.k=H[z],X.v=h.options.data[H[z]];var ie=h.getLabel(H[z],X);K(ie)?X.appendChild(ie):X.innerHTML=ie,B.appendChild(X)}};h.setOptions=function(H,z){var X={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};H&&H.options&&(H.data=H.options);for(var ie in X)H&&H.hasOwnProperty(ie)?h.options[ie]=H[ie]:(typeof h.options[ie]>"u"||z===!0)&&(h.options[ie]=X[ie]);return h.options.header===!1?c.style.display="none":c.style.display="",h.options.width?c.style.width=parseInt(h.options.width)+"px":c.style.width="",h.options.height?(B.style.maxHeight=h.options.height+"px",B.style.overflow="scroll"):B.style.overflow="",h.options.columns>0&&(h.options.grid?(B.classList.add("jpicker-grid"),B.style.gridTemplateColumns="repeat("+h.options.grid+", 1fr)"):(B.classList.add("jpicker-columns"),B.style.width=h.options.width?h.options.width:36*h.options.columns+"px")),isNaN(parseInt(h.options.value))&&(h.options.value=0),ee(),h.setValue(h.options.value),h},h.getValue=function(){return h.options.value},h.setValue=function(H,z){if(h.setLabel(H),h.options.value=String(H),L.value!=h.options.value&&(L.value=h.options.value,typeof L.oninput=="function"&&L.oninput({type:"input",target:L,value:L.value})),B.children[H]&&B.children[H].getAttribute("type")!=="generic"&&h.close(),z&&typeof h.options.onchange=="function"){var X=h.options.data[H];h.options.onchange(L,h,X,X,H,z)}},h.getLabel=function(H,z){var X=h.options.data[H]||null;return typeof h.options.render=="function"&&(X=h.options.render(X,z)),X},h.setLabel=function(H){var z;h.options.content?z='<i class="material-icons">'+h.options.content+"</i>":z=h.getLabel(H,null),K(z)?(c.innerHTML="",c.appendChild(z)):c.innerHTML=z},h.open=function(){if(!L.classList.contains("jpicker-focus")){m(h,!0),L.classList.add("jpicker-focus"),L.focus();var H=0,z=0;B.style.marginLeft="";var X=c.getBoundingClientRect(),ie=B.getBoundingClientRect();window.innerHeight<X.bottom+ie.height||h.options.bottom?H=-1*(ie.height+4):H=X.height+4,h.options.right===!0&&(z=-1*ie.width+X.width),ie.left+z<0&&(z=z+ie.left+10),ie.left+ie.width>window.innerWidth&&(z=-1*(10+ie.left+ie.width-window.innerWidth)),B.style.marginTop=parseInt(H)+"px",B.style.marginLeft=parseInt(z)+"px",typeof h.options.onopen=="function"&&h.options.onopen(L,h)}},h.close=function(){L.classList.contains("jpicker-focus")&&(L.classList.remove("jpicker-focus"),m(h,!1),typeof h.options.onclose=="function"&&h.options.onclose(L,h))};var P=function(){let H=M.guid();L.classList.add("jpicker"),L.setAttribute("role","combobox"),L.setAttribute("aria-haspopup","listbox"),L.setAttribute("aria-expanded","false"),L.setAttribute("aria-controls",H),L.setAttribute("tabindex","0"),L.onmousedown=function(z){L.classList.contains("jpicker-focus")||h.open()},c=document.createElement("div"),c.classList.add("jpicker-header"),B=document.createElement("div"),B.setAttribute("id",H),B.setAttribute("role","listbox"),B.classList.add("jpicker-content"),B.onclick=function(z){var X=M.findElement(z.target,"jpicker-item");X&&X.parentNode===B&&h.setValue(X.k,z)},L.appendChild(c),L.appendChild(B),L.value=I.value||0,h.setOptions(I),typeof h.options.onload=="function"&&h.options.onload(L,h),L.change=h.setValue,L.val=function(z){if(z===void 0)return h.getValue();h.setValue(z)},L.picker=h};return P(),h}function $e(L,I){var h={type:"toolbar"};h.options={};var c={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var B in c)I&&I.hasOwnProperty(B)?h.options[B]=I[B]:h.options[B]=c[B];!L&&I.app&&I.app.el&&(L=document.createElement("div"),I.app.el.appendChild(L));var K=document.createElement("div");K.classList.add("jtoolbar-item"),K.classList.add("jtoolbar-arrow");var ee=document.createElement("div");ee.classList.add("jtoolbar-floating"),K.appendChild(ee),h.selectItem=function(H){for(var z=P.children,X=0;X<z.length;X++)H!=z[X]&&z[X].classList.remove("jtoolbar-selected");H.classList.add("jtoolbar-selected")},h.hide=function(){A.slideBottom(L,0,function(){L.style.display="none"})},h.show=function(){L.style.display="",A.slideBottom(L,1)},h.get=function(){return L},h.setBadge=function(H,z){P.children[H].children[1].firstChild.innerHTML=z},h.destroy=function(){toolbar.remove(),L.innerHTML=""},h.update=function(H,z){for(var X=0;X<P.children.length;X++){var ie=P.children[X];typeof ie.updateState=="function"&&ie.updateState(L,h,ie,H,z)}for(var X=0;X<ee.children.length;X++){var ie=ee.children[X];typeof ie.updateState=="function"&&ie.updateState(L,h,ie,H,z)}},h.create=function(H){P.innerHTML="";for(var z=0;z<H.length;z++){var X=document.createElement("div");if(X.classList.add("jtoolbar-item"),H[z].width&&(X.style.width=parseInt(H[z].width)+"px"),H[z].k&&(X.k=H[z].k),H[z].tooltip&&(X.setAttribute("title",H[z].tooltip),X.setAttribute("aria-label",H[z].tooltip)),H[z].id&&X.setAttribute("id",H[z].id),H[z].updateState&&(X.updateState=H[z].updateState),H[z].active&&X.classList.add("jtoolbar-active"),H[z].disabled&&X.classList.add("jtoolbar-disabled"),H[z].type=="select"||H[z].type=="dropdown")Ye(X,H[z]);else if(H[z].type=="divisor")X.classList.add("jtoolbar-divisor");else if(H[z].type=="label")X.classList.add("jtoolbar-label"),X.innerHTML=H[z].content;else{var ie=document.createElement("i");if(typeof H[z].class>"u")ie.classList.add("material-icons");else for(var me=H[z].class.split(" "),se=0;se<me.length;se++)ie.classList.add(me[se]);if(ie.innerHTML=H[z].content?H[z].content:"",X.setAttribute("role","button"),X.appendChild(ie),h.options.badge==!0){var ce=document.createElement("div");ce.classList.add("jbadge");var Me=document.createElement("div");Me.innerHTML=H[z].badge?H[z].badge:"",ce.appendChild(Me),X.appendChild(ce)}if(H[z].title)if(h.options.title==!0){var Se=document.createElement("span");Se.innerHTML=H[z].title,X.appendChild(Se)}else X.setAttribute("title",H[z].title);h.options.app&&H[z].route&&(X.route=H[z].route,X.onclick=function(){h.options.app.pages(this.route)},h.options.app.pages(H[z].route,{toolbarItem:X,closed:!0})),typeof H[z].render=="function"&&H[z].render(X,H[z])}H[z].onclick&&(X.onclick=H[z].onclick.bind(H[z],L,h,X)),P.appendChild(X)}setTimeout(function(){h.refresh()},0)},h.open=function(){K.classList.add("jtoolbar-arrow-selected");var H=L.getBoundingClientRect(),z=ee.getBoundingClientRect();z.bottom>window.innerHeight||h.options.bottom?ee.style.bottom="0":ee.style.removeProperty("bottom"),ee.style.right="0",K.children[0].focus(),m(h,!0)},h.close=function(){K.classList.remove("jtoolbar-arrow-selected"),m(h,!1)},h.refresh=function(){if(h.options.responsive==!0){var H=L.parentNode.getBoundingClientRect();h.options.maxWidth||(h.options.maxWidth=H.width);var z=parseInt(h.options.maxWidth);for(K.parentNode&&K.parentNode.removeChild(K);ee.firstChild;)P.appendChild(ee.firstChild);if(z<P.offsetWidth)for(z-=50;P.lastChild&&z<P.offsetWidth;)ee.insertBefore(P.lastChild,ee.firstChild);ee.children.length>0&&P.appendChild(K)}},h.setReadonly=function(H){H=H?"add":"remove",L.classList[H]("jtoolbar-disabled")},L.onclick=function(H){var z=M.findElement(H.target,"jtoolbar-item");z&&h.selectItem(z),H.target.classList.contains("jtoolbar-arrow")&&h.open()},window.addEventListener("resize",function(){h.refresh()}),L.classList.add("jtoolbar"),L.innerHTML="",h.options.container==!0&&L.classList.add("jtoolbar-container");var P=document.createElement("div");return L.appendChild(P),h.options.app&&L.classList.add("jtoolbar-mobile"),h.create(h.options.items),L.toolbar=h,h}function Ge(){var L=function(I,h){var c={type:"editor"};c.options={};var B={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var K in B)h&&h.hasOwnProperty(K)?c.options[K]=h[K]:c.options[K]=B[K];var ee=null,P=null,H=[];c.el=I,typeof c.options.onclick=="function"&&(I.onclick=function(te){c.options.onclick(I,c,te)}),I.classList.add("jeditor-container");var z=document.createElement("div");z.className="jsnippet",z.setAttribute("contenteditable",!1);var X=document.createElement("div");if(X.className="jeditor-toolbar",c.editor=document.createElement("div"),c.editor.setAttribute("contenteditable",!0),c.editor.setAttribute("spellcheck",!1),c.editor.classList.add("jeditor"),c.options.placeholder&&c.editor.setAttribute("data-placeholder",c.options.placeholder),(c.options.maxHeight||c.options.height)&&(c.editor.style.overflowY="auto",c.options.maxHeight&&(c.editor.style.maxHeight=c.options.maxHeight),c.options.height&&(c.editor.style.height=c.options.height)),c.options.url)v({url:c.options.url,dataType:"html",success:function(te){c.editor.innerHTML=te,L.setCursor(c.editor,c.options.focus=="initial")}});else if(c.options.value)c.editor.innerHTML=c.options.value;else for(var ie=0;ie<I.children.length;ie++)c.editor.appendChild(I.children[ie]);I.innerHTML="";var me=function(te){typeof c.options.onchange=="function"&&c.options.onchange(I,c,te),c.options.value=c.getData(),I.value!=c.options.value&&(I.value=c.options.value,typeof I.oninput=="function"&&I.oninput({type:"input",target:I,value:I.value}))},se=function(te){var ge=document.createElement("div");ge.innerHTML=te;var Ee=ge.querySelectorAll("img");if(Ee.length)for(var Re=0;Re<Ee.length;Re++)c.addImage(Ee[Re].src)},ce=function(te){var ge,Ee;if(window.getSelection&&(ge=window.getSelection(),ge.rangeCount)){Ee=ge.getRangeAt(0);var Re=Ee.toString();Ee.deleteContents(),Ee.insertNode(te),Ee.setStartAfter(te),Ee.setEndAfter(te),ge.removeAllRanges(),ge.addRange(Ee)}},Me=function(){var te=null;if(te=z.children[0]){te.classList.contains("jslider-grid")||te.classList.add("jslider-grid");var ge=te.children.length;te.setAttribute("data-number",ge>4?4:ge),ge>4?te.setAttribute("data-total",ge-4):te.removeAttribute("data-total")}},Se=function(te){z.innerHTML||c.appendSnippet({}),z.children[0].appendChild(te),Me()};c.appendSnippet=function(te){z.innerHTML="";for(var ge=["image","title","description","host","url"],Ee=0;Ee<ge.length;Ee++){var Re=document.createElement("div");if(Re.className="jsnippet-"+ge[Ee],Re.setAttribute("data-k",ge[Ee]),z.appendChild(Re),te[ge[Ee]])if(ge[Ee]=="image"){Array.isArray(te.image)||(te.image=[te.image]);for(var ot=0;ot<te.image.length;ot++){var Qe=document.createElement("img");Qe.src=te.image[ot],Re.appendChild(Qe)}}else Re.innerHTML=te[ge[Ee]]}c.editor.appendChild(document.createElement("br")),c.editor.appendChild(z)},c.setData=function(te){typeof te=="object"?c.editor.innerHTML=te.content:c.editor.innerHTML=te,c.options.focus&&L.setCursor(c.editor,!0),H=[]},c.getFiles=function(){for(var te=c.editor.querySelectorAll(".jfile"),ge=[],Ee=0;Ee<te.length;Ee++)H[te[Ee].src]&&ge.push(H[te[Ee].src]);return ge},c.getText=function(){return c.editor.innerText},c.getData=function(te){if(te){var ge={content:""};if(z.innerHTML){var Ee=0;ge.snippet={};for(var Re=0;Re<z.children.length;Re++){var ot=z.children[Re].getAttribute("data-k");if(ot)if(ot=="image"){ge.snippet.image||(ge.snippet.image=[]);for(var Qe=0;Qe<z.children[Re].children.length;Qe++)ge.snippet.image.push(z.children[Re].children[Qe].getAttribute("src"))}else ge.snippet[ot]=z.children[Re].innerHTML}}var st=Object.keys(H);if(st.length){ge.files=[];for(var Re=0;Re<st.length;Re++)ge.files.push(H[st[Re]])}var Ct=document.createElement("div");Ct.innerHTML=c.editor.innerHTML;var qe=Ct.querySelector(".jsnippet");qe&&qe.remove();var Ve=Ct.innerHTML;Ve=Ve.replace(/<br>/g,`
`),Ve=Ve.replace(/<\/div>/g,`</div>
`),Ve=Ve.replace(/<(?:.|\n)*?>/gm,""),ge.content=Ve.trim(),_e("getData",ge)}else var ge=c.editor.innerHTML;return ge},c.reset=function(){c.editor.innerHTML="",z.innerHTML="",H=[]},c.addPdf=function(te){if(te.result.substr(0,4)!="data")console.error("Invalid source");else{var ge=document.createElement("canvas");ge.width=60,ge.height=60;var Ee=new Image,Re=ge.getContext("2d");Re.drawImage(Ee,0,0,ge.width,ge.height),ge.toBlob(function(ot){var Qe=document.createElement("img");Qe.src=window.URL.createObjectURL(ot),Qe.title=te.name,Qe.className="jfile pdf",H[Qe.src]={file:Qe.src,extension:"pdf",content:te.result},document.execCommand("insertHtml",!1,Qe.outerHTML)})}},c.addImage=function(te,ge){if(c.options.acceptImages)if(te||(te=""),te.substr(0,4)!="data"&&!c.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(te.substr(0,4)=="data"){var Ee=te.split(";");Ee=Ee[0].split("/"),Ee=Ee[1]}else{var Ee=te.substr(te.lastIndexOf(".")+1);te=c.options.remoteParser+te}var Re=new Image;Re.onload=function(){var Qe=document.createElement("canvas");Qe.width=Re.width,Qe.height=Re.height;var st=Qe.getContext("2d");st.drawImage(Re,0,0,Qe.width,Qe.height),Qe.toBlob(function(Ct){var qe=document.createElement("img");qe.src=window.URL.createObjectURL(Ct),qe.classList.add("jfile"),qe.setAttribute("tabindex","900"),qe.setAttribute("width",Re.width),qe.setAttribute("height",Re.height),H[qe.src]={file:qe.src,extension:Ee,content:Qe.toDataURL()},c.options.dropAsSnippet||ge?(Se(qe),H[qe.src].snippet=!0):document.execCommand("insertHtml",!1,qe.outerHTML),me()})},Re.src=te}},c.addFile=function(te){for(var ge=[],Ee=0;Ee<te.length;Ee++)if(te[Ee].size>c.options.maxFileSize)alert("The file is too big");else{var Re=te[Ee].type.split("/");Re[0]=="image"?Re=1:Re[1]=="pdf"?Re=2:Re=0,Re?(ge[Ee]=new FileReader,ge[Ee].index=Ee,ge[Ee].type=Re,ge[Ee].name=te[Ee].name,ge[Ee].date=te[Ee].lastModified,ge[Ee].size=te[Ee].size,ge[Ee].addEventListener("load",function(ot){ot.target.type==2?c.options.acceptFiles==!0&&c.addPdf(ot.target):c.addImage(ot.target.result)},!1),ge[Ee].readAsDataURL(te[Ee])):alert("The extension is not allowed")}},c.destroy=function(){c.editor.removeEventListener("mouseup",xe),c.editor.removeEventListener("mousedown",Ce),c.editor.removeEventListener("mousemove",Ae),c.editor.removeEventListener("keyup",J),c.editor.removeEventListener("keydown",ve),c.editor.removeEventListener("dragstart",q),c.editor.removeEventListener("dragenter",k),c.editor.removeEventListener("dragover",R),c.editor.removeEventListener("drop",Z),c.editor.removeEventListener("paste",Y),c.editor.removeEventListener("blur",de),c.editor.removeEventListener("focus",ne),I.editor=null,I.classList.remove("jeditor-container"),X.remove(),z.remove(),c.editor.remove()},c.upload=function(){M.click(c.file)};let Te=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],Xe=["width","height","align","border","src","tabindex"],tt=["color","font-weight","font-size","background","background-color","margin"],he=function(te){if(te.tagName&&Te.indexOf(te.tagName.toLowerCase())===-1&&te.innerText&&(te.innerHTML=te.innerText),te.attributes&&te.attributes.length){let ge=null,Ee=te.getAttribute("style");if(Ee){ge=[];let ot=Ee.split(";");for(let Qe=0;Qe<ot.length;Qe++){let st=ot[Qe].trim().split(":");if(tt.indexOf(st[0].trim())>=0){let Ct=st.shift();st=st.join(":"),ge.push(Ct+":"+st)}}}te.tagName.toUpperCase()==="IMG"&&(!c.options.acceptImages||!te.src?te.parentNode.removeChild(te):(te.setAttribute("tabindex","900"),c.addImage(te.src)));let Re=[];for(let ot=0;ot<te.attributes.length;ot++)Re.push(te.attributes[ot].name);Re.length&&Re.forEach(function(ot){Xe.indexOf(ot)===-1?te.removeAttribute(ot):te.attributes&&te.attributes[ie]&&te.attributes[ie].value.indexOf("<")!==-1&&te.attributes[ie].value.replace("<","&#60;")}),te.style="",ge&&ge.length&&te.setAttribute("style",ge.join(";"))}if(te.children.length)for(let ge=te.children.length;ge>0;ge--)he(te.children[ge-1])};var ue=function(te){var ge=window.getSelection(),Ee=document.createRange();Ee.selectNode(te),ge.addRange(Ee)},je=function(te){te&&(te=te.replace(new RegExp("<!--(.*?)-->","gsi"),""));var ge=new DOMParser,Ee=ge.parseFromString(te,"text/html");he(Ee);var Re=document.createElement("div");return Re.innerHTML=Ee.firstChild.innerHTML,Re},Y=function(te){if(c.options.filterPaste==!0){if(te.clipboardData||te.originalEvent.clipboardData)var ge=(te.originalEvent||te).clipboardData.getData("text/html"),Ee=(te.originalEvent||te).clipboardData.getData("text/plain"),Re=(te.originalEvent||te).clipboardData.files;else if(window.clipboardData)var ge=window.clipboardData.getData("Html"),Ee=window.clipboardData.getData("Text"),Re=window.clipboardData.files;if(Re.length)c.addFile(Re);else if(!ge)ge=Ee.split(`\r
`),te.target.innerText?(ge=ge.map(function(Qe){return"<div>"+Qe+"</div>"}),document.execCommand("insertText",!1,ge.join(""))):ge.map(function(Qe){var st=document.createElement("div");st.innerText=Qe,c.editor.appendChild(st)});else{var ot=je(ge);document.execCommand("insertHtml",!1,ot.innerHTML)}te.preventDefault()}},q=function(te){P&&P.e&&te.preventDefault()},k=function(te){P||c.options.dropZone==!1||(I.classList.add("jeditor-dragging"),te.preventDefault())},R=function(te){P||c.options.dropZone==!1||(ee&&clearTimeout(ee),ee=setTimeout(function(){I.classList.remove("jeditor-dragging")},100),te.preventDefault())},Z=function(te){if(!(P||c.options.dropZone==!1)){var ge=null;document.caretRangeFromPoint?ge=document.caretRangeFromPoint(te.clientX,te.clientY):te.rangeParent&&(ge=document.createRange(),ge.setStart(te.rangeParent,te.rangeOffset));var Ee=window.getSelection();Ee.removeAllRanges(),Ee.addRange(ge),Ee.anchorNode.parentNode.focus();var Re=(te.originalEvent||te).dataTransfer.getData("text/html"),ot=(te.originalEvent||te).dataTransfer.getData("text/plain"),Qe=(te.originalEvent||te).dataTransfer.files;Qe.length?c.addFile(Qe):ot&&se(Re),I.classList.remove("jeditor-dragging"),te.preventDefault()}},de=function(te){_e("onevent",te),me(te),typeof c.options.onblur=="function"&&c.options.onblur(I,c,te)},ne=function(te){typeof c.options.onfocus=="function"&&c.options.onfocus(I,c,te)},J=function(te){c.editor.innerHTML||(c.editor.innerHTML="<div><br></div>"),typeof c.options.onkeyup=="function"&&c.options.onkeyup(I,c,te)},ve=function(te){if(_e("onevent",te),te.key=="Delete"&&te.target.tagName=="IMG"){var ge=te.target.parentNode;ue(te.target),ge.classList.contains("jsnippet-image")&&Me()}typeof c.options.onkeydown=="function"&&c.options.onkeydown(I,c,te)},xe=function(te){if(P&&P.e&&(P.e.classList.remove("resizing"),P.e.changed==!0)){var ge=P.e.cloneNode();ge.width=parseInt(P.e.style.width)||P.e.getAttribute("width"),ge.height=parseInt(P.e.style.height)||P.e.getAttribute("height"),P.e.style.width="",P.e.style.height="",ue(P.e),document.execCommand("insertHtml",!1,ge.outerHTML)}P=!1},Ce=function(te){var ge=function(Qe){var st=Qe.getBoundingClientRect();st.width-(te.clientX-st.left)<40&&te.clientY-st.top<40&&(Qe.innerHTML="",Qe.remove())};if(te.target.tagName=="IMG")if(te.target.style.cursor){var Ee=te.target.getBoundingClientRect();P={e:te.target,x:te.clientX,y:te.clientY,w:Ee.width,h:Ee.height,d:te.target.style.cursor},te.target.getAttribute("width")||te.target.setAttribute("width",Ee.width),te.target.getAttribute("height")||te.target.setAttribute("height",Ee.height);var Re=window.getSelection();if(Re.rangeCount)for(var ot=0;ot<Re.rangeCount;ot++)Re.removeRange(Re.getRangeAt(ot));te.target.classList.add("resizing")}else P=!0;else te.target.classList.contains("jsnippet")?ge(te.target):te.target.parentNode.classList.contains("jsnippet")&&ge(te.target.parentNode),P=!0},Ae=function(te){if(te.target.tagName=="IMG"&&!te.target.parentNode.classList.contains("jsnippet-image")&&c.options.allowImageResize==!0&&te.target.getAttribute("tabindex")){var ge=te.target.getBoundingClientRect();te.clientY-ge.top<5?ge.width-(te.clientX-ge.left)<5?te.target.style.cursor="ne-resize":te.clientX-ge.left<5?te.target.style.cursor="nw-resize":te.target.style.cursor="n-resize":ge.height-(te.clientY-ge.top)<5?ge.width-(te.clientX-ge.left)<5?te.target.style.cursor="se-resize":te.clientX-ge.left<5?te.target.style.cursor="sw-resize":te.target.style.cursor="s-resize":ge.width-(te.clientX-ge.left)<5?te.target.style.cursor="e-resize":te.clientX-ge.left<5?te.target.style.cursor="w-resize":te.target.style.cursor=""}if(te.which==1&&P&&P.d){if(P.d=="e-resize"||P.d=="ne-resize"||P.d=="se-resize")if(P.e.style.width=P.w+(te.clientX-P.x),te.shiftKey){var Ee=(te.clientX-P.x)*(P.h/P.w);P.e.style.height=P.h+Ee}else var Ee=null;Ee||(P.d=="s-resize"||P.d=="se-resize"||P.d=="sw-resize")&&(te.shiftKey||(P.e.style.height=P.h+(te.clientY-P.y))),P.e.changed=!0}},_e=function(te,ge){if(c.options.extensions){var Ee=Object.keys(c.options.extensions);if(Ee.length)for(var Re=0;Re<Ee.length;Re++)c.options.extensions[Ee[Re]]&&typeof c.options.extensions[Ee[Re]][te]=="function"&&c.options.extensions[Ee[Re]][te].call(c,ge)}},We=function(){if(c.options.extensions){var te=Object.keys(c.options.extensions);if(te.length)for(var ge=0;ge<te.length;ge++)c.options.extensions[te[ge]]&&typeof c.options.extensions[te[ge]]=="function"&&(c.options.extensions[te[ge]]=c.options.extensions[te[ge]](I,c))}};if(document.addEventListener("mouseup",xe),document.addEventListener("mousemove",Ae),c.editor.addEventListener("mousedown",Ce),c.editor.addEventListener("keyup",J),c.editor.addEventListener("keydown",ve),c.editor.addEventListener("dragstart",q),c.editor.addEventListener("dragenter",k),c.editor.addEventListener("dragover",R),c.editor.addEventListener("drop",Z),c.editor.addEventListener("paste",Y),c.editor.addEventListener("focus",ne),c.editor.addEventListener("blur",de),I.appendChild(c.editor),c.options.snippet&&c.appendSnippet(c.options.snippet),c.options.toolbar){if(Array.isArray(c.options.toolbar))var nt={container:!0,responsive:!0,items:c.options.toolbar};else if(c.options.toolbar===!0)var nt={container:!0,responsive:!0,items:[]};else var nt=c.options.toolbar;nt.items&&nt.items.length||(nt.items=L.getDefaultToolbar(c)),c.options.toolbarOnTop?(I.classList.add("toolbar-on-top"),I.insertBefore(X,I.firstChild)):(c.editor.style.padding="15px",I.appendChild(X)),$e(X,nt),X.addEventListener("click",function(){c.editor.focus()})}return c.file=document.createElement("input"),c.file.style.display="none",c.file.type="file",c.file.setAttribute("accept","image/*"),c.file.onchange=function(){c.addFile(this.files)},I.appendChild(c.file),c.options.focus&&L.setCursor(c.editor,c.options.focus=="initial"),I.change=c.setData,I.val=function(te){if(te===void 0){var ge=I.getAttribute("data-html")!=="true";return c.getData(ge)}else c.setData(te)},We(),I.editor=c,typeof c.options.onload=="function"&&c.options.onload(I,c,c.editor),c};return L.setCursor=function(I,h){I.focus(),document.execCommand("selectAll");var c=window.getSelection(),B=c.getRangeAt(0);if(h==!0)var K=B.startContainer,ee=0;else var K=B.endContainer,ee=K.length;B.setStart(K,ee),B.setEnd(K,ee),c.removeAllRanges(),c.addRange(B)},L.getDefaultToolbar=function(I){var h=function(B,K,ee){if(!ee.color){var P=null,H=ae(ee,{onchange:function(z,X){ee.k==="color"?document.execCommand("foreColor",!1,X):document.execCommand("backColor",!1,X)}});ee.color.open()}},c=[];return c.push({content:"undo",onclick:function(){document.execCommand("undo")}}),c.push({content:"redo",onclick:function(){document.execCommand("redo")}}),c.push({type:"divisor"}),I.options.toolbarOnTop&&(c.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(B){return'<span style="font-family:'+B+'">'+B+"</span>"},onchange:function(B,K,ee,P,H){document.execCommand("fontName",!1,P)}}),c.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(B){return'<span style="font-size:'+B+'">'+B+"</span>"},onchange:function(B,K,ee,P,H){document.execCommand("fontSize",!1,parseInt(H)+1)}}),c.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(B){return'<i class="material-icons">'+B+"</i>"},onchange:function(B,K,ee,P,H){var z=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(z[H])}}),c.push({type:"divisor"}),c.push({content:"format_color_text",k:"color",onclick:h}),c.push({content:"format_color_fill",k:"background-color",onclick:h})),c.push({content:"format_bold",onclick:function(B,K,ee){document.execCommand("bold"),document.queryCommandState("bold")?ee.classList.add("selected"):ee.classList.remove("selected")}}),c.push({content:"format_italic",onclick:function(B,K,ee){document.execCommand("italic"),document.queryCommandState("italic")?ee.classList.add("selected"):ee.classList.remove("selected")}}),c.push({content:"format_underline",onclick:function(B,K,ee){document.execCommand("underline"),document.queryCommandState("underline")?ee.classList.add("selected"):ee.classList.remove("selected")}}),c.push({type:"divisor"}),c.push({content:"format_list_bulleted",onclick:function(B,K,ee){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),c.push({content:"format_list_numbered",onclick:function(B,K,ee){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),c.push({content:"format_indent_increase",onclick:function(B,K,ee){document.execCommand("indent",!0,null),document.queryCommandState("indent")?ee.classList.add("selected"):ee.classList.remove("selected")}}),c.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),I.options.toolbarOnTop&&(c.push({type:"divisor"}),c.push({content:"photo",onclick:function(){I.upload()}}),c.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(B,K){K&&(K.onmouseover=this.onmouseover,B=B.split("x"),K.setAttribute("data-x",B[0]),K.setAttribute("data-y",B[1]));var ee=document.createElement("div");return K.style.margin="1px",K.style.border="1px solid #ddd",ee},onmouseover:function(B){for(var K=parseInt(B.target.getAttribute("data-x")),ee=parseInt(B.target.getAttribute("data-y")),P=0;P<B.target.parentNode.children.length;P++){var H=B.target.parentNode.children[P],z=parseInt(H.getAttribute("data-x")),X=parseInt(H.getAttribute("data-y"));z<=K&&X<=ee?(H.style.backgroundColor="#cae1fc",H.style.borderColor="#2977ff"):(H.style.backgroundColor="",H.style.borderColor="#ddd")}},onchange:function(B,K,ee){ee=ee.split("x");for(var P=document.createElement("table"),H=document.createElement("tbody"),z=0;z<=ee[1];z++){for(var X=document.createElement("tr"),ie=0;ie<=ee[0];ie++){var me=document.createElement("td");me.innerHTML="",X.appendChild(me)}H.appendChild(X)}P.appendChild(H),P.setAttribute("width","100%"),P.setAttribute("cellpadding","6"),P.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,P.outerHTML)}})),c},L}var ze=Ge();function vt(){var L=function(I,h){var c={};c.options={};var B={type:"big",title:"Untitled",width:510,height:472};for(var K in B)h&&h.hasOwnProperty(K)?c.options[K]=h[K]:c.options[K]=B[K];var ee=function(){for(var z=document.createElement("div");I.children[0];)z.appendChild(I.children[0]);for(c.content=document.createElement("div"),c.content.className="jfloating_content",c.content.innerHTML=I.innerHTML;z.children[0];)c.content.appendChild(z.children[0]);c.container=document.createElement("div"),c.container.className="jfloating",c.container.appendChild(c.content),c.options.title?c.container.setAttribute("title",c.options.title):c.container.classList.add("no-title"),c.options.width&&(c.container.style.width=parseInt(c.options.width)+"px"),c.options.height&&(c.container.style.height=parseInt(c.options.height)+"px"),I.innerHTML="",I.appendChild(c.container)},P=function(){c.container&&c.container.addEventListener("click",function(z){var X=z.target.getBoundingClientRect();if(z.target.classList.contains("jfloating")){if(z.changedTouches&&z.changedTouches[0])var ie=z.changedTouches[0].clientX,me=z.changedTouches[0].clientY;else var ie=z.clientX,me=z.clientY;X.width-(ie-X.left)<50&&me-X.top<50?setTimeout(function(){c.close()},100):c.setState()}})},H=function(){c.container.classList.add("jfloating-"+c.options.type)};return c.state={isMinized:!1},c.setState=function(){c.state.isMinized?c.container.classList.remove("jfloating-minimized"):c.container.classList.add("jfloating-minimized"),c.state.isMinized=!c.state.isMinized},c.close=function(){Components.elements.splice(L.elements.indexOf(c.container),1),c.updatePosition(),I.remove()},c.updatePosition=function(){for(var z=0;z<L.elements.length;z++){var X=L.elements[z],ie=L.elements[z-1];X.style.right=z*(ie?ie.offsetWidth:X.offsetWidth)*1.01+"px"}},c.init=function(){ee(),P(),H(),L.elements.push(c.container),c.updatePosition(),I.floating=c},c.init(),c};return L.elements=[],L}var W=vt();function ke(){let L=function(P){return!isNaN(P)&&P!==null&&(typeof P!="string"||P.trim()!=="")},I={between:function(P,H){return P>=H[0]&&P<=H[1]},"not between":function(P,H){return P<H[0]||P>H[1]},"<":function(P,H){return P<H[0]},"<=":function(P,H){return P<=H[0]},">":function(P,H){return P>H[0]},">=":function(P,H){return P>=H[0]},"=":function(P,H){return P==H[0]},"!=":function(P,H){return P!=H[0]}},h={"valid date":function(){return!0},"=":function(P,H){return P===H[0]},"!=":function(P,H){return P!==H[0]},"<":function(P,H){return P<H[0]},"<=":function(P,H){return P<=H[0]},">":function(P,H){return P>H[0]},">=":function(P,H){return P>=H[0]},between:function(P,H){return P>=H[0]&&P<=H[1]},"not between":function(P,H){return P<H[0]||P>H[1]}},c={contains:function(P,H){return P.includes(H[0])},"not contains":function(P,H){return!P.includes(H[0])},"begins with":function(P,H){return P.startsWith(H[0])},"ends with":function(P,H){return P.endsWith(H[0])},"=":function(P,H){return P===H[0]},"!=":function(P,H){return P!==H[0]},"valid email":function(P){var H=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return H.test(P)},"valid url":function(P){var H=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return H.test(P)}},B=function(P,H){return typeof B[H.type]=="function"?H.allowBlank&&(typeof P>"u"||P===""||P===null)?!0:B[H.type].call(this,P,H):null};B.url=function(P){var H=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!H.test(P)},B.email=function(P){var H=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(P&&H.test(P))},B.required=function(P){return!!(P&&P.trim())},B.empty=function(P){return typeof P>"u"||P===null||typeof P=="string"&&!P.toString().trim()},B["not exist"]=B.empty,B.notEmpty=function(P){return!B.empty(P)},B.exist=B.notEmpty,B.number=function(P,H){if(!L(P))return!1;if(!H||!H.criteria)return!0;if(!I[H.criteria])return!1;let z=H.value.map(function(X){return parseFloat(X)});return I[H.criteria](P,z)},B.login=function(P){let H=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(P&&H.test(P))},B.list=function(P,H){let z=typeof P;if(z!=="string"&&z!=="number")return!1;let X;return typeof H.value[0]=="string"?H.source?X=H.source:X=H.value[0].split(","):X=H.value[0],Array.isArray(X)?X.findIndex(function(me){return me==P})>-1:!1};let K=function(){let P=new Date;return P.setHours(0,0,0,0),P},ee={"one year ago":function(){let P=K();return P.setFullYear(P.getFullYear()-1),P},"one month ago":function(){let P=K();return P.setMonth(P.getMonth()-1),P},"one week ago":function(){let P=K();return P.setDate(P.getDate()-7),P},yesterday:function(){let P=K();return P.setDate(P.getDate()-1),P},today:K,tomorrow:function(){let P=K();return P.setDate(P.getDate()+1),P}};return B.date=function(P,H){if(L(P)&&P>0&&P<1e6&&(P=D.numToDate(P)),new Date(P)=="Invalid Date")return!1;if(!H||!H.criteria)return!0;if(!h[H.criteria])return!1;let z=H.value.map(function(X){return typeof X=="string"&&ee[X]?ee[X]().getTime():new Date(X).getTime()});return h[H.criteria](new Date(P).getTime(),z)},B.text=function(P,H){if(typeof P>"u"||P===null)P="";else if(typeof P!="string")return!1;return!H||!H.criteria?!0:c[H.criteria]?c[H.criteria](P,H.value):!1},B.textLength=function(P,H){let z;return typeof P=="string"?z=P.length:typeof P<"u"&&P!==null&&typeof P.toString=="function"?z=P.toString().length:z=0,B.number(z,H)},B}var Ze=ke();function Oe(){var L=function(I,h){var c={};c.options={};var B={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(H,z){alert(z)}};for(var K in B)h&&h.hasOwnProperty(K)?c.options[K]=h[K]:c.options[K]=B[K];c.options.validations||(c.options.validations={}),c.options.submitButton||(c.options.submitButton=I.querySelector("input[type=submit]")),c.options.submitButton&&c.options.url&&(c.options.submitButton.onclick=function(){c.save()}),c.options.validations.email||(c.options.validations.email=Ze.email),c.options.validations.length||(c.options.validations.length=Ze.length),c.options.validations.required||(c.options.validations.required=Ze.required),c.setUrl=function(H){c.options.url=H},c.load=function(){v({url:c.options.url,method:"GET",dataType:"json",queue:!0,success:function(H){if(typeof c.options.onbeforeload=="function"){var z=c.options.onbeforeload(I,H);z&&(H=z)}L.setElements(I,H),typeof c.options.onload=="function"&&c.options.onload(I,H)}})},c.save=function(){var H=c.validate();if(H)c.options.onerror(I,H);else{var z=L.getElements(I,!0);if(typeof c.options.onbeforesave=="function"){var z=c.options.onbeforesave(I,z);if(z===!1)return}v({url:c.options.url,method:"POST",dataType:"json",data:z,success:function(X){typeof c.options.onsave=="function"&&c.options.onsave(I,z,X)}})}},c.remove=function(){if(typeof c.options.onbeforeremove=="function"){var H=c.options.onbeforeremove(I,c);if(H===!1)return!1}v({url:c.options.url,method:"DELETE",dataType:"json",success:function(z){typeof c.options.onremove=="function"&&c.options.onremove(I,c,z),c.reset()}})};var ee=function(H){H.classList.add("error"),c.options.submitButton&&c.options.submitButton.setAttribute("disabled",!0);var z=H.getAttribute("data-error")||"There is an error in the form";return H.setAttribute("title",z),z},P=function(H){var z=!1;H.classList.remove("error"),H.removeAttribute("title");for(var X=I.querySelectorAll("input, select, textarea, div[name]"),ie=0;ie<X.length;ie++)X[ie].getAttribute("data-validation")&&X[ie].classList.contains("error")&&(z=!0);c.options.submitButton&&(z?c.options.submitButton.setAttribute("disabled",!0):c.options.submitButton.removeAttribute("disabled"))};return c.validateElement=function(H){var z=!1,X=L.getValue(H),ie=H.getAttribute("data-validation");return typeof c.options.validations[ie]=="function"&&!c.options.validations[ie](X,H)?z=ee(H):H.classList.contains("error")&&P(H),z},c.reset=function(){for(var H=null,z=I.querySelectorAll("input, select, textarea, div[name]"),X=0;X<z.length;X++)(H=z[X].getAttribute("name"))&&(z[X].type=="checkbox"||z[X].type=="radio"?z[X].checked=!1:typeof z[X].val=="function"?z[X].val(""):z[X].value="")},c.validate=function(){for(var H=[],z=I.querySelectorAll("input, select, textarea, div[name]"),X=0;X<z.length;X++)if(z[X].getAttribute("data-validation")){var ie=c.validateElement(z[X]);ie&&H.push(ie)}return H.length>0?H.join("<br>"):!1},c.getError=function(){return!!c.validation()},c.setHash=function(){return c.getHash(L.getElements(I))},c.getHash=function(H){var z=0,X,ie;if(H.length===0)return z;for(X=0;X<H.length;X++)ie=H.charCodeAt(X),z=(z<<5)-z+ie,z|=0;return z},c.isChanged=function(){var H=c.setHash();return c.options.currentHash!=H},c.resetTracker=function(){c.options.currentHash=c.setHash(),c.options.ignore=!1},c.setIgnore=function(H){c.options.ignore=!!H},setTimeout(function(){c.options.currentHash=c.setHash()},1e3),I.addEventListener("keyup",function(H){H.target.getAttribute("data-validation")&&c.validateElement(H.target)}),L.hasEvents||(window.addEventListener("beforeunload",function(H){if(c.isChanged()&&c.options.ignore==!1){var z=c.options.message?c.options.message:"o/";return z?(typeof H>"u"&&(H=window.event),H&&(H.returnValue=z),z):void 0}}),L.hasEvents=!0),I.form=c,c};return L.getValue=function(I){var h=null;if(I.type=="checkbox")I.checked==!0&&(h=I.value||!0);else if(I.type=="radio")I.checked==!0&&(h=I.value);else if(I.type=="file")h=I.files;else if(I.tagName=="select"&&I.multiple==!0){h=[];for(var c=I.querySelectorAll("options[selected]"),B=0;B<c.length;B++)h.push(c[B].value)}else typeof I.val=="function"?h=I.val():h=I.value||"";return h},L.getElements=function(I,h){for(var c={},B=null,K=I.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<K.length;ee++)(B=K[ee].getAttribute("name"))&&(c[B]=L.getValue(K[ee])||"");return h==!0?c:JSON.stringify(c)},L.setElements=function(I,h){for(var c=null,B=null,K=I.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<K.length;ee++){var P=K[ee].getAttribute("type");if(c=K[ee].getAttribute("name")){if(c=c.replace(new RegExp(/\[(.*?)\]/ig),".$1"),B=null,c.match(/\./)){var H=g.call(h,c)||"";typeof H<"u"&&(B=H)}else typeof h[c]<"u"&&(B=h[c]);B!==null&&(P=="checkbox"||P=="radio"?K[ee].checked=!!B:P=="file"||(typeof K[ee].val=="function"?K[ee].val(B):K[ee].value=B))}}},L}var Ie=Oe();function Fe(){var L=function(){var h=null,c=function(P){if(P.which==27)for(var H=document.querySelectorAll(".jmodal"),z=0;z<H.length;z++)H[z].parentNode.modal.close()},B=function(P){let H=P.composedPath();var z=M.findElement(H[0],"jmodal");if(z){var X=z.getBoundingClientRect();if(P.changedTouches&&P.changedTouches[0])var ie=P.changedTouches[0].clientX,me=P.changedTouches[0].clientY;else var ie=P.clientX,me=P.clientY;X.width-(ie-X.left)<50&&me-X.top<50&&z.parentNode.modal.close()}h&&(h.element.style.cursor="auto",h=null)},K=function(P){let H=P.composedPath();var z=M.findElement(H[0],"jmodal");if(z){var X=z.getBoundingClientRect();if(P.changedTouches&&P.changedTouches[0])var ie=P.changedTouches[0].clientX,me=P.changedTouches[0].clientY;else var ie=P.clientX,me=P.clientY;X.width-(ie-X.left)<50&&me-X.top<50||me-X.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),h={left:X.left,top:X.top,x:P.clientX,y:P.clientY,width:X.width,height:X.height,element:z})}},ee=function(P){if(h){if(P=P||window.event,P.buttons)var H=P.buttons;else if(P.button)var H=P.button;else var H=P.which;H?(h.element.style.top=h.top+(P.clientY-h.y)+h.height/2+"px",h.element.style.left=h.left+(P.clientX-h.x)+h.width/2+"px",h.element.style.cursor="move"):h.element.style.cursor="auto"}};document.addEventListener("keydown",c),document.addEventListener("mouseup",B),document.addEventListener("mousedown",K),document.addEventListener("mousemove",ee)},I=function(h,c){var B={};B.options={};var K={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var ee in K)c&&c.hasOwnProperty(ee)?B.options[ee]=c[ee]:B.options[ee]=K[ee];!B.options.title&&h.getAttribute("title")&&(B.options.title=h.getAttribute("title"));for(var P=document.createElement("div");h.children[0];)P.appendChild(h.children[0]);for(B.title=document.createElement("div"),B.title.className="jmodal_title",B.options.icon&&B.title.setAttribute("data-icon",B.options.icon),B.content=document.createElement("div"),B.content.className="jmodal_content",B.content.innerHTML=h.innerHTML;P.children[0];)B.content.appendChild(P.children[0]);if(B.container=document.createElement("div"),B.container.className="jmodal",B.container.appendChild(B.title),B.container.appendChild(B.content),B.options.padding&&(B.content.style.padding=B.options.padding),B.options.width&&(B.container.style.width=B.options.width),B.options.height&&(B.container.style.height=B.options.height),B.options.title){var H=document.createElement("h4");H.innerText=B.options.title,B.title.appendChild(H)}if(h.innerHTML="",h.style.display="none",h.appendChild(B.container),B.options.backdrop){var z=document.createElement("div");z.className="jmodal_backdrop",z.onclick=function(){B.close()},h.appendChild(z)}return B.open=function(){h.style.display="block";var X=B.container.getBoundingClientRect();M.getWindowWidth()<X.width?(B.container.style.top="",B.container.style.left="",B.container.classList.add("jmodal_fullscreen"),A.slideBottom(B.container,1)):B.options.backdrop&&(z.style.display="block"),typeof B.options.onopen=="function"&&B.options.onopen(h,B)},B.resetPosition=function(){B.container.style.top="",B.container.style.left=""},B.isOpen=function(){return h.style.display!="none"},B.close=function(){B.isOpen()&&(h.style.display="none",B.options.backdrop&&(z.style.display=""),B.container.classList.remove("jmodal_fullscreen"),typeof B.options.onclose=="function"&&B.options.onclose(h,B))},B.options.url?v({url:B.options.url,method:"GET",dataType:"text/html",success:function(X){B.content.innerHTML=X,B.options.closed||B.open(),typeof B.options.onload=="function"&&B.options.onload(B)}}):(B.options.closed||B.open(),typeof B.options.onload=="function"&&B.options.onload(B)),h.modal=B,L(),L=function(){},B};return I}var Be=Fe();function Ke(){var L=function(I){var h={};h.options={};var c={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var B in c)I&&I.hasOwnProperty(B)?h.options[B]=I[B]:h.options[B]=c[B];var K=document.createElement("div");K.className="jnotification",h.options.error&&K.classList.add("jnotification-error");var ee=document.createElement("div");ee.className="jnotification-container",K.appendChild(ee);var P=document.createElement("div");P.className="jnotification-header",ee.appendChild(P);var H=document.createElement("div");if(H.className="jnotification-image",P.appendChild(H),h.options.icon){var z=document.createElement("img");z.src=h.options.icon,H.appendChild(z)}var X=document.createElement("div");if(X.className="jnotification-name",X.innerHTML=h.options.name,P.appendChild(X),h.options.closeable==!0){var ie=document.createElement("div");ie.className="jnotification-close",ie.onclick=function(){h.hide()},P.appendChild(ie)}var me=document.createElement("div");me.className="jnotification-date",P.appendChild(me);var se=document.createElement("div");if(se.className="jnotification-content",ee.appendChild(se),h.options.title){var ce=document.createElement("div");ce.className="jnotification-title",ce.innerHTML=h.options.title,se.appendChild(ce)}var Me=document.createElement("div");if(Me.className="jnotification-message",Me.innerHTML=h.options.message,se.appendChild(Me),h.show=function(){document.body.appendChild(K),M.getWindowWidth()>800?A.fadeIn(K):A.slideTop(K,1)},h.hide=function(){M.getWindowWidth()>800?A.fadeOut(K,function(){K.parentNode&&(K.parentNode.removeChild(K),Se&&clearTimeout(Se))}):A.slideTop(K,0,function(){K.parentNode&&(K.parentNode.removeChild(K),Se&&clearTimeout(Se))})},h.show(),h.options.autoHide==!0)var Se=setTimeout(function(){h.hide()},h.options.timeout);return M.getWindowWidth()<800&&K.addEventListener("swipeup",function(Te){h.hide(),Te.preventDefault(),Te.stopPropagation()}),h};return L.isVisible=function(){var I=document.querySelector(".jnotification");return!!(I&&I.parentNode)},L}var et=Ke();function bt(L,I){var h={};h.options={};var c={value:0,onchange:null,width:null};for(var B in c)I&&I.hasOwnProperty(B)?h.options[B]=I[B]:h.options[B]=c[B];L.classList.add("jprogressbar"),L.setAttribute("tabindex",1),L.setAttribute("data-value",h.options.value);var K=document.createElement("div");K.style.width=h.options.value+"%",K.style.color="#fff",L.appendChild(K),h.options.width&&(L.style.width=h.options.width),h.setValue=function(P){P=parseInt(P),h.options.value=P,K.style.width=P+"%",L.setAttribute("data-value",P+"%"),P<6?L.style.color="#000":L.style.color="#fff",h.options.value=P,typeof h.options.onchange=="function"&&h.options.onchange(L,P),L.value!=h.options.value&&(L.value=h.options.value,typeof L.oninput=="function"&&L.oninput({type:"input",target:L,value:L.value}))},h.getValue=function(){return h.options.value};var ee=function(P){if(P.which){var H=L.getBoundingClientRect();if(P.changedTouches&&P.changedTouches[0])var z=P.changedTouches[0].clientX,X=P.changedTouches[0].clientY;else var z=P.clientX,X=P.clientY;h.setValue(Math.round((z-H.left)/H.width*100))}};return"touchstart"in document.documentElement?(L.addEventListener("touchstart",ee),L.addEventListener("touchend",ee)):(L.addEventListener("mousedown",ee),L.addEventListener("mousemove",ee)),L.change=h.setValue,L.val=function(P){if(P===void 0)return h.getValue();h.setValue(P)},L.progressbar=h,h}function Tt(L,I){if(L.rating)return L.rating.setOptions(I,!0);var h={};h.options={},h.setOptions=function(B,K){var ee={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var P in ee)B&&B.hasOwnProperty(P)?h.options[P]=B[P]:(typeof h.options[P]>"u"||K===!0)&&(h.options[P]=ee[P]);L.innerHTML="";for(var H=0;H<h.options.number;H++){var z=document.createElement("div");z.setAttribute("data-index",H+1),z.setAttribute("title",h.options.tooltip[H]),L.appendChild(z)}if(h.options.value)for(var H=0;H<h.options.number;H++)H<h.options.value&&L.children[H].classList.add("jrating-selected");return h},h.setValue=function(B){for(var K=0;K<h.options.number;K++)K<B?L.children[K].classList.add("jrating-selected"):(L.children[K].classList.remove("jrating-over"),L.children[K].classList.remove("jrating-selected"));h.options.value=B,typeof h.options.onchange=="function"&&h.options.onchange(L,B),L.value!=h.options.value&&(L.value=h.options.value,typeof L.oninput=="function"&&L.oninput({type:"input",target:L,value:L.value}))},h.getValue=function(){return h.options.value};var c=function(){h.setOptions(I),L.classList.add("jrating"),L.addEventListener("click",function(B){var K=B.target.getAttribute("data-index");K!=null&&(K==h.options.value?h.setValue(0):h.setValue(K))}),L.addEventListener("mouseover",function(B){for(var K=B.target.getAttribute("data-index"),ee=0;ee<h.options.number;ee++)ee<K?L.children[ee].classList.add("jrating-over"):L.children[ee].classList.remove("jrating-over")}),L.addEventListener("mouseout",function(B){for(var K=0;K<h.options.number;K++)L.children[K].classList.remove("jrating-over")}),L.change=h.setValue,L.val=function(B){if(B===void 0)return h.getValue();h.setValue(B)},L.rating=h};return c(),h}function jt(L,I){if(L.search)return L.search;var h=null,c=function(z){if(z.target.classList.contains("jsearch_item"))var X=z.target;else var X=z.target.parentNode;P.selectIndex(X),z.preventDefault()},B=function(z){if(typeof P.options.onsearch=="function"){var X=P.options.onsearch(P,z);X&&(z=X)}if(H.innerHTML="",!z.length)L.style.display="";else{L.style.display="block";for(var ie=z.length<11?z.length:10,me=0;me<ie;me++){if(typeof z[me]=="string")var se=z[me],ce=z[me];else{var se=z[me].text;!se&&z[me].name&&(se=z[me].name);var ce=z[me].value;!ce&&z[me].id&&(ce=z[me].id)}var Me=document.createElement("div");Me.setAttribute("data-value",ce),Me.setAttribute("data-text",se),Me.className="jsearch_item",z[me].id&&Me.setAttribute("id",z[me].id),P.options.forceSelect&&me==0&&Me.classList.add("selected");var Se=document.createElement("img");z[me].image?Se.src=z[me].image:Se.style.display="none",Me.appendChild(Se);var Te=document.createElement("div");Te.innerHTML=se,Me.appendChild(Te),H.appendChild(Me)}}},K=function(z){if(z!=P.terms)if(P.terms=z,P.options.forceSelect?h=0:h=null,Array.isArray(P.options.data)){var X=function(me){if(typeof me=="string"){if((""+me).toLowerCase().search(z.toLowerCase())>=0)return!0}else for(var se in me){var ce=me[se];if((""+ce).toLowerCase().search(z.toLowerCase())>=0)return!0}return!1},ie=P.options.data.filter(function(me){return X(me)});B(ie)}else v({url:P.options.data+z,method:"GET",dataType:"json",success:function(me){B(me)}})},ee=null,P=function(z){ee&&clearTimeout(ee),ee=setTimeout(function(){K(z)},500)};I.forceSelect===null&&(I.forceSelect=!0),P.options={data:I.data||null,input:I.input||null,searchByNode:I.searchByNode||null,onselect:I.onselect||null,forceSelect:I.forceSelect,onsearch:I.onsearch||null,onbeforesearch:I.onbeforesearch||null},P.selectIndex=function(z){var X=z.getAttribute("id"),ie=z.getAttribute("data-text"),me=z.getAttribute("data-value"),se=z.children[0].src||"";typeof P.options.onselect=="function"&&P.options.onselect(P,ie,me,X,se),P.close()},P.open=function(){L.style.display="block"},P.close=function(){ee&&clearTimeout(ee),P.terms="",H.innerHTML="",L.style.display=""},P.isOpened=function(){return!!L.style.display},P.keydown=function(z){P.isOpened()&&(z.key=="Enter"?h!==null&&H.children[h]?(P.selectIndex(H.children[h]),z.preventDefault()):P.close():z.key==="ArrowUp"?(h!==null&&H.children[0]&&(H.children[h].classList.remove("selected"),!P.options.forceSelect&&h===0?h=null:(h=Math.max(0,h-1),H.children[h].classList.add("selected"))),z.preventDefault()):z.key==="ArrowDown"&&(h==null?h=-1:H.children[h].classList.remove("selected"),h<9&&H.children[h+1]&&h++,H.children[h].classList.add("selected"),z.preventDefault()))},P.keyup=function(z){if(!P.options.searchByNode&&P.options.input)if(P.options.input.tagName==="DIV")var X=P.options.input.innerText;else var X=P.options.input.value;else{var ie=M.getNode();if(ie)var X=ie.innerText}if(typeof P.options.onbeforesearch=="function"){var me=P.options.onbeforesearch(P,X);if(me)X=me;else if(me===!1)return}P(X)},P.blur=function(z){P.close()},P.options.input&&(P.options.input.addEventListener("keyup",P.keyup),P.options.input.addEventListener("keydown",P.keydown),P.options.input.addEventListener("blur",P.blur));var H=document.createElement("div");return H.classList.add("jsearch_container"),H.onmousedown=c,L.appendChild(H),L.classList.add("jsearch"),L.search=P,P}function Ut(L,I){var h={};if(h.options={},h.currentImage=null,I&&(h.options=I),L.setAttribute("tabindex","900"),h.options.items=[],!L.classList.contains("jslider")){if(L.classList.add("jslider"),L.classList.add("unselectable"),h.options.height&&(L.style.minHeight=parseInt(h.options.height)+"px"),h.options.width&&(L.style.width=parseInt(h.options.width)+"px"),h.options.grid){L.classList.add("jslider-grid");var c=L.children.length;c>4&&L.setAttribute("data-total",c-4),L.setAttribute("data-number",c>4?4:c)}var B=document.createElement("div");if(B.classList.add("jslider-counter"),L.children.length>0)for(var K=0;K<L.children.length;K++){h.options.items.push(L.children[K]);var ee=document.createElement("div");ee.onclick=function(){var ie=Array.prototype.slice.call(B.children).indexOf(this);h.show(h.currentImage=h.options.items[ie])},B.appendChild(ee)}var P=document.createElement("div");P.className="jslider-caption";var H=document.createElement("div"),z=document.createElement("div");z.className="jslider-close",z.innerHTML="",z.onclick=function(){h.close()},H.appendChild(P),H.appendChild(z)}h.updateCounter=function(ie){for(var me=0;me<B.children.length;me++)if(B.children[me].classList.contains("jslider-counter-focus")){B.children[me].classList.remove("jslider-counter-focus");break}B.children[ie].classList.add("jslider-counter-focus")},h.show=function(ie){if(!ie)var ie=L.children[0];L.classList.add("jslider-focus"),L.classList.remove("jslider-grid"),L.appendChild(H),L.appendChild(B);var me=h.options.items.indexOf(ie);h.updateCounter(me);for(var se=0;se<L.children.length;se++)L.children[se].style.display="";ie.style.display="block",ie.previousElementSibling?L.classList.add("jslider-left"):L.classList.remove("jslider-left"),ie.nextElementSibling&&ie.nextElementSibling.tagName=="IMG"?L.classList.add("jslider-right"):L.classList.remove("jslider-right"),h.currentImage=ie,h.currentImage.offsetHeight>h.currentImage.offsetWidth&&h.currentImage.classList.add("jslider-vertical"),H.children[0].innerText=h.currentImage.getAttribute("title")},h.open=function(){h.show(),typeof h.options.onopen=="function"&&h.options.onopen(L)},h.close=function(){L.classList.remove("jslider-focus"),L.classList.remove("jslider-left"),L.classList.remove("jslider-right"),h.options.grid&&L.classList.add("jslider-grid");for(var ie=0;ie<L.children.length;ie++)L.children[ie].style.display="";B.remove(),H.remove(),h.currentImage=null,typeof h.options.onclose=="function"&&h.options.onclose(L)},h.reset=function(){L.innerHTML=""},h.next=function(){var ie=h.currentImage.nextElementSibling;ie&&ie.tagName==="IMG"&&h.show(h.currentImage.nextElementSibling)},h.prev=function(){h.currentImage.previousElementSibling&&h.show(h.currentImage.previousElementSibling)};var X=function(ie){if(ie.target.tagName=="IMG")h.show(ie.target);else if(!ie.target.classList.contains("jslider-close")&&!(ie.target.parentNode.classList.contains("jslider-counter")||ie.target.classList.contains("jslider-counter"))){var me=ie.offsetX||ie.changedTouches[0].clientX;ie.target.clientWidth-me<40?h.next():me<40&&h.prev()}};return"ontouchend"in document.documentElement?L.addEventListener("touchend",X):L.addEventListener("mouseup",X),L.addEventListener("swipeleft",function(ie){h.next(),ie.preventDefault(),ie.stopPropagation()}),L.addEventListener("swiperight",function(ie){h.prev(),ie.preventDefault(),ie.stopPropagation()}),L.addEventListener("keydown",function(ie){ie.which==27&&h.close()}),L.slider=h,h}function bn(L,I){if(L.tags)return L.tags.setOptions(I,!0);var h={type:"tags"};h.options={};var c=function(){return!!(h.options.limit&&L.children.length>=h.options.limit)},B=null,K=null;h.setOptions=function(he,ue){var je={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var Y in je)he&&he.hasOwnProperty(Y)?h.options[Y]=he[Y]:(typeof h.options[Y]>"u"||ue===!0)&&(h.options[Y]=je[Y]);return h.options.placeholder?L.setAttribute("data-placeholder",h.options.placeholder):L.removeAttribute("data-placeholder"),L.placeholder=h.options.placeholder,h.setValue(h.options.value),z(),h.options.search?K||(K=document.createElement("div"),L.parentNode.insertBefore(K,L.nextSibling),B=jt(K,{data:h.options.search,onselect:function(q,k,R){h.selectIndex(k,R)}})):K&&(B=null,K.remove(),K=null),h},h.add=function(he,ue){if(typeof h.options.onbeforechange=="function"){var je=h.options.onbeforechange(L,h,h.options.value,he);if(je===!1)return!1;je!=null&&(he=je)}if(B&&B.close(),c())typeof h.options.onlimit=="function"?h.options.onlimit(h,h.options.limit):alert(u.translate("You reach the limit number of entries")+" "+h.options.limit);else{var Y=M.getNode();if(Y&&Y.parentNode&&Y.parentNode.classList.contains("jtags")&&Y.nextSibling&&!(Y.nextSibling.innerText&&Y.nextSibling.innerText.trim()))q=Y.nextSibling;else{if(L.lastChild&&(L.lastChild.innerText.trim()||L.removeChild(L.lastChild)),!he||typeof he=="string")var q=P(he,he,Y);else for(var k=0;k<=he.length;k++)if(!c()){if(!he[k]||typeof he[k]=="string")var R=he[k]||"",Z=null;else var R=he[k].text,Z=he[k].value;var q=P(R,Z)}H()}ue&&ee(q)}},h.setLimit=function(he){h.options.limit=he;for(var ue=L.children.length-he;L.children.length>he;)L.removeChild(L.lastChild)},h.remove=function(he){he.parentNode.removeChild(he),L.children.length?H():h.add("",!0),typeof h.options.onremoveitem=="function"&&h.options.onremoveitem(L,h,he)},h.getData=function(){for(var he=[],ue=0;ue<L.children.length;ue++){var je=L.children[ue].innerText.replace(`
`,""),Y=L.children[ue].getAttribute("data-value");Y||(Y=je),(je||Y)&&he.push({text:je,value:Y})}return he},h.getValue=function(he){var ue=null;if(he!=null)ue=L.children[he].getAttribute("data-value"),ue||(ue=L.children[he].innerText.replace(`
`,""));else{for(var je=[],Y=0;Y<L.children.length;Y++)ue=L.children[Y].innerText.replace(`
`,""),ue&&je.push(h.getValue(Y));ue=je.join(",")}return ue},h.setValue=function(he){if(!he)h.reset();else if(L.value!=he)if(Array.isArray(he))h.add(he);else{var ue=(""+he).trim(),je=ie(ue);L.innerHTML="",h.add(je)}},h.reset=function(){L.classList.add("jtags-empty"),L.innerHTML="<div></div>",H()},h.isValid=function(){for(var he=0,ue=0;ue<L.children.length;ue++)L.children[ue].classList.contains("jtags_error")&&he++;return he==0},h.selectIndex=function(he,ue){var je=M.getNode();je&&(je.innerText=he,ue&&je.setAttribute("data-value",ue),je.classList.remove("jtags_error"),c()||h.add("",!0))},h.search=function(he){var ue=he.innerText},h.destroy=function(){L.removeEventListener("mouseup",Se),L.removeEventListener("keydown",se),L.removeEventListener("keyup",ce),L.removeEventListener("paste",Me),L.removeEventListener("focus",Te),L.removeEventListener("blur",Xe),L.parentNode.removeChild(L)};var ee=function(he){if(L.children.length){var ue=document.createRange(),je=window.getSelection();if(!he)var he=L.childNodes[L.childNodes.length-1];ue.setStart(he,he.length),ue.collapse(!0),je.removeAllRanges(),je.addRange(ue),L.scrollLeft=L.scrollWidth}},P=function(he,ue,je){var Y=document.createElement("div");return Y.textContent=he||"",ue&&Y.setAttribute("data-value",ue),je&&je.parentNode.classList.contains("jtags")?L.insertBefore(Y,je.nextSibling):L.appendChild(Y),Y},H=function(){var he=h.getValue();he!=h.options.value&&(h.options.value=he,typeof h.options.onchange=="function"&&h.options.onchange(L,h,h.options.value),L.value!=h.options.value&&(L.value=h.options.value,typeof L.oninput=="function"&&L.oninput({type:"input",target:L,value:L.value}))),z()},z=function(){for(var he=0;he<L.children.length;he++)L.children[he].tagName==="DIV"&&(h.getValue(he)?(L.children[he].classList.add("jtags_label"),typeof h.options.validation=="function"&&h.getValue(he)?h.options.validation(L.children[he],L.children[he].innerText,L.children[he].getAttribute("data-value"))?L.children[he].classList.remove("jtags_error"):L.children[he].classList.add("jtags_error"):L.children[he].classList.remove("jtags_error")):L.children[he].classList.remove("jtags_label"));X()},X=function(){L.innerText.trim()?L.classList.remove("jtags-empty"):(!L.children.length||L.children[0].tagName==="BR")&&(L.innerHTML="",ee(P()))},ie=function(he){var ue=[],je="";if(he=he.trim(),he){for(var Y=0;Y<he.length;Y++)he[Y]==","||he[Y]==";"||he[Y]==`
`?je&&(ue.push(je.trim()),je=""):je+=he[Y];je&&ue.push(je)}return ue},me=0,se=function(he){if(me=window.getSelection().anchorOffset,X(),he.key==="Tab"||he.key===";"||he.key===","){var ue=window.getSelection().anchorOffset;ue>1&&(c()?typeof h.options.onlimit=="function"&&h.options.onlimit(h,h.options.limit):h.add("",!0)),he.preventDefault()}else if(he.key=="Enter"){if(!B||!B.isOpened()){var ue=window.getSelection().anchorOffset;ue>1&&(c()||h.add("",!0)),he.preventDefault()}}else he.key=="Backspace"&&L.children.length==1&&window.getSelection().anchorOffset<1&&he.preventDefault();B&&B.keydown(he),X()},ce=function(he){if(he.which==39){var ue=window.getSelection().anchorOffset;ue>1&&ue==me&&h.add("",!0)}else he.which==13||he.which==38||he.which==40?he.preventDefault():B&&B.keyup(he);z()},Me=function(he){if(he.clipboardData||he.originalEvent.clipboardData)var ue=(he.originalEvent||he).clipboardData.getData("text/plain");else if(window.clipboardData)var ue=window.clipboardData.getData("Text");var je=ie(ue);if(typeof h.options.onbeforepaste=="function"){var Y=h.options.onbeforepaste(L,h,je);if(Y===!1)return he.preventDefault(),!1;Y&&(je=Y)}je.length>1?(h.add(je,!0),he.preventDefault()):je[0]&&(document.execCommand("insertText",!1,je[0]),he.preventDefault())},Se=function(he){if(he.target.parentNode&&he.target.parentNode.classList.contains("jtags")&&(he.target.classList.contains("jtags_label")||he.target.classList.contains("jtags_error"))){var ue=he.target.getBoundingClientRect();ue.width-(he.clientX-ue.left)<16&&h.remove(he.target)}he.target==L&&ee()},Te=function(){L.classList.contains("jtags-focus")||((!L.children.length||h.getValue(L.children.length-1))&&(c()||P("")),typeof h.options.onfocus=="function"&&h.options.onfocus(L,h,h.getValue()),L.classList.add("jtags-focus"))},Xe=function(){if(L.classList.contains("jtags-focus")){B&&B.close();for(var he=0;he<L.children.length-1;he++)h.getValue(he)||L.removeChild(L.children[he]);H(),L.classList.remove("jtags-focus"),typeof h.options.onblur=="function"&&h.options.onblur(L,h,h.getValue())}},tt=function(){"touchend"in document.documentElement?L.addEventListener("touchend",Se):L.addEventListener("mouseup",Se),L.addEventListener("keydown",se),L.addEventListener("keyup",ce),L.addEventListener("paste",Me),L.addEventListener("focus",Te),L.addEventListener("blur",Xe),L.setAttribute("contenteditable",!0),L.classList.add("jtags"),h.setOptions(I),typeof h.options.onload=="function"&&h.options.onload(L,h),L.change=h.setValue,L.val=function(he){if(he===void 0)return h.getValue();h.setValue(he)},L.tags=h};return tt(),h}function Yt(L,I){var h={};h.options={};var c={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var B in c)I&&I.hasOwnProperty(B)?h.options[B]=I[B]:h.options[B]=c[B];h.options.multiple==!0&&L.setAttribute("data-multiple",!0),L.content=[],L.classList.add("jupload"),h.options.input==!0&&L.classList.add("input"),h.add=function(z){if(h.options.multiple==!1&&(L.content=[],L.innerText=""),h.options.type=="image"){var X=document.createElement("img");X.setAttribute("src",z.file),X.setAttribute("tabindex",-1),L.getAttribute("name")||(X.className="jfile",X.content=z),L.appendChild(X)}else{if(z.name)var ie=z.name;else var ie=z.file;var me=document.createElement("div");me.innerText=ie||h.options.type,me.classList.add("jupload-item"),me.setAttribute("tabindex",-1),L.appendChild(me)}z.content&&(z.file=M.guid()),L.content.push(z),typeof h.options.onchange=="function"&&h.options.onchange(L,z)},h.addFromFile=function(z){var X=z.type.split("/");if(X[0]==h.options.type){var ie=new FileReader;ie.addEventListener("load",function(me){var se={file:me.srcElement.result,extension:z.name.substr(z.name.lastIndexOf(".")+1),name:z.name,size:z.size,lastmodified:z.lastModified,content:me.srcElement.result};h.add(se)}),ie.readAsDataURL(z)}else alert(u.translate("This extension is not allowed"))},h.addFromUrl=function(z){if(z.substr(0,4)!="data"&&!h.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(z.substr(0,4)=="data"){var X=z.split(";");X=X[0].split("/");var ie=X[0].replace("data:","");if(ie==h.options.type){var me={file:z,name:"",extension:X[1],content:z};h.add(me)}else alert(h.options.text.extensionNotAllowed)}else{var X=z.substr(z.lastIndexOf(".")+1);z=h.options.remoteParser+z,v({url:z,type:"GET",dataType:"blob",success:function(ce){}})}};var K=function(z,X){for(var ie=.92,me=null,se=z.toDataURL(X,ie);h.options.maxJpegSizeBytes&&X==="image/jpeg"&&se.length>h.options.maxJpegSizeBytes&&se.length!==me;)ie*=.9,me=se.length,se=z.toDataURL(X,ie);return se},ee=h.options.type+"/"+h.options.extension,P=document.createElement("input");P.type="file",P.setAttribute("accept",ee),P.onchange=function(){for(var z=0;z<this.files.length;z++)h.addFromFile(this.files[z])},h.options.multiple==!0&&P.setAttribute("multiple",!0);var H=null;return L.addEventListener("click",function(z){H=null,!L.children.length||z.target===L?M.click(P):z.target.parentNode==L&&(H=z.target)}),L.addEventListener("dblclick",function(z){M.click(P)}),L.addEventListener("dragenter",function(z){L.style.border="1px dashed #000"}),L.addEventListener("dragleave",function(z){L.style.border="1px solid #eee"}),L.addEventListener("dragstop",function(z){L.style.border="1px solid #eee"}),L.addEventListener("dragover",function(z){z.preventDefault()}),L.addEventListener("keydown",function(z){if(H&&z.which==46){var X=Array.prototype.indexOf.call(L.children,H);X>=0&&(L.content.splice(X,1),H.remove(),H=null)}}),L.addEventListener("drop",function(z){z.preventDefault(),z.stopPropagation();var X=(z.originalEvent||z).dataTransfer.getData("text/html"),ie=(z.originalEvent||z).dataTransfer.files;if(ie.length)for(var me=0;me<z.dataTransfer.files.length;me++)h.addFromFile(z.dataTransfer.files[me]);else if(X){h.options.multiple==!1&&(L.innerText="");var se=document.createElement("div");se.innerHTML=X;var ce=se.querySelectorAll("img");if(ce.length)for(var me=0;me<ce.length;me++)h.addFromUrl(ce[me].src)}return L.style.border="1px solid #eee",!1}),L.val=function(z){if(z===void 0)return L.content&&L.content.length?L.content:null;if(L.innerText="",L.content=[],z)if(Array.isArray(z))for(var X=0;X<z.length;X++)typeof z[X]=="string"?h.add({file:z[X]}):h.add(z[X]);else typeof z=="string"&&h.add({file:z})},L.upload=L.image=h,h}var fi=o(195),pi=o.n(fi),Dt={...u,...M,version:"5.9.2",setExtensions:function(L){if(typeof L=="object")for(var I=Object.keys(L),h=0;h<I.length;h++)Dt[I[h]]=L[I[h]]},tracking:m,path:g,sorting:p,lazyLoading:b,ajax:v,animation:A,calendar:G,color:ae,contextmenu:Ne,dropdown:le,editor:ze,floating:W,form:Ie,mask:N,modal:Be,notification:et,palette:re,picker:Ye,progressbar:bt,rating:Tt,search:jt,slider:Ut,tabs:fe,tags:bn,toolbar:$e,upload:Yt,validations:Ze};Dt.image=Yt,Dt.image.create=function(L){var I=document.createElement("img");return I.setAttribute("src",L.file),I.className="jfile",I.setAttribute("tabindex",-1),I.content=L,I},Dt.tracker=Ie,Dt.loading=A.loading,Dt.sha512=pi(),typeof document<"u"&&function(){if(typeof window.jSuitesStateControl>"u")window.jSuitesStateControl=[];else return;let L=function(ue,je){return ue[je.type]&&ue[je.type]==je||ue.component&&ue.component==je?!0:ue.parentNode?L(ue.parentNode,je):!1},I=function(ue){let je=window.jSuitesStateControl;if(je&&je.length>0)for(let Y=0;Y<je.length;Y++)je[Y]&&!L(ue,je[Y])&&je[Y].close()},h=15,c=null,B=!1,K={x:null,y:null},ee=document.createElement("div");ee.classList.add("jtooltip");let P=function(ue){return ue&&(ue.shadowRoot||ue.tagName&&ue.tagName.includes("-"))},H=function(ue){let je,Y,q=ue.path||ue.composedPath&&ue.composedPath();return q?(Y=q[0],Y&&P(Y)&&!Y.shadowRoot&&ue.toElement&&(Y=ue.toElement)):(ue.target&&P(ue.target)?je=ue.target.shadowRoot:je=document,Y=je.elementFromPoint(x,y)),Y},z=function(ue){if(ue.changedTouches&&ue.changedTouches[0])var je=ue.changedTouches[0].clientX,Y=ue.changedTouches[0].clientY;else var je=ue.clientX,Y=ue.clientY;let q=H(ue),k=q&&q.tagName==="DIV"&&q.getAttribute("contentEditable"),R=Dt.findElement(q,"jpanel");if(R&&!R.classList.contains("readonly")&&!k){let Z=R.getBoundingClientRect(),de=0;R.style.rotate&&(de=parseFloat(R.style.rotate));let ne="move";q.getAttribute("data-action")?ne=q.getAttribute("data-action"):R.style.cursor?ne="resize":R.style.cursor="move",B={action:ne,a:de,e:R,x:je,y:Y,l:Z.left,t:Z.top,b:Z.bottom,r:Z.right,w:Z.width,h:Z.height,d:R.style.cursor,actioned:!1},R.style.width||(R.style.width=Z.width+"px"),R.style.height||(R.style.height=Z.height+"px")}else B=!1;I(q),Me(ue)},X=function(ue,je,Y,q,k,R){let Z=Y-ue,de=q-je,ne=k-ue,J=R-je,ve=Math.atan2(de,Z),Ce=Math.atan2(J,ne)-ve;return Ce=Ce*(180/Math.PI),Ce<0&&(Ce+=360),Ce},ie=function(ue){B&&B.e&&(typeof B.e.refresh=="function"&&K.actioned&&B.e.refresh(),B.e.style.cursor=""),K={x:null,y:null},B=!1},me=function(ue){if(B){let R=ue.clientX||ue.pageX,Z=ue.clientY||ue.pageY;if(K.x==null&&K.y==null&&(K.x=R,K.y=Z),B.action==="move"){var je=R-K.x,Y=Z-K.y,q=B.e.offsetTop+Y,k=B.e.offsetLeft+je;B.e.style.top=q+"px",B.e.style.left=k+"px",typeof B.e.refresh=="function"&&(K.actioned=!0,B.e.refresh("position",q,k))}else if(B.action==="rotate"){let de=B.l+B.w/2,ne=B.t+B.h/2,J=X(de,ne,B.x,B.y,R,Z);J=J+B.a%360,J=Math.round(J/2)*2,B.e.style.rotate=`${J}deg`,typeof B.e.refresh=="function"&&(K.actioned=!0,B.e.refresh("rotate",J))}else if(B.action==="resize"){let de=null,ne=null,J=null,ve=null;B.d=="e-resize"||B.d=="ne-resize"||B.d=="se-resize"?(J=B.e.offsetWidth+(R-K.x),ue.shiftKey&&(ve=B.e.offsetHeight+(R-K.x)*(B.e.offsetHeight/B.e.offsetWidth))):(B.d==="w-resize"||B.d=="nw-resize"||B.d=="sw-resize")&&(ne=B.e.offsetLeft+(R-K.x),J=B.e.offsetLeft+B.e.offsetWidth-ne,ue.shiftKey&&(ve=B.e.offsetHeight-(R-K.x)*(B.e.offsetHeight/B.e.offsetWidth))),B.d=="s-resize"||B.d=="se-resize"||B.d=="sw-resize"?ve||(ve=B.e.offsetHeight+(Z-K.y)):(B.d==="n-resize"||B.d=="ne-resize"||B.d=="nw-resize")&&(de=B.e.offsetTop+(Z-K.y),ve=B.e.offsetTop+B.e.offsetHeight-de),de&&(B.e.style.top=de+"px"),ne&&(B.e.style.left=ne+"px"),J&&(B.e.style.width=J+"px"),ve&&(B.e.style.height=ve+"px"),typeof B.e.refresh=="function"&&(K.actioned=!0,B.e.refresh("dimensions",J,ve))}K.x=R,K.y=Z}else{let R=H(ue),Z=Dt.findElement(R,"jpanel");if(Z){if(Z.classList.contains("jpanel-controls")){let ne=R.getAttribute("data-position");ne?Z.style.cursor=ne:Z.style.cursor=""}else if(Z.getAttribute("tabindex")){let ne=Z.getBoundingClientRect();ue.clientY-ne.top<h?ne.width-(ue.clientX-ne.left)<h?Z.style.cursor="ne-resize":ue.clientX-ne.left<h?Z.style.cursor="nw-resize":Z.style.cursor="n-resize":ne.height-(ue.clientY-ne.top)<h?ne.width-(ue.clientX-ne.left)<h?Z.style.cursor="se-resize":ue.clientX-ne.left<h?Z.style.cursor="sw-resize":Z.style.cursor="s-resize":ne.width-(ue.clientX-ne.left)<h?Z.style.cursor="e-resize":ue.clientX-ne.left<h?Z.style.cursor="w-resize":Z.style.cursor=""}}}},se=["n","ne","e","se","s","sw","w","nw","rotate"];se.forEach(function(ue,je){se[je]=document.createElement("div"),se[je].classList.add("jpanel-action"),ue==="rotate"?se[je].setAttribute("data-action","rotate"):(se[je].setAttribute("data-action","resize"),se[je].setAttribute("data-position",ue+"-resize"))});let ce,Me=function(ue){let je=H(ue),Y=Dt.findElement(je,"jpanel");Y&&!Y.classList.contains("readonly")&&Y.classList.contains("jpanel-controls")?(Y.append(...se),Y.classList.contains("jpanel-rotate")||se[se.length-1].remove(),ce=Y):Se(ue)},Se=function(ue){ce&&(se.forEach(function(je){je.remove()}),ce=null)},Te=function(ue){var Y=H(ue).getAttribute("data-tooltip");if(Y){if(ee.innerText=Y,ue.changedTouches&&ue.changedTouches[0])var q=ue.changedTouches[0].clientX,k=ue.changedTouches[0].clientY;else var q=ue.clientX,k=ue.clientY;ee.style.top=k+"px",ee.style.left=q+"px",document.body.appendChild(ee)}else ee.innerText&&(ee.innerText="",document.body.removeChild(ee))},Xe=function(ue){var je=document.activeElement;if(je&&typeof je.contextmenu=="function")je.contextmenu(ue),ue.preventDefault(),ue.stopImmediatePropagation();else if(je=Dt.findElement(ue.target,function(q){return q.tagName&&q.getAttribute("aria-contextmenu-id")}),je){var Y=document.querySelector("#"+je);Y?(Y.contextmenu.open(ue),ue.preventDefault(),ue.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+je)}},tt=function(ue){let je=document.activeElement;je&&ue.key==="Delete"&&typeof je.delete=="function"&&(je.delete(),ue.preventDefault(),ue.stopImmediatePropagation());let Y=window.jSuitesStateControl;Y&&Y.length>0&&(je=Y[Y.length-1],je&&ue.key==="Escape"&&typeof je.isOpened=="function"&&typeof je.close=="function"&&je.isOpened()&&(je.close(),ue.preventDefault(),ue.stopImmediatePropagation()))},he=function(ue){(ue.target.getAttribute("data-mask")||ue.target.mask)&&Dt.mask(ue)};document.addEventListener("focusin",Me),document.addEventListener("mouseup",ie),document.addEventListener("mousedown",z),document.addEventListener("mousemove",me),document.addEventListener("mouseover",Te),document.addEventListener("keydown",tt),document.addEventListener("contextmenu",Xe),document.addEventListener("input",he)}();var Rr=Dt})(),e=a.default}(),e})});var yp=jn((exports,module)=>{!jSuites&&typeof _u=="function"&&(jSuites=jp());var jSuites;(function(e,t){typeof exports=="object"&&typeof module<"u"?module.exports=t():typeof define=="function"&&define.amd?define(t):e.jspreadsheet=t()})(exports,function(){var jspreadsheet;return function(){var __webpack_modules__={463:function(e){var t;e.exports=(function(){var n={765:function(E,u){var s;s=function(m){m.version="1.0.2";var T=Math;function M(be,le){for(var Ye=0,$e=0;Ye<be.length;++Ye)$e=le*$e+be[Ye];return $e}function g(be,le,Ye,$e,Ge){if(le===0)return Ye;if(le===1)return $e;for(var ze=2/be,vt=$e,W=1;W<le;++W)vt=$e*W*ze+Ge*Ye,Ye=$e,$e=vt;return vt}function p(be,le,Ye,$e,Ge){return function(ze,vt){if($e){if(ze===0)return $e==1?-1/0:1/0;if(ze<0)return NaN}return vt===0?be(ze):vt===1?le(ze):vt<0?NaN:g(ze,vt|=0,be(ze),le(ze),Ge)}}var b,j,v,C,A,S,D,F,N,_,G,U,re,fe=function(){var be=.636619772,le=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),Ye=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),$e=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),Ge=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function ze(Ie){var Fe=0,Be=0,Ke=0,et=Ie*Ie;if(Ie<8)Fe=(Be=M(le,et))/(Ke=M(Ye,et));else{var bt=Ie-.785398164;Be=M($e,et=64/et),Ke=M(Ge,et),Fe=T.sqrt(be/Ie)*(T.cos(bt)*Be-T.sin(bt)*Ke*8/Ie)}return Fe}var vt=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),W=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),ke=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),Ze=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function Oe(Ie){var Fe=0,Be=0,Ke=0,et=Ie*Ie,bt=T.abs(Ie)-2.356194491;return Math.abs(Ie)<8?Fe=(Be=Ie*M(vt,et))/(Ke=M(W,et)):(Be=M(ke,et=64/et),Ke=M(Ze,et),Fe=T.sqrt(be/T.abs(Ie))*(T.cos(bt)*Be-T.sin(bt)*Ke*8/T.abs(Ie)),Ie<0&&(Fe=-Fe)),Fe}return function Ie(Fe,Be){if(Be=Math.round(Be),!isFinite(Fe))return isNaN(Fe)?Fe:0;if(Be<0)return(Be%2?-1:1)*Ie(Fe,-Be);if(Fe<0)return(Be%2?-1:1)*Ie(-Fe,Be);if(Be===0)return ze(Fe);if(Be===1)return Oe(Fe);if(Fe===0)return 0;var Ke=0;if(Fe>Be)Ke=g(Fe,Be,ze(Fe),Oe(Fe),-1);else{for(var et=!1,bt=0,Tt=0,jt=1,Ut=0,bn=2/Fe,Yt=2*T.floor((Be+T.floor(T.sqrt(40*Be)))/2);Yt>0;Yt--)Ut=Yt*bn*jt-bt,bt=jt,jt=Ut,T.abs(jt)>1e10&&(jt*=1e-10,bt*=1e-10,Ke*=1e-10,Tt*=1e-10),et&&(Tt+=jt),et=!et,Yt==Be&&(Ke=bt);Ke/=Tt=2*Tt-jt}return Ke}}(),ae=(b=.636619772,j=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),v=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),C=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),A=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),S=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),D=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),F=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),N=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),p(function(be){var le=0,Ye=0,$e=0,Ge=be*be,ze=be-.785398164;return be<8?le=(Ye=M(j,Ge))/($e=M(v,Ge))+b*fe(be,0)*T.log(be):(Ye=M(C,Ge=64/Ge),$e=M(A,Ge),le=T.sqrt(b/be)*(T.sin(ze)*Ye+T.cos(ze)*$e*8/be)),le},function(be){var le=0,Ye=0,$e=0,Ge=be*be,ze=be-2.356194491;return be<8?le=(Ye=be*M(S,Ge))/($e=M(D,Ge))+b*(fe(be,1)*T.log(be)-1/be):(Ye=M(F,Ge=64/Ge),$e=M(N,Ge),le=T.sqrt(b/be)*(T.sin(ze)*Ye+T.cos(ze)*$e*8/be)),le},0,1,-1)),ye=(_=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),G=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),U=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),re=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function be(le,Ye){if((Ye=Math.round(Ye))===0)return function(Ze){return Ze<=3.75?M(_,Ze*Ze/14.0625):T.exp(T.abs(Ze))/T.sqrt(T.abs(Ze))*M(G,3.75/T.abs(Ze))}(le);if(Ye===1)return function(Ze){return Ze<3.75?Ze*M(U,Ze*Ze/14.0625):(Ze<0?-1:1)*T.exp(T.abs(Ze))/T.sqrt(T.abs(Ze))*M(re,3.75/T.abs(Ze))}(le);if(Ye<0)return NaN;if(T.abs(le)===0)return 0;if(le==1/0)return 1/0;var $e,Ge=0,ze=2/T.abs(le),vt=0,W=1,ke=0;for($e=2*T.round((Ye+T.round(T.sqrt(40*Ye)))/2);$e>0;$e--)ke=$e*ze*W+vt,vt=W,W=ke,T.abs(W)>1e10&&(W*=1e-10,vt*=1e-10,Ge*=1e-10),$e==Ye&&(Ge=vt);return Ge*=be(le,0)/W,le<0&&Ye%2?-Ge:Ge}),Ne=function(){var be=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),le=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),Ye=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),$e=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return p(function(Ge){return Ge<=2?-T.log(Ge/2)*ye(Ge,0)+M(be,Ge*Ge/4):T.exp(-Ge)/T.sqrt(Ge)*M(le,2/Ge)},function(Ge){return Ge<=2?T.log(Ge/2)*ye(Ge,1)+1/Ge*M(Ye,Ge*Ge/4):T.exp(-Ge)/T.sqrt(Ge)*M($e,2/Ge)},0,2,1)}();m.besselj=fe,m.bessely=ae,m.besseli=ye,m.besselk=Ne},s(typeof DO_NOT_EXPORT_BESSEL>"u"?u:{})},162:function(E){var u;E.exports=(u=function(s,m){var T=Array.prototype.concat,M=Array.prototype.slice,g=Object.prototype.toString;function p(N,_){var G=N>_?N:_;return s.pow(10,17-~~(s.log(G>0?G:-G)*s.LOG10E))}var b=Array.isArray||function(N){return g.call(N)==="[object Array]"};function j(N){return g.call(N)==="[object Function]"}function v(N){return typeof N=="number"&&N-N==0}function C(){return new C._init(arguments)}function A(){return 0}function S(){return 1}function D(N,_){return N===_?1:0}C.fn=C.prototype,C._init=function(N){if(b(N[0]))if(b(N[0][0])){j(N[1])&&(N[0]=C.map(N[0],N[1]));for(var _=0;_<N[0].length;_++)this[_]=N[0][_];this.length=N[0].length}else this[0]=j(N[1])?C.map(N[0],N[1]):N[0],this.length=1;else if(v(N[0]))this[0]=C.seq.apply(null,N),this.length=1;else{if(N[0]instanceof C)return C(N[0].toArray());this[0]=[],this.length=1}return this},C._init.prototype=C.prototype,C._init.constructor=C,C.utils={calcRdx:p,isArray:b,isFunction:j,isNumber:v,toVector:function(N){return T.apply([],N)}},C._random_fn=s.random,C.setRandom=function(N){if(typeof N!="function")throw new TypeError("fn is not a function");C._random_fn=N},C.extend=function(N){var _,G;if(arguments.length===1){for(G in N)C[G]=N[G];return this}for(_=1;_<arguments.length;_++)for(G in arguments[_])N[G]=arguments[_][G];return N},C.rows=function(N){return N.length||1},C.cols=function(N){return N[0].length||1},C.dimensions=function(N){return{rows:C.rows(N),cols:C.cols(N)}},C.row=function(N,_){return b(_)?_.map(function(G){return C.row(N,G)}):N[_]},C.rowa=function(N,_){return C.row(N,_)},C.col=function(N,_){if(b(_)){var G=C.arange(N.length).map(function(){return new Array(_.length)});return _.forEach(function(fe,ae){C.arange(N.length).forEach(function(ye){G[ye][ae]=N[ye][fe]})}),G}for(var U=new Array(N.length),re=0;re<N.length;re++)U[re]=[N[re][_]];return U},C.cola=function(N,_){return C.col(N,_).map(function(G){return G[0]})},C.diag=function(N){for(var _=C.rows(N),G=new Array(_),U=0;U<_;U++)G[U]=[N[U][U]];return G},C.antidiag=function(N){for(var _=C.rows(N)-1,G=new Array(_),U=0;_>=0;_--,U++)G[U]=[N[U][_]];return G},C.transpose=function(N){var _,G,U,re,fe,ae=[];for(b(N[0])||(N=[N]),G=N.length,U=N[0].length,fe=0;fe<U;fe++){for(_=new Array(G),re=0;re<G;re++)_[re]=N[re][fe];ae.push(_)}return ae.length===1?ae[0]:ae},C.map=function(N,_,G){var U,re,fe,ae,ye;for(b(N[0])||(N=[N]),re=N.length,fe=N[0].length,ae=G?N:new Array(re),U=0;U<re;U++)for(ae[U]||(ae[U]=new Array(fe)),ye=0;ye<fe;ye++)ae[U][ye]=_(N[U][ye],U,ye);return ae.length===1?ae[0]:ae},C.cumreduce=function(N,_,G){var U,re,fe,ae,ye;for(b(N[0])||(N=[N]),re=N.length,fe=N[0].length,ae=G?N:new Array(re),U=0;U<re;U++)for(ae[U]||(ae[U]=new Array(fe)),fe>0&&(ae[U][0]=N[U][0]),ye=1;ye<fe;ye++)ae[U][ye]=_(ae[U][ye-1],N[U][ye]);return ae.length===1?ae[0]:ae},C.alter=function(N,_){return C.map(N,_,!0)},C.create=function(N,_,G){var U,re,fe=new Array(N);for(j(_)&&(G=_,_=N),U=0;U<N;U++)for(fe[U]=new Array(_),re=0;re<_;re++)fe[U][re]=G(U,re);return fe},C.zeros=function(N,_){return v(_)||(_=N),C.create(N,_,A)},C.ones=function(N,_){return v(_)||(_=N),C.create(N,_,S)},C.rand=function(N,_){return v(_)||(_=N),C.create(N,_,C._random_fn)},C.identity=function(N,_){return v(_)||(_=N),C.create(N,_,D)},C.symmetric=function(N){var _,G,U=N.length;if(N.length!==N[0].length)return!1;for(_=0;_<U;_++)for(G=0;G<U;G++)if(N[G][_]!==N[_][G])return!1;return!0},C.clear=function(N){return C.alter(N,A)},C.seq=function(N,_,G,U){j(U)||(U=!1);var re,fe=[],ae=p(N,_),ye=(_*ae-N*ae)/((G-1)*ae),Ne=N;for(re=0;Ne<=_&&re<G;Ne=(N*ae+ye*ae*++re)/ae)fe.push(U?U(Ne,re):Ne);return fe},C.arange=function(N,_,G){var U,re=[];if(G=G||1,_===m&&(_=N,N=0),N===_||G===0)return[];if(N<_&&G<0)return[];if(N>_&&G>0)return[];if(G>0)for(U=N;U<_;U+=G)re.push(U);else for(U=N;U>_;U+=G)re.push(U);return re},C.slice=function(){function N(_,G,U,re){var fe,ae=[],ye=_.length;if(G===m&&U===m&&re===m)return C.copy(_);if(re=re||1,(G=(G=G||0)>=0?G:ye+G)===(U=(U=U||_.length)>=0?U:ye+U)||re===0)return[];if(G<U&&re<0)return[];if(G>U&&re>0)return[];if(re>0)for(fe=G;fe<U;fe+=re)ae.push(_[fe]);else for(fe=G;fe>U;fe+=re)ae.push(_[fe]);return ae}return function(_,G){var U,re;return v((G=G||{}).row)?v(G.col)?_[G.row][G.col]:N(C.rowa(_,G.row),(U=G.col||{}).start,U.end,U.step):v(G.col)?N(C.cola(_,G.col),(re=G.row||{}).start,re.end,re.step):(re=G.row||{},U=G.col||{},N(_,re.start,re.end,re.step).map(function(fe){return N(fe,U.start,U.end,U.step)}))}}(),C.sliceAssign=function(N,_,G){var U,re;if(v(_.row)){if(v(_.col))return N[_.row][_.col]=G;_.col=_.col||{},_.col.start=_.col.start||0,_.col.end=_.col.end||N[0].length,_.col.step=_.col.step||1,U=C.arange(_.col.start,s.min(N.length,_.col.end),_.col.step);var fe=_.row;return U.forEach(function(ye,Ne){N[fe][ye]=G[Ne]}),N}if(v(_.col)){_.row=_.row||{},_.row.start=_.row.start||0,_.row.end=_.row.end||N.length,_.row.step=_.row.step||1,re=C.arange(_.row.start,s.min(N[0].length,_.row.end),_.row.step);var ae=_.col;return re.forEach(function(ye,Ne){N[ye][ae]=G[Ne]}),N}return G[0].length===m&&(G=[G]),_.row.start=_.row.start||0,_.row.end=_.row.end||N.length,_.row.step=_.row.step||1,_.col.start=_.col.start||0,_.col.end=_.col.end||N[0].length,_.col.step=_.col.step||1,re=C.arange(_.row.start,s.min(N.length,_.row.end),_.row.step),U=C.arange(_.col.start,s.min(N[0].length,_.col.end),_.col.step),re.forEach(function(ye,Ne){U.forEach(function(be,le){N[ye][be]=G[Ne][le]})}),N},C.diagonal=function(N){var _=C.zeros(N.length,N.length);return N.forEach(function(G,U){_[U][U]=G}),_},C.copy=function(N){return N.map(function(_){return v(_)?_:_.map(function(G){return G})})};var F=C.prototype;return F.length=0,F.push=Array.prototype.push,F.sort=Array.prototype.sort,F.splice=Array.prototype.splice,F.slice=Array.prototype.slice,F.toArray=function(){return this.length>1?M.call(this):M.call(this)[0]},F.map=function(N,_){return C(C.map(this,N,_))},F.cumreduce=function(N,_){return C(C.cumreduce(this,N,_))},F.alter=function(N){return C.alter(this,N),this},function(N){for(var _=0;_<N.length;_++)(function(G){F[G]=function(U){var re,fe=this;return U?(setTimeout(function(){U.call(fe,F[G].call(fe))}),this):(re=C[G](this),b(re)?C(re):re)}})(N[_])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(N){for(var _=0;_<N.length;_++)(function(G){F[G]=function(U,re){var fe=this;return re?(setTimeout(function(){re.call(fe,F[G].call(fe,U))}),this):C(C[G](this,U))}})(N[_])}("row col".split(" ")),function(N){for(var _=0;_<N.length;_++)(function(G){F[G]=function(){return C(C[G].apply(null,arguments))}})(N[_])}("create zeros ones rand identity".split(" ")),C}(Math),function(s,m){var T=s.utils.isFunction;function M(b,j){return b-j}function g(b,j,v){return m.max(j,m.min(b,v))}s.sum=function(b){for(var j=0,v=b.length;--v>=0;)j+=b[v];return j},s.sumsqrd=function(b){for(var j=0,v=b.length;--v>=0;)j+=b[v]*b[v];return j},s.sumsqerr=function(b){for(var j,v=s.mean(b),C=0,A=b.length;--A>=0;)C+=(j=b[A]-v)*j;return C},s.sumrow=function(b){for(var j=0,v=b.length;--v>=0;)j+=b[v];return j},s.product=function(b){for(var j=1,v=b.length;--v>=0;)j*=b[v];return j},s.min=function(b){for(var j=b[0],v=0;++v<b.length;)b[v]<j&&(j=b[v]);return j},s.max=function(b){for(var j=b[0],v=0;++v<b.length;)b[v]>j&&(j=b[v]);return j},s.unique=function(b){for(var j={},v=[],C=0;C<b.length;C++)j[b[C]]||(j[b[C]]=!0,v.push(b[C]));return v},s.mean=function(b){return s.sum(b)/b.length},s.meansqerr=function(b){return s.sumsqerr(b)/b.length},s.geomean=function(b){var j=b.map(m.log),v=s.mean(j);return m.exp(v)},s.median=function(b){var j=b.length,v=b.slice().sort(M);return 1&j?v[j/2|0]:(v[j/2-1]+v[j/2])/2},s.cumsum=function(b){return s.cumreduce(b,function(j,v){return j+v})},s.cumprod=function(b){return s.cumreduce(b,function(j,v){return j*v})},s.diff=function(b){var j,v=[],C=b.length;for(j=1;j<C;j++)v.push(b[j]-b[j-1]);return v},s.rank=function(b){var j,v=[],C={};for(j=0;j<b.length;j++)C[F=b[j]]?C[F]++:(C[F]=1,v.push(F));var A=v.sort(M),S={},D=1;for(j=0;j<A.length;j++){var F,N=C[F=A[j]],_=(D+(D+N-1))/2;S[F]=_,D+=N}return b.map(function(G){return S[G]})},s.mode=function(b){var j,v=b.length,C=b.slice().sort(M),A=1,S=0,D=0,F=[];for(j=0;j<v;j++)C[j]===C[j+1]?A++:(A>S?(F=[C[j]],S=A,D=0):A===S&&(F.push(C[j]),D++),A=1);return D===0?F[0]:F},s.range=function(b){return s.max(b)-s.min(b)},s.variance=function(b,j){return s.sumsqerr(b)/(b.length-(j?1:0))},s.pooledvariance=function(b){return b.reduce(function(j,v){return j+s.sumsqerr(v)},0)/(b.reduce(function(j,v){return j+v.length},0)-b.length)},s.deviation=function(b){for(var j=s.mean(b),v=b.length,C=new Array(v),A=0;A<v;A++)C[A]=b[A]-j;return C},s.stdev=function(b,j){return m.sqrt(s.variance(b,j))},s.pooledstdev=function(b){return m.sqrt(s.pooledvariance(b))},s.meandev=function(b){for(var j=s.mean(b),v=[],C=b.length-1;C>=0;C--)v.push(m.abs(b[C]-j));return s.mean(v)},s.meddev=function(b){for(var j=s.median(b),v=[],C=b.length-1;C>=0;C--)v.push(m.abs(b[C]-j));return s.median(v)},s.coeffvar=function(b){return s.stdev(b)/s.mean(b)},s.quartiles=function(b){var j=b.length,v=b.slice().sort(M);return[v[m.round(j/4)-1],v[m.round(j/2)-1],v[m.round(3*j/4)-1]]},s.quantiles=function(b,j,v,C){var A,S,D,F,N,_=b.slice().sort(M),G=[j.length],U=b.length;for(v===void 0&&(v=.375),C===void 0&&(C=.375),A=0;A<j.length;A++)D=U*(S=j[A])+(v+S*(1-v-C)),F=m.floor(g(D,1,U-1)),N=g(D-F,0,1),G[A]=(1-N)*_[F-1]+N*_[F];return G},s.percentile=function(b,j,v){var C=b.slice().sort(M),A=j*(C.length+(v?1:-1))+(v?0:1),S=parseInt(A),D=A-S;return S+1<C.length?C[S-1]+D*(C[S]-C[S-1]):C[S-1]},s.percentileOfScore=function(b,j,v){var C,A,S=0,D=b.length,F=!1;for(v==="strict"&&(F=!0),A=0;A<D;A++)C=b[A],(F&&C<j||!F&&C<=j)&&S++;return S/D},s.histogram=function(b,j){j=j||4;var v,C=s.min(b),A=(s.max(b)-C)/j,S=b.length,D=[];for(v=0;v<j;v++)D[v]=0;for(v=0;v<S;v++)D[m.min(m.floor((b[v]-C)/A),j-1)]+=1;return D},s.covariance=function(b,j){var v,C=s.mean(b),A=s.mean(j),S=b.length,D=new Array(S);for(v=0;v<S;v++)D[v]=(b[v]-C)*(j[v]-A);return s.sum(D)/(S-1)},s.corrcoeff=function(b,j){return s.covariance(b,j)/s.stdev(b,1)/s.stdev(j,1)},s.spearmancoeff=function(b,j){return b=s.rank(b),j=s.rank(j),s.corrcoeff(b,j)},s.stanMoment=function(b,j){for(var v=s.mean(b),C=s.stdev(b),A=b.length,S=0,D=0;D<A;D++)S+=m.pow((b[D]-v)/C,j);return S/b.length},s.skewness=function(b){return s.stanMoment(b,3)},s.kurtosis=function(b){return s.stanMoment(b,4)-3};var p=s.prototype;(function(b){for(var j=0;j<b.length;j++)(function(v){p[v]=function(C,A){var S=[],D=0,F=this;if(T(C)&&(A=C,C=!1),A)return setTimeout(function(){A.call(F,p[v].call(F,C))}),this;if(this.length>1){for(F=C===!0?this:this.transpose();D<F.length;D++)S[D]=s[v](F[D]);return S}return s[v](this[0],C)}})(b[j])})("cumsum cumprod".split(" ")),function(b){for(var j=0;j<b.length;j++)(function(v){p[v]=function(C,A){var S=[],D=0,F=this;if(T(C)&&(A=C,C=!1),A)return setTimeout(function(){A.call(F,p[v].call(F,C))}),this;if(this.length>1){for(v!=="sumrow"&&(F=C===!0?this:this.transpose());D<F.length;D++)S[D]=s[v](F[D]);return C===!0?s[v](s.utils.toVector(S)):S}return s[v](this[0],C)}})(b[j])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(b){for(var j=0;j<b.length;j++)(function(v){p[v]=function(){var C,A=[],S=0,D=this,F=Array.prototype.slice.call(arguments);if(T(F[F.length-1])){C=F[F.length-1];var N=F.slice(0,F.length-1);return setTimeout(function(){C.call(D,p[v].apply(D,N))}),this}C=void 0;var _=function(G){return s[v].apply(D,[G].concat(F))};if(this.length>1){for(D=D.transpose();S<D.length;S++)A[S]=_(D[S]);return A}return _(this[0])}})(b[j])}("quantiles percentileOfScore".split(" "))}(u,Math),function(s,m){s.gammaln=function(T){var M,g,p,b=0,j=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],v=1.000000000190015;for(p=(g=M=T)+5.5,p-=(M+.5)*m.log(p);b<6;b++)v+=j[b]/++g;return m.log(2.5066282746310007*v/M)-p},s.loggam=function(T){var M,g,p,b,j,v,C,A=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(M=T,C=0,T==1||T==2)return 0;for(T<=7&&(M=T+(C=m.floor(7-T))),g=1/(M*M),p=2*m.PI,j=A[9],v=8;v>=0;v--)j*=g,j+=A[v];if(b=j/M+.5*m.log(p)+(M-.5)*m.log(M)-M,T<=7)for(v=1;v<=C;v++)b-=m.log(M-1),M-=1;return b},s.gammafn=function(T){var M,g,p,b,j=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],v=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],C=!1,A=0,S=0,D=0,F=T;if(T>171.6243769536076)return 1/0;if(F<=0){if(!(b=F%1+36e-17))return 1/0;C=(1&F?-1:1)*m.PI/m.sin(m.PI*b),F=1-F}for(p=F,g=F<1?F++:(F-=A=(0|F)-1)-1,M=0;M<8;++M)D=(D+j[M])*g,S=S*g+v[M];if(b=D/S+1,p<F)b/=p;else if(p>F)for(M=0;M<A;++M)b*=F,F++;return C&&(b=C/b),b},s.gammap=function(T,M){return s.lowRegGamma(T,M)*s.gammafn(T)},s.lowRegGamma=function(T,M){var g,p=s.gammaln(T),b=T,j=1/T,v=j,C=M+1-T,A=1/1e-30,S=1/C,D=S,F=1,N=-~(8.5*m.log(T>=1?T:1/T)+.4*T+17);if(M<0||T<=0)return NaN;if(M<T+1){for(;F<=N;F++)j+=v*=M/++b;return j*m.exp(-M+T*m.log(M)-p)}for(;F<=N;F++)D*=(S=1/(S=(g=-F*(F-T))*S+(C+=2)))*(A=C+g/A);return 1-D*m.exp(-M+T*m.log(M)-p)},s.factorialln=function(T){return T<0?NaN:s.gammaln(T+1)},s.factorial=function(T){return T<0?NaN:s.gammafn(T+1)},s.combination=function(T,M){return T>170||M>170?m.exp(s.combinationln(T,M)):s.factorial(T)/s.factorial(M)/s.factorial(T-M)},s.combinationln=function(T,M){return s.factorialln(T)-s.factorialln(M)-s.factorialln(T-M)},s.permutation=function(T,M){return s.factorial(T)/s.factorial(T-M)},s.betafn=function(T,M){if(!(T<=0||M<=0))return T+M>170?m.exp(s.betaln(T,M)):s.gammafn(T)*s.gammafn(M)/s.gammafn(T+M)},s.betaln=function(T,M){return s.gammaln(T)+s.gammaln(M)-s.gammaln(T+M)},s.betacf=function(T,M,g){var p,b,j,v,C=1e-30,A=1,S=M+g,D=M+1,F=M-1,N=1,_=1-S*T/D;for(m.abs(_)<C&&(_=C),v=_=1/_;A<=100&&(_=1+(b=A*(g-A)*T/((F+(p=2*A))*(M+p)))*_,m.abs(_)<C&&(_=C),N=1+b/N,m.abs(N)<C&&(N=C),v*=(_=1/_)*N,_=1+(b=-(M+A)*(S+A)*T/((M+p)*(D+p)))*_,m.abs(_)<C&&(_=C),N=1+b/N,m.abs(N)<C&&(N=C),v*=j=(_=1/_)*N,!(m.abs(j-1)<3e-7));A++);return v},s.gammapinv=function(T,M){var g,p,b,j,v,C,A=0,S=M-1,D=s.gammaln(M);if(T>=1)return m.max(100,M+100*m.sqrt(M));if(T<=0)return 0;for(M>1?(v=m.log(S),C=m.exp(S*(v-1)-D),j=T<.5?T:1-T,g=(2.30753+.27061*(p=m.sqrt(-2*m.log(j))))/(1+p*(.99229+.04481*p))-p,T<.5&&(g=-g),g=m.max(.001,M*m.pow(1-1/(9*M)-g/(3*m.sqrt(M)),3))):g=T<(p=1-M*(.253+.12*M))?m.pow(T/p,1/M):1-m.log(1-(T-p)/(1-p));A<12;A++){if(g<=0)return 0;if((g-=p=(b=(s.lowRegGamma(M,g)-T)/(p=M>1?C*m.exp(-(g-S)+S*(m.log(g)-v)):m.exp(-g+S*m.log(g)-D)))/(1-.5*m.min(1,b*((M-1)/g-1))))<=0&&(g=.5*(g+p)),m.abs(p)<1e-8*g)break}return g},s.erf=function(T){var M,g,p,b,j=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],v=j.length-1,C=!1,A=0,S=0;for(T<0&&(T=-T,C=!0),g=4*(M=2/(2+T))-2;v>0;v--)p=A,A=g*A-S+j[v],S=p;return b=M*m.exp(-T*T+.5*(j[0]+g*A)-S),C?b-1:1-b},s.erfc=function(T){return 1-s.erf(T)},s.erfcinv=function(T){var M,g,p,b,j=0;if(T>=2)return-100;if(T<=0)return 100;for(b=T<1?T:2-T,M=-.70711*((2.30753+.27061*(p=m.sqrt(-2*m.log(b/2))))/(1+p*(.99229+.04481*p))-p);j<2;j++)M+=(g=s.erfc(M)-b)/(1.1283791670955126*m.exp(-M*M)-M*g);return T<1?M:-M},s.ibetainv=function(T,M,g){var p,b,j,v,C,A,S,D,F,N,_=M-1,G=g-1,U=0;if(T<=0)return 0;if(T>=1)return 1;for(M>=1&&g>=1?(j=T<.5?T:1-T,A=(2.30753+.27061*(v=m.sqrt(-2*m.log(j))))/(1+v*(.99229+.04481*v))-v,T<.5&&(A=-A),S=(A*A-3)/6,D=2/(1/(2*M-1)+1/(2*g-1)),F=A*m.sqrt(S+D)/D-(1/(2*g-1)-1/(2*M-1))*(S+.8333333333333334-2/(3*D)),A=M/(M+g*m.exp(2*F))):(p=m.log(M/(M+g)),b=m.log(g/(M+g)),A=T<(v=m.exp(M*p)/M)/(F=v+(C=m.exp(g*b)/g))?m.pow(M*F*T,1/M):1-m.pow(g*F*(1-T),1/g)),N=-s.gammaln(M)-s.gammaln(g)+s.gammaln(M+g);U<10;U++){if(A===0||A===1)return A;if((A-=v=(C=(s.ibeta(A,M,g)-T)/(v=m.exp(_*m.log(A)+G*m.log(1-A)+N)))/(1-.5*m.min(1,C*(_/A-G/(1-A)))))<=0&&(A=.5*(A+v)),A>=1&&(A=.5*(A+v+1)),m.abs(v)<1e-8*A&&U>0)break}return A},s.ibeta=function(T,M,g){var p=T===0||T===1?0:m.exp(s.gammaln(M+g)-s.gammaln(M)-s.gammaln(g)+M*m.log(T)+g*m.log(1-T));return!(T<0||T>1)&&(T<(M+1)/(M+g+2)?p*s.betacf(T,M,g)/M:1-p*s.betacf(1-T,g,M)/g)},s.randn=function(T,M){var g,p,b,j,v;if(M||(M=T),T)return s.create(T,M,function(){return s.randn()});do g=s._random_fn(),p=1.7156*(s._random_fn()-.5),v=(b=g-.449871)*b+(j=m.abs(p)+.386595)*(.196*j-.25472*b);while(v>.27597&&(v>.27846||p*p>-4*m.log(g)*g*g));return p/g},s.randg=function(T,M,g){var p,b,j,v,C,A,S=T;if(g||(g=M),T||(T=1),M)return(A=s.zeros(M,g)).alter(function(){return s.randg(T)}),A;T<1&&(T+=1),p=T-.3333333333333333,b=1/m.sqrt(9*p);do{do v=1+b*(C=s.randn());while(v<=0);v*=v*v,j=s._random_fn()}while(j>1-.331*m.pow(C,4)&&m.log(j)>.5*C*C+p*(1-v+m.log(v)));if(T==S)return p*v;do j=s._random_fn();while(j===0);return m.pow(j,1/S)*p*v},function(T){for(var M=0;M<T.length;M++)(function(g){s.fn[g]=function(){return s(s.map(this,function(p){return s[g](p)}))}})(T[M])}("gammaln gammafn factorial factorialln".split(" ")),function(T){for(var M=0;M<T.length;M++)(function(g){s.fn[g]=function(){return s(s[g].apply(null,arguments))}})(T[M])}("randn".split(" "))}(u,Math),function(s,m){function T(g,p,b,j){for(var v,C=0,A=1,S=1,D=1,F=0,N=0;m.abs((S-N)/S)>j;)N=S,A=D+(v=-(p+F)*(p+b+F)*g/(p+2*F)/(p+2*F+1))*A,S=(C=S+v*C)+(v=(F+=1)*(b-F)*g/(p+2*F-1)/(p+2*F))*S,C/=D=A+v*D,A/=D,S/=D,D=1;return S/p}function M(g,p,b){var j=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],v=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],C=.5*g;if(C>=8)return 1;var A,S=2*s.normal.cdf(C,0,1,1,0)-1;S=S>=m.exp(-50/b)?m.pow(S,b):0;for(var D=C,F=(8-C)/(A=g>3?2:3),N=D+F,_=0,G=b-1,U=1;U<=A;U++){for(var re=0,fe=.5*(N+D),ae=.5*(N-D),ye=1;ye<=12;ye++){var Ne,be=fe+ae*(6<ye?j[(Ne=12-ye+1)-1]:-j[(Ne=ye)-1]),le=be*be;if(le>60)break;var Ye=2*s.normal.cdf(be,0,1,1,0)*.5-2*s.normal.cdf(be,g,1,1,0)*.5;Ye>=m.exp(-30/G)&&(re+=Ye=v[Ne-1]*m.exp(-.5*le)*m.pow(Ye,G))}_+=re*=2*ae*b/m.sqrt(2*m.PI),D=N,N+=F}return(S+=_)<=m.exp(-30/p)?0:(S=m.pow(S,p))>=1?1:S}(function(g){for(var p=0;p<g.length;p++)(function(b){s[b]=function j(v,C,A){return this instanceof j?(this._a=v,this._b=C,this._c=A,this):new j(v,C,A)},s.fn[b]=function(j,v,C){var A=s[b](j,v,C);return A.data=this,A},s[b].prototype.sample=function(j){var v=this._a,C=this._b,A=this._c;return j?s.alter(j,function(){return s[b].sample(v,C,A)}):s[b].sample(v,C,A)},function(j){for(var v=0;v<j.length;v++)(function(C){s[b].prototype[C]=function(A){var S=this._a,D=this._b,F=this._c;return A||A===0||(A=this.data),typeof A!="number"?s.fn.map.call(A,function(N){return s[b][C](N,S,D,F)}):s[b][C](A,S,D,F)}})(j[v])}("pdf cdf inv".split(" ")),function(j){for(var v=0;v<j.length;v++)(function(C){s[b].prototype[C]=function(){return s[b][C](this._a,this._b,this._c)}})(j[v])}("mean median mode variance".split(" "))})(g[p])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),s.extend(s.beta,{pdf:function(g,p,b){return g>1||g<0?0:p==1&&b==1?1:p<512&&b<512?m.pow(g,p-1)*m.pow(1-g,b-1)/s.betafn(p,b):m.exp((p-1)*m.log(g)+(b-1)*m.log(1-g)-s.betaln(p,b))},cdf:function(g,p,b){return g>1||g<0?1*(g>1):s.ibeta(g,p,b)},inv:function(g,p,b){return s.ibetainv(g,p,b)},mean:function(g,p){return g/(g+p)},median:function(g,p){return s.ibetainv(.5,g,p)},mode:function(g,p){return(g-1)/(g+p-2)},sample:function(g,p){var b=s.randg(g);return b/(b+s.randg(p))},variance:function(g,p){return g*p/(m.pow(g+p,2)*(g+p+1))}}),s.extend(s.centralF,{pdf:function(g,p,b){var j;return g<0?0:p<=2?g===0&&p<2?1/0:g===0&&p===2?1:1/s.betafn(p/2,b/2)*m.pow(p/b,p/2)*m.pow(g,p/2-1)*m.pow(1+p/b*g,-(p+b)/2):(j=p*g/(b+g*p),p*(b/(b+g*p))/2*s.binomial.pdf((p-2)/2,(p+b-2)/2,j))},cdf:function(g,p,b){return g<0?0:s.ibeta(p*g/(p*g+b),p/2,b/2)},inv:function(g,p,b){return b/(p*(1/s.ibetainv(g,p/2,b/2)-1))},mean:function(g,p){return p>2?p/(p-2):void 0},mode:function(g,p){return g>2?p*(g-2)/(g*(p+2)):void 0},sample:function(g,p){return 2*s.randg(g/2)/g/(2*s.randg(p/2)/p)},variance:function(g,p){if(!(p<=4))return 2*p*p*(g+p-2)/(g*(p-2)*(p-2)*(p-4))}}),s.extend(s.cauchy,{pdf:function(g,p,b){return b<0?0:b/(m.pow(g-p,2)+m.pow(b,2))/m.PI},cdf:function(g,p,b){return m.atan((g-p)/b)/m.PI+.5},inv:function(g,p,b){return p+b*m.tan(m.PI*(g-.5))},median:function(g){return g},mode:function(g){return g},sample:function(g,p){return s.randn()*m.sqrt(1/(2*s.randg(.5)))*p+g}}),s.extend(s.chisquare,{pdf:function(g,p){return g<0?0:g===0&&p===2?.5:m.exp((p/2-1)*m.log(g)-g/2-p/2*m.log(2)-s.gammaln(p/2))},cdf:function(g,p){return g<0?0:s.lowRegGamma(p/2,g/2)},inv:function(g,p){return 2*s.gammapinv(g,.5*p)},mean:function(g){return g},median:function(g){return g*m.pow(1-2/(9*g),3)},mode:function(g){return g-2>0?g-2:0},sample:function(g){return 2*s.randg(g/2)},variance:function(g){return 2*g}}),s.extend(s.exponential,{pdf:function(g,p){return g<0?0:p*m.exp(-p*g)},cdf:function(g,p){return g<0?0:1-m.exp(-p*g)},inv:function(g,p){return-m.log(1-g)/p},mean:function(g){return 1/g},median:function(g){return 1/g*m.log(2)},mode:function(){return 0},sample:function(g){return-1/g*m.log(s._random_fn())},variance:function(g){return m.pow(g,-2)}}),s.extend(s.gamma,{pdf:function(g,p,b){return g<0?0:g===0&&p===1?1/b:m.exp((p-1)*m.log(g)-g/b-s.gammaln(p)-p*m.log(b))},cdf:function(g,p,b){return g<0?0:s.lowRegGamma(p,g/b)},inv:function(g,p,b){return s.gammapinv(g,p)*b},mean:function(g,p){return g*p},mode:function(g,p){if(g>1)return(g-1)*p},sample:function(g,p){return s.randg(g)*p},variance:function(g,p){return g*p*p}}),s.extend(s.invgamma,{pdf:function(g,p,b){return g<=0?0:m.exp(-(p+1)*m.log(g)-b/g-s.gammaln(p)+p*m.log(b))},cdf:function(g,p,b){return g<=0?0:1-s.lowRegGamma(p,b/g)},inv:function(g,p,b){return b/s.gammapinv(1-g,p)},mean:function(g,p){return g>1?p/(g-1):void 0},mode:function(g,p){return p/(g+1)},sample:function(g,p){return p/s.randg(g)},variance:function(g,p){if(!(g<=2))return p*p/((g-1)*(g-1)*(g-2))}}),s.extend(s.kumaraswamy,{pdf:function(g,p,b){return g===0&&p===1?b:g===1&&b===1?p:m.exp(m.log(p)+m.log(b)+(p-1)*m.log(g)+(b-1)*m.log(1-m.pow(g,p)))},cdf:function(g,p,b){return g<0?0:g>1?1:1-m.pow(1-m.pow(g,p),b)},inv:function(g,p,b){return m.pow(1-m.pow(1-g,1/b),1/p)},mean:function(g,p){return p*s.gammafn(1+1/g)*s.gammafn(p)/s.gammafn(1+1/g+p)},median:function(g,p){return m.pow(1-m.pow(2,-1/p),1/g)},mode:function(g,p){if(g>=1&&p>=1&&g!==1&&p!==1)return m.pow((g-1)/(g*p-1),1/g)},variance:function(){throw new Error("variance not yet implemented")}}),s.extend(s.lognormal,{pdf:function(g,p,b){return g<=0?0:m.exp(-m.log(g)-.5*m.log(2*m.PI)-m.log(b)-m.pow(m.log(g)-p,2)/(2*b*b))},cdf:function(g,p,b){return g<0?0:.5+.5*s.erf((m.log(g)-p)/m.sqrt(2*b*b))},inv:function(g,p,b){return m.exp(-1.4142135623730951*b*s.erfcinv(2*g)+p)},mean:function(g,p){return m.exp(g+p*p/2)},median:function(g){return m.exp(g)},mode:function(g,p){return m.exp(g-p*p)},sample:function(g,p){return m.exp(s.randn()*p+g)},variance:function(g,p){return(m.exp(p*p)-1)*m.exp(2*g+p*p)}}),s.extend(s.noncentralt,{pdf:function(g,p,b){return m.abs(b)<1e-14?s.studentt.pdf(g,p):m.abs(g)<1e-14?m.exp(s.gammaln((p+1)/2)-b*b/2-.5*m.log(m.PI*p)-s.gammaln(p/2)):p/g*(s.noncentralt.cdf(g*m.sqrt(1+2/p),p+2,b)-s.noncentralt.cdf(g,p,b))},cdf:function(g,p,b){var j=1e-14;if(m.abs(b)<j)return s.studentt.cdf(g,p);var v=!1;g<0&&(v=!0,b=-b);for(var C=s.normal.cdf(-b,0,1),A=j+1,S=A,D=g*g/(g*g+p),F=0,N=m.exp(-b*b/2),_=m.exp(-b*b/2-.5*m.log(2)-s.gammaln(1.5))*b;F<200||S>j||A>j;)S=A,F>0&&(N*=b*b/(2*F),_*=b*b/(2*(F+.5))),C+=.5*(A=N*s.beta.cdf(D,F+.5,p/2)+_*s.beta.cdf(D,F+1,p/2)),F++;return v?1-C:C}}),s.extend(s.normal,{pdf:function(g,p,b){return m.exp(-.5*m.log(2*m.PI)-m.log(b)-m.pow(g-p,2)/(2*b*b))},cdf:function(g,p,b){return .5*(1+s.erf((g-p)/m.sqrt(2*b*b)))},inv:function(g,p,b){return-1.4142135623730951*b*s.erfcinv(2*g)+p},mean:function(g){return g},median:function(g){return g},mode:function(g){return g},sample:function(g,p){return s.randn()*p+g},variance:function(g,p){return p*p}}),s.extend(s.pareto,{pdf:function(g,p,b){return g<p?0:b*m.pow(p,b)/m.pow(g,b+1)},cdf:function(g,p,b){return g<p?0:1-m.pow(p/g,b)},inv:function(g,p,b){return p/m.pow(1-g,1/b)},mean:function(g,p){if(!(p<=1))return p*m.pow(g,p)/(p-1)},median:function(g,p){return g*(p*m.SQRT2)},mode:function(g){return g},variance:function(g,p){if(!(p<=2))return g*g*p/(m.pow(p-1,2)*(p-2))}}),s.extend(s.studentt,{pdf:function(g,p){return p=p>1e100?1e100:p,1/(m.sqrt(p)*s.betafn(.5,p/2))*m.pow(1+g*g/p,-(p+1)/2)},cdf:function(g,p){var b=p/2;return s.ibeta((g+m.sqrt(g*g+p))/(2*m.sqrt(g*g+p)),b,b)},inv:function(g,p){var b=s.ibetainv(2*m.min(g,1-g),.5*p,.5);return b=m.sqrt(p*(1-b)/b),g>.5?b:-b},mean:function(g){return g>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(g){return s.randn()*m.sqrt(g/(2*s.randg(g/2)))},variance:function(g){return g>2?g/(g-2):g>1?1/0:void 0}}),s.extend(s.weibull,{pdf:function(g,p,b){return g<0||p<0||b<0?0:b/p*m.pow(g/p,b-1)*m.exp(-m.pow(g/p,b))},cdf:function(g,p,b){return g<0?0:1-m.exp(-m.pow(g/p,b))},inv:function(g,p,b){return p*m.pow(-m.log(1-g),1/b)},mean:function(g,p){return g*s.gammafn(1+1/p)},median:function(g,p){return g*m.pow(m.log(2),1/p)},mode:function(g,p){return p<=1?0:g*m.pow((p-1)/p,1/p)},sample:function(g,p){return g*m.pow(-m.log(s._random_fn()),1/p)},variance:function(g,p){return g*g*s.gammafn(1+2/p)-m.pow(s.weibull.mean(g,p),2)}}),s.extend(s.uniform,{pdf:function(g,p,b){return g<p||g>b?0:1/(b-p)},cdf:function(g,p,b){return g<p?0:g<b?(g-p)/(b-p):1},inv:function(g,p,b){return p+g*(b-p)},mean:function(g,p){return .5*(g+p)},median:function(g,p){return s.mean(g,p)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(g,p){return g/2+p/2+(p/2-g/2)*(2*s._random_fn()-1)},variance:function(g,p){return m.pow(p-g,2)/12}}),s.extend(s.binomial,{pdf:function(g,p,b){return b===0||b===1?p*b===g?1:0:s.combination(p,g)*m.pow(b,g)*m.pow(1-b,p-g)},cdf:function(g,p,b){var j,v=1e-10;if(g<0)return 0;if(g>=p)return 1;if(b<0||b>1||p<=0)return NaN;var C=b,A=(g=m.floor(g))+1,S=p-g,D=A+S,F=m.exp(s.gammaln(D)-s.gammaln(S)-s.gammaln(A)+A*m.log(C)+S*m.log(1-C));return j=C<(A+1)/(D+2)?F*T(C,A,S,v):1-F*T(1-C,S,A,v),m.round(1/v*(1-j))/(1/v)}}),s.extend(s.negbin,{pdf:function(g,p,b){return g===g>>>0&&(g<0?0:s.combination(g+p-1,p-1)*m.pow(1-b,g)*m.pow(b,p))},cdf:function(g,p,b){var j=0,v=0;if(g<0)return 0;for(;v<=g;v++)j+=s.negbin.pdf(v,p,b);return j}}),s.extend(s.hypgeom,{pdf:function(g,p,b,j){if(g!=g|0)return!1;if(g<0||g<b-(p-j)||g>j||g>b)return 0;if(2*b>p)return 2*j>p?s.hypgeom.pdf(p-b-j+g,p,p-b,p-j):s.hypgeom.pdf(j-g,p,p-b,j);if(2*j>p)return s.hypgeom.pdf(b-g,p,b,p-j);if(b<j)return s.hypgeom.pdf(g,p,j,b);for(var v=1,C=0,A=0;A<g;A++){for(;v>1&&C<j;)v*=1-b/(p-C),C++;v*=(j-A)*(b-A)/((A+1)*(p-b-j+A+1))}for(;C<j;C++)v*=1-b/(p-C);return m.min(1,m.max(0,v))},cdf:function(g,p,b,j){if(g<0||g<b-(p-j))return 0;if(g>=j||g>=b)return 1;if(2*b>p)return 2*j>p?s.hypgeom.cdf(p-b-j+g,p,p-b,p-j):1-s.hypgeom.cdf(j-g-1,p,p-b,j);if(2*j>p)return 1-s.hypgeom.cdf(b-g-1,p,b,p-j);if(b<j)return s.hypgeom.cdf(g,p,j,b);for(var v=1,C=1,A=0,S=0;S<g;S++){for(;v>1&&A<j;){var D=1-b/(p-A);C*=D,v*=D,A++}v+=C*=(j-S)*(b-S)/((S+1)*(p-b-j+S+1))}for(;A<j;A++)v*=1-b/(p-A);return m.min(1,m.max(0,v))}}),s.extend(s.poisson,{pdf:function(g,p){return p<0||g%1!=0||g<0?0:m.pow(p,g)*m.exp(-p)/s.factorial(g)},cdf:function(g,p){var b=[],j=0;if(g<0)return 0;for(;j<=g;j++)b.push(s.poisson.pdf(j,p));return s.sum(b)},mean:function(g){return g},variance:function(g){return g},sampleSmall:function(g){var p=1,b=0,j=m.exp(-g);do b++,p*=s._random_fn();while(p>j);return b-1},sampleLarge:function(g){var p,b,j,v,C,A,S,D,F,N,_=g;for(v=m.sqrt(_),C=m.log(_),A=.02483*(S=.931+2.53*v)-.059,D=1.1239+1.1328/(S-3.4),F=.9277-3.6224/(S-2);;)if(b=m.random()-.5,j=m.random(),N=.5-m.abs(b),p=m.floor((2*A/N+S)*b+_+.43),N>=.07&&j<=F||!(p<0||N<.013&&j>N)&&m.log(j)+m.log(D)-m.log(A/(N*N)+S)<=p*C-_-s.loggam(p+1))return p},sample:function(g){return g<10?this.sampleSmall(g):this.sampleLarge(g)}}),s.extend(s.triangular,{pdf:function(g,p,b,j){return b<=p||j<p||j>b?NaN:g<p||g>b?0:g<j?2*(g-p)/((b-p)*(j-p)):g===j?2/(b-p):2*(b-g)/((b-p)*(b-j))},cdf:function(g,p,b,j){return b<=p||j<p||j>b?NaN:g<=p?0:g>=b?1:g<=j?m.pow(g-p,2)/((b-p)*(j-p)):1-m.pow(b-g,2)/((b-p)*(b-j))},inv:function(g,p,b,j){return b<=p||j<p||j>b?NaN:g<=(j-p)/(b-p)?p+(b-p)*m.sqrt(g*((j-p)/(b-p))):p+(b-p)*(1-m.sqrt((1-g)*(1-(j-p)/(b-p))))},mean:function(g,p,b){return(g+p+b)/3},median:function(g,p,b){return b<=(g+p)/2?p-m.sqrt((p-g)*(p-b))/m.sqrt(2):b>(g+p)/2?g+m.sqrt((p-g)*(b-g))/m.sqrt(2):void 0},mode:function(g,p,b){return b},sample:function(g,p,b){var j=s._random_fn();return j<(b-g)/(p-g)?g+m.sqrt(j*(p-g)*(b-g)):p-m.sqrt((1-j)*(p-g)*(p-b))},variance:function(g,p,b){return(g*g+p*p+b*b-g*p-g*b-p*b)/18}}),s.extend(s.arcsine,{pdf:function(g,p,b){return b<=p?NaN:g<=p||g>=b?0:2/m.PI*m.pow(m.pow(b-p,2)-m.pow(2*g-p-b,2),-.5)},cdf:function(g,p,b){return g<p?0:g<b?2/m.PI*m.asin(m.sqrt((g-p)/(b-p))):1},inv:function(g,p,b){return p+(.5-.5*m.cos(m.PI*g))*(b-p)},mean:function(g,p){return p<=g?NaN:(g+p)/2},median:function(g,p){return p<=g?NaN:(g+p)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(g,p){return(g+p)/2+(p-g)/2*m.sin(2*m.PI*s.uniform.sample(0,1))},variance:function(g,p){return p<=g?NaN:m.pow(p-g,2)/8}}),s.extend(s.laplace,{pdf:function(g,p,b){return b<=0?0:m.exp(-m.abs(g-p)/b)/(2*b)},cdf:function(g,p,b){return b<=0?0:g<p?.5*m.exp((g-p)/b):1-.5*m.exp(-(g-p)/b)},mean:function(g){return g},median:function(g){return g},mode:function(g){return g},variance:function(g,p){return 2*p*p},sample:function(g,p){var b,j=s._random_fn()-.5;return g-p*((b=j)/m.abs(b))*m.log(1-2*m.abs(j))}}),s.extend(s.tukey,{cdf:function(g,p,b){var j=p,v=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],C=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(g<=0)return 0;if(b<2||j<2)return NaN;if(!Number.isFinite(g))return 1;if(b>25e3)return M(g,1,j);var A,S=.5*b,D=S*m.log(b)-b*m.log(2)-s.gammaln(S),F=S-1,N=.25*b;A=b<=100?1:b<=800?.5:b<=5e3?.25:.125,D+=m.log(A);for(var _=0,G=1;G<=50;G++){for(var U=0,re=(2*G-1)*A,fe=1;fe<=16;fe++){var ae,ye;8<fe?(ae=fe-8-1,ye=D+F*m.log(re+v[ae]*A)-(v[ae]*A+re)*N):(ae=fe-1,ye=D+F*m.log(re-v[ae]*A)+(v[ae]*A-re)*N),ye>=-30&&(U+=M(8<fe?g*m.sqrt(.5*(v[ae]*A+re)):g*m.sqrt(.5*(-v[ae]*A+re)),1,j)*C[ae]*m.exp(ye))}if(G*A>=1&&U<=1e-14)break;_+=U}if(U>1e-14)throw new Error("tukey.cdf failed to converge");return _>1&&(_=1),_},inv:function(g,p,b){if(b<2||p<2)return NaN;if(g<0||g>1)return NaN;if(g===0)return 0;if(g===1)return 1/0;var j,v=function(F,N,_){var G=.5-.5*F,U=m.sqrt(m.log(1/(G*G))),re=U+((((-453642210148e-16*U-.204231210125)*U-.342242088547)*U-1)*U+.322232421088)/((((.0038560700634*U+.10353775285)*U+.531103462366)*U+.588581570495)*U+.099348462606);_<120&&(re+=(re*re*re+re)/_/4);var fe=.8832-.2368*re;return _<120&&(fe+=-1.214/_+1.208*re/_),re*(fe*m.log(N-1)+1.4142)}(g,p,b),C=s.tukey.cdf(v,p,b)-g;j=C>0?m.max(0,v-1):v+1;for(var A,S=s.tukey.cdf(j,p,b)-g,D=1;D<50;D++)if(A=j-S*(j-v)/(S-C),C=S,v=j,A<0&&(A=0,S=-g),S=s.tukey.cdf(A,p,b)-g,j=A,m.abs(j-v)<1e-4)return A;throw new Error("tukey.inv failed to converge")}})}(u,Math),function(s,m){var T,M,g=Array.prototype.push,p=s.utils.isArray;function b(j){return p(j)||j instanceof s}s.extend({add:function(j,v){return b(v)?(b(v[0])||(v=[v]),s.map(j,function(C,A,S){return C+v[A][S]})):s.map(j,function(C){return C+v})},subtract:function(j,v){return b(v)?(b(v[0])||(v=[v]),s.map(j,function(C,A,S){return C-v[A][S]||0})):s.map(j,function(C){return C-v})},divide:function(j,v){return b(v)?(b(v[0])||(v=[v]),s.multiply(j,s.inv(v))):s.map(j,function(C){return C/v})},multiply:function(j,v){var C,A,S,D,F,N,_,G;if(j.length===void 0&&v.length===void 0)return j*v;if(F=j.length,N=j[0].length,_=s.zeros(F,S=b(v)?v[0].length:N),G=0,b(v)){for(;G<S;G++)for(C=0;C<F;C++){for(D=0,A=0;A<N;A++)D+=j[C][A]*v[A][G];_[C][G]=D}return F===1&&G===1?_[0][0]:_}return s.map(j,function(U){return U*v})},outer:function(j,v){return s.multiply(j.map(function(C){return[C]}),[v])},dot:function(j,v){b(j[0])||(j=[j]),b(v[0])||(v=[v]);for(var C,A,S=j[0].length===1&&j.length!==1?s.transpose(j):j,D=v[0].length===1&&v.length!==1?s.transpose(v):v,F=[],N=0,_=S.length,G=S[0].length;N<_;N++){for(F[N]=[],C=0,A=0;A<G;A++)C+=S[N][A]*D[N][A];F[N]=C}return F.length===1?F[0]:F},pow:function(j,v){return s.map(j,function(C){return m.pow(C,v)})},exp:function(j){return s.map(j,function(v){return m.exp(v)})},log:function(j){return s.map(j,function(v){return m.log(v)})},abs:function(j){return s.map(j,function(v){return m.abs(v)})},norm:function(j,v){var C=0,A=0;for(isNaN(v)&&(v=2),b(j[0])&&(j=j[0]);A<j.length;A++)C+=m.pow(m.abs(j[A]),v);return m.pow(C,1/v)},angle:function(j,v){return m.acos(s.dot(j,v)/(s.norm(j)*s.norm(v)))},aug:function(j,v){var C,A=[];for(C=0;C<j.length;C++)A.push(j[C].slice());for(C=0;C<A.length;C++)g.apply(A[C],v[C]);return A},inv:function(j){for(var v,C=j.length,A=j[0].length,S=s.identity(C,A),D=s.gauss_jordan(j,S),F=[],N=0;N<C;N++)for(F[N]=[],v=A;v<D[0].length;v++)F[N][v-A]=D[N][v];return F},det:function j(v){if(v.length===2)return v[0][0]*v[1][1]-v[0][1]*v[1][0];for(var C=0,A=0;A<v.length;A++){for(var S=[],D=1;D<v.length;D++){S[D-1]=[];for(var F=0;F<v.length;F++)F<A?S[D-1][F]=v[D][F]:F>A&&(S[D-1][F-1]=v[D][F])}var N=A%2?-1:1;C+=j(S)*v[0][A]*N}return C},gauss_elimination:function(j,v){var C,A,S,D,F=0,N=0,_=j.length,G=j[0].length,U=1,re=0,fe=[];for(C=(j=s.aug(j,v))[0].length,F=0;F<_;F++){for(A=j[F][F],N=F,D=F+1;D<G;D++)A<m.abs(j[D][F])&&(A=j[D][F],N=D);if(N!=F)for(D=0;D<C;D++)S=j[F][D],j[F][D]=j[N][D],j[N][D]=S;for(N=F+1;N<_;N++)for(U=j[N][F]/j[F][F],D=F;D<C;D++)j[N][D]=j[N][D]-U*j[F][D]}for(F=_-1;F>=0;F--){for(re=0,N=F+1;N<=_-1;N++)re+=fe[N]*j[F][N];fe[F]=(j[F][C-1]-re)/j[F][F]}return fe},gauss_jordan:function(j,v){var C,A,S,D=s.aug(j,v),F=D.length,N=D[0].length,_=0;for(A=0;A<F;A++){var G=A;for(S=A+1;S<F;S++)m.abs(D[S][A])>m.abs(D[G][A])&&(G=S);var U=D[A];for(D[A]=D[G],D[G]=U,S=A+1;S<F;S++)for(_=D[S][A]/D[A][A],C=A;C<N;C++)D[S][C]-=D[A][C]*_}for(A=F-1;A>=0;A--){for(_=D[A][A],S=0;S<A;S++)for(C=N-1;C>A-1;C--)D[S][C]-=D[A][C]*D[S][A]/_;for(D[A][A]/=_,C=F;C<N;C++)D[A][C]/=_}return D},triaUpSolve:function(j,v){var C,A=j[0].length,S=s.zeros(1,A)[0],D=!1;return v[0].length!=null&&(v=v.map(function(F){return F[0]}),D=!0),s.arange(A-1,-1,-1).forEach(function(F){C=s.arange(F+1,A).map(function(N){return S[N]*j[F][N]}),S[F]=(v[F]-s.sum(C))/j[F][F]}),D?S.map(function(F){return[F]}):S},triaLowSolve:function(j,v){var C,A=j[0].length,S=s.zeros(1,A)[0],D=!1;return v[0].length!=null&&(v=v.map(function(F){return F[0]}),D=!0),s.arange(A).forEach(function(F){C=s.arange(F).map(function(N){return j[F][N]*S[N]}),S[F]=(v[F]-s.sum(C))/j[F][F]}),D?S.map(function(F){return[F]}):S},lu:function(j){var v,C=j.length,A=s.identity(C),S=s.zeros(j.length,j[0].length);return s.arange(C).forEach(function(D){S[0][D]=j[0][D]}),s.arange(1,C).forEach(function(D){s.arange(D).forEach(function(F){v=s.arange(F).map(function(N){return A[D][N]*S[N][F]}),A[D][F]=(j[D][F]-s.sum(v))/S[F][F]}),s.arange(D,C).forEach(function(F){v=s.arange(D).map(function(N){return A[D][N]*S[N][F]}),S[D][F]=j[v.length][F]-s.sum(v)})}),[A,S]},cholesky:function(j){var v,C=j.length,A=s.zeros(j.length,j[0].length);return s.arange(C).forEach(function(S){v=s.arange(S).map(function(D){return m.pow(A[S][D],2)}),A[S][S]=m.sqrt(j[S][S]-s.sum(v)),s.arange(S+1,C).forEach(function(D){v=s.arange(S).map(function(F){return A[S][F]*A[D][F]}),A[D][S]=(j[S][D]-s.sum(v))/A[S][S]})}),A},gauss_jacobi:function(j,v,C,A){for(var S,D,F,N,_=0,G=0,U=j.length,re=[],fe=[],ae=[];_<U;_++)for(re[_]=[],fe[_]=[],ae[_]=[],G=0;G<U;G++)_>G?(re[_][G]=j[_][G],fe[_][G]=ae[_][G]=0):_<G?(fe[_][G]=j[_][G],re[_][G]=ae[_][G]=0):(ae[_][G]=j[_][G],re[_][G]=fe[_][G]=0);for(F=s.multiply(s.multiply(s.inv(ae),s.add(re,fe)),-1),D=s.multiply(s.inv(ae),v),S=C,N=s.add(s.multiply(F,C),D),_=2;m.abs(s.norm(s.subtract(N,S)))>A;)S=N,N=s.add(s.multiply(F,S),D),_++;return N},gauss_seidel:function(j,v,C,A){for(var S,D,F,N,_,G=0,U=j.length,re=[],fe=[],ae=[];G<U;G++)for(re[G]=[],fe[G]=[],ae[G]=[],S=0;S<U;S++)G>S?(re[G][S]=j[G][S],fe[G][S]=ae[G][S]=0):G<S?(fe[G][S]=j[G][S],re[G][S]=ae[G][S]=0):(ae[G][S]=j[G][S],re[G][S]=fe[G][S]=0);for(N=s.multiply(s.multiply(s.inv(s.add(ae,re)),fe),-1),F=s.multiply(s.inv(s.add(ae,re)),v),D=C,_=s.add(s.multiply(N,C),F),G=2;m.abs(s.norm(s.subtract(_,D)))>A;)D=_,_=s.add(s.multiply(N,D),F),G+=1;return _},SOR:function(j,v,C,A,S){for(var D,F,N,_,G,U=0,re=j.length,fe=[],ae=[],ye=[];U<re;U++)for(fe[U]=[],ae[U]=[],ye[U]=[],D=0;D<re;D++)U>D?(fe[U][D]=j[U][D],ae[U][D]=ye[U][D]=0):U<D?(ae[U][D]=j[U][D],fe[U][D]=ye[U][D]=0):(ye[U][D]=j[U][D],fe[U][D]=ae[U][D]=0);for(_=s.multiply(s.inv(s.add(ye,s.multiply(fe,S))),s.subtract(s.multiply(ye,1-S),s.multiply(ae,S))),N=s.multiply(s.multiply(s.inv(s.add(ye,s.multiply(fe,S))),v),S),F=C,G=s.add(s.multiply(_,C),N),U=2;m.abs(s.norm(s.subtract(G,F)))>A;)F=G,G=s.add(s.multiply(_,F),N),U++;return G},householder:function(j){for(var v,C,A,S,D=j.length,F=j[0].length,N=0,_=[],G=[];N<D-1;N++){for(v=0,S=N+1;S<F;S++)v+=j[S][N]*j[S][N];for(v=(j[N+1][N]>0?-1:1)*m.sqrt(v),C=m.sqrt((v*v-j[N+1][N]*v)/2),(_=s.zeros(D,1))[N+1][0]=(j[N+1][N]-v)/(2*C),A=N+2;A<D;A++)_[A][0]=j[A][N]/(2*C);G=s.subtract(s.identity(D,F),s.multiply(s.multiply(_,s.transpose(_)),2)),j=s.multiply(G,s.multiply(j,G))}return j},QR:(T=s.sum,M=s.arange,function(j){var v,C,A,S=j.length,D=j[0].length,F=s.zeros(D,D);for(j=s.copy(j),C=0;C<D;C++){for(F[C][C]=m.sqrt(T(M(S).map(function(N){return j[N][C]*j[N][C]}))),v=0;v<S;v++)j[v][C]=j[v][C]/F[C][C];for(A=C+1;A<D;A++)for(F[C][A]=T(M(S).map(function(N){return j[N][C]*j[N][A]})),v=0;v<S;v++)j[v][A]=j[v][A]-j[v][C]*F[C][A]}return[j,F]}),lstsq:function(j,v){var C=!1;v[0].length===void 0&&(v=v.map(function(re){return[re]}),C=!0);var A=s.QR(j),S=A[0],D=A[1],F=j[0].length,N=s.slice(S,{col:{end:F}}),_=function(re){var fe=(re=s.copy(re)).length,ae=s.identity(fe);return s.arange(fe-1,-1,-1).forEach(function(ye){s.sliceAssign(ae,{row:ye},s.divide(s.slice(ae,{row:ye}),re[ye][ye])),s.sliceAssign(re,{row:ye},s.divide(s.slice(re,{row:ye}),re[ye][ye])),s.arange(ye).forEach(function(Ne){var be=s.multiply(re[Ne][ye],-1),le=s.slice(re,{row:Ne}),Ye=s.multiply(s.slice(re,{row:ye}),be);s.sliceAssign(re,{row:Ne},s.add(le,Ye));var $e=s.slice(ae,{row:Ne}),Ge=s.multiply(s.slice(ae,{row:ye}),be);s.sliceAssign(ae,{row:Ne},s.add($e,Ge))})}),ae}(s.slice(D,{row:{end:F}})),G=s.transpose(N);G[0].length===void 0&&(G=[G]);var U=s.multiply(s.multiply(_,G),v);return U.length===void 0&&(U=[[U]]),C?U.map(function(re){return re[0]}):U},jacobi:function(j){for(var v,C,A,S,D,F,N,_=1,G=j.length,U=s.identity(G,G),re=[];_===1;){for(D=j[0][1],A=0,S=1,v=0;v<G;v++)for(C=0;C<G;C++)v!=C&&D<m.abs(j[v][C])&&(D=m.abs(j[v][C]),A=v,S=C);for(F=j[A][A]===j[S][S]?j[A][S]>0?m.PI/4:-m.PI/4:m.atan(2*j[A][S]/(j[A][A]-j[S][S]))/2,(N=s.identity(G,G))[A][A]=m.cos(F),N[A][S]=-m.sin(F),N[S][A]=m.sin(F),N[S][S]=m.cos(F),U=s.multiply(U,N),j=s.multiply(s.multiply(s.inv(N),j),N),_=0,v=1;v<G;v++)for(C=1;C<G;C++)v!=C&&m.abs(j[v][C])>.001&&(_=1)}for(v=0;v<G;v++)re.push(j[v][v]);return[U,re]},rungekutta:function(j,v,C,A,S,D){var F,N,_;if(D===2)for(;A<=C;)S+=((F=v*j(A,S))+(N=v*j(A+v,S+F)))/2,A+=v;if(D===4)for(;A<=C;)S+=((F=v*j(A,S))+2*(N=v*j(A+v/2,S+F/2))+2*(_=v*j(A+v/2,S+N/2))+v*j(A+v,S+_))/6,A+=v;return S},romberg:function(j,v,C,A){for(var S,D,F,N,_,G=0,U=(C-v)/2,re=[],fe=[],ae=[];G<A/2;){for(_=j(v),F=v,N=0;F<=C;F+=U,N++)re[N]=F;for(S=re.length,F=1;F<S-1;F++)_+=(F%2!=0?4:2)*j(re[F]);_=U/3*(_+j(C)),ae[G]=_,U/=2,G++}for(D=ae.length,S=1;D!==1;){for(F=0;F<D-1;F++)fe[F]=(m.pow(4,S)*ae[F+1]-ae[F])/(m.pow(4,S)-1);D=fe.length,ae=fe,fe=[],S++}return ae},richardson:function(j,v,C,A){function S(ye,Ne){for(var be,le=0,Ye=ye.length;le<Ye;le++)ye[le]===Ne&&(be=le);return be}for(var D,F,N,_,G,U=m.abs(C-j[S(j,C)+1]),re=0,fe=[],ae=[];A>=U;)D=S(j,C+A),F=S(j,C),fe[re]=(v[D]-2*v[F]+v[2*F-D])/(A*A),A/=2,re++;for(_=fe.length,N=1;_!=1;){for(G=0;G<_-1;G++)ae[G]=(m.pow(4,N)*fe[G+1]-fe[G])/(m.pow(4,N)-1);_=ae.length,fe=ae,ae=[],N++}return fe},simpson:function(j,v,C,A){for(var S,D=(C-v)/A,F=j(v),N=[],_=v,G=0,U=1;_<=C;_+=D,G++)N[G]=_;for(S=N.length;U<S-1;U++)F+=(U%2!=0?4:2)*j(N[U]);return D/3*(F+j(C))},hermite:function(j,v,C,A){for(var S,D=j.length,F=0,N=0,_=[],G=[],U=[],re=[];N<D;N++){for(_[N]=1,S=0;S<D;S++)N!=S&&(_[N]*=(A-j[S])/(j[N]-j[S]));for(G[N]=0,S=0;S<D;S++)N!=S&&(G[N]+=1/(j[N]-j[S]));U[N]=(1-2*(A-j[N])*G[N])*(_[N]*_[N]),re[N]=(A-j[N])*(_[N]*_[N]),F+=U[N]*v[N]+re[N]*C[N]}return F},lagrange:function(j,v,C){for(var A,S,D=0,F=0,N=j.length;F<N;F++){for(S=v[F],A=0;A<N;A++)F!=A&&(S*=(C-j[A])/(j[F]-j[A]));D+=S}return D},cubic_spline:function(j,v,C){for(var A,S,D=j.length,F=0,N=[],_=[],G=[],U=[],re=[],fe=[];F<D-1;F++)U[F]=j[F+1]-j[F];for(G[0]=0,F=1;F<D-1;F++)G[F]=3/U[F]*(v[F+1]-v[F])-3/U[F-1]*(v[F]-v[F-1]);for(F=1;F<D-1;F++)N[F]=[],_[F]=[],N[F][F-1]=U[F-1],N[F][F]=2*(U[F-1]+U[F]),N[F][F+1]=U[F],_[F][0]=G[F];for(S=s.multiply(s.inv(N),_),A=0;A<D-1;A++)re[A]=(v[A+1]-v[A])/U[A]-U[A]*(S[A+1][0]+2*S[A][0])/3,fe[A]=(S[A+1][0]-S[A][0])/(3*U[A]);for(A=0;A<D&&!(j[A]>C);A++);return v[A-=1]+(C-j[A])*re[A]+s.sq(C-j[A])*S[A]+(C-j[A])*s.sq(C-j[A])*fe[A]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(j){var v,C,A,S,D,F=j.length,N=j[0].length,_=0,G=[],U=[],re=[],fe=[],ae=[],ye=[],Ne=[];for(_=0;_<F;_++)G[_]=s.sum(j[_])/N;for(_=0;_<N;_++)for(ae[_]=[],v=0;v<F;v++)ae[_][v]=j[v][_]-G[v];for(ae=s.transpose(ae),_=0;_<F;_++)for(ye[_]=[],v=0;v<F;v++)ye[_][v]=s.dot([ae[_]],[ae[v]])/(N-1);for(D=(A=s.jacobi(ye))[0],U=A[1],Ne=s.transpose(D),_=0;_<U.length;_++)for(v=_;v<U.length;v++)U[_]<U[v]&&(C=U[_],U[_]=U[v],U[v]=C,re=Ne[_],Ne[_]=Ne[v],Ne[v]=re);for(S=s.transpose(ae),_=0;_<F;_++)for(fe[_]=[],v=0;v<S.length;v++)fe[_][v]=s.dot([Ne[_]],[S[v]]);return[j,U,Ne,fe]}}),function(j){for(var v=0;v<j.length;v++)(function(C){s.fn[C]=function(A,S){var D=this;return S?(setTimeout(function(){S.call(D,s.fn[C].call(D,A))},15),this):typeof s[C](this,A)=="number"?s[C](this,A):s(s[C](this,A))}})(j[v])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(u,Math),function(s,m){var T=[].slice,M=s.utils.isNumber,g=s.utils.isArray;function p(b,j,v,C){if(b>1||v>1||b<=0||v<=0)throw new Error("Proportions should be greater than 0 and less than 1");var A=(b*j+v*C)/(j+C);return(b-v)/m.sqrt(A*(1-A)*(1/j+1/C))}s.extend({zscore:function(){var b=T.call(arguments);return M(b[1])?(b[0]-b[1])/b[2]:(b[0]-s.mean(b[1]))/s.stdev(b[1],b[2])},ztest:function(){var b,j=T.call(arguments);return g(j[1])?(b=s.zscore(j[0],j[1],j[3]),j[2]===1?s.normal.cdf(-m.abs(b),0,1):2*s.normal.cdf(-m.abs(b),0,1)):j.length>2?(b=s.zscore(j[0],j[1],j[2]),j[3]===1?s.normal.cdf(-m.abs(b),0,1):2*s.normal.cdf(-m.abs(b),0,1)):(b=j[0],j[1]===1?s.normal.cdf(-m.abs(b),0,1):2*s.normal.cdf(-m.abs(b),0,1))}}),s.extend(s.fn,{zscore:function(b,j){return(b-this.mean())/this.stdev(j)},ztest:function(b,j,v){var C=m.abs(this.zscore(b,v));return j===1?s.normal.cdf(-C,0,1):2*s.normal.cdf(-C,0,1)}}),s.extend({tscore:function(){var b=T.call(arguments);return b.length===4?(b[0]-b[1])/(b[2]/m.sqrt(b[3])):(b[0]-s.mean(b[1]))/(s.stdev(b[1],!0)/m.sqrt(b[1].length))},ttest:function(){var b,j=T.call(arguments);return j.length===5?(b=m.abs(s.tscore(j[0],j[1],j[2],j[3])),j[4]===1?s.studentt.cdf(-b,j[3]-1):2*s.studentt.cdf(-b,j[3]-1)):M(j[1])?(b=m.abs(j[0]),j[2]==1?s.studentt.cdf(-b,j[1]-1):2*s.studentt.cdf(-b,j[1]-1)):(b=m.abs(s.tscore(j[0],j[1])),j[2]==1?s.studentt.cdf(-b,j[1].length-1):2*s.studentt.cdf(-b,j[1].length-1))}}),s.extend(s.fn,{tscore:function(b){return(b-this.mean())/(this.stdev(!0)/m.sqrt(this.cols()))},ttest:function(b,j){return j===1?1-s.studentt.cdf(m.abs(this.tscore(b)),this.cols()-1):2*s.studentt.cdf(-m.abs(this.tscore(b)),this.cols()-1)}}),s.extend({anovafscore:function(){var b,j,v,C,A,S,D,F,N=T.call(arguments);if(N.length===1){for(A=new Array(N[0].length),D=0;D<N[0].length;D++)A[D]=N[0][D];N=A}for(j=new Array,D=0;D<N.length;D++)j=j.concat(N[D]);for(v=s.mean(j),b=0,D=0;D<N.length;D++)b+=N[D].length*m.pow(s.mean(N[D])-v,2);for(b/=N.length-1,S=0,D=0;D<N.length;D++)for(C=s.mean(N[D]),F=0;F<N[D].length;F++)S+=m.pow(N[D][F]-C,2);return b/(S/(j.length-N.length))},anovaftest:function(){var b,j,v,C,A=T.call(arguments);if(M(A[0]))return 1-s.centralF.cdf(A[0],A[1],A[2]);var S=s.anovafscore(A);for(b=A.length-1,v=0,C=0;C<A.length;C++)v+=A[C].length;return j=v-b-1,1-s.centralF.cdf(S,b,j)},ftest:function(b,j,v){return 1-s.centralF.cdf(b,j,v)}}),s.extend(s.fn,{anovafscore:function(){return s.anovafscore(this.toArray())},anovaftes:function(){var b,j=0;for(b=0;b<this.length;b++)j+=this[b].length;return s.ftest(this.anovafscore(),this.length-1,j-this.length)}}),s.extend({qscore:function(){var b,j,v,C,A,S=T.call(arguments);return M(S[0])?(b=S[0],j=S[1],v=S[2],C=S[3],A=S[4]):(b=s.mean(S[0]),j=s.mean(S[1]),v=S[0].length,C=S[1].length,A=S[2]),m.abs(b-j)/(A*m.sqrt((1/v+1/C)/2))},qtest:function(){var b,j=T.call(arguments);j.length===3?(b=j[0],j=j.slice(1)):j.length===7?(b=s.qscore(j[0],j[1],j[2],j[3],j[4]),j=j.slice(5)):(b=s.qscore(j[0],j[1],j[2]),j=j.slice(3));var v=j[0],C=j[1];return 1-s.tukey.cdf(b,C,v-C)},tukeyhsd:function(b){for(var j=s.pooledstdev(b),v=b.map(function(N){return s.mean(N)}),C=b.reduce(function(N,_){return N+_.length},0),A=[],S=0;S<b.length;++S)for(var D=S+1;D<b.length;++D){var F=s.qtest(v[S],v[D],b[S].length,b[D].length,j,C,b.length);A.push([[S,D],F])}return A}}),s.extend({normalci:function(){var b,j=T.call(arguments),v=new Array(2);return b=j.length===4?m.abs(s.normal.inv(j[1]/2,0,1)*j[2]/m.sqrt(j[3])):m.abs(s.normal.inv(j[1]/2,0,1)*s.stdev(j[2])/m.sqrt(j[2].length)),v[0]=j[0]-b,v[1]=j[0]+b,v},tci:function(){var b,j=T.call(arguments),v=new Array(2);return b=j.length===4?m.abs(s.studentt.inv(j[1]/2,j[3]-1)*j[2]/m.sqrt(j[3])):m.abs(s.studentt.inv(j[1]/2,j[2].length-1)*s.stdev(j[2],!0)/m.sqrt(j[2].length)),v[0]=j[0]-b,v[1]=j[0]+b,v},significant:function(b,j){return b<j}}),s.extend(s.fn,{normalci:function(b,j){return s.normalci(b,j,this.toArray())},tci:function(b,j){return s.tci(b,j,this.toArray())}}),s.extend(s.fn,{oneSidedDifferenceOfProportions:function(b,j,v,C){var A=p(b,j,v,C);return s.ztest(A,1)},twoSidedDifferenceOfProportions:function(b,j,v,C){var A=p(b,j,v,C);return s.ztest(A,2)}})}(u,Math),u.models=function(){function s(m,T){var M=m.length,g=T[0].length-1,p=M-g-1,b=u.lstsq(T,m),j=u.multiply(T,b.map(function(F){return[F]})).map(function(F){return F[0]}),v=u.subtract(m,j),C=u.mean(m),A=u.sum(j.map(function(F){return Math.pow(F-C,2)})),S=u.sum(m.map(function(F,N){return Math.pow(F-j[N],2)})),D=A+S;return{exog:T,endog:m,nobs:M,df_model:g,df_resid:p,coef:b,predict:j,resid:v,ybar:C,SST:D,SSE:A,SSR:S,R2:A/D}}return{ols:function(m,T){var M=s(m,T),g=function(j){var v,C,A=(v=j.exog,C=v[0].length,u.arange(C).map(function(U){var re=u.arange(C).filter(function(fe){return fe!==U});return s(u.col(v,U).map(function(fe){return fe[0]}),u.col(v,re))})),S=Math.sqrt(j.SSR/j.df_resid),D=A.map(function(U){var re=U.SST,fe=U.R2;return S/Math.sqrt(re*(1-fe))}),F=j.coef.map(function(U,re){return(U-0)/D[re]}),N=F.map(function(U){var re=u.studentt.cdf(U,j.df_resid);return 2*(re>.5?1-re:re)}),_=u.studentt.inv(.975,j.df_resid),G=j.coef.map(function(U,re){var fe=_*D[re];return[U-fe,U+fe]});return{se:D,t:F,p:N,sigmaHat:S,interval95:G}}(M),p=function(j){var v,C,A,S=j.R2/j.df_model/((1-j.R2)/j.df_resid);return{F_statistic:S,pvalue:1-(v=S,C=j.df_model,A=j.df_resid,u.beta.cdf(v/(A/C+v),C/2,A/2))}}(M),b=1-(1-M.R2)*((M.nobs-1)/M.df_resid);return M.t=g,M.f=p,M.adjust_R2=b,M}}}(),u.extend({buildxmatrix:function(){for(var s=new Array(arguments.length),m=0;m<arguments.length;m++)s[m]=[1].concat(arguments[m]);return u(s)},builddxmatrix:function(){for(var s=new Array(arguments[0].length),m=0;m<arguments[0].length;m++)s[m]=[1].concat(arguments[0][m]);return u(s)},buildjxmatrix:function(s){for(var m=new Array(s.length),T=0;T<s.length;T++)m[T]=s[T];return u.builddxmatrix(m)},buildymatrix:function(s){return u(s).transpose()},buildjymatrix:function(s){return s.transpose()},matrixmult:function(s,m){var T,M,g,p,b;if(s.cols()==m.rows()){if(m.rows()>1){for(p=[],T=0;T<s.rows();T++)for(p[T]=[],M=0;M<m.cols();M++){for(b=0,g=0;g<s.cols();g++)b+=s.toArray()[T][g]*m.toArray()[g][M];p[T][M]=b}return u(p)}for(p=[],T=0;T<s.rows();T++)for(p[T]=[],M=0;M<m.cols();M++){for(b=0,g=0;g<s.cols();g++)b+=s.toArray()[T][g]*m.toArray()[M];p[T][M]=b}return u(p)}},regress:function(s,m){var T=u.xtranspxinv(s),M=s.transpose(),g=u.matrixmult(u(T),M);return u.matrixmult(g,m)},regresst:function(s,m,T){var M=u.regress(s,m),g={anova:{}},p=u.jMatYBar(s,M);g.yBar=p;var b=m.mean();g.anova.residuals=u.residuals(m,p),g.anova.ssr=u.ssr(p,b),g.anova.msr=g.anova.ssr/(s[0].length-1),g.anova.sse=u.sse(m,p),g.anova.mse=g.anova.sse/(m.length-(s[0].length-1)-1),g.anova.sst=u.sst(m,b),g.anova.mst=g.anova.sst/(m.length-1),g.anova.r2=1-g.anova.sse/g.anova.sst,g.anova.r2<0&&(g.anova.r2=0),g.anova.fratio=g.anova.msr/g.anova.mse,g.anova.pvalue=u.anovaftest(g.anova.fratio,s[0].length-1,m.length-(s[0].length-1)-1),g.anova.rmse=Math.sqrt(g.anova.mse),g.anova.r2adj=1-g.anova.mse/g.anova.mst,g.anova.r2adj<0&&(g.anova.r2adj=0),g.stats=new Array(s[0].length);for(var j,v,C,A=u.xtranspxinv(s),S=0;S<M.length;S++)j=Math.sqrt(g.anova.mse*Math.abs(A[S][S])),v=Math.abs(M[S]/j),C=u.ttest(v,m.length-s[0].length-1,T),g.stats[S]=[M[S],j,v,C];return g.regress=M,g},xtranspx:function(s){return u.matrixmult(s.transpose(),s)},xtranspxinv:function(s){var m=u.matrixmult(s.transpose(),s);return u.inv(m)},jMatYBar:function(s,m){var T=u.matrixmult(s,m);return new u(T)},residuals:function(s,m){return u.matrixsubtract(s,m)},ssr:function(s,m){for(var T=0,M=0;M<s.length;M++)T+=Math.pow(s[M]-m,2);return T},sse:function(s,m){for(var T=0,M=0;M<s.length;M++)T+=Math.pow(s[M]-m[M],2);return T},sst:function(s,m){for(var T=0,M=0;M<s.length;M++)T+=Math.pow(s[M]-m,2);return T},matrixsubtract:function(s,m){for(var T=new Array(s.length),M=0;M<s.length;M++){T[M]=new Array(s[M].length);for(var g=0;g<s[M].length;g++)T[M][g]=s[M][g]-m[M][g]}return u(T)}}),u.jStat=u,u)},960:function(E,u,s){let m=s(592);E.exports=function(T){function M(S,D){let F=D.split("."),N=S;for(let _ of F){if(N==null)return;N=N[_]}return N}for(let S=0;S<Object.keys(m).length;S++){let D,F=Object.keys(m)[S],N=[];if(typeof m[F]=="object"){N=Object.keys(m[F]),D=Object.values(m[F]);for(let _=0;_<D.length;_++)if(typeof D[_]=="object"){let G=N[_];m[F][G]&&(N=[...N,...Object.keys(m[F][G]).map(U=>G+"."+U)],N.splice(N.indexOf(G),1))}}if(N.length<1)T[F]=m[F];else for(let _=0;_<N.length;_++)typeof M(m[F],N[_])=="function"&&(T[F]=M(m[F],N[_]))}let g=function(S){return typeof S=="number"&&(S=parseInt(S)),S},p=null,b=null,j=null;T.TABLE=function(){return j},T.COLUMN=T.COL=function(){return j.tracking&&j.tracking.push(A.getColumnNameFromCoords(g(p),g(b))),g(p)+1},T.ROW=function(){return j.tracking&&j.tracking.push(A.getColumnNameFromCoords(g(p),g(b))),g(b)+1},T.CELL=function(){return A.getColumnNameFromCoords(p,b)},T.VALUE=function(S,D,F){return j.getValueFromCoords(g(S)-1,g(D)-1,F)},T.THISROWCELL=function(S){return j.getValueFromCoords(g(S)-1,g(b))};let v=function(S,D){for(let F=0;F<S.length;F++){let N=A.getTokensFromRange(S[F]);D=D.replace(S[F],"["+N.join(",")+"]")}return D},C=function(S){return typeof S=="string"&&(S=S.trim()),!isNaN(S)&&S!==null&&S!==""},A=function(S,D,F,N,_){j=_,p=F,b=N;let G="",U={};if(D)if(D.size){let ae,ye=null;D.forEach(function(Ne,be){ae=be.replace(/!/g,"."),ae.indexOf(".")!==-1&&(ae=ae.split("."),U[ae[0]]=!0)}),ae=Object.keys(U);for(let Ne=0;Ne<ae.length;Ne++)G+="var "+ae[Ne]+" = {};";D.forEach(function(Ne,be){ae=be.replace(/!/g,"."),Ne===null||C(Ne)||(ye=Ne.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),ye&&ye.length&&(Ne=updateRanges(ye,Ne))),ae.indexOf(".")>0?G+=ae+" = "+D.get(be)+`;
`:G+="var "+ae+" = "+Ne+`;
`})}else{let ae=Object.keys(D);if(ae.length){let ye,Ne={};for(let be=0;be<ae.length;be++)if(ye=ae[be].replace(/\!/g,"."),ye.indexOf(".")>0){let le=le.split(".");Ne[le[0]]={}}ye=Object.keys(Ne);for(let be=0;be<ye.length;be++)G+="var "+ye[be]+" = {};";for(let be=0;be<ae.length;be++){if(ye=ae[be].replace(/!/g,"."),D[ae[be]]!==null&&!C(D[ae[be]])){let le=D[ae[be]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);le&&le.length&&(D[ae[be]]=v(le,D[ae[be]]))}ye.indexOf(".")>0?G+=ye+" = "+D[ae[be]]+`;
`:G+="var "+ye+" = "+D[ae[be]]+`;
`}}}let re=(S=function(ae,ye){let Ne="",be=0,le=["=","!",">","<"];for(let Ye=0;Ye<ae.length;Ye++)ae[Ye]==='"'&&(be=be===0?1:0),be===1?Ne+=ae[Ye]:(Ne+=ae[Ye].toUpperCase(),Ye>0&&ae[Ye]==="="&&le.indexOf(ae[Ye-1])===-1&&le.indexOf(ae[Ye+1])===-1&&(Ne+="="));return Ne=Ne.replace(/\^/g,"**"),Ne=Ne.replace(/<>/g,"!="),Ne=Ne.replace(/&/g,"+"),Ne=Ne.replace(/\$/g,""),Ne}(S=(S=S.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);re&&re.length&&(S=v(re,S));let fe=new Function(G+"; return "+S)();return fe===null&&(fe=0),fe};return A.getColumnNameFromCoords=function(S,D){return N="",(F=parseInt(S))>701?(N+=String.fromCharCode(64+parseInt(F/676)),N+=String.fromCharCode(64+parseInt(F%676/26))):F>25&&(N+=String.fromCharCode(64+parseInt(F/26))),N+String.fromCharCode(65+F%26)+(parseInt(D)+1);var F,N},A.getCoordsFromColumnName=function(S){var D=/^[a-zA-Z]+/.exec(S);if(D){for(var F=0,N=0;N<D[0].length;N++)F+=parseInt(D[0].charCodeAt(N)-64)*Math.pow(26,D[0].length-1-N);--F<0&&(F=0);var _=parseInt(/[0-9]+$/.exec(S))||null;return _>0&&_--,[F,_]}},A.getRangeFromTokens=function(S){S=S.filter(function(_){return _!="#REF!"});for(var D="",F="",N=0;N<S.length;N++)S[N].indexOf(".")>=0?D=".":S[N].indexOf("!")>=0&&(D="!"),D&&(F=S[N].split(D),S[N]=F[1],F=F[0]+D);return S.sort(function(_,G){var U=Helpers.getCoordsFromColumnName(_),re=Helpers.getCoordsFromColumnName(G);return U[1]>re[1]?1:U[1]<re[1]?-1:U[0]>re[0]?1:U[0]<re[0]?-1:0}),S.length?F+(S[0]+":")+S[S.length-1]:"#REF!"},A.getTokensFromRange=function(S){if(S.indexOf(".")>0){var D=S.split(".");S=D[1],D=D[0]+"."}else S.indexOf("!")>0?(D=S.split("!"),S=D[1],D=D[0]+"!"):D="";S=S.split(":");var F=A.getCoordsFromColumnName(S[0]),N=A.getCoordsFromColumnName(S[1]);if(F[0]<=N[0])var _=F[0],G=N[0];else _=N[0],G=F[0];if(F[1]===null&&N[1]==null)for(var U=null,re=null,fe=Object.keys(vars),ae=0;ae<fe.length;ae++){var ye=A.getCoordsFromColumnName(fe[ae]);ye[0]===F[0]&&(U===null||ye[1]<U)&&(U=ye[1]),ye[0]===N[0]&&(re===null||ye[1]>re)&&(re=ye[1])}else F[1]<=N[1]?(U=F[1],re=N[1]):(U=N[1],re=F[1]);for(var Ne=[],be=U;be<=re;be++){var le=[];for(ae=_;ae<=G;ae++)le.push(D+A.getColumnNameFromCoords(ae,be));Ne.push(le)}return Ne},A.setFormula=function(S){let D=Object.keys(S);for(let F=0;F<D.length;F++)typeof S[D[F]]=="function"&&(T[D[F]]=S[D[F]])},A.basic=!0,A}(typeof window>"u"?s.g:window)},592:function(E,u,s){"use strict";var m=s(162),T=s(765);let M=new Error("#NULL!"),g=new Error("#DIV/0!"),p=new Error("#VALUE!"),b=new Error("#REF!"),j=new Error("#NAME?"),v=new Error("#NUM!"),C=new Error("#N/A"),A=new Error("#ERROR!"),S=new Error("#GETTING_DATA");var D=Object.freeze({__proto__:null,data:S,div0:g,error:A,na:C,name:j,nil:M,num:v,ref:b,value:p});function F(r){let l=[];return N(r,f=>{l.push(f)}),l}function N(r,l){let f=-1,w=r.length;for(;++f<w&&l(r[f],f,r)!==!1;);return r}function _(r){let l,f=r.length;for(;f--;)if(l=r[f],typeof l!="number")if(l!==!0)if(l!==!1){if(typeof l=="string"){let w=W(l);r[f]=w instanceof Error?0:w}}else r[f]=0;else r[f]=1;return r}function G(r,l){if(!r)return p;r.every(O=>Array.isArray(O))&&r.length!==0||(r=[[...r]]),r.map((O,V)=>{O.map((Q,oe)=>{Q||(r[V][oe]=0)})});let f=r.reduce((O,V,Q)=>V.length>r[O].length?Q:O,0),w=r[f].length;return r.map(O=>[...O,...Array(w-O.length).fill(l||0)])}function U(){let r;if(arguments.length===1){let f=arguments[0];r=(l=f)!=null&&typeof l.length=="number"&&typeof l!="string"?F.apply(null,arguments):[f]}else r=Array.from(arguments);for(var l;!fe(r);)r=re(r);return r}function re(r){return r&&r.reduce?r.reduce((l,f)=>{let w=Array.isArray(l),O=Array.isArray(f);return w&&O?l.concat(f):w?(l.push(f),l):O?[l].concat(f):[l,f]}):[r]}function fe(r){if(!r)return!1;for(let l=0;l<r.length;++l)if(Array.isArray(r[l]))return!1;return!0}function ae(r,l){return l=l||1,r&&typeof r.slice=="function"?r.slice(l):r}function ye(r){return r?r[0].map((l,f)=>r.map(w=>w[f])):p}function Ne(r,l){let f=null;return N(r,(w,O)=>{if(w[0]===l)return f=O,!1}),f??p}function be(){for(let r=0;r<arguments.length;r++)if(arguments[r]instanceof Error)return arguments[r]}function le(){let r=arguments.length;for(;r--;)if(arguments[r]instanceof Error)return!0;return!1}function Ye(r){return Math.round(r*1e14)/1e14}function $e(){return U.apply(null,arguments).filter(r=>typeof r=="number")}function Ge(r){if(typeof r=="boolean"||r instanceof Error)return r;if(typeof r=="number")return r!==0;if(typeof r=="string"){let l=r.toUpperCase();if(l==="TRUE")return!0;if(l==="FALSE")return!1}return r instanceof Date&&!isNaN(r)||p}function ze(r){if(!isNaN(r)){if(r instanceof Date)return new Date(r);let l=parseFloat(r);return l<0||l>=2958466?v:function(f){f<60&&(f+=1);let w=Math.floor(f-25569),O=new Date(86400*w*1e3),V=f-Math.floor(f)+1e-7,Q=Math.floor(86400*V),oe=Q%60;Q-=oe;let pe=Math.floor(Q/3600),we=Math.floor(Q/60)%60,De=O.getUTCDate(),Ue=O.getUTCMonth();return f>=60&&f<61&&(De=29,Ue=1),new Date(O.getUTCFullYear(),Ue,De,pe,we,oe)}(l)}return typeof r!="string"||(r=/(\d{4})-(\d\d?)-(\d\d?)$/.test(r)?new Date(r+"T00:00:00.000"):new Date(r),isNaN(r))?p:r}function vt(r){let l,f=r.length;for(;f--;){if(l=ze(r[f]),l===p)return l;r[f]=l}return r}function W(r){return r instanceof Error?r:r==null?0:(typeof r=="boolean"&&(r=+r),isNaN(r)||r===""?p:parseFloat(r))}function ke(r){let l,f;if(!r||(l=r.length)===0)return p;for(;l--;){if(r[l]instanceof Error)return r[l];if(f=W(r[l]),f instanceof Error)return f;r[l]=f}return r}function Ze(r){return r instanceof Error?r:r==null?"":r.toString()}function Oe(){let r=arguments.length;for(;r--;)if(typeof arguments[r]=="string")return!0;return!1}function Ie(r){return r!=null}let Fe="=",Be=[">",">=","<","<=","=","<>"],Ke="operator",et="literal",bt=[Ke,et],Tt=Ke,jt=et;function Ut(r,l){if(bt.indexOf(l)===-1)throw new Error("Unsupported token type: "+l);return{value:r,type:l}}function bn(r){return function(l){let f="",w=[];for(let O=0;O<l.length;O++){let V=l[O];O===0&&Be.indexOf(V)>=0?w.push(Ut(V,Tt)):f+=V}return f.length>0&&w.push(Ut(function(O){return typeof O!="string"||/^\d+(\.\d+)?$/.test(O)&&(O=O.indexOf(".")===-1?parseInt(O,10):parseFloat(O)),O}(f),jt)),w.length>0&&w[0].type!==Tt&&w.unshift(Ut(Fe,Tt)),w}(function(l){let f=l.length,w=[],O=0,V="",Q="";for(;O<f;){let oe=l.charAt(O);switch(oe){case">":case"<":case"=":Q+=oe,V.length>0&&(w.push(V),V="");break;default:Q.length>0&&(w.push(Q),Q=""),V+=oe}O++}return V.length>0&&w.push(V),Q.length>0&&w.push(Q),w}(r))}let Yt=function(r){let l=[],f;for(let w=0;w<r.length;w++){let O=r[w];switch(O.type){case Tt:f=O.value;break;case jt:l.push(O.value)}}return function(w,O){let V=!1;switch(O){case">":V=w[0]>w[1];break;case">=":V=w[0]>=w[1];break;case"<":V=w[0]<w[1];break;case"<=":V=w[0]<=w[1];break;case"=":V=w[0]==w[1];break;case"<>":V=w[0]!=w[1]}return V}(l,f)},fi={};function pi(r){return[p,b,g,v,j,M].indexOf(r)>=0||typeof r=="number"&&(isNaN(r)||!isFinite(r))}function Dt(r){return pi(r)||r===C}function Wl(r){return r===!0||r===!1}function Rr(r){return typeof r=="number"&&!isNaN(r)&&isFinite(r)}function L(r){return typeof r=="string"}function I(){let r=[];for(let l=0;l<arguments.length;++l){let f=!1,w=arguments[l];for(let O=0;O<r.length&&(f=r[O]===w,!f);++O);f||r.push(w)}return r}function h(r,l,f,w){if(!l||!f)return C;w=!(w===0||w===!1);let O=C,V=typeof r=="number",Q=!1;for(let oe=0;oe<l.length;oe++){let pe=l[oe];if(pe[0]===r){O=f<pe.length+1?pe[f-1]:b;break}!Q&&(V&&w&&pe[0]<=r||w&&typeof pe[0]=="string"&&pe[0].localeCompare(r)<0)&&(O=f<pe.length+1?pe[f-1]:b),V&&pe[0]>r&&(Q=!0)}return O}function c(){let r=U(arguments).filter(Ie);if(r.length===0)return g;let l=be.apply(void 0,r);if(l)return l;let f=$e(r),w=f.length,O,V=0,Q=0;for(let oe=0;oe<w;oe++)V+=f[oe],Q+=1;return O=V/Q,isNaN(O)&&(O=v),O}function B(){let r=U(arguments).filter(Ie);if(r.length===0)return g;let l=be.apply(void 0,r);if(l)return l;let f=r,w=f.length,O,V=0,Q=0;for(let oe=0;oe<w;oe++){let pe=f[oe];typeof pe=="number"&&(V+=pe),pe===!0&&V++,pe!==null&&Q++}return O=V/Q,isNaN(O)&&(O=v),O}fi.TYPE=r=>{switch(r){case M:return 1;case g:return 2;case p:return 3;case b:return 4;case j:return 5;case v:return 6;case C:return 7;case S:return 8}return C};let K={DIST:function(r,l,f,w,O,V){return arguments.length<4?p:(O=O===void 0?0:O,V=V===void 0?1:V,le(r=W(r),l=W(l),f=W(f),O=W(O),V=W(V))?p:(r=(r-O)/(V-O),w?m.beta.cdf(r,l,f):m.beta.pdf(r,l,f)))},INV:(r,l,f,w,O)=>(w=w===void 0?0:w,O=O===void 0?1:O,le(r=W(r),l=W(l),f=W(f),w=W(w),O=W(O))?p:m.beta.inv(r,l,f)*(O-w)+w)},ee={DIST:(r,l,f,w)=>le(r=W(r),l=W(l),f=W(f),w=W(w))?p:w?m.binomial.cdf(r,l,f):m.binomial.pdf(r,l,f)};ee.DIST.RANGE=(r,l,f,w)=>{if(w=w===void 0?f:w,le(r=W(r),l=W(l),f=W(f),w=W(w)))return p;let O=0;for(let V=f;V<=w;V++)O+=st(r,V)*Math.pow(l,V)*Math.pow(1-l,r-V);return O},ee.INV=(r,l,f)=>{if(le(r=W(r),l=W(l),f=W(f)))return p;let w=0;for(;w<=r;){if(m.binomial.cdf(w,r,l)>=f)return w;w++}};let P={DIST:(r,l,f)=>le(r=W(r),l=W(l))?p:f?m.chisquare.cdf(r,l):m.chisquare.pdf(r,l)};P.DIST.RT=(r,l)=>!r|!l?C:r<1||l>Math.pow(10,10)?v:typeof r!="number"||typeof l!="number"?p:1-m.chisquare.cdf(r,l),P.INV=(r,l)=>le(r=W(r),l=W(l))?p:m.chisquare.inv(r,l),P.INV.RT=(r,l)=>!r|!l?C:r<0||r>1||l<1||l>Math.pow(10,10)?v:typeof r!="number"||typeof l!="number"?p:m.chisquare.inv(1-r,l),P.TEST=function(r,l){if(arguments.length!==2)return C;if(!(r instanceof Array&&l instanceof Array)||r.length!==l.length||r[0]&&l[0]&&r[0].length!==l[0].length)return p;let f=r.length,w,O,V;for(O=0;O<f;O++)r[O]instanceof Array||(w=r[O],r[O]=[],r[O].push(w)),l[O]instanceof Array||(w=l[O],l[O]=[],l[O].push(w));let Q=r[0].length,oe=Q===1?f-1:(f-1)*(Q-1),pe=0,we=Math.PI;for(O=0;O<f;O++)for(V=0;V<Q;V++)pe+=Math.pow(r[O][V]-l[O][V],2)/l[O][V];return Math.round(1e6*function(De,Ue){let Pe=Math.exp(-.5*De);Ue%2==1&&(Pe*=Math.sqrt(2*De/we));let Je=Ue;for(;Je>=2;)Pe=Pe*De/Je,Je-=2;let it=Pe,at=Ue;for(;it>1e-10*Pe;)at+=2,it=it*De/at,Pe+=it;return 1-Pe}(pe,oe))/1e6};let H={};function z(){return $e(U(arguments)).length}function X(){let r=U(arguments);return r.length-ie(r)}function ie(){let r=U(arguments),l,f=0;for(let w=0;w<r.length;w++)l=r[w],l!=null&&l!==""||f++;return f}H.NORM=(r,l,f)=>le(r=W(r),l=W(l),f=W(f))?p:m.normalci(1,r,l,f)[1]-1,H.T=(r,l,f)=>le(r=W(r),l=W(l),f=W(f))?p:m.tci(1,r,l,f)[1]-1;let me={P:(r,l)=>{if(le(r=ke(U(r)),l=ke(U(l))))return p;let f=m.mean(r),w=m.mean(l),O=0,V=r.length;for(let Q=0;Q<V;Q++)O+=(r[Q]-f)*(l[Q]-w);return O/V},S:(r,l)=>le(r=ke(U(r)),l=ke(U(l)))?p:m.covariance(r,l)},se={DIST:(r,l,f)=>le(r=W(r),l=W(l))?p:f?m.exponential.cdf(r,l):m.exponential.pdf(r,l)},ce={};function Me(r,l,f){if(le(r=W(r),l=ke(U(l)),f=ke(U(f))))return p;let w=m.mean(f),O=m.mean(l),V=f.length,Q=0,oe=0;for(let we=0;we<V;we++)Q+=(f[we]-w)*(l[we]-O),oe+=Math.pow(f[we]-w,2);let pe=Q/oe;return O-pe*w+pe*r}function Se(r){return(r=W(r))instanceof Error?r:r===0||parseInt(r,10)===r&&r<0?v:m.gammafn(r)}function Te(r){return(r=W(r))instanceof Error?r:m.gammaln(r)}ce.DIST=(r,l,f,w)=>le(r=W(r),l=W(l),f=W(f))?p:w?m.centralF.cdf(r,l,f):m.centralF.pdf(r,l,f),ce.DIST.RT=function(r,l,f){return arguments.length!==3?C:r<0||l<1||f<1?v:typeof r!="number"||typeof l!="number"||typeof f!="number"?p:1-m.centralF.cdf(r,l,f)},ce.INV=(r,l,f)=>le(r=W(r),l=W(l),f=W(f))?p:r<=0||r>1?v:m.centralF.inv(r,l,f),ce.INV.RT=function(r,l,f){return arguments.length!==3?C:r<0||r>1||l<1||l>Math.pow(10,10)||f<1||f>Math.pow(10,10)?v:typeof r!="number"||typeof l!="number"||typeof f!="number"?p:m.centralF.inv(1-r,l,f)},ce.TEST=(r,l)=>{if(!r||!l||!(r instanceof Array&&l instanceof Array))return C;if(r.length<2||l.length<2)return g;let f=(V,Q)=>{let oe=0;for(let pe=0;pe<V.length;pe++)oe+=Math.pow(V[pe]-Q,2);return oe},w=mr(r)/r.length,O=mr(l)/l.length;return f(r,w)/(r.length-1)/(f(l,O)/(l.length-1))},Se.DIST=function(r,l,f,w){return arguments.length!==4?C:r<0||l<=0||f<=0||typeof r!="number"||typeof l!="number"||typeof f!="number"?p:w?m.gamma.cdf(r,l,f,!0):m.gamma.pdf(r,l,f,!1)},Se.INV=function(r,l,f){return arguments.length!==3?C:r<0||r>1||l<=0||f<=0?v:typeof r!="number"||typeof l!="number"||typeof f!="number"?p:m.gamma.inv(r,l,f)},Te.PRECISE=function(r){return arguments.length!==1?C:r<=0?v:typeof r!="number"?p:m.gammaln(r)};let Xe={};function tt(r,l){return le(r=ke(U(r)),l=W(l))?r:l<0||r.length<l?p:r.sort((f,w)=>w-f)[l-1]}function he(r,l){if(le(r=ke(U(r)),l=ke(U(l))))return p;let f=m.mean(r),w=m.mean(l),O=l.length,V=0,Q=0;for(let pe=0;pe<O;pe++)V+=(l[pe]-w)*(r[pe]-f),Q+=Math.pow(l[pe]-w,2);let oe=V/Q;return[oe,f-oe*w]}Xe.DIST=(r,l,f,w,O)=>{if(le(r=W(r),l=W(l),f=W(f),w=W(w)))return p;function V(Q,oe,pe,we){return st(pe,Q)*st(we-pe,oe-Q)/st(we,oe)}return O?function(Q,oe,pe,we){let De=0;for(let Ue=0;Ue<=Q;Ue++)De+=V(Ue,oe,pe,we);return De}(r,l,f,w):V(r,l,f,w)};let ue={};function je(){let r=U(arguments),l=be.apply(void 0,r);if(l)return l;let f=$e(r);return f.length===0?0:Math.max.apply(Math,f)}function Y(){let r=U(arguments),l=be.apply(void 0,r);if(l)return l;let f=_(r),w=m.median(f);return isNaN(w)&&(w=v),w}function q(){let r=U(arguments),l=be.apply(void 0,r);if(l)return l;let f=$e(r);return f.length===0?0:Math.min.apply(Math,f)}ue.DIST=(r,l,f,w)=>le(r=W(r),l=W(l),f=W(f))?p:w?m.lognormal.cdf(r,l,f):m.lognormal.pdf(r,l,f),ue.INV=(r,l,f)=>le(r=W(r),l=W(l),f=W(f))?p:m.lognormal.inv(r,l,f);let k={MULT:function(){let r=ke(U(arguments));if(r instanceof Error)return r;let l=r.length,f={},w,O=[],V=0;for(let Q=0;Q<l;Q++)w=r[Q],f[w]=f[w]?f[w]+1:1,f[w]>V&&(V=f[w],O=[]),f[w]===V&&(O[O.length]=w);return O},SNGL:function(){let r=ke(U(arguments));return r instanceof Error?r:k.MULT(r).sort((l,f)=>l-f)[0]}},R={DIST:(r,l,f,w)=>le(r=W(r),l=W(l),f=W(f))?p:w?m.negbin.cdf(r,l,f):m.negbin.pdf(r,l,f)},Z={};function de(r,l){if(le(l=ke(U(l)),r=ke(U(r))))return p;let f=m.mean(r),w=m.mean(l),O=r.length,V=0,Q=0,oe=0;for(let pe=0;pe<O;pe++)V+=(r[pe]-f)*(l[pe]-w),Q+=Math.pow(r[pe]-f,2),oe+=Math.pow(l[pe]-w,2);return V/Math.sqrt(Q*oe)}Z.DIST=(r,l,f,w)=>le(r=W(r),l=W(l),f=W(f))?p:f<=0?v:w?m.normal.cdf(r,l,f):m.normal.pdf(r,l,f),Z.INV=(r,l,f)=>le(r=W(r),l=W(l),f=W(f))?p:m.normal.inv(r,l,f),Z.S={},Z.S.DIST=(r,l)=>(r=W(r))instanceof Error?p:l?m.normal.cdf(r,0,1):m.normal.pdf(r,0,1),Z.S.INV=r=>(r=W(r))instanceof Error?p:m.normal.inv(r,0,1);let ne={EXC:(r,l)=>{if(le(r=ke(U(r)),l=W(l)))return p;let f=(r=r.sort((V,Q)=>V-Q)).length;if(l<1/(f+1)||l>1-1/(f+1))return v;let w=l*(f+1)-1,O=Math.floor(w);return Ye(w===O?r[w]:r[O]+(w-O)*(r[O+1]-r[O]))},INC:(r,l)=>{if(le(r=ke(U(r)),l=W(l)))return p;let f=l*((r=r.sort((O,V)=>O-V)).length-1),w=Math.floor(f);return Ye(f===w?r[f]:r[w]+(f-w)*(r[w+1]-r[w]))}},J={EXC:(r,l,f)=>{if(f=f===void 0?3:f,le(r=ke(U(r)),l=W(l),f=W(f)))return p;r=r.sort((De,Ue)=>De-Ue);let w=I.apply(null,r),O=r.length,V=w.length,Q=Math.pow(10,f),oe=0,pe=!1,we=0;for(;!pe&&we<V;)l===w[we]?(oe=(r.indexOf(w[we])+1)/(O+1),pe=!0):l>=w[we]&&(l<w[we+1]||we===V-1)&&(oe=(r.indexOf(w[we])+1+(l-w[we])/(w[we+1]-w[we]))/(O+1),pe=!0),we++;return Math.floor(oe*Q)/Q},INC:(r,l,f)=>{if(f=f===void 0?3:f,le(r=ke(U(r)),l=W(l),f=W(f)))return p;r=r.sort((De,Ue)=>De-Ue);let w=I.apply(null,r),O=r.length,V=w.length,Q=Math.pow(10,f),oe=0,pe=!1,we=0;for(;!pe&&we<V;)l===w[we]?(oe=r.indexOf(w[we])/(O-1),pe=!0):l>=w[we]&&(l<w[we+1]||we===V-1)&&(oe=(r.indexOf(w[we])+(l-w[we])/(w[we+1]-w[we]))/(O-1),pe=!0),we++;return Math.floor(oe*Q)/Q}},ve={DIST:(r,l,f)=>le(r=W(r),l=W(l))?p:f?m.poisson.cdf(r,l):m.poisson.pdf(r,l)},xe={EXC:(r,l)=>{if(le(r=ke(U(r)),l=W(l)))return p;switch(l){case 1:return ne.EXC(r,.25);case 2:return ne.EXC(r,.5);case 3:return ne.EXC(r,.75);default:return v}},INC:(r,l)=>{if(le(r=ke(U(r)),l=W(l)))return p;switch(l){case 1:return ne.INC(r,.25);case 2:return ne.INC(r,.5);case 3:return ne.INC(r,.75);default:return v}}},Ce={};function Ae(){let r=ke(U(arguments));if(r instanceof Error)return r;let l=m.mean(r),f=r.length,w=0;for(let O=0;O<f;O++)w+=Math.pow(r[O]-l,3);return f*w/((f-1)*(f-2)*Math.pow(m.stdev(r,!0),3))}function _e(r,l){return le(r=ke(U(r)),l=W(l))?r:r.sort((f,w)=>f-w)[l-1]}Ce.AVG=(r,l,f)=>{if(le(r=W(r),l=ke(U(l))))return p;let w=(f=f||!1)?(Q,oe)=>Q-oe:(Q,oe)=>oe-Q,O=(l=(l=U(l)).sort(w)).length,V=0;for(let Q=0;Q<O;Q++)l[Q]===r&&V++;return V>1?(2*l.indexOf(r)+V+1)/2:l.indexOf(r)+1},Ce.EQ=(r,l,f)=>{if(le(r=W(r),l=ke(U(l))))return p;let w=(f=f||!1)?(O,V)=>O-V:(O,V)=>V-O;return(l=l.sort(w)).indexOf(r)+1},Ae.P=function(){let r=ke(U(arguments));if(r instanceof Error)return r;let l=m.mean(r),f=r.length,w=0,O=0;for(let V=0;V<f;V++)O+=Math.pow(r[V]-l,3),w+=Math.pow(r[V]-l,2);return O/=f,w/=f,O/Math.pow(w,1.5)};let We={P:function(){let r=te.P.apply(this,arguments),l=Math.sqrt(r);return isNaN(l)&&(l=v),l},S:function(){let r=te.S.apply(this,arguments);return Math.sqrt(r)}},nt={DIST:(r,l,f)=>f!==1&&f!==2?v:f===1?nt.DIST.RT(r,l):nt.DIST["2T"](r,l)};nt.DIST["2T"]=function(r,l){return arguments.length!==2?C:r<0||l<1?v:typeof r!="number"||typeof l!="number"?p:2*(1-m.studentt.cdf(r,l))},nt.DIST.RT=function(r,l){return arguments.length!==2?C:r<0||l<1?v:typeof r!="number"||typeof l!="number"?p:1-m.studentt.cdf(r,l)},nt.INV=(r,l)=>le(r=W(r),l=W(l))?p:m.studentt.inv(r,l),nt.INV["2T"]=(r,l)=>(r=W(r),l=W(l),r<=0||r>1||l<1?v:le(r,l)?p:Math.abs(m.studentt.inv(r/2,l))),nt.TEST=(r,l)=>{if(le(r=ke(U(r)),l=ke(U(l))))return p;let f=m.mean(r),w=m.mean(l),O,V=0,Q=0;for(O=0;O<r.length;O++)V+=Math.pow(r[O]-f,2);for(O=0;O<l.length;O++)Q+=Math.pow(l[O]-w,2);V/=r.length-1,Q/=l.length-1;let oe=Math.abs(f-w)/Math.sqrt(V/r.length+Q/l.length);return nt.DIST["2T"](oe,r.length+l.length-2)};let te={};function ge(){let r=U(arguments),l=r.length,f=0,w=0,O=B(r);for(let V=0;V<l;V++){let Q=r[V];f+=Math.pow(typeof Q=="number"?Q-O:Q===!0?1-O:0-O,2),Q!==null&&w++}return f/(w-1)}function Ee(){let r=U(arguments),l=r.length,f=0,w=0,O=B(r),V;for(let Q=0;Q<l;Q++){let oe=r[Q];f+=Math.pow(typeof oe=="number"?oe-O:oe===!0?1-O:0-O,2),oe!==null&&w++}return V=f/w,isNaN(V)&&(V=v),V}te.P=function(){let r=$e(U(arguments)),l=r.length,f=0,w=c(r),O;for(let V=0;V<l;V++)f+=Math.pow(r[V]-w,2);return O=f/l,isNaN(O)&&(O=v),O},te.S=function(){let r=$e(U(arguments)),l=r.length,f=0,w=c(r);for(let O=0;O<l;O++)f+=Math.pow(r[O]-w,2);return f/(l-1)};let Re={DIST:(r,l,f,w)=>le(r=W(r),l=W(l),f=W(f))?p:w?1-Math.exp(-Math.pow(r/f,l)):Math.pow(r,l-1)*Math.exp(-Math.pow(r/f,l))*l/Math.pow(f,l)},ot={};function Qe(r,l,f){let w=be(r=W(r),l=W(l),f=W(f));if(w)return w;if(l===0)return 0;l=Math.abs(l);let O=-Math.floor(Math.log(l)/Math.log(10));return r>=0?Nn(Math.ceil(r/l)*l,O):f===0?-Nn(Math.floor(Math.abs(r)/l)*l,O):-Nn(Math.ceil(Math.abs(r)/l)*l,O)}function st(r,l){return be(r=W(r),l=W(l))||(r<l?v:qe(r)/(qe(l)*qe(r-l)))}ot.TEST=(r,l,f)=>{if(le(r=ke(U(r)),l=W(l)))return p;f=f||We.S(r);let w=r.length;return 1-Z.S.DIST((c(r)-l)/(f/Math.sqrt(w)),!0)},Qe.MATH=Qe,Qe.PRECISE=Qe;let Ct=[];function qe(r){if((r=W(r))instanceof Error)return r;let l=Math.floor(r);return l===0||l===1?1:(Ct[l]>0||(Ct[l]=qe(l-1)*l),Ct[l])}function Ve(r,l){let f=be(r=W(r),l=W(l));if(f)return f;if(l===0)return 0;if(!(r>=0&&l>0||r<=0&&l<0))return v;l=Math.abs(l);let w=-Math.floor(Math.log(l)/Math.log(10));return r>=0?Nn(Math.floor(r/l)*l,w):-Nn(Math.ceil(Math.abs(r)/l),w)}Ve.MATH=(r,l,f)=>{if(l instanceof Error)return l;l=l===void 0?0:l;let w=be(r=W(r),l=W(l),f=W(f));if(w)return w;if(l===0)return 0;l=l?Math.abs(l):1;let O=-Math.floor(Math.log(l)/Math.log(10));return r>=0?Nn(Math.floor(r/l)*l,O):f===0||f===void 0?-Nn(Math.ceil(Math.abs(r)/l)*l,O):-Nn(Math.floor(Math.abs(r)/l)*l,O)},Ve.PRECISE=Ve.MATH;let Tp={CEILING:Qe};function Su(r,l){let f=be(r=W(r),l=W(l));if(f)return f;if(r===0&&l===0)return v;let w=Math.pow(r,l);return isNaN(w)?v:w}function Gl(){let r=U(arguments).filter(w=>w!=null);if(r.length===0)return 0;let l=ke(r);if(l instanceof Error)return l;let f=1;for(let w=0;w<l.length;w++)f*=l[w];return f}function Nn(r,l){return be(r=W(r),l=W(l))||+(Math.round(+(r+"e"+l))+"e"+-1*l)}function mr(){let r=0;return N(F(arguments),l=>{if(r instanceof Error)return!1;if(l instanceof Error)r=l;else if(typeof l=="number")r+=l;else if(typeof l=="string"){let f=parseFloat(l);!isNaN(f)&&(r+=f)}else if(Array.isArray(l)){let f=mr.apply(null,l);f instanceof Error?r=f:r+=f}}),r}var Dp=Object.freeze({__proto__:null,ADD:function(r,l){return arguments.length!==2?C:be(r=W(r),l=W(l))||r+l},DIVIDE:function(r,l){return arguments.length!==2?C:be(r=W(r),l=W(l))||(l===0?g:r/l)},EQ:function(r,l){return arguments.length!==2?C:r instanceof Error?r:l instanceof Error?l:(r===null&&(r=void 0),l===null&&(l=void 0),r===l)},GT:function(r,l){return arguments.length!==2?C:r instanceof Error?r:l instanceof Error?l:(Oe(r,l)?(r=Ze(r),l=Ze(l)):(r=W(r),l=W(l)),be(r,l)||r>l)},GTE:function(r,l){return arguments.length!==2?C:(Oe(r,l)?(r=Ze(r),l=Ze(l)):(r=W(r),l=W(l)),be(r,l)||r>=l)},LT:function(r,l){return arguments.length!==2?C:(Oe(r,l)?(r=Ze(r),l=Ze(l)):(r=W(r),l=W(l)),be(r,l)||r<l)},LTE:function(r,l){return arguments.length!==2?C:(Oe(r,l)?(r=Ze(r),l=Ze(l)):(r=W(r),l=W(l)),be(r,l)||r<=l)},MINUS:function(r,l){return arguments.length!==2?C:be(r=W(r),l=W(l))||r-l},MULTIPLY:function(r,l){return arguments.length!==2?C:be(r=W(r),l=W(l))||r*l},NE:function(r,l){return arguments.length!==2?C:r instanceof Error?r:l instanceof Error?l:(r===null&&(r=void 0),l===null&&(l=void 0),r!==l)},POW:function(r,l){return arguments.length!==2?C:Su(r,l)}});let Op=new Date(Date.UTC(1900,0,1)),Fp=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],Rp=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],hi=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function mo(r,l,f){f=f.toUpperCase(),r=ze(r),l=ze(l);let w=r.getFullYear(),O=r.getMonth(),V=r.getDate(),Q=l.getFullYear(),oe=l.getMonth(),pe=l.getDate(),we;switch(f){case"Y":we=Math.floor(Zl(r,l));break;case"D":we=vr(l,r);break;case"M":we=oe-O+12*(Q-w),pe<V&&we--;break;case"MD":V<=pe?we=pe-V:(oe===0?(r.setFullYear(Q-1),r.setMonth(12)):(r.setFullYear(Q),r.setMonth(oe-1)),we=vr(l,r));break;case"YM":we=oe-O+12*(Q-w),pe<V&&we--,we%=12;break;case"YD":oe>O||oe===O&&pe<V?r.setFullYear(Q):r.setFullYear(Q-1),we=vr(l,r)}return we}function gi(r){let l=new Date(r);return l.setHours(0,0,0,0),l}function vr(r,l){return r=ze(r),l=ze(l),r instanceof Error?r:l instanceof Error?l:Nu(gi(r))-Nu(gi(l))}function Xn(r,l,f){if(f=Ge(f||"false"),r=ze(r),l=ze(l),r instanceof Error)return r;if(l instanceof Error)return l;if(f instanceof Error)return f;let w=r.getMonth(),O,V,Q=l.getMonth();if(f)O=r.getDate()===31?30:r.getDate(),V=l.getDate()===31?30:l.getDate();else{let oe=new Date(r.getFullYear(),w+1,0).getDate(),pe=new Date(l.getFullYear(),Q+1,0).getDate();O=r.getDate()===oe?30:r.getDate(),l.getDate()===pe?O<30?(Q++,V=1):V=30:V=l.getDate()}return 360*(l.getFullYear()-r.getFullYear())+30*(Q-w)+(V-O)}function Lu(r){if((r=ze(r))instanceof Error)return r;(r=gi(r)).setDate(r.getDate()+4-(r.getDay()||7));let l=new Date(r.getFullYear(),0,1);return Math.ceil(((r-l)/864e5+1)/7)}function mi(r,l,f){return mi.INTL(r,l,1,f)}function vi(r,l,f){return vi.INTL(r,l,1,f)}function Xl(r){return new Date(r,1,29).getMonth()===1}function bi(r,l){return Math.ceil((l-r)/1e3/60/60/24)}function Zl(r,l,f){if((r=ze(r))instanceof Error)return r;if((l=ze(l))instanceof Error)return l;f=f||0;let w=r.getDate(),O=r.getMonth()+1,V=r.getFullYear(),Q=l.getDate(),oe=l.getMonth()+1,pe=l.getFullYear();switch(f){case 0:return w===31&&Q===31?(w=30,Q=30):w===31?w=30:w===30&&Q===31&&(Q=30),(Q+30*oe+360*pe-(w+30*O+360*V))/360;case 1:{let we=(Je,it)=>{let at=Je.getFullYear(),qt=new Date(at,2,1);if(Xl(at)&&Je<qt&&it>=qt)return!0;let Et=it.getFullYear(),Zn=new Date(Et,2,1);return Xl(Et)&&it>=Zn&&Je<Zn},De=365;if(V===pe||V+1===pe&&(O>oe||O===oe&&w>=Q))return(V===pe&&Xl(V)||we(r,l)||oe===1&&Q===29)&&(De=366),bi(r,l)/De;let Ue=pe-V+1,Pe=(new Date(pe+1,0,1)-new Date(V,0,1))/1e3/60/60/24/Ue;return bi(r,l)/Pe}case 2:return bi(r,l)/360;case 3:return bi(r,l)/365;case 4:return(Q+30*oe+360*pe-(w+30*O+360*V))/360}}function Nu(r){let l=r>-22038912e5?2:1;return Math.ceil((r-Op)/864e5)+l}function ku(r){return(r=W(r))===0?p:r instanceof Error?r:String.fromCharCode(r)}function Mu(r){if(le(r))return r;let l=(r=r||"").charCodeAt(0);return isNaN(l)&&(l=p),l}function Iu(){let r=U(arguments),l=be.apply(void 0,r);if(l)return l;let f=0;for(;(f=r.indexOf(!0))>-1;)r[f]="TRUE";let w=0;for(;(w=r.indexOf(!1))>-1;)r[w]="FALSE";return r.join("")}mi.INTL=(r,l,f,w)=>{if((r=ze(r))instanceof Error)return r;if((l=ze(l))instanceof Error)return l;let O=!1,V=[],Q=[1,2,3,4,5,6,0],oe=new RegExp("^[0|1]{7}$");if(f===void 0)f=hi[1];else if(typeof f=="string"&&oe.test(f)){O=!0,f=f.split("");for(let Ue=0;Ue<f.length;Ue++)f[Ue]==="1"&&V.push(Q[Ue])}else f=hi[f];if(!(f instanceof Array))return p;w===void 0?w=[]:w instanceof Array||(w=[w]);for(let Ue=0;Ue<w.length;Ue++){let Pe=ze(w[Ue]);if(Pe instanceof Error)return Pe;w[Ue]=Pe}let pe=Math.round((l-r)/864e5)+1,we=pe,De=r;for(let Ue=0;Ue<pe;Ue++){let Pe=new Date().getTimezoneOffset()>0?De.getUTCDay():De.getDay(),Je=O?V.includes(Pe):Pe===f[0]||Pe===f[1];for(let it=0;it<w.length;it++){let at=w[it];if(at.getDate()===De.getDate()&&at.getMonth()===De.getMonth()&&at.getFullYear()===De.getFullYear()){Je=!0;break}}Je&&we--,De.setDate(De.getDate()+1)}return we},vi.INTL=(r,l,f,w)=>{if((r=ze(r))instanceof Error)return r;if((l=W(l))instanceof Error)return l;if(l<0)return v;if(!((f=f===void 0?hi[1]:hi[f])instanceof Array))return p;w===void 0?w=[]:w instanceof Array||(w=[w]);for(let V=0;V<w.length;V++){let Q=ze(w[V]);if(Q instanceof Error)return Q;w[V]=Q}let O=0;for(;O<l;){r.setDate(r.getDate()+1);let V=r.getDay();if(V!==f[0]&&V!==f[1]){for(let Q=0;Q<w.length;Q++){let oe=w[Q];if(oe.getDate()===r.getDate()&&oe.getMonth()===r.getMonth()&&oe.getFullYear()===r.getFullYear()){O--;break}}O++}}return r};let _p=Iu;function Tu(r,l=2,f=!1){if(r=W(r),isNaN(r)||(l=W(l),isNaN(l)))return p;if(l<0){let w=Math.pow(10,-l);r=Math.round(r/w)*w}else r=r.toFixed(l);if(f)r=r.toString().replace(/,/g,"");else{let w=r.toString().split(".");w[0]=w[0].replace(/\B(?=(\d{3})+$)/g,","),r=w.join(".")}return r}function nn(r,l){return be(r,l)||(r=Ze(r),(l=W(l))instanceof Error?l:new Array(l+1).join(r))}let Hp=ku,Pp=Mu;function Ql(r){return/^[01]{1,10}$/.test(r)}function _t(r,l,f){if(le(r=W(r),l=W(l)))return r;if((f=f===void 0?"i":f)!=="i"&&f!=="j")return p;if(r===0&&l===0)return 0;if(r===0)return l===1?f:l.toString()+f;if(l===0)return r.toString();{let w=l>0?"+":"";return r.toString()+w+(l===1?f:l.toString()+f)}}function ql(r,l){return l=l===void 0?0:l,le(r=W(r),l=W(l))?p:m.erf(r)}function Jl(r){return isNaN(r)?p:m.erfc(r)}function $l(r){let l=dt(r),f=ct(r);return le(l,f)?p:Math.sqrt(Math.pow(l,2)+Math.pow(f,2))}function ct(r){if(r===void 0||r===!0||r===!1)return p;if(r===0||r==="0")return 0;if(["i","j"].indexOf(r)>=0)return 1;let l=(r=(r+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),f=r.indexOf("-");l===0&&(l=r.indexOf("+",1)),f===0&&(f=r.indexOf("-",1));let w=r.substring(r.length-1,r.length),O=w==="i"||w==="j";return l>=0||f>=0?O?l>=0?isNaN(r.substring(0,l))||isNaN(r.substring(l+1,r.length-1))?v:Number(r.substring(l+1,r.length-1)):isNaN(r.substring(0,f))||isNaN(r.substring(f+1,r.length-1))?v:-Number(r.substring(f+1,r.length-1)):v:O?isNaN(r.substring(0,r.length-1))?v:r.substring(0,r.length-1):isNaN(r)?v:0}function Kl(r){let l=dt(r),f=ct(r);return le(l,f)?p:l===0&&f===0?g:l===0&&f>0?Math.PI/2:l===0&&f<0?-Math.PI/2:f===0&&l>0?0:f===0&&l<0?-Math.PI:l>0?Math.atan(f/l):l<0&&f>=0?Math.atan(f/l)+Math.PI:Math.atan(f/l)-Math.PI}function ji(r){let l=dt(r),f=ct(r);if(le(l,f))return p;let w=r.substring(r.length-1);return w=w==="i"||w==="j"?w:"i",_t(Math.cos(l)*(Math.exp(f)+Math.exp(-f))/2,-Math.sin(l)*(Math.exp(f)-Math.exp(-f))/2,w)}function Du(r){let l=dt(r),f=ct(r);if(le(l,f))return p;let w=r.substring(r.length-1);return w=w==="i"||w==="j"?w:"i",_t(Math.cos(f)*(Math.exp(l)+Math.exp(-l))/2,Math.sin(f)*(Math.exp(l)-Math.exp(-l))/2,w)}function br(r,l){let f=dt(r),w=ct(r),O=dt(l),V=ct(l);if(le(f,w,O,V))return p;let Q=r.substring(r.length-1),oe=l.substring(l.length-1),pe="i";if((Q==="j"||oe==="j")&&(pe="j"),O===0&&V===0)return v;let we=O*O+V*V;return _t((f*O+w*V)/we,(w*O-f*V)/we,pe)}function dt(r){if(r===void 0||r===!0||r===!1)return p;if(r===0||r==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(r)>=0)return 0;let l=(r+="").indexOf("+"),f=r.indexOf("-");l===0&&(l=r.indexOf("+",1)),f===0&&(f=r.indexOf("-",1));let w=r.substring(r.length-1,r.length),O=w==="i"||w==="j";return l>=0||f>=0?O?l>=0?isNaN(r.substring(0,l))||isNaN(r.substring(l+1,r.length-1))?v:Number(r.substring(0,l)):isNaN(r.substring(0,f))||isNaN(r.substring(f+1,r.length-1))?v:Number(r.substring(0,f)):v:O?isNaN(r.substring(0,r.length-1))?v:0:isNaN(r)?v:r}function yi(r){let l=dt(r),f=ct(r);if(le(l,f))return p;let w=r.substring(r.length-1);return w=w==="i"||w==="j"?w:"i",_t(Math.sin(l)*(Math.exp(f)+Math.exp(-f))/2,Math.cos(l)*(Math.exp(f)-Math.exp(-f))/2,w)}function Ou(r){let l=dt(r),f=ct(r);if(le(l,f))return p;let w=r.substring(r.length-1);return w=w==="i"||w==="j"?w:"i",_t(Math.cos(f)*(Math.exp(l)-Math.exp(-l))/2,Math.sin(f)*(Math.exp(l)+Math.exp(-l))/2,w)}ql.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Jl.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};let zp=K.DIST,Bp=K.INV,Vp=ee.DIST,Up=Qe.MATH,Yp=Qe.PRECISE,Wp=P.DIST,Gp=P.DIST.RT,Xp=P.INV,Zp=P.INV.RT,Qp=P.TEST,qp=me.P,Jp=me.P,$p=me.S,Kp=ee.INV,e0=Jl.PRECISE,t0=ql.PRECISE,n0=se.DIST,r0=ce.DIST,o0=ce.DIST.RT,i0=ce.INV,l0=ce.INV.RT,a0=Ve.MATH,s0=Ve.PRECISE,u0=ce.TEST,c0=Se.DIST,d0=Se.INV,f0=Te.PRECISE,p0=Xe.DIST,h0=ue.INV,g0=ue.DIST,m0=ue.INV,v0=k.MULT,b0=k.SNGL,j0=R.DIST,y0=mi.INTL,x0=Z.DIST,w0=Z.INV,C0=Z.S.DIST,E0=Z.S.INV,A0=ne.EXC,S0=ne.INC,L0=J.EXC,N0=J.INC,k0=ve.DIST,M0=xe.EXC,I0=xe.INC,T0=Ce.AVG,D0=Ce.EQ,O0=Ae.P,F0=We.P,R0=We.S,_0=nt.DIST,H0=nt.DIST.RT,P0=nt.INV,z0=nt.TEST,B0=te.P,V0=te.S,U0=Re.DIST,Y0=vi.INTL,W0=ot.TEST;function ea(r){let l=[];return N(r,f=>{f&&l.push(f)}),l}function cn(r,l){let f={};for(let V=1;V<r[0].length;++V)f[V]=!0;let w=l[0].length;for(let V=1;V<l.length;++V)l[V].length>w&&(w=l[V].length);for(let V=1;V<r.length;++V)for(let Q=1;Q<r[V].length;++Q){let oe=!1,pe=!1;for(let we=0;we<l.length;++we){let De=l[we];if(De.length<w)continue;let Ue=De[0];if(r[V][0]===Ue){pe=!0;for(let Pe=1;Pe<De.length;++Pe)if(!oe)if(De[Pe]===void 0||De[Pe]==="*")oe=!0;else{let Je=bn(De[Pe]+""),it=[Ut(r[V][Q],jt)].concat(Je);oe=Yt(it)}}}pe&&(f[Q]=f[Q]&&oe)}let O=[];for(let V=0;V<r[0].length;++V)f[V]&&O.push(V-1);return O}function ta(r){return r&&r.getTime&&!isNaN(r.getTime())}function na(r){return r instanceof Date?r:new Date(r)}function jr(r,l,f,w,O){if(w=w||0,O=O||0,le(r=W(r),l=W(l),f=W(f),w=W(w),O=W(O)))return p;let V;if(r===0)V=w+f*l;else{let Q=Math.pow(1+r,l);V=O===1?w*Q+f*(1+r)*(Q-1)/r:w*Q+f*(Q-1)/r}return-V}function Fu(r,l,f,w,O,V){if(O=O||0,V=V||0,le(r=W(r),l=W(l),f=W(f),w=W(w),O=W(O),V=W(V)))return p;let Q=vo(r,f,w,O,V);return(l===1?V===1?0:-w:V===1?jr(r,l-2,Q,w,1)-Q:jr(r,l-1,Q,w,0))*r}function ra(){let r=ke(U(arguments));if(r instanceof Error)return r;let l=r[0],f=0;for(let w=1;w<r.length;w++)f+=r[w]/Math.pow(1+l,w);return f}function vo(r,l,f,w,O){if(w=w||0,O=O||0,le(r=W(r),l=W(l),f=W(f),w=W(w),O=W(O)))return p;let V;if(r===0)V=(f+w)/l;else{let Q=Math.pow(1+r,l);V=O===1?(w*r/(Q-1)+f*r/(1-1/Q))/(1+r):w*r/(Q-1)+f*r/(1-1/Q)}return-V}let G0={errors:D,symbols:Dp};u.ABS=function(r){return(r=W(r))instanceof Error?r:Math.abs(r)},u.ACCRINT=function(r,l,f,w,O,V,Q){return r=na(r),l=na(l),f=na(f),ta(r)&&ta(l)&&ta(f)?w<=0||O<=0||[1,2,4].indexOf(V)===-1||[0,1,2,3,4].indexOf(Q)===-1||f<=r?v:(O=O||0)*w*Zl(r,f,Q=Q||0):p},u.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},u.ACOS=function(r){if((r=W(r))instanceof Error)return r;let l=Math.acos(r);return isNaN(l)&&(l=v),l},u.ACOSH=function(r){if((r=W(r))instanceof Error)return r;let l=Math.log(r+Math.sqrt(r*r-1));return isNaN(l)&&(l=v),l},u.ACOT=function(r){return(r=W(r))instanceof Error?r:Math.atan(1/r)},u.ACOTH=function(r){if((r=W(r))instanceof Error)return r;let l=.5*Math.log((r+1)/(r-1));return isNaN(l)&&(l=v),l},u.AGGREGATE=function(r,l,f,w){if(le(r=W(r),W(r)))return p;switch(r){case 1:return c(f);case 2:return z(f);case 3:return X(f);case 4:return je(f);case 5:return q(f);case 6:return Gl(f);case 7:return We.S(f);case 8:return We.P(f);case 9:return mr(f);case 10:return te.S(f);case 11:return te.P(f);case 12:return Y(f);case 13:return k.SNGL(f);case 14:return tt(f,w);case 15:return _e(f,w);case 16:return ne.INC(f,w);case 17:return xe.INC(f,w);case 18:return ne.EXC(f,w);case 19:return xe.EXC(f,w)}},u.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},u.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},u.AND=function(){let r=U(arguments),l=p;for(let f=0;f<r.length;f++){if(r[f]instanceof Error)return r[f];r[f]!==void 0&&r[f]!==null&&typeof r[f]!="string"&&(l===p&&(l=!0),r[f]||(l=!1))}return l},u.ARABIC=function(r){if(r==null)return 0;if(r instanceof Error)return r;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(r))return p;let l=0;return r.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,f=>{l+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[f]}),l},u.ASC=function(){throw new Error("ASC is not implemented")},u.ASIN=function(r){if((r=W(r))instanceof Error)return r;let l=Math.asin(r);return isNaN(l)&&(l=v),l},u.ASINH=function(r){return(r=W(r))instanceof Error?r:Math.log(r+Math.sqrt(r*r+1))},u.ATAN=function(r){return(r=W(r))instanceof Error?r:Math.atan(r)},u.ATAN2=function(r,l){return be(r=W(r),l=W(l))||Math.atan2(r,l)},u.ATANH=function(r){if((r=W(r))instanceof Error)return r;let l=Math.log((1+r)/(1-r))/2;return isNaN(l)&&(l=v),l},u.AVEDEV=function(){let r=U(arguments).filter(Ie);if(r.length===0)return v;let l=ke(r);return l instanceof Error?l:m.sum(m(l).subtract(m.mean(l)).abs()[0])/l.length},u.AVERAGE=c,u.AVERAGEA=B,u.AVERAGEIF=function(r,l,f){if(arguments.length<=1)return C;if(f=ke(U(f=f||r).filter(Ie)),r=U(r),f instanceof Error)return f;let w=0,O=0,V=l===void 0||l==="*",Q=V?null:bn(l+"");for(let oe=0;oe<r.length;oe++){let pe=r[oe];if(V)O+=f[oe],w++;else{let we=[Ut(pe,jt)].concat(Q);Yt(we)&&(O+=f[oe],w++)}}return O/w},u.AVERAGEIFS=function(){let r=F(arguments),l=(r.length-1)/2,f=U(r[0]),w=0,O=0;for(let Q=0;Q<f.length;Q++){let oe=!1;for(let pe=0;pe<l;pe++){let we=r[2*pe+1][Q],De=r[2*pe+2],Ue=!1;if(De===void 0||De==="*")Ue=!0;else{let Pe=bn(De+""),Je=[Ut(we,jt)].concat(Pe);Ue=Yt(Je)}if(!Ue){oe=!1;break}oe=!0}oe&&(O+=f[Q],w++)}let V=O/w;return isNaN(V)?0:V},u.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},u.BASE=function(r,l,f){let w=be(r=W(r),l=W(l),f=W(f));if(w)return w;if(l===0)return v;let O=r.toString(l);return new Array(Math.max(f+1-O.length,0)).join("0")+O},u.BESSELI=function(r,l){return le(r=W(r),l=W(l))?p:T.besseli(r,l)},u.BESSELJ=function(r,l){return le(r=W(r),l=W(l))?p:T.besselj(r,l)},u.BESSELK=function(r,l){return le(r=W(r),l=W(l))?p:T.besselk(r,l)},u.BESSELY=function(r,l){return le(r=W(r),l=W(l))?p:T.bessely(r,l)},u.BETA=K,u.BETADIST=zp,u.BETAINV=Bp,u.BIN2DEC=function(r){if(!Ql(r))return v;let l=parseInt(r,2),f=r.toString();return f.length===10&&f.substring(0,1)==="1"?parseInt(f.substring(1),2)-512:l},u.BIN2HEX=function(r,l){if(!Ql(r))return v;let f=r.toString();if(f.length===10&&f.substring(0,1)==="1")return(0xfffffffe00+parseInt(f.substring(1),2)).toString(16);let w=parseInt(r,2).toString(16);return l===void 0?w:isNaN(l)?p:l<0?v:(l=Math.floor(l))>=w.length?nn("0",l-w.length)+w:v},u.BIN2OCT=function(r,l){if(!Ql(r))return v;let f=r.toString();if(f.length===10&&f.substring(0,1)==="1")return(1073741312+parseInt(f.substring(1),2)).toString(8);let w=parseInt(r,2).toString(8);return l===void 0?w:isNaN(l)?p:l<0?v:(l=Math.floor(l))>=w.length?nn("0",l-w.length)+w:v},u.BINOM=ee,u.BINOMDIST=Vp,u.BITAND=function(r,l){return le(r=W(r),l=W(l))?p:r<0||l<0||Math.floor(r)!==r||Math.floor(l)!==l||r>0xffffffffffff||l>0xffffffffffff?v:r&l},u.BITLSHIFT=function(r,l){return le(r=W(r),l=W(l))?p:r<0||Math.floor(r)!==r||r>0xffffffffffff||Math.abs(l)>53?v:l>=0?r<<l:r>>-l},u.BITOR=function(r,l){return le(r=W(r),l=W(l))?p:r<0||l<0||Math.floor(r)!==r||Math.floor(l)!==l||r>0xffffffffffff||l>0xffffffffffff?v:r|l},u.BITRSHIFT=function(r,l){return le(r=W(r),l=W(l))?p:r<0||Math.floor(r)!==r||r>0xffffffffffff||Math.abs(l)>53?v:l>=0?r>>l:r<<-l},u.BITXOR=function(r,l){return le(r=W(r),l=W(l))?p:r<0||l<0||Math.floor(r)!==r||Math.floor(l)!==l||r>0xffffffffffff||l>0xffffffffffff?v:r^l},u.CEILING=Qe,u.CEILINGMATH=Up,u.CEILINGPRECISE=Yp,u.CELL=function(){throw new Error("CELL is not implemented")},u.CHAR=ku,u.CHIDIST=Wp,u.CHIDISTRT=Gp,u.CHIINV=Xp,u.CHIINVRT=Zp,u.CHISQ=P,u.CHITEST=Qp,u.CHOOSE=function(){if(arguments.length<2)return C;let r=arguments[0];return r<1||r>254||arguments.length<r+1?p:arguments[r]},u.CLEAN=function(r){return le(r)?r:(r=r||"").replace(/[\0-\x1F]/g,"")},u.CODE=Mu,u.COLUMN=function(r,l){return arguments.length!==2?C:l<0?v:r instanceof Array&&typeof l=="number"?r.length!==0?m.col(r,l):void 0:p},u.COLUMNS=function(r){return arguments.length!==1?C:r instanceof Array?r.length===0?0:m.cols(r):p},u.COMBIN=st,u.COMBINA=function(r,l){return be(r=W(r),l=W(l))||(r<l?v:r===0&&l===0?1:st(r+l-1,r-1))},u.COMPLEX=_t,u.CONCAT=_p,u.CONCATENATE=Iu,u.CONFIDENCE=H,u.CONVERT=function(r,l,f){if((r=W(r))instanceof Error)return r;let w=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\xE5ngstr\xF6m","\xC5",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \xE5ngstr\xF6m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","\xB0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03A9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\xE4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \xE5ngstr\xF6m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],O={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},V={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},Q,oe=null,pe=null,we=l,De=f,Ue=1,Pe=1;for(let Je=0;Je<w.length;Je++)Q=w[Je][2]===null?[]:w[Je][2],(w[Je][1]===we||Q.indexOf(we)>=0)&&(oe=w[Je]),(w[Je][1]===De||Q.indexOf(De)>=0)&&(pe=w[Je]);if(oe===null){let Je=O[l.substring(0,2)],it=V[l.substring(0,1)];l.substring(0,2)==="da"&&(it=["dekao",10,"da"]),Je?(Ue=Je[2],we=l.substring(2)):it&&(Ue=it[1],we=l.substring(it[2].length));for(let at=0;at<w.length;at++)Q=w[at][2]===null?[]:w[at][2],(w[at][1]===we||Q.indexOf(we)>=0)&&(oe=w[at])}if(pe===null){let Je=O[f.substring(0,2)],it=V[f.substring(0,1)];f.substring(0,2)==="da"&&(it=["dekao",10,"da"]),Je?(Pe=Je[2],De=f.substring(2)):it&&(Pe=it[1],De=f.substring(it[2].length));for(let at=0;at<w.length;at++)Q=w[at][2]===null?[]:w[at][2],(w[at][1]===De||Q.indexOf(De)>=0)&&(pe=w[at])}return oe===null||pe===null||oe[3]!==pe[3]?C:r*oe[6]*Ue/(pe[6]*Pe)},u.CORREL=function(r,l){return le(r=ke(U(r)),l=ke(U(l)))?p:m.corrcoeff(r,l)},u.COS=function(r){return(r=W(r))instanceof Error?r:Math.cos(r)},u.COSH=function(r){return(r=W(r))instanceof Error?r:(Math.exp(r)+Math.exp(-r))/2},u.COT=function(r){return(r=W(r))instanceof Error?r:r===0?g:1/Math.tan(r)},u.COTH=function(r){if((r=W(r))instanceof Error)return r;if(r===0)return g;let l=Math.exp(2*r);return(l+1)/(l-1)},u.COUNT=z,u.COUNTA=X,u.COUNTBLANK=ie,u.COUNTIF=function(r,l){if(r=U(r),l===void 0||l==="*")return r.length;let f=0,w=bn(l+"");for(let O=0;O<r.length;O++){let V=[Ut(r[O],jt)].concat(w);Yt(V)&&f++}return f},u.COUNTIFS=function(){let r=F(arguments),l=new Array(U(r[0]).length);for(let w=0;w<l.length;w++)l[w]=!0;for(let w=0;w<r.length;w+=2){let O=U(r[w]),V=r[w+1];if(V!==void 0&&V!=="*"){let Q=bn(V+"");for(let oe=0;oe<O.length;oe++){let pe=[Ut(O[oe],jt)].concat(Q);l[oe]=l[oe]&&Yt(pe)}}}let f=0;for(let w=0;w<l.length;w++)l[w]&&f++;return f},u.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},u.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},u.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},u.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},u.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},u.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},u.COVAR=qp,u.COVARIANCE=me,u.COVARIANCEP=Jp,u.COVARIANCES=$p,u.CRITBINOM=Kp,u.CSC=function(r){return(r=W(r))instanceof Error?r:r===0?g:1/Math.sin(r)},u.CSCH=function(r){return(r=W(r))instanceof Error?r:r===0?g:2/(Math.exp(r)-Math.exp(-r))},u.CUMIPMT=function(r,l,f,w,O,V){if(le(r=W(r),l=W(l),f=W(f)))return p;if(r<=0||l<=0||f<=0||w<1||O<1||w>O||V!==0&&V!==1)return v;let Q=vo(r,l,f,0,V),oe=0;w===1&&(V===0&&(oe=-f),w++);for(let pe=w;pe<=O;pe++)oe+=V===1?jr(r,pe-2,Q,f,1)-Q:jr(r,pe-1,Q,f,0);return oe*=r,oe},u.CUMPRINC=function(r,l,f,w,O,V){if(le(r=W(r),l=W(l),f=W(f)))return p;if(r<=0||l<=0||f<=0||w<1||O<1||w>O||V!==0&&V!==1)return v;let Q=vo(r,l,f,0,V),oe=0;w===1&&(oe=V===0?Q+f*r:Q,w++);for(let pe=w;pe<=O;pe++)oe+=V>0?Q-(jr(r,pe-2,Q,f,1)-Q)*r:Q-jr(r,pe-1,Q,f,0)*r;return oe},u.DATE=function(r,l,f){let w;return le(r=W(r),l=W(l),f=W(f))?w=p:(w=new Date(r,l-1,f),w.getFullYear()<0&&(w=v)),w},u.DATEDIF=mo,u.DATEVALUE=function(r){if(typeof r!="string")return p;let l=Date.parse(r);return isNaN(l)?p:new Date(r)},u.DAVERAGE=function(r,l,f){if(isNaN(l)&&typeof l!="string")return p;let w=cn(r,f),O=[];if(typeof l=="string"){let Q=Ne(r,l);O=ae(r[Q])}else O=ae(r[l]);let V=0;return N(w,Q=>{V+=O[Q]}),w.length===0?g:V/w.length},u.DAY=function(r){let l=ze(r);return l instanceof Error?l:l.getDate()},u.DAYS=vr,u.DAYS360=Xn,u.DB=function(r,l,f,w,O){if(O=O===void 0?12:O,le(r=W(r),l=W(l),f=W(f),w=W(w),O=W(O)))return p;if(r<0||l<0||f<0||w<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(O)===-1||w>f)return v;if(l>=r)return 0;let V=(1-Math.pow(l/r,1/f)).toFixed(3),Q=r*V*O/12,oe=Q,pe=0,we=w===f?f-1:w;for(let De=2;De<=we;De++)pe=(r-oe)*V,oe+=pe;return w===1?Q:w===f?(r-oe)*V:pe},u.DBCS=function(){throw new Error("DBCS is not implemented")},u.DCOUNT=function(r,l,f){if(isNaN(l)&&typeof l!="string")return p;let w=cn(r,f),O=[];if(typeof l=="string"){let Q=Ne(r,l);O=ae(r[Q])}else O=ae(r[l]);let V=[];return N(w,Q=>{V.push(O[Q])}),z(V)},u.DCOUNTA=function(r,l,f){if(isNaN(l)&&typeof l!="string")return p;let w=cn(r,f),O=[];if(typeof l=="string"){let Q=Ne(r,l);O=ae(r[Q])}else O=ae(r[l]);let V=[];return N(w,Q=>{V.push(O[Q])}),X(V)},u.DDB=function(r,l,f,w,O){if(O=O===void 0?2:O,le(r=W(r),l=W(l),f=W(f),w=W(w),O=W(O)))return p;if(r<0||l<0||f<0||w<0||O<=0||w>f)return v;if(l>=r)return 0;let V=0,Q=0;for(let oe=1;oe<=w;oe++)Q=Math.min(O/f*(r-V),r-l-V),V+=Q;return Q},u.DEC2BIN=function(r,l){if((r=W(r))instanceof Error)return r;if(!/^-?[0-9]{1,3}$/.test(r)||r<-512||r>511)return v;if(r<0)return"1"+nn("0",9-(512+r).toString(2).length)+(512+r).toString(2);let f=parseInt(r,10).toString(2);return l===void 0?f:isNaN(l)?p:l<0?v:(l=Math.floor(l))>=f.length?nn("0",l-f.length)+f:v},u.DEC2HEX=function(r,l){if((r=W(r))instanceof Error)return r;if(!/^-?[0-9]{1,12}$/.test(r)||r<-549755813888||r>549755813887)return v;if(r<0)return(1099511627776+r).toString(16);let f=parseInt(r,10).toString(16);return l===void 0?f:isNaN(l)?p:l<0?v:(l=Math.floor(l))>=f.length?nn("0",l-f.length)+f:v},u.DEC2OCT=function(r,l){if((r=W(r))instanceof Error)return r;if(!/^-?[0-9]{1,9}$/.test(r)||r<-536870912||r>536870911)return v;if(r<0)return(1073741824+r).toString(8);let f=parseInt(r,10).toString(8);return l===void 0?f:isNaN(l)?p:l<0?v:(l=Math.floor(l))>=f.length?nn("0",l-f.length)+f:v},u.DECIMAL=function(r,l){return arguments.length<1?p:be(r=W(r),l=W(l))||(l===0?v:parseInt(r,l))},u.DEGREES=function(r){return(r=W(r))instanceof Error?r:180*r/Math.PI},u.DELTA=function(r,l){return l=l===void 0?0:l,le(r=W(r),l=W(l))?p:r===l?1:0},u.DEVSQ=function(){let r=ke(U(arguments));if(r instanceof Error)return r;let l=m.mean(r),f=0;for(let w=0;w<r.length;w++)f+=Math.pow(r[w]-l,2);return f},u.DGET=function(r,l,f){if(isNaN(l)&&typeof l!="string")return p;let w=cn(r,f),O=[];return O=ae(typeof l=="string"?r[Ne(r,l)]:r[l]),w.length===0?p:w.length>1?v:O[w[0]]},u.DISC=function(r,l,f,w,O){if(le(r=ze(r),l=ze(l),f=W(f),w=W(w),O=(O=W(O))||0))return p;if(f<=0||w<=0)return v;if(r>=l)return p;let V,Q;switch(O){case 0:V=360,Q=Xn(r,l,!1);break;case 1:case 3:V=365,Q=mo(r,l,"D");break;case 2:V=360,Q=mo(r,l,"D");break;case 4:V=360,Q=Xn(r,l,!0);break;default:return v}return(w-f)/w*V/Q},u.DMAX=function(r,l,f){if(isNaN(l)&&typeof l!="string")return p;let w=cn(r,f),O=[];if(typeof l=="string"){let Q=Ne(r,l);O=ae(r[Q])}else O=ae(r[l]);let V=O[w[0]];return N(w,Q=>{V<O[Q]&&(V=O[Q])}),V},u.DMIN=function(r,l,f){if(isNaN(l)&&typeof l!="string")return p;let w=cn(r,f),O=[];if(typeof l=="string"){let Q=Ne(r,l);O=ae(r[Q])}else O=ae(r[l]);let V=O[w[0]];return N(w,Q=>{V>O[Q]&&(V=O[Q])}),V},u.DOLLAR=function(r,l=2){if(r=W(r),isNaN(r))return p;let f={style:"currency",currency:"USD",minimumFractionDigits:l>=0?l:0,maximumFractionDigits:l>=0?l:0},w=(r=Nn(r,l)).toLocaleString("en-US",f);return r<0?"$("+w.slice(2)+")":w},u.DOLLARDE=function(r,l){if(le(r=W(r),l=W(l)))return p;if(l<0)return v;if(l>=0&&l<1)return g;l=parseInt(l,10);let f=parseInt(r,10);f+=r%1*Math.pow(10,Math.ceil(Math.log(l)/Math.LN10))/l;let w=Math.pow(10,Math.ceil(Math.log(l)/Math.LN2)+1);return f=Math.round(f*w)/w,f},u.DOLLARFR=function(r,l){if(le(r=W(r),l=W(l)))return p;if(l<0)return v;if(l>=0&&l<1)return g;l=parseInt(l,10);let f=parseInt(r,10);return f+=r%1*Math.pow(10,-Math.ceil(Math.log(l)/Math.LN10))*l,f},u.DPRODUCT=function(r,l,f){if(isNaN(l)&&typeof l!="string")return p;let w=cn(r,f),O=[];if(typeof l=="string"){let oe=Ne(r,l);O=ae(r[oe])}else O=ae(r[l]);let V=[];N(w,oe=>{V.push(O[oe])}),V=ea(V);let Q=1;return N(V,oe=>{Q*=oe}),Q},u.DSTDEV=function(r,l,f){if(isNaN(l)&&typeof l!="string")return p;let w=cn(r,f),O=[];if(typeof l=="string"){let Q=Ne(r,l);O=ae(r[Q])}else O=ae(r[l]);let V=[];return N(w,Q=>{V.push(O[Q])}),V=ea(V),We.S(V)},u.DSTDEVP=function(r,l,f){if(isNaN(l)&&typeof l!="string")return p;let w=cn(r,f),O=[];if(typeof l=="string"){let Q=Ne(r,l);O=ae(r[Q])}else O=ae(r[l]);let V=[];return N(w,Q=>{V.push(O[Q])}),V=ea(V),We.P(V)},u.DSUM=function(r,l,f){if(isNaN(l)&&typeof l!="string")return p;let w=cn(r,f),O=[];if(typeof l=="string"){let Q=Ne(r,l);O=ae(r[Q])}else O=ae(r[l]);let V=[];return N(w,Q=>{V.push(O[Q])}),mr(V)},u.DURATION=function(){throw new Error("DURATION is not implemented")},u.DVAR=function(r,l,f){if(isNaN(l)&&typeof l!="string")return p;let w=cn(r,f),O=[];if(typeof l=="string"){let Q=Ne(r,l);O=ae(r[Q])}else O=ae(r[l]);let V=[];return N(w,Q=>{V.push(O[Q])}),te.S(V)},u.DVARP=function(r,l,f){if(isNaN(l)&&typeof l!="string")return p;let w=cn(r,f),O=[];if(typeof l=="string"){let Q=Ne(r,l);O=ae(r[Q])}else O=ae(r[l]);let V=[];return N(w,Q=>{V.push(O[Q])}),te.P(V)},u.EDATE=function(r,l){return(r=ze(r))instanceof Error?r:isNaN(l)?p:(l=parseInt(l,10),r.setMonth(r.getMonth()+l),r)},u.EFFECT=function(r,l){return le(r=W(r),l=W(l))?p:r<=0||l<1?v:(l=parseInt(l,10),Math.pow(1+r/l,l)-1)},u.EOMONTH=function(r,l){return(r=ze(r))instanceof Error?r:isNaN(l)?p:(l=parseInt(l,10),new Date(r.getFullYear(),r.getMonth()+l+1,0))},u.ERF=ql,u.ERFC=Jl,u.ERFCPRECISE=e0,u.ERFPRECISE=t0,u.ERROR=fi,u.EVEN=function(r){return(r=W(r))instanceof Error?r:Qe(r,-2,-1)},u.EXACT=function(r,l){return arguments.length!==2?C:be(r,l)||(r=Ze(r))===Ze(l)},u.EXP=function(r){return arguments.length<1?C:arguments.length>1?A:(r=W(r))instanceof Error?r:r=Math.exp(r)},u.EXPON=se,u.EXPONDIST=n0,u.F=ce,u.FACT=qe,u.FACTDOUBLE=function r(l){if((l=W(l))instanceof Error)return l;let f=Math.floor(l);return f<=0?1:f*r(f-2)},u.FALSE=function(){return!1},u.FDIST=r0,u.FDISTRT=o0,u.FIND=function(r,l,f){if(arguments.length<2)return C;r=Ze(r),f=f===void 0?0:f;let w=(l=Ze(l)).indexOf(r,f-1);return w===-1?p:w+1},u.FINV=i0,u.FINVRT=l0,u.FISHER=function(r){return(r=W(r))instanceof Error?r:Math.log((1+r)/(1-r))/2},u.FISHERINV=function(r){if((r=W(r))instanceof Error)return r;let l=Math.exp(2*r);return(l-1)/(l+1)},u.FIXED=Tu,u.FLOOR=Ve,u.FLOORMATH=a0,u.FLOORPRECISE=s0,u.FORECAST=Me,u.FREQUENCY=function(r,l){if(le(r=ke(U(r)),l=ke(U(l))))return p;let f=r.length,w=l.length,O=[];for(let V=0;V<=w;V++){O[V]=0;for(let Q=0;Q<f;Q++)V===0?r[Q]<=l[0]&&(O[0]+=1):V<w?r[Q]>l[V-1]&&r[Q]<=l[V]&&(O[V]+=1):V===w&&r[Q]>l[w-1]&&(O[w]+=1)}return O},u.FTEST=u0,u.FV=jr,u.FVSCHEDULE=function(r,l){if(le(r=W(r),l=ke(U(l))))return p;let f=l.length,w=r;for(let O=0;O<f;O++)w*=1+l[O];return w},u.GAMMA=Se,u.GAMMADIST=c0,u.GAMMAINV=d0,u.GAMMALN=Te,u.GAMMALNPRECISE=f0,u.GAUSS=function(r){return(r=W(r))instanceof Error?r:m.normal.cdf(r,0,1)-.5},u.GCD=function(){let r=ke(U(arguments));if(r instanceof Error)return r;let l=r.length,f=r[0],w=f<0?-f:f;for(let O=1;O<l;O++){let V=r[O],Q=V<0?-V:V;for(;w&&Q;)w>Q?w%=Q:Q%=w;w+=Q}return w},u.GEOMEAN=function(){let r=ke(U(arguments));return r instanceof Error?r:m.geomean(r)},u.GESTEP=function(r,l){return le(l=l||0,r=W(r))?r:r>=l?1:0},u.GROWTH=function(r,l,f,w){if((r=ke(r))instanceof Error)return r;let O;if(l===void 0)for(l=[],O=1;O<=r.length;O++)l.push(O);if(f===void 0)for(f=[],O=1;O<=r.length;O++)f.push(O);if(le(l=ke(l),f=ke(f)))return p;w===void 0&&(w=!0);let V=r.length,Q,oe,pe=0,we=0,De=0,Ue=0;for(O=0;O<V;O++){let Je=l[O],it=Math.log(r[O]);pe+=Je,we+=it,De+=Je*it,Ue+=Je*Je}pe/=V,we/=V,De/=V,Ue/=V,w?(Q=(De-pe*we)/(Ue-pe*pe),oe=we-Q*pe):(Q=De/Ue,oe=0);let Pe=[];for(O=0;O<f.length;O++)Pe.push(Math.exp(oe+Q*f[O]));return Pe},u.HARMEAN=function(){let r=ke(U(arguments));if(r instanceof Error)return r;let l=r.length,f=0;for(let w=0;w<l;w++)f+=1/r[w];return l/f},u.HEX2BIN=function(r,l){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return v;let f=!(r.length!==10||r.substring(0,1).toLowerCase()!=="f"),w=f?parseInt(r,16)-1099511627776:parseInt(r,16);if(w<-512||w>511)return v;if(f)return"1"+nn("0",9-(512+w).toString(2).length)+(512+w).toString(2);let O=w.toString(2);return l===void 0?O:isNaN(l)?p:l<0?v:(l=Math.floor(l))>=O.length?nn("0",l-O.length)+O:v},u.HEX2DEC=function(r){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return v;let l=parseInt(r,16);return l>=549755813888?l-1099511627776:l},u.HEX2OCT=function(r,l){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return v;let f=parseInt(r,16);if(f>536870911&&f<0xffe0000000)return v;if(f>=0xffe0000000)return(f-0xffc0000000).toString(8);let w=f.toString(8);return l===void 0?w:isNaN(l)?p:l<0?v:(l=Math.floor(l))>=w.length?nn("0",l-w.length)+w:v},u.HLOOKUP=function(r,l,f,w){return h(r,ye(l),f,w)},u.HOUR=function(r){return(r=ze(r))instanceof Error?r:r.getHours()},u.HYPGEOM=Xe,u.HYPGEOMDIST=p0,u.IF=function(r,l,f){return r instanceof Error?r:((l=!(arguments.length>=2)||l)==null&&(l=0),(f=arguments.length===3&&f)==null&&(f=0),r?l:f)},u.IFERROR=function(r,l){return Dt(r)?l:r},u.IFNA=function(r,l){return r===C?l:r},u.IFS=function(){for(let r=0;r<arguments.length/2;r++)if(arguments[2*r])return arguments[2*r+1];return C},u.IMABS=$l,u.IMAGINARY=ct,u.IMARGUMENT=Kl,u.IMCONJUGATE=function(r){let l=dt(r),f=ct(r);if(le(l,f))return p;let w=r.substring(r.length-1);return w=w==="i"||w==="j"?w:"i",f!==0?_t(l,-f,w):r},u.IMCOS=ji,u.IMCOSH=Du,u.IMCOT=function(r){return le(dt(r),ct(r))?p:br(ji(r),yi(r))},u.IMCSC=function(r){return r===!0||r===!1?p:le(dt(r),ct(r))?v:br("1",yi(r))},u.IMCSCH=function(r){return r===!0||r===!1?p:le(dt(r),ct(r))?v:br("1",Ou(r))},u.IMDIV=br,u.IMEXP=function(r){let l=dt(r),f=ct(r);if(le(l,f))return p;let w=r.substring(r.length-1);w=w==="i"||w==="j"?w:"i";let O=Math.exp(l);return _t(O*Math.cos(f),O*Math.sin(f),w)},u.IMLN=function(r){let l=dt(r),f=ct(r);if(le(l,f))return p;let w=r.substring(r.length-1);return w=w==="i"||w==="j"?w:"i",_t(Math.log(Math.sqrt(l*l+f*f)),Math.atan(f/l),w)},u.IMLOG10=function(r){let l=dt(r),f=ct(r);if(le(l,f))return p;let w=r.substring(r.length-1);return w=w==="i"||w==="j"?w:"i",_t(Math.log(Math.sqrt(l*l+f*f))/Math.log(10),Math.atan(f/l)/Math.log(10),w)},u.IMLOG2=function(r){let l=dt(r),f=ct(r);if(le(l,f))return p;let w=r.substring(r.length-1);return w=w==="i"||w==="j"?w:"i",_t(Math.log(Math.sqrt(l*l+f*f))/Math.log(2),Math.atan(f/l)/Math.log(2),w)},u.IMPOWER=function(r,l){if(le(l=W(l),dt(r),ct(r)))return p;let f=r.substring(r.length-1);f=f==="i"||f==="j"?f:"i";let w=Math.pow($l(r),l),O=Kl(r);return _t(w*Math.cos(l*O),w*Math.sin(l*O),f)},u.IMPRODUCT=function(){let r=arguments[0];if(!arguments.length)return p;for(let l=1;l<arguments.length;l++){let f=dt(r),w=ct(r),O=dt(arguments[l]),V=ct(arguments[l]);if(le(f,w,O,V))return p;r=_t(f*O-w*V,f*V+w*O)}return r},u.IMREAL=dt,u.IMSEC=function(r){return r===!0||r===!1||le(dt(r),ct(r))?p:br("1",ji(r))},u.IMSECH=function(r){return le(dt(r),ct(r))?p:br("1",Du(r))},u.IMSIN=yi,u.IMSINH=Ou,u.IMSQRT=function(r){if(le(dt(r),ct(r)))return p;let l=r.substring(r.length-1);l=l==="i"||l==="j"?l:"i";let f=Math.sqrt($l(r)),w=Kl(r);return _t(f*Math.cos(w/2),f*Math.sin(w/2),l)},u.IMSUB=function(r,l){let f=dt(r),w=ct(r),O=dt(l),V=ct(l);if(le(f,w,O,V))return p;let Q=r.substring(r.length-1),oe=l.substring(l.length-1),pe="i";return(Q==="j"||oe==="j")&&(pe="j"),_t(f-O,w-V,pe)},u.IMSUM=function(){if(!arguments.length)return p;let r=U(arguments),l=r[0];for(let f=1;f<r.length;f++){let w=dt(l),O=ct(l),V=dt(r[f]),Q=ct(r[f]);if(le(w,O,V,Q))return p;l=_t(w+V,O+Q)}return l},u.IMTAN=function(r){return r===!0||r===!1||le(dt(r),ct(r))?p:br(yi(r),ji(r))},u.INDEX=function(r,l,f){let w=be(r,l,f);if(w)return w;if(!Array.isArray(r))return p;let O=r.length>0&&!Array.isArray(r[0]);return O&&!f?(f=l,l=1):(f=f||1,l=l||1),f<0||l<0?p:O&&l===1&&f<=r.length?r[f-1]:l<=r.length&&f<=r[l-1].length?r[l-1][f-1]:b},u.INFO=function(){throw new Error("INFO is not implemented")},u.INT=function(r){return(r=W(r))instanceof Error?r:Math.floor(r)},u.INTERCEPT=function(r,l){return le(r=ke(r),l=ke(l))?p:r.length!==l.length?C:Me(0,r,l)},u.INTRATE=function(){throw new Error("INTRATE is not implemented")},u.IPMT=Fu,u.IRR=function(r,l){if(l=l||0,le(r=ke(U(r)),l=W(l)))return p;let f=(Pe,Je,it)=>{let at=it+1,qt=Pe[0];for(let Et=1;Et<Pe.length;Et++)qt+=Pe[Et]/Math.pow(at,(Je[Et]-Je[0])/365);return qt},w=(Pe,Je,it)=>{let at=it+1,qt=0;for(let Et=1;Et<Pe.length;Et++){let Zn=(Je[Et]-Je[0])/365;qt-=Zn*Pe[Et]/Math.pow(at,Zn+1)}return qt},O=[],V=!1,Q=!1;for(let Pe=0;Pe<r.length;Pe++)O[Pe]=Pe===0?0:O[Pe-1]+365,r[Pe]>0&&(V=!0),r[Pe]<0&&(Q=!0);if(!V||!Q)return v;let oe,pe,we,De=l=l===void 0?.1:l,Ue=!0;do we=f(r,O,De),oe=De-we/w(r,O,De),pe=Math.abs(oe-De),De=oe,Ue=pe>1e-10&&Math.abs(we)>1e-10;while(Ue);return De},u.ISBLANK=function(r){return r===null},u.ISERR=pi,u.ISERROR=Dt,u.ISEVEN=function(r){return!(1&Math.floor(Math.abs(r)))},u.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},u.ISLOGICAL=Wl,u.ISNA=function(r){return r===C},u.ISNONTEXT=function(r){return typeof r!="string"},u.ISNUMBER=Rr,u.ISO=Tp,u.ISODD=function(r){return!!(1&Math.floor(Math.abs(r)))},u.ISOWEEKNUM=Lu,u.ISPMT=function(r,l,f,w){return le(r=W(r),l=W(l),f=W(f),w=W(w))?p:w*r*(l/f-1)},u.ISREF=function(){throw new Error("ISREF is not implemented")},u.ISTEXT=L,u.KURT=function(){let r=ke(U(arguments));if(r instanceof Error)return r;let l=m.mean(r),f=r.length,w=0;for(let O=0;O<f;O++)w+=Math.pow(r[O]-l,4);return w/=Math.pow(m.stdev(r,!0),4),f*(f+1)/((f-1)*(f-2)*(f-3))*w-3*(f-1)*(f-1)/((f-2)*(f-3))},u.LARGE=tt,u.LCM=function(){let r=ke(U(arguments));if(r instanceof Error)return r;for(var l,f,w,O,V=1;(w=r.pop())!==void 0;){if(w===0)return 0;for(;w>1;){if(w%2){for(l=3,f=Math.floor(Math.sqrt(w));l<=f&&w%l;l+=2);O=l<=f?l:w}else O=2;for(w/=O,V*=O,l=r.length;l;r[--l]%O==0&&(r[l]/=O)==1&&r.splice(l,1));}}return V},u.LEFT=function(r,l){return be(r,l)||(r=Ze(r),(l=W(l=l===void 0?1:l))instanceof Error||typeof r!="string"?p:r.substring(0,l))},u.LEN=function(r){return arguments.length===0?A:r instanceof Error?r:Array.isArray(r)?p:Ze(r).length},u.LINEST=he,u.LN=function(r){return(r=W(r))instanceof Error?r:r===0?v:Math.log(r)},u.LOG=function(r,l){return be(r=W(r),l=W(l))||(r===0||l===0?v:Math.log(r)/Math.log(l))},u.LOG10=function(r){return(r=W(r))instanceof Error?r:r===0?v:Math.log(r)/Math.log(10)},u.LOGEST=function(r,l){if(le(r=ke(U(r)),l=ke(U(l)))||r.length!==l.length)return p;for(let w=0;w<r.length;w++)r[w]=Math.log(r[w]);let f=he(r,l);return f[0]=Math.round(1e6*Math.exp(f[0]))/1e6,f[1]=Math.round(1e6*Math.exp(f[1]))/1e6,f},u.LOGINV=h0,u.LOGNORM=ue,u.LOGNORMDIST=g0,u.LOGNORMINV=m0,u.LOOKUP=function(r,l,f){l=U(l),f=f?U(f):l;let w=typeof r=="number",O=C;for(let V=0;V<l.length;V++){if(l[V]===r)return f[V];if(w&&l[V]<=r||typeof l[V]=="string"&&l[V].localeCompare(r)<0)O=f[V];else if(w&&l[V]>r)return O}return O},u.LOWER=function(r){return arguments.length!==1?p:le(r=Ze(r))?r:r.toLowerCase()},u.MATCH=function(r,l,f){if(!r||!l||(arguments.length===2&&(f=1),!((l=U(l))instanceof Array))||f!==-1&&f!==0&&f!==1)return C;let w,O;for(let V=0;V<l.length;V++)if(f===1){if(l[V]===r)return V+1;l[V]<r&&(O?l[V]>O&&(w=V+1,O=l[V]):(w=V+1,O=l[V]))}else if(f===0){if(typeof r=="string"&&typeof l[V]=="string"){let Q=r.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+Q+"$").test(l[V].toLowerCase()))return V+1}else if(l[V]===r)return V+1}else if(f===-1){if(l[V]===r)return V+1;l[V]>r&&(O?l[V]<O&&(w=V+1,O=l[V]):(w=V+1,O=l[V]))}return w||C},u.MAX=je,u.MAXA=function(){let r=U(arguments),l=be.apply(void 0,r);if(l)return l;let f=_(r);return f=f.map(w=>w??0),f.length===0?0:Math.max.apply(Math,f)},u.MDURATION=function(){throw new Error("MDURATION is not implemented")},u.MEDIAN=Y,u.MID=function(r,l,f){if(l==null)return p;if(le(l=W(l),f=W(f))||typeof r!="string")return f;let w=l-1,O=w+f;return r.substring(w,O)},u.MIN=q,u.MINA=function(){let r=U(arguments),l=be.apply(void 0,r);if(l)return l;let f=_(r);return f=f.map(w=>w??0),f.length===0?0:Math.min.apply(Math,f)},u.MINUTE=function(r){return(r=ze(r))instanceof Error?r:r.getMinutes()},u.MIRR=function(r,l,f){if(le(r=ke(U(r)),l=W(l),f=W(f)))return p;let w=r.length,O=[],V=[];for(let pe=0;pe<w;pe++)r[pe]<0?O.push(r[pe]):V.push(r[pe]);let Q=-ra(f,V)*Math.pow(1+f,w-1),oe=ra(l,O)*(1+l);return Math.pow(Q/oe,1/(w-1))-1},u.MMULT=function(r,l){return!Array.isArray(r)||!Array.isArray(l)||r.some(f=>!f.length)||l.some(f=>!f.length)||re(r).some(f=>typeof f!="number")||re(l).some(f=>typeof f!="number")||r[0].length!==l.length?p:Array(r.length).fill(0).map(()=>Array(l[0].length).fill(0)).map((f,w)=>f.map((O,V)=>r[w].reduce((Q,oe,pe)=>Q+oe*l[pe][V],0)))},u.MOD=function(r,l){let f=be(r=W(r),l=W(l));if(f)return f;if(l===0)return g;let w=Math.abs(r%l);return w=r<0?l-w:w,l>0?w:-w},u.MODE=k,u.MODEMULT=v0,u.MODESNGL=b0,u.MONTH=function(r){return(r=ze(r))instanceof Error?r:r.getMonth()+1},u.MROUND=function(r,l){return be(r=W(r),l=W(l))||(r*l==0?0:r*l<0?v:Math.round(r/l)*l)},u.MULTINOMIAL=function(){let r=ke(U(arguments));if(r instanceof Error)return r;let l=0,f=1;for(let w=0;w<r.length;w++)l+=r[w],f*=qe(r[w]);return qe(l)/f},u.MUNIT=function(r){return arguments.length>1?C:!(r=parseInt(r))||r<=0?p:Array(r).fill(0).map(()=>Array(r).fill(0)).map((l,f)=>(l[f]=1,l))},u.N=function(r){return Rr(r)?r:r instanceof Date?r.getTime():r===!0?1:r===!1?0:Dt(r)?r:0},u.NA=function(){return C},u.NEGBINOM=R,u.NEGBINOMDIST=j0,u.NETWORKDAYS=mi,u.NETWORKDAYSINTL=y0,u.NOMINAL=function(r,l){return le(r=W(r),l=W(l))?p:r<=0||l<1?v:(l=parseInt(l,10),(Math.pow(r+1,1/l)-1)*l)},u.NORM=Z,u.NORMDIST=x0,u.NORMINV=w0,u.NORMSDIST=C0,u.NORMSINV=E0,u.NOT=function(r){return typeof r=="string"?p:r instanceof Error?r:!r},u.NOW=function(){return new Date},u.NPER=function(r,l,f,w,O){if(O=O===void 0?0:O,w=w===void 0?0:w,le(r=W(r),l=W(l),f=W(f),w=W(w),O=W(O)))return p;if(r===0)return-(f+w)/l;{let V=l*(1+r*O)-w*r,Q=f*r+l*(1+r*O);return Math.log(V/Q)/Math.log(1+r)}},u.NPV=ra,u.NUMBERVALUE=function(r,l,f){return typeof(r=Ie(r)?r:"")=="number"?r:typeof r!="string"?C:(l=l===void 0?".":l,f=f===void 0?",":f,Number(r.replace(l,".").replace(f,"")))},u.OCT2BIN=function(r,l){if(!/^[0-7]{1,10}$/.test(r))return v;let f=!(r.length!==10||r.substring(0,1)!=="7"),w=f?parseInt(r,8)-1073741824:parseInt(r,8);if(w<-512||w>511)return v;if(f)return"1"+nn("0",9-(512+w).toString(2).length)+(512+w).toString(2);let O=w.toString(2);return l===void 0?O:isNaN(l)?p:l<0?v:(l=Math.floor(l))>=O.length?nn("0",l-O.length)+O:v},u.OCT2DEC=function(r){if(!/^[0-7]{1,10}$/.test(r))return v;let l=parseInt(r,8);return l>=536870912?l-1073741824:l},u.OCT2HEX=function(r,l){if(!/^[0-7]{1,10}$/.test(r))return v;let f=parseInt(r,8);if(f>=536870912)return"ff"+(f+3221225472).toString(16);let w=f.toString(16);return l===void 0?w:isNaN(l)?p:l<0?v:(l=Math.floor(l))>=w.length?nn("0",l-w.length)+w:v},u.ODD=function(r){if((r=W(r))instanceof Error)return r;let l=Math.ceil(Math.abs(r));return l=1&l?l:l+1,r>=0?l:-l},u.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},u.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},u.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},u.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},u.OR=function(){let r=U(arguments),l=p;for(let f=0;f<r.length;f++){if(r[f]instanceof Error)return r[f];r[f]!==void 0&&r[f]!==null&&typeof r[f]!="string"&&(l===p&&(l=!1),r[f]&&(l=!0))}return l},u.PDURATION=function(r,l,f){return le(r=W(r),l=W(l),f=W(f))?p:r<=0?v:(Math.log(f)-Math.log(l))/Math.log(1+r)},u.PEARSON=de,u.PERCENTILE=ne,u.PERCENTILEEXC=A0,u.PERCENTILEINC=S0,u.PERCENTRANK=J,u.PERCENTRANKEXC=L0,u.PERCENTRANKINC=N0,u.PERMUT=function(r,l){return le(r=W(r),l=W(l))?p:qe(r)/qe(r-l)},u.PERMUTATIONA=function(r,l){return le(r=W(r),l=W(l))?p:Math.pow(r,l)},u.PHI=function(r){return(r=W(r))instanceof Error?p:Math.exp(-.5*r*r)/2.5066282746310002},u.PI=function(){return Math.PI},u.PMT=vo,u.POISSON=ve,u.POISSONDIST=k0,u.POWER=Su,u.PPMT=function(r,l,f,w,O,V){return O=O||0,V=V||0,le(r=W(r),f=W(f),w=W(w),O=W(O),V=W(V))?p:vo(r,f,w,O,V)-Fu(r,l,f,w,O,V)},u.PRICE=function(){throw new Error("PRICE is not implemented")},u.PRICEDISC=function(r,l,f,w,O){if(le(r=ze(r),l=ze(l),f=W(f),w=W(w),O=(O=W(O))||0))return p;if(f<=0||w<=0)return v;if(r>=l)return p;let V,Q;switch(O){case 0:V=360,Q=Xn(r,l,!1);break;case 1:case 3:V=365,Q=mo(r,l,"D");break;case 2:V=360,Q=mo(r,l,"D");break;case 4:V=360,Q=Xn(r,l,!0);break;default:return v}return w-f*w*Q/V},u.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},u.PROB=function(r,l,f,w){if(f===void 0)return 0;if(w=w===void 0?f:w,le(r=ke(U(r)),l=ke(U(l)),f=W(f),w=W(w)))return p;if(f===w)return r.indexOf(f)>=0?l[r.indexOf(f)]:0;let O=r.sort((oe,pe)=>oe-pe),V=O.length,Q=0;for(let oe=0;oe<V;oe++)O[oe]>=f&&O[oe]<=w&&(Q+=l[r.indexOf(O[oe])]);return Q},u.PRODUCT=Gl,u.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},u.PROPER=function(r){return le(r)?r:isNaN(r)&&typeof r=="number"?p:(r=Ze(r)).replace(/\w\S*/g,l=>l.charAt(0).toUpperCase()+l.substr(1).toLowerCase())},u.PV=function(r,l,f,w,O){return w=w||0,O=O||0,le(r=W(r),l=W(l),f=W(f),w=W(w),O=W(O))?p:r===0?-f*l-w:((1-Math.pow(1+r,l))/r*f*(1+r*O)-w)/Math.pow(1+r,l)},u.QUARTILE=xe,u.QUARTILEEXC=M0,u.QUARTILEINC=I0,u.QUOTIENT=function(r,l){return be(r=W(r),l=W(l))||parseInt(r/l,10)},u.RADIANS=function(r){return(r=W(r))instanceof Error?r:r*Math.PI/180},u.RAND=function(){return Math.random()},u.RANDBETWEEN=function(r,l){return be(r=W(r),l=W(l))||r+Math.ceil((l-r+1)*Math.random())-1},u.RANK=Ce,u.RANKAVG=T0,u.RANKEQ=D0,u.RATE=function(r,l,f,w,O,V){if(V=V===void 0?.01:V,w=w===void 0?0:w,O=O===void 0?0:O,le(r=W(r),l=W(l),f=W(f),w=W(w),O=W(O),V=W(V)))return p;let Q=1e-10,oe=V;O=O?1:0;for(let pe=0;pe<20;pe++){if(oe<=-1)return v;let we,De,Ue;if(Math.abs(oe)<Q?we=f*(1+r*oe)+l*(1+oe*O)*r+w:(De=Math.pow(1+oe,r),we=f*De+l*(1/oe+O)*(De-1)+w),Math.abs(we)<Q)return oe;if(Math.abs(oe)<Q)Ue=f*r+l*O*r;else{De=Math.pow(1+oe,r);let Pe=r*Math.pow(1+oe,r-1);Ue=f*Pe+l*(1/oe+O)*Pe+l*(-1/(oe*oe))*(De-1)}oe-=we/Ue}return oe},u.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},u.REPLACE=function(r,l,f,w){return le(l=W(l),f=W(f))||typeof r!="string"||typeof w!="string"?p:r.substr(0,l-1)+w+r.substr(l-1+f)},u.REPT=nn,u.RIGHT=function(r,l){return be(r,l)||(r=Ze(r),(l=W(l=l===void 0?1:l))instanceof Error?l:r.substring(r.length-l))},u.ROMAN=function(r){if((r=W(r))instanceof Error)return r;let l=String(r).split(""),f=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],w="",O=3;for(;O--;)w=(f[+l.pop()+10*O]||"")+w;return new Array(+l.join("")+1).join("M")+w},u.ROUND=Nn,u.ROUNDDOWN=function(r,l){return be(r=W(r),l=W(l))||(r>0?1:-1)*Math.floor(Math.abs(r)*Math.pow(10,l))/Math.pow(10,l)},u.ROUNDUP=function(r,l){return be(r=W(r),l=W(l))||(r>0?1:-1)*Math.ceil(Math.abs(r)*Math.pow(10,l))/Math.pow(10,l)},u.ROW=function(r,l){return arguments.length!==2?C:l<0?v:r instanceof Array&&typeof l=="number"?r.length!==0?m.row(r,l):void 0:p},u.ROWS=function(r){return arguments.length!==1?C:r instanceof Array?r.length===0?0:m.rows(r):p},u.RRI=function(r,l,f){return le(r=W(r),l=W(l),f=W(f))?p:r===0||l===0?v:Math.pow(f/l,1/r)-1},u.RSQ=function(r,l){return le(r=ke(U(r)),l=ke(U(l)))?p:Math.pow(de(r,l),2)},u.SEARCH=function(r,l,f){let w;return typeof r!="string"||typeof l!="string"?p:(f=f===void 0?0:f,w=l.toLowerCase().indexOf(r.toLowerCase(),f-1)+1,w===0?p:w)},u.SEC=function(r){return(r=W(r))instanceof Error?r:1/Math.cos(r)},u.SECH=function(r){return(r=W(r))instanceof Error?r:2/(Math.exp(r)+Math.exp(-r))},u.SECOND=function(r){return(r=ze(r))instanceof Error?r:r.getSeconds()},u.SERIESSUM=function(r,l,f,w){if(le(r=W(r),l=W(l),f=W(f),w=ke(w)))return p;let O=w[0]*Math.pow(r,l);for(let V=1;V<w.length;V++)O+=w[V]*Math.pow(r,l+V*f);return O},u.SHEET=function(){throw new Error("SHEET is not implemented")},u.SHEETS=function(){throw new Error("SHEETS is not implemented")},u.SIGN=function(r){return(r=W(r))instanceof Error?r:r<0?-1:r===0?0:1},u.SIN=function(r){return(r=W(r))instanceof Error?r:Math.sin(r)},u.SINH=function(r){return(r=W(r))instanceof Error?r:(Math.exp(r)-Math.exp(-r))/2},u.SKEW=Ae,u.SKEWP=O0,u.SLN=function(r,l,f){return le(r=W(r),l=W(l),f=W(f))?p:f===0?v:(r-l)/f},u.SLOPE=function(r,l){if(le(r=ke(U(r)),l=ke(U(l))))return p;let f=m.mean(l),w=m.mean(r),O=l.length,V=0,Q=0;for(let oe=0;oe<O;oe++)V+=(l[oe]-f)*(r[oe]-w),Q+=Math.pow(l[oe]-f,2);return V/Q},u.SMALL=_e,u.SORT=function(r,l=1,f=1,w=!1){if(!r||!Array.isArray(r))return C;if(r.length===0)return 0;if(!(l=W(l))||l<1||(f=W(f))!==1&&f!==-1)return p;if(typeof(w=Ge(w))!="boolean")return j;let O=oe=>oe.sort((pe,we)=>(pe=Ze(pe[l-1]),we=Ze(we[l-1]),f===1?pe<we?-1*f:f:pe>we?f:-1*f)),V=G(r),Q=w?ye(V):V;return l>=1&&l<=Q[0].length?w?ye(O(Q)):O(Q):p},u.SQRT=function(r){return(r=W(r))instanceof Error?r:r<0?v:Math.sqrt(r)},u.SQRTPI=function(r){return(r=W(r))instanceof Error?r:Math.sqrt(r*Math.PI)},u.STANDARDIZE=function(r,l,f){return le(r=W(r),l=W(l),f=W(f))?p:(r-l)/f},u.STDEV=We,u.STDEVA=function(){let r=ge.apply(this,arguments);return Math.sqrt(r)},u.STDEVP=F0,u.STDEVPA=function(){let r=Ee.apply(this,arguments),l=Math.sqrt(r);return isNaN(l)&&(l=v),l},u.STDEVS=R0,u.STEYX=function(r,l){if(le(r=ke(U(r)),l=ke(U(l))))return p;let f=m.mean(l),w=m.mean(r),O=l.length,V=0,Q=0,oe=0;for(let pe=0;pe<O;pe++)V+=Math.pow(r[pe]-w,2),Q+=(l[pe]-f)*(r[pe]-w),oe+=Math.pow(l[pe]-f,2);return Math.sqrt((V-Q*Q/oe)/(O-2))},u.SUBSTITUTE=function(r,l,f,w){if(arguments.length<3)return C;if(r&&l){if(w===void 0)return r.split(l).join(f);{if(w=Math.floor(Number(w)),Number.isNaN(w)||w<=0)return p;let O=0,V=0;for(;O>-1&&r.indexOf(l,O)>-1;)if(O=r.indexOf(l,O+1),V++,O>-1&&V===w)return r.substring(0,O)+f+r.substring(O+l.length);return r}}return r},u.SUBTOTAL=function(r,l){if((r=W(r))instanceof Error)return r;switch(r){case 1:case 101:return c(l);case 2:case 102:return z(l);case 3:case 103:return X(l);case 4:case 104:return je(l);case 5:case 105:return q(l);case 6:case 106:return Gl(l);case 7:case 107:return We.S(l);case 8:case 108:return We.P(l);case 9:case 109:return mr(l);case 10:case 110:return te.S(l);case 11:case 111:return te.P(l)}},u.SUM=mr,u.SUMIF=function(r,l,f){if(r=U(r),f=f?U(f):r,r instanceof Error)return r;if(l==null||l instanceof Error)return 0;let w=0,O=l==="*",V=O?null:bn(l+"");for(let Q=0;Q<r.length;Q++){let oe=r[Q],pe=f[Q];if(O)w+=oe;else{let we=[Ut(oe,jt)].concat(V);w+=Yt(we)?pe:0}}return w},u.SUMIFS=function(){let r=F(arguments),l=ke(U(r.shift()));if(l instanceof Error)return l;let f=r,w=f.length/2;for(let V=0;V<w;V++)f[2*V]=U(f[2*V]);let O=0;for(let V=0;V<l.length;V++){let Q=!1;for(let oe=0;oe<w;oe++){let pe=f[2*oe][V],we=f[2*oe+1],De=!1;if(we===void 0||we==="*")De=!0;else{let Ue=bn(we+""),Pe=[Ut(pe,jt)].concat(Ue);De=Yt(Pe)}if(!De){Q=!1;break}Q=!0}Q&&(O+=l[V])}return O},u.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return p;let r=arguments.length+1,l,f,w,O,V=0;for(let Q=0;Q<arguments[0].length;Q++)if(arguments[0][Q]instanceof Array)for(let oe=0;oe<arguments[0][Q].length;oe++){for(l=1,f=1;f<r;f++){let pe=arguments[f-1][Q][oe];if(pe instanceof Error)return pe;if(O=W(pe),O instanceof Error)return O;l*=O}V+=l}else{for(l=1,f=1;f<r;f++){let oe=arguments[f-1][Q];if(oe instanceof Error)return oe;if(w=W(oe),w instanceof Error)return w;l*=w}V+=l}return V},u.SUMSQ=function(){let r=ke(U(arguments));if(r instanceof Error)return r;let l=0,f=r.length;for(let w=0;w<f;w++)l+=Rr(r[w])?r[w]*r[w]:0;return l},u.SUMX2MY2=function(r,l){if(le(r=ke(U(r)),l=ke(U(l))))return p;let f=0;for(let w=0;w<r.length;w++)f+=r[w]*r[w]-l[w]*l[w];return f},u.SUMX2PY2=function(r,l){if(le(r=ke(U(r)),l=ke(U(l))))return p;let f=0;r=ke(U(r)),l=ke(U(l));for(let w=0;w<r.length;w++)f+=r[w]*r[w]+l[w]*l[w];return f},u.SUMXMY2=function(r,l){if(le(r=ke(U(r)),l=ke(U(l))))return p;let f=0;r=U(r),l=U(l);for(let w=0;w<r.length;w++)f+=Math.pow(r[w]-l[w],2);return f},u.SWITCH=function(){let r;if(arguments.length>0){let l=arguments[0],f=arguments.length-1,w=Math.floor(f/2),O=!1,V=f%2!=0,Q=f%2==0?null:arguments[arguments.length-1];if(w){for(let oe=0;oe<w;oe++)if(l===arguments[2*oe+1]){r=arguments[2*oe+2],O=!0;break}}O||(r=V?Q:C)}else r=p;return r},u.SYD=function(r,l,f,w){return le(r=W(r),l=W(l),f=W(f),w=W(w))?p:f===0||w<1||w>f?v:(r-l)*(f-(w=parseInt(w,10))+1)*2/(f*(f+1))},u.T=function(r){return r instanceof Error||typeof r=="string"?r:""},u.TAN=function(r){return(r=W(r))instanceof Error?r:Math.tan(r)},u.TANH=function(r){if((r=W(r))instanceof Error)return r;let l=Math.exp(2*r);return(l-1)/(l+1)},u.TBILLEQ=function(r,l,f){return le(r=ze(r),l=ze(l),f=W(f))?p:f<=0||r>l||l-r>31536e6?v:365*f/(360-f*Xn(r,l,!1))},u.TBILLPRICE=function(r,l,f){return le(r=ze(r),l=ze(l),f=W(f))?p:f<=0||r>l||l-r>31536e6?v:100*(1-f*Xn(r,l,!1)/360)},u.TBILLYIELD=function(r,l,f){return le(r=ze(r),l=ze(l),f=W(f))?p:f<=0||r>l||l-r>31536e6?v:360*(100-f)/(f*Xn(r,l,!1))},u.TDIST=_0,u.TDISTRT=H0,u.TEXT=function(r,l){if(r===void 0||r instanceof Error||l instanceof Error)return C;if(l==null)return"";if(typeof l=="number")return String(l);if(typeof l!="string")return p;let f=l.startsWith("$")?"$":"",w=l.endsWith("%");return w&&(r*=100),r=(r=Tu(r,(l=l.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!l.includes(","))).startsWith("-")?"-"+f+(r=r.replace("-","")):f+r,w&&(r+="%"),r},u.TEXTJOIN=function(r,l,...f){if(typeof l!="boolean"&&(l=Ge(l)),arguments.length<3)return C;r=r??"";let w=U(f),O=l?w.filter(V=>V):w;if(Array.isArray(r)){r=U(r);let V=O.map(oe=>[oe]),Q=0;for(let oe=0;oe<V.length-1;oe++)V[oe].push(r[Q]),Q++,Q===r.length&&(Q=0);return O=U(V),O.join("")}return O.join(r)},u.TIME=function(r,l,f){return le(r=W(r),l=W(l),f=W(f))?p:r<0||l<0||f<0?v:(3600*r+60*l+f)/86400},u.TIMEVALUE=function(r){return(r=ze(r))instanceof Error?r:(3600*r.getHours()+60*r.getMinutes()+r.getSeconds())/86400},u.TINV=P0,u.TODAY=function(){return gi(new Date)},u.TRANSPOSE=function(r){return r?ye(G(r)):C},u.TREND=function(r,l,f){if(le(r=ke(U(r)),l=ke(U(l)),f=ke(U(f))))return p;let w=he(r,l),O=w[0],V=w[1],Q=[];return f.forEach(oe=>{Q.push(O*oe+V)}),Q},u.TRIM=function(r){return(r=Ze(r))instanceof Error?r:r.replace(/\s+/g," ").trim()},u.TRIMMEAN=function(r,l){if(le(r=ke(U(r)),l=W(l)))return p;let f=Ve(r.length*l,2)/2;return m.mean((O=(O=f)||1,(w=ae(r.sort((V,Q)=>V-Q),f))&&typeof w.slice=="function"?w.slice(0,w.length-O):w));var w,O},u.TRUE=function(){return!0},u.TRUNC=function(r,l){return be(r=W(r),l=W(l))||(r>0?1:-1)*Math.floor(Math.abs(r)*Math.pow(10,l))/Math.pow(10,l)},u.TTEST=z0,u.TYPE=function(r){return Rr(r)?1:L(r)?2:Wl(r)?4:Dt(r)?16:Array.isArray(r)?64:void 0},u.UNICHAR=Hp,u.UNICODE=Pp,u.UNIQUE=I,u.UPPER=function(r){return(r=Ze(r))instanceof Error?r:r.toUpperCase()},u.VALUE=function(r){let l=be(r);if(l)return l;if(typeof r=="number")return r;if(Ie(r)||(r=""),typeof r!="string")return p;let f=/(%)$/.test(r)||/^(%)/.test(r);if((r=(r=(r=r.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let w=Number(r);return isNaN(w)?p:(w=w||0,f&&(w*=.01),w)},u.VAR=te,u.VARA=ge,u.VARP=B0,u.VARPA=Ee,u.VARS=V0,u.VDB=function(){throw new Error("VDB is not implemented")},u.VLOOKUP=h,u.WEEKDAY=function(r,l){if((r=ze(r))instanceof Error)return r;l===void 0&&(l=1);let f=r.getDay();return Rp[l][f]},u.WEEKNUM=function(r,l){if((r=ze(r))instanceof Error)return r;if(l===void 0&&(l=1),l===21)return Lu(r);let f=Fp[l],w=new Date(r.getFullYear(),0,1),O=w.getDay()<f?1:0;return w-=24*Math.abs(w.getDay()-f)*60*60*1e3,Math.floor((r-w)/864e5/7+1)+O},u.WEIBULL=Re,u.WEIBULLDIST=U0,u.WORKDAY=vi,u.WORKDAYINTL=Y0,u.XIRR=function(r,l,f){if(le(r=ke(U(r)),l=vt(U(l)),f=W(f)))return p;let w=(Pe,Je,it)=>{let at=it+1,qt=Pe[0];for(let Et=1;Et<Pe.length;Et++)qt+=Pe[Et]/Math.pow(at,vr(Je[Et],Je[0])/365);return qt},O=(Pe,Je,it)=>{let at=it+1,qt=0;for(let Et=1;Et<Pe.length;Et++){let Zn=vr(Je[Et],Je[0])/365;qt-=Zn*Pe[Et]/Math.pow(at,Zn+1)}return qt},V=!1,Q=!1;for(let Pe=0;Pe<r.length;Pe++)r[Pe]>0&&(V=!0),r[Pe]<0&&(Q=!0);if(!V||!Q)return v;let oe,pe,we,De=f=f||.1,Ue=!0;do we=w(r,l,De),oe=De-we/O(r,l,De),pe=Math.abs(oe-De),De=oe,Ue=pe>1e-10&&Math.abs(we)>1e-10;while(Ue);return De},u.XNPV=function(r,l,f){if(le(r=W(r),l=ke(U(l)),f=vt(U(f))))return p;let w=0;for(let O=0;O<l.length;O++)w+=l[O]/Math.pow(1+r,vr(f[O],f[0])/365);return w},u.XOR=function(){let r=U(arguments),l=p;for(let f=0;f<r.length;f++){if(r[f]instanceof Error)return r[f];r[f]!==void 0&&r[f]!==null&&typeof r[f]!="string"&&(l===p&&(l=0),r[f]&&l++)}return l===p?l:!!(1&Math.floor(Math.abs(l)))},u.YEAR=function(r){return(r=ze(r))instanceof Error?r:r.getFullYear()},u.YEARFRAC=Zl,u.YIELD=function(){throw new Error("YIELD is not implemented")},u.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},u.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},u.Z=ot,u.ZTEST=W0,u.utils=G0}},o={};function a(E){var u=o[E];if(u!==void 0)return u.exports;var s=o[E]={exports:{}};return n[E].call(s.exports,s,s.exports,a),s.exports}a.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var d=a(960);t=d}(),t)},44:function(module,__unused_webpack_exports,__webpack_require__){if(!formula)var formula=__webpack_require__(463);var factory;factory=function(){"use strict";var Version=(info={title:"Jspreadsheet",version:"4.15.0",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join(`\r
`)}},function(){return info}),info,isFormula=function(e){var t=(""+e)[0];return t=="="||t=="#"},getMask=function(e){if(e.format||e.mask||e.locale){var t={};return e.mask?t.mask=e.mask:e.format?t.mask=e.format:(t.locale=e.locale,t.options=e.options),e.decimal&&(t.options||(t.options={}),t.options={decimal:e.decimal}),t}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if(el.tagName=="TABLE"){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if(property==="text")for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,obj.options.lazyLoading==1&&obj.options.tableOverflow==0&&obj.options.fullscreen==0&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(e){e==null&&(e=!obj.options.fullscreen),obj.options.fullscreen!=e&&(obj.options.fullscreen=e,e==1?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(e){if(!obj.ignoreEvents){if(typeof obj.options.onevent=="function")var t=obj.options.onevent.apply(this,arguments);typeof obj.options[e]=="function"&&(t=obj.options[e].apply(this,Array.prototype.slice.call(arguments,1)))}if(e=="onafterchanges"&&obj.options.persistance){var n=obj.options.persistance==1?obj.options.url:obj.options.persistance,o=obj.prepareJson(arguments[2]);obj.save(n,o)}return t},obj.prepareTable=function(){var e=obj.options.columns.length;if(obj.options.data&&obj.options.data[0]!==void 0){var t=Object.keys(obj.options.data[0]);t.length>e&&(e=t.length)}obj.options.minDimensions[0]>e&&(e=obj.options.minDimensions[0]);for(var n=[],o=0;o<e;o++)obj.options.colHeaders[o]||(obj.options.colHeaders[o]=""),obj.options.colWidths[o]||(obj.options.colWidths[o]=obj.options.defaultColWidth),obj.options.colAlignments[o]||(obj.options.colAlignments[o]=obj.options.defaultColAlign),obj.options.columns[o]?obj.options.columns[o].type||(obj.options.columns[o].type="text"):obj.options.columns[o]={type:"text"},obj.options.columns[o].name||(obj.options.columns[o].name=t&&t[o]?t[o]:o),obj.options.columns[o].source||(obj.options.columns[o].source=[]),obj.options.columns[o].options||(obj.options.columns[o].options=[]),obj.options.columns[o].editor||(obj.options.columns[o].editor=null),obj.options.columns[o].allowEmpty||(obj.options.columns[o].allowEmpty=!1),obj.options.columns[o].title||(obj.options.columns[o].title=obj.options.colHeaders[o]?obj.options.colHeaders[o]:""),obj.options.columns[o].width||(obj.options.columns[o].width=obj.options.colWidths[o]?obj.options.colWidths[o]:obj.options.defaultColWidth),obj.options.columns[o].align||(obj.options.columns[o].align=obj.options.colAlignments[o]?obj.options.colAlignments[o]:"center"),obj.options.columns[o].type=="autocomplete"||obj.options.columns[o].type=="dropdown"?obj.options.columns[o].url&&n.push({url:obj.options.columns[o].url,index:o,method:"GET",dataType:"json",success:function(a){for(var d=0;d<a.length;d++)obj.options.columns[this.index].source.push(a[d])}}):obj.options.columns[o].type=="calendar"&&(obj.options.columns[o].options.format||(obj.options.columns[o].options.format="DD/MM/YYYY"));n.length?jSuites.ajax(n,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(j){obj.scrollControls(j)},obj.content.onwheel=function(j){obj.wheelControls(j)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var e=document.createElement("div"),t=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),e.appendChild(t),e.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var n=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var o=0;o<obj.options.paginationOptions.length;o++){var a=document.createElement("option");a.value=obj.options.paginationOptions[o],a.innerHTML=obj.options.paginationOptions[o],obj.paginationDropdown.appendChild(a)}obj.paginationDropdown.value=obj.options.pagination,n.appendChild(document.createTextNode(obj.options.text.show)),n.appendChild(obj.paginationDropdown),n.appendChild(document.createTextNode(obj.options.text.entries))}var d,E=document.createElement("div");if(E.classList.add("jexcel_filter"),E.appendChild(n),E.appendChild(e),obj.colgroupContainer=document.createElement("colgroup"),(d=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(d),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var u=0;u<obj.options.nestedHeaders.length;u++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[u]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(d=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(d),o=0;o<obj.options.columns.length;o++)obj.createCellHeader(o),obj.headerContainer.appendChild(obj.headers[o]),obj.colgroupContainer.appendChild(obj.colgroup[o]);if(obj.thead.appendChild(obj.headerContainer),obj.options.filters==1){obj.filter=document.createElement("tr");var s=document.createElement("td");for(obj.filter.appendChild(s),o=0;o<obj.options.columns.length;o++)(s=document.createElement("td")).innerHTML="&nbsp;",s.setAttribute("data-x",o),s.className="jexcel_column_filter",obj.options.columns[o].type=="hidden"&&(s.style.display="none"),obj.filter.appendChild(s);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),obj.options.selectionCopy==0&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var m=document.createElement("a");m.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";var T=document.createElement("span");T.innerHTML="Jspreadsheet CE",m.appendChild(T),obj.ads.appendChild(m),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var M=document.createElement("div"),g=document.createElement("div");if(obj.pagination.appendChild(M),obj.pagination.appendChild(g),obj.options.pagination||(obj.pagination.style.display="none"),obj.options.search==1&&el.appendChild(E),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),obj.options.fullscreen==1?el.classList.add("fullscreen"):obj.options.tableOverflow==1&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),obj.options.tableOverflow!=1&&obj.options.toolbar&&el.classList.add("with-toolbar"),obj.options.columnDrag==1&&obj.thead.classList.add("draggable"),obj.options.columnResize==1&&obj.thead.classList.add("resizable"),obj.options.rowDrag==1&&obj.tbody.classList.add("draggable"),obj.options.rowResize==1&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var p=Object.keys(obj.options.classes);for(o=0;o<p.length;o++){var b=jexcel.getIdFromColumnName(p[o],!0);obj.records[b[1]][b[0]].classList.add(obj.options.classes[p[o]])}}},obj.refresh=function(){obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.setData(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(e){if(e&&(typeof e=="string"&&(e=JSON.parse(e)),obj.options.data=e),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){e=[];for(var t=0;t<obj.options.data.length;t++){for(var n=[],o=0;o<obj.options.columns.length;o++)n[o]=obj.options.data[t][obj.options.columns[o].name];e.push(n)}obj.options.data=e}t=0,o=0;var a=obj.options.columns.length,d=obj.options.data.length,E=obj.options.minDimensions[0],u=obj.options.minDimensions[1],s=E>a?E:a,m=u>d?u:d;for(t=0;t<m;t++)for(o=0;o<s;o++)obj.options.data[t]==null&&(obj.options.data[t]=[]),obj.options.data[t][o]==null&&(obj.options.data[t][o]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",obj.options.lazyLoading==1){var T=0,M=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,T=obj.options.pagination*obj.pageNumber,M=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<M&&(M=obj.options.data.length)):(T=0,M=obj.options.data.length);for(t=0;t<obj.options.data.length;t++){var g=obj.createRow(t,obj.options.data[t]);t>=T&&t<M&&obj.tbody.appendChild(g)}if(obj.options.lazyLoading==1||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var p=Object.keys(obj.options.mergeCells);for(o=0;o<p.length;o++){var b=obj.options.mergeCells[p[o]];obj.setMerge(p[o],b[0],b[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(e,t){for(var n=[],o=0,a=0,d=t==1||obj.options.copyCompatibility==0,E=obj.options.columns.length,u=obj.options.data.length,s=0;s<u;s++){o=0;for(var m=0;m<E;m++)e&&!obj.records[s][m].classList.contains("highlight")||(n[a]||(n[a]=[]),n[a][o]=d?obj.options.data[s][m]:obj.records[s][m].innerHTML,o++);o>0&&a++}return n},obj.getJsonRow=function(e){for(var t=obj.options.data[e],n=obj.options.columns.length,o={},a=0;a<n;a++)obj.options.columns[a].name||(obj.options.columns[a].name=a),o[obj.options.columns[a].name]=t[a];return o},obj.getJson=function(e){for(var t=[],n=obj.options.columns.length,o=obj.options.data.length,a=0;a<o;a++){for(var d=null,E=0;E<n;E++)e&&!obj.records[a][E].classList.contains("highlight")||(d==null&&(d={}),obj.options.columns[E].name||(obj.options.columns[E].name=E),d[obj.options.columns[E].name]=obj.options.data[a][E]);d!=null&&t.push(d)}return t},obj.prepareJson=function(e){for(var t=[],n=0;n<e.length;n++){var o=e[n].x,a=e[n].y,d=obj.options.columns[o].name?obj.options.columns[o].name:o;t[a]||(t[a]={row:a,data:{}}),t[a].data[d]=e[n].newValue}return t.filter(function(E){return E!=null})},obj.save=function(e,t){var n=obj.dispatch("onbeforesave",el,obj,t);if(n)t=n;else if(n===!1)return!1;jSuites.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(t)},success:function(o){obj.dispatch("onsave",el,obj,t)}})},obj.getRowData=function(e){return obj.options.data[e]},obj.setRowData=function(e,t){for(var n=0;n<obj.headers.length;n++){var o=jexcel.getColumnNameFromId([n,e]);t[n]!=null&&obj.setValue(o,t[n])}},obj.getColumnData=function(e){for(var t=[],n=0;n<obj.options.data.length;n++)t.push(obj.options.data[n][e]);return t},obj.setColumnData=function(e,t){for(var n=0;n<obj.rows.length;n++){var o=jexcel.getColumnNameFromId([e,n]);t[n]!=null&&obj.setValue(o,t[n])}},obj.createRow=function(e,t){obj.records[e]||(obj.records[e]=[]),t||(t=obj.options.data[e]),obj.rows[e]=document.createElement("tr"),obj.rows[e].setAttribute("data-y",e);var n=null;obj.options.defaultRowHeight&&(obj.rows[e].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[e]&&(obj.options.rows[e].height&&(obj.rows[e].style.height=obj.options.rows[e].height),obj.options.rows[e].title&&(n=obj.options.rows[e].title)),n||(n=parseInt(e+1));var o=document.createElement("td");o.innerHTML=n,o.setAttribute("data-y",e),o.className="jexcel_row",obj.rows[e].appendChild(o);for(var a=0;a<obj.options.columns.length;a++)obj.records[e][a]=obj.createCell(a,e,t[a]),obj.rows[e].appendChild(obj.records[e][a]);return obj.rows[e]},obj.parseValue=function(e,t,n,o){(""+n).substr(0,1)=="="&&obj.options.parseFormulas==1&&(n=obj.executeFormula(n,e,t));var a=obj.options.columns[e];if(a&&!isFormula(n)){var d=null;if(d=getMask(a)){n&&n==Number(n)&&(n=Number(n));var E=jSuites.mask.render(n,d,!0);if(o&&d.mask){var u=d.mask.split(";");u[1]&&(u[1].match(new RegExp("\\[Red\\]","gi"))&&(n<0?o.classList.add("red"):o.classList.remove("red")),u[1].match(new RegExp("\\(","gi"))&&n<0&&(E="("+E+")"))}E&&(n=E)}}return n};var validDate=function(e){return(e=""+e).substr(4,1)=="-"&&e.substr(7,1)=="-"||(e=e.split("-"))[0].length==4&&e[0]==Number(e[0])&&e[1].length==2&&e[1]==Number(e[1])};obj.createCell=function(e,t,n){var o=document.createElement("td");if(o.setAttribute("data-x",e),o.setAttribute("data-y",t),(""+n).substr(0,1)=="="&&obj.options.secureFormulas==1){var a=secureFormula(n);a!=n&&(n=a)}if(obj.options.columns[e].editor)obj.options.stripHTML===!1||obj.options.columns[e].stripHTML===!1?o.innerHTML=n:o.textContent=n,typeof obj.options.columns[e].editor.createCell=="function"&&(o=obj.options.columns[e].editor.createCell(o));else if(obj.options.columns[e].type=="hidden")o.style.display="none",o.textContent=n;else if(obj.options.columns[e].type=="checkbox"||obj.options.columns[e].type=="radio"){var d=document.createElement("input");d.type=obj.options.columns[e].type,d.name="c"+e,d.checked=n==1||n==1||n=="true",d.onclick=function(){obj.setValue(o,this.checked)},obj.options.columns[e].readOnly!=1&&obj.options.editable!=0||d.setAttribute("disabled","disabled"),o.appendChild(d),obj.options.data[t][e]=d.checked}else if(obj.options.columns[e].type=="calendar"){var E=null;if(!validDate(n)){var u=jSuites.calendar.extractDateFromString(n,obj.options.columns[e].options.format);u&&(E=u)}o.textContent=jSuites.calendar.getDateString(E||n,obj.options.columns[e].options.format)}else if(obj.options.columns[e].type=="dropdown"||obj.options.columns[e].type=="autocomplete")o.classList.add("jexcel_dropdown"),o.textContent=obj.getDropDownValue(e,n);else if(obj.options.columns[e].type=="color")if(obj.options.columns[e].render=="square"){var s=document.createElement("div");s.className="color",s.style.backgroundColor=n,o.appendChild(s)}else o.style.color=n,o.textContent=n;else if(obj.options.columns[e].type=="image"){if(n&&n.substr(0,10)=="data:image"){var m=document.createElement("img");m.src=n,o.appendChild(m)}}else obj.options.columns[e].type=="html"||obj.options.stripHTML===!1||obj.options.columns[e].stripHTML===!1?o.innerHTML=stripScript(obj.parseValue(e,t,n,o)):o.textContent=obj.parseValue(e,t,n,o);obj.options.columns[e].readOnly==1&&(o.className="readonly");var T=obj.options.columns[e].align?obj.options.columns[e].align:"center";return o.style.textAlign=T,obj.options.columns[e].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[e].wordWrap==1||o.innerHTML.length>200)&&(o.style.whiteSpace="pre-wrap"),e>0&&this.options.textOverflow==1&&(n||o.innerHTML?obj.records[t][e-1].style.overflow="hidden":e==obj.options.columns.length-1&&(o.style.overflow="hidden")),o},obj.createCellHeader=function(e){var t=obj.options.columns[e].width?obj.options.columns[e].width:obj.options.defaultColWidth,n=obj.options.columns[e].align?obj.options.columns[e].align:obj.options.defaultColAlign;obj.headers[e]=document.createElement("td"),obj.options.stripHTML?obj.headers[e].textContent=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e):obj.headers[e].innerHTML=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e),obj.headers[e].setAttribute("data-x",e),obj.headers[e].style.textAlign=n,obj.options.columns[e].title&&obj.headers[e].setAttribute("title",obj.headers[e].innerText),obj.options.columns[e].id&&obj.headers[e].setAttribute("id",obj.options.columns[e].id),obj.colgroup[e]=document.createElement("col"),obj.colgroup[e].setAttribute("width",t),obj.options.columns[e].type=="hidden"&&(obj.headers[e].style.display="none",obj.colgroup[e].style.display="none")},obj.updateNestedHeader=function(e,t,n){obj.options.nestedHeaders[t][e].title&&(obj.options.nestedHeaders[t][e].title=n,obj.options.nestedHeaders[t].element.children[e+1].textContent=n)},obj.createNestedHeader=function(e){var t=document.createElement("tr");t.classList.add("jexcel_nested");var n=document.createElement("td");t.appendChild(n),e.element=t;for(var o=0,a=0;a<e.length;a++){e[a].colspan||(e[a].colspan=1),e[a].align||(e[a].align="center"),e[a].title||(e[a].title=""),e[a].id||(e[a].id="");for(var d=e[a].colspan,E=[],u=0;u<d;u++)obj.options.columns[o]&&obj.options.columns[o].type=="hidden"&&d++,E.push(o),o++;(n=document.createElement("td")).setAttribute("data-column",E.join(",")),n.setAttribute("colspan",e[a].colspan),n.setAttribute("align",e[a].align),n.setAttribute("id",e[a].id),n.textContent=e[a].title,t.appendChild(n)}return t},obj.createToolbar=function(e){e?obj.options.toolbar=e:e=obj.options.toolbar;for(var t=0;t<e.length;t++)if(e[t].type=="i")(d=document.createElement("i")).classList.add("jexcel_toolbar_item"),d.classList.add("material-icons"),d.setAttribute("data-k",e[t].k),d.setAttribute("data-v",e[t].v),d.setAttribute("id",e[t].id),e[t].tooltip&&d.setAttribute("title",e[t].tooltip),e[t].onclick&&(e[t].onclick,1)?d.onclick=function(E){var u=E;return function(){e[u].onclick(el,obj,this)}}(t):d.onclick=function(){var E=this.getAttribute("data-k"),u=this.getAttribute("data-v");obj.setStyle(obj.highlighted,E,u)},d.textContent=e[t].content,obj.toolbar.appendChild(d);else if(e[t].type=="select"){var n=!1;(d=document.createElement("select")).classList.add("jexcel_toolbar_item"),d.setAttribute("data-k",e[t].k),e[t].tooltip&&d.setAttribute("title",e[t].tooltip),e[t].onchange&&(e[t].onchange,1)?(d.onchange=e[t].onchange,n=!0):d.onchange=function(){var E=this.getAttribute("data-k");obj.setStyle(obj.highlighted,E,this.value)};for(var o=0;o<e[t].v.length;o++){var a=document.createElement("option");a.value=e[t].v[o],a.textContent=e[t].v[o],e[t].selectedValue&&a.value===e[t].selectedValue&&(a.selected=!0),d.appendChild(a)}n&&d.dispatchEvent(new Event("change")),obj.toolbar.appendChild(d)}else if(e[t].type=="color"){var d;(d=document.createElement("i")).classList.add("jexcel_toolbar_item"),d.classList.add("material-icons"),d.setAttribute("data-k",e[t].k),d.setAttribute("data-v",""),e[t].tooltip&&d.setAttribute("title",e[t].tooltip),obj.toolbar.appendChild(d),d.textContent=e[t].content,jSuites.color(d,{onchange:function(E,u){var s=E.getAttribute("data-k");obj.setStyle(obj.highlighted,s,u)}})}},obj.setMerge=function(e,t,n,o){var a=!1;if(!e){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var d=parseInt(obj.highlighted[0].getAttribute("data-x")),E=parseInt(obj.highlighted[0].getAttribute("data-y")),u=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),s=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));e=jexcel.getColumnNameFromId([d,E]),t=u-d+1,n=s-E+1}var m=jexcel.getIdFromColumnName(e,!0);if(obj.options.mergeCells[e])obj.records[m[1]][m[0]].getAttribute("data-merged")&&(a=obj.options.text.cellAlreadyMerged);else if((!t||t<2)&&(!n||n<2))a=obj.options.text.invalidMergeProperties;else for(var T=m[1];T<m[1]+n;T++)for(var M=m[0];M<m[0]+t;M++)jexcel.getColumnNameFromId([M,T]),obj.records[T][M].getAttribute("data-merged")&&(a=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(a)alert(a);else{t>1?obj.records[m[1]][m[0]].setAttribute("colspan",t):t=1,n>1?obj.records[m[1]][m[0]].setAttribute("rowspan",n):n=1,obj.options.mergeCells[e]=[t,n,[]],obj.records[m[1]][m[0]].setAttribute("data-merged","true"),obj.records[m[1]][m[0]].style.overflow="hidden";for(var g=[],p=m[1];p<m[1]+n;p++)for(var b=m[0];b<m[0]+t;b++)m[0]==b&&m[1]==p||(g.push(obj.options.data[p][b]),obj.updateCell(b,p,"",!0),obj.options.mergeCells[e][2].push(obj.records[p][b]),obj.records[p][b].style.display="none",obj.records[p][b]=obj.records[m[1]][m[0]]);obj.updateSelection(obj.records[m[1]][m[0]]),o||(obj.setHistory({action:"setMerge",column:e,colspan:t,rowspan:n,data:g}),obj.dispatch("onmerge",el,e,t,n))}},obj.getMerge=function(e){var t={};if(e)t=obj.options.mergeCells[e]?[obj.options.mergeCells[e][0],obj.options.mergeCells[e][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var n=Object.keys(obj.options.mergeCells),o=0;o<n.length;o++)t[n[o]]=[obj.options.mergeCells[n[o]][0],obj.options.mergeCells[n[o]][1]]}return t},obj.removeMerge=function(e,t,n){if(obj.options.mergeCells[e]){var o=jexcel.getIdFromColumnName(e,!0);obj.records[o[1]][o[0]].removeAttribute("colspan"),obj.records[o[1]][o[0]].removeAttribute("rowspan"),obj.records[o[1]][o[0]].removeAttribute("data-merged");for(var a=obj.options.mergeCells[e],d=0,E=0;E<a[1];E++)for(var u=0;u<a[0];u++)(E>0||u>0)&&(obj.records[o[1]+E][o[0]+u]=a[2][d],obj.records[o[1]+E][o[0]+u].style.display="",t&&t[d]&&obj.updateCell(o[0]+u,o[1]+E,t[d]),d++);obj.updateSelection(obj.records[o[1]][o[0]],obj.records[o[1]+E-1][o[0]+u-1]),n||delete obj.options.mergeCells[e]}},obj.destroyMerged=function(e){if(obj.options.mergeCells){obj.options.mergeCells;for(var t=Object.keys(obj.options.mergeCells),n=0;n<t.length;n++)obj.removeMerge(t[n],null,e)}},obj.isColMerged=function(e,t){var n=[];if(obj.options.mergeCells)for(var o=Object.keys(obj.options.mergeCells),a=0;a<o.length;a++){var d=jexcel.getIdFromColumnName(o[a],!0),E=obj.options.mergeCells[o[a]][0],u=d[0],s=d[0]+(E>1?E-1:0);t==null?u<=e&&s>=e&&n.push(o[a]):t?u<e&&s>=e&&n.push(o[a]):u<=e&&s>e&&n.push(o[a])}return n},obj.isRowMerged=function(e,t){var n=[];if(obj.options.mergeCells)for(var o=Object.keys(obj.options.mergeCells),a=0;a<o.length;a++){var d=jexcel.getIdFromColumnName(o[a],!0),E=obj.options.mergeCells[o[a]][1],u=d[1],s=d[1]+(E>1?E-1:0);t==null?u<=e&&s>=e&&n.push(o[a]):t?u<e&&s>=e&&n.push(o[a]):u<=e&&s>e&&n.push(o[a])}return n},obj.openFilter=function(e){if(obj.options.filters){e=parseInt(e),obj.resetSelection();var t=[];if(obj.options.columns[e].type=="checkbox")t.push({id:"true",name:"True"}),t.push({id:"false",name:"False"});else{for(var n=[],o=!1,a=0;a<obj.options.data.length;a++){var d=obj.options.data[a][e],E=obj.records[a][e].innerHTML;d&&E?n[d]=E:o=!0}var u=Object.keys(n);for(t=[],a=0;a<u.length;a++)t.push({id:u[a],name:n[u[a]]});o&&t.push({value:"",id:"",name:"(Blanks)"})}var s=document.createElement("div");obj.filter.children[e+1].innerHTML="",obj.filter.children[e+1].appendChild(s),obj.filter.children[e+1].style.paddingLeft="0px",obj.filter.children[e+1].style.paddingRight="0px",obj.filter.children[e+1].style.overflow="initial";var m={data:t,multiple:!0,autocomplete:!0,opened:!0,value:obj.filters[e]!==void 0?obj.filters[e]:null,width:"100%",position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(T){obj.resetFilters(),obj.filters[e]=T.dropdown.getValue(!0),obj.filter.children[e+1].innerHTML=T.dropdown.getText(),obj.filter.children[e+1].style.paddingLeft="",obj.filter.children[e+1].style.paddingRight="",obj.filter.children[e+1].style.overflow="",obj.closeFilter(e),obj.refreshSelection()}};jSuites.dropdown(s,m)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var e=0;e<obj.filter.children.length;e++)obj.filter.children[e].innerHTML="&nbsp;",obj.filters[e]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(e){if(!e)for(var t=0;t<obj.filter.children.length;t++)obj.filters[t]&&(e=t);var n=function(d,E,u){for(var s=0;s<d.length;s++){var m=""+obj.options.data[u][E],T=""+obj.records[u][E].innerHTML;if(d[s]==m||d[s]==T)return!0}return!1},o=obj.filters[e];obj.results=[];for(var a=0;a<obj.options.data.length;a++)n(o,e,a)&&obj.results.push(a);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(e,t,n){var o=e.getAttribute("data-y"),a=e.getAttribute("data-x");obj.dispatch("oneditionstart",el,e,a,o),a>0&&(obj.records[o][a-1].style.overflow="hidden");var d=function(A){var S=e.getBoundingClientRect(),D=document.createElement(A);return D.style.width=S.width+"px",D.style.height=S.height-2+"px",D.style.minHeight=S.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(D),obj.dispatch("oncreateeditor",el,e,a,o,D),D};if(e.classList.contains("readonly")!=1){if(obj.edition=[obj.records[o][a],obj.records[o][a].innerHTML,a,o],obj.options.columns[a].editor)obj.options.columns[a].editor.openEditor(e,el,t,n);else if(obj.options.columns[a].type!="hidden")if(obj.options.columns[a].type=="checkbox"||obj.options.columns[a].type=="radio"){var E=!e.children[0].checked;obj.setValue(e,E),obj.edition=null}else if(obj.options.columns[a].type=="dropdown"||obj.options.columns[a].type=="autocomplete"){if(E=obj.options.data[o][a],obj.options.columns[a].multiple&&!Array.isArray(E)&&(E=E.split(";")),typeof obj.options.columns[a].filter=="function")var u=obj.options.columns[a].filter(el,e,a,o,obj.options.columns[a].source);else u=obj.options.columns[a].source;for(var s=[],m=0;m<u.length;m++)s.push(u[m]);var T=d("div"),M={data:s,multiple:!!obj.options.columns[a].multiple,autocomplete:!(!obj.options.columns[a].autocomplete&&obj.options.columns[a].type!="autocomplete"),opened:!0,value:E,width:"100%",height:T.style.minHeight,position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(){obj.closeEditor(e,!0)}};obj.options.columns[a].options&&obj.options.columns[a].options.type&&(M.type=obj.options.columns[a].options.type),jSuites.dropdown(T,M)}else if(obj.options.columns[a].type=="calendar"||obj.options.columns[a].type=="color")E=obj.options.data[o][a],(T=d("input")).value=E,obj.options.tableOverflow!=1&&obj.options.fullscreen!=1||(obj.options.columns[a].options.position=!0),obj.options.columns[a].options.value=obj.options.data[o][a],obj.options.columns[a].options.opened=!0,obj.options.columns[a].options.onclose=function(A,S){obj.closeEditor(e,!0)},obj.options.columns[a].type=="color"?jSuites.color(T,obj.options.columns[a].options):jSuites.calendar(T,obj.options.columns[a].options),T.focus();else if(obj.options.columns[a].type=="html"){E=obj.options.data[o][a],(T=d("div")).style.position="relative",(b=document.createElement("div")).classList.add("jexcel_richtext"),T.appendChild(b),jSuites.editor(b,{focus:!0,value:E});var g=e.getBoundingClientRect(),p=b.getBoundingClientRect();window.innerHeight<g.bottom+p.height?b.style.top=g.top-(p.height+2)+"px":b.style.top=g.top+"px"}else if(obj.options.columns[a].type=="image"){var b,j=e.children[0];(T=d("div")).style.position="relative",(b=document.createElement("div")).classList.add("jclose"),j&&j.src&&b.appendChild(j),T.appendChild(b),jSuites.image(b,obj.options.imageOptions),g=e.getBoundingClientRect(),p=b.getBoundingClientRect(),window.innerHeight<g.bottom+p.height?b.style.top=g.top-(p.height+2)+"px":b.style.top=g.top+"px"}else{E=t==1?"":obj.options.data[o][a],obj.options.columns[a].wordWrap==0||obj.options.wordWrap!=1&&obj.options.columns[a].wordWrap!=1?T=d("input"):T=d("textarea"),T.focus(),T.value=E,M=obj.options.columns[a];var v=null;if(!isFormula(E)&&(v=getMask(M))){if(!M.disabledMaskOnEdition)if(M.mask){var C=M.mask.split(";");T.setAttribute("data-mask",C[0])}else M.locale&&T.setAttribute("data-locale",M.locale);v.input=T,T.mask=v,jSuites.mask.render(E,v,!1)}T.onblur=function(){obj.closeEditor(e,!0)},T.scrollLeft=T.scrollWidth}}},obj.closeEditor=function(e,t){var n=parseInt(e.getAttribute("data-x")),o=parseInt(e.getAttribute("data-y"));if(t==1){if(obj.options.columns[n].editor)var a=obj.options.columns[n].editor.closeEditor(e,t);else if(!(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"||obj.options.columns[n].type=="hidden"))if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")a=e.children[0].dropdown.close(!0);else if(obj.options.columns[n].type=="calendar")a=e.children[0].calendar.close(!0);else if(obj.options.columns[n].type=="color")a=e.children[0].color.close(!0);else if(obj.options.columns[n].type=="html")a=e.children[0].children[0].editor.getData();else if(obj.options.columns[n].type=="image"){var d=e.children[0].children[0].children[0];a=d&&d.tagName=="IMG"?d.src:""}else if(obj.options.columns[n].type=="numeric")(""+(a=e.children[0].value)).substr(0,1)!="="&&a==""&&(a=obj.options.columns[n].allowEmpty?"":0),e.children[0].onblur=null;else{a=e.children[0].value,e.children[0].onblur=null;var E,u=obj.options.columns[n];if((E=getMask(u))&&a!==""&&!isFormula(a)&&typeof a!="number"){var s=jSuites.mask.extract(a,E,!0);s&&s.value!==""&&(a=s.value)}}obj.options.data[o][n]==a?e.innerHTML=obj.edition[1]:obj.setValue(e,a)}else obj.options.columns[n].editor?obj.options.columns[n].editor.closeEditor(e,t):obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete"?e.children[0].dropdown.close(!0):obj.options.columns[n].type=="calendar"?e.children[0].calendar.close(!0):obj.options.columns[n].type=="color"?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,e,n,o,a,t),e.classList.remove("editor"),obj.edition=null},obj.getCell=function(e){var t=(e=jexcel.getIdFromColumnName(e,!0))[0],n=e[1];return obj.records[n][t]},obj.getColumnOptions=function(e,t){var n=obj.options.columns[e];return n||(n={type:"text"}),n},obj.getCellFromCoords=function(e,t){return obj.records[t][e]},obj.getLabel=function(e){var t=(e=jexcel.getIdFromColumnName(e,!0))[0],n=e[1];return obj.records[n][t].innerHTML},obj.getLabelFromCoords=function(e,t){return obj.records[t][e].innerHTML},obj.getValue=function(e,t){if(typeof e=="object")var n=e.getAttribute("data-x"),o=e.getAttribute("data-y");else n=(e=jexcel.getIdFromColumnName(e,!0))[0],o=e[1];var a=null;return n!=null&&o!=null&&(obj.records[o]&&obj.records[o][n]&&(t||obj.options.copyCompatibility==1)?a=obj.records[o][n].innerHTML:obj.options.data[o]&&obj.options.data[o][n]!="undefined"&&(a=obj.options.data[o][n])),a},obj.getValueFromCoords=function(e,t,n){var o=null;return e!=null&&t!=null&&(obj.records[t]&&obj.records[t][e]&&n||obj.options.copyCompatibility==1?o=obj.records[t][e].innerHTML:obj.options.data[t]&&obj.options.data[t][e]!="undefined"&&(o=obj.options.data[t][e])),o},obj.setValue=function(e,t,n){var o=[];if(typeof e=="string"){var a=(s=jexcel.getIdFromColumnName(e,!0))[0],d=s[1];o.push(obj.updateCell(a,d,t,n)),obj.updateFormulaChain(a,d,o)}else if(a=null,d=null,e&&e.getAttribute&&(a=e.getAttribute("data-x"),d=e.getAttribute("data-y")),a!=null&&d!=null)o.push(obj.updateCell(a,d,t,n)),obj.updateFormulaChain(a,d,o);else{var E=Object.keys(e);if(E.length>0)for(var u=0;u<E.length;u++){var s;typeof e[u]=="string"?(a=(s=jexcel.getIdFromColumnName(e[u],!0))[0],d=s[1]):e[u].x!=null&&e[u].y!=null?(a=e[u].x,d=e[u].y,e[u].newValue!=null?t=e[u].newValue:e[u].value!=null&&(t=e[u].value)):(a=e[u].getAttribute("data-x"),d=e[u].getAttribute("data-y")),a!=null&&d!=null&&(o.push(obj.updateCell(a,d,t,n)),obj.updateFormulaChain(a,d,o))}}obj.setHistory({action:"setValue",records:o,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,o)},obj.setValueFromCoords=function(e,t,n,o){var a=[];a.push(obj.updateCell(e,t,n,o)),obj.updateFormulaChain(e,t,a),obj.setHistory({action:"setValue",records:a,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,a)},obj.setCheckRadioValue=function(){for(var e=[],t=Object.keys(obj.highlighted),n=0;n<t.length;n++){var o=obj.highlighted[n].getAttribute("data-x"),a=obj.highlighted[n].getAttribute("data-y");obj.options.columns[o].type!="checkbox"&&obj.options.columns[o].type!="radio"||e.push(obj.updateCell(o,a,!obj.options.data[a][o]))}e.length&&(obj.setHistory({action:"setValue",records:e,selection:obj.selectedCell}),obj.onafterchanges(el,e))};var stripScript=function(e){var t=new Option;t.innerHTML=e;var n=null;for(e=t.getElementsByTagName("script");n=e[0];)n.parentNode.removeChild(n);return t.innerHTML};obj.updateCell=function(e,t,n,o){if(obj.records[t][e].classList.contains("readonly")!=1||o){var a;(""+n).substr(0,1)=="="&&obj.options.secureFormulas==1&&(a=secureFormula(n))!=n&&(n=a),(a=obj.dispatch("onbeforechange",el,obj.records[t][e],e,t,n))!=null&&(n=a),obj.options.columns[e].editor&&typeof obj.options.columns[e].editor.updateCell=="function"&&(n=obj.options.columns[e].editor.updateCell(obj.records[t][e],n,o)),T={x:e,y:t,col:e,row:t,newValue:n,oldValue:obj.options.data[t][e]};let M=obj.options.columns[e].editor;if(M)obj.options.data[t][e]=n,typeof M.setValue=="function"&&M.setValue(obj.records[t][e],n);else if(obj.options.columns[e].type=="checkbox"||obj.options.columns[e].type=="radio"){if(obj.options.columns[e].type=="radio")for(var d=0;d<obj.options.data.length;d++)obj.options.data[d][e]=!1;obj.records[t][e].children[0].checked=n==1||n==1||n=="true"||n=="TRUE",obj.options.data[t][e]=obj.records[t][e].children[0].checked}else if(obj.options.columns[e].type=="dropdown"||obj.options.columns[e].type=="autocomplete")obj.options.data[t][e]=n,obj.records[t][e].textContent=obj.getDropDownValue(e,n);else if(obj.options.columns[e].type=="calendar"){var E=null;if(!validDate(n)){var u=jSuites.calendar.extractDateFromString(n,obj.options.columns[e].options.format);u&&(E=u)}obj.options.data[t][e]=n,obj.records[t][e].textContent=jSuites.calendar.getDateString(E||n,obj.options.columns[e].options.format)}else if(obj.options.columns[e].type=="color")if(obj.options.data[t][e]=n,obj.options.columns[e].render=="square"){var s=document.createElement("div");s.className="color",s.style.backgroundColor=n,obj.records[t][e].textContent="",obj.records[t][e].appendChild(s)}else obj.records[t][e].style.color=n,obj.records[t][e].textContent=n;else if(obj.options.columns[e].type=="image"){if(n=""+n,obj.options.data[t][e]=n,obj.records[t][e].innerHTML="",n&&n.substr(0,10)=="data:image"){var m=document.createElement("img");m.src=n,obj.records[t][e].appendChild(m)}}else obj.options.data[t][e]=n,obj.options.columns[e].type=="html"?obj.records[t][e].innerHTML=stripScript(obj.parseValue(e,t,n)):obj.options.stripHTML===!1||obj.options.columns[e].stripHTML===!1?obj.records[t][e].innerHTML=stripScript(obj.parseValue(e,t,n,obj.records[t][e])):obj.records[t][e].textContent=obj.parseValue(e,t,n,obj.records[t][e]),obj.options.columns[e].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[e].wordWrap==1||obj.records[t][e].innerHTML.length>200)?obj.records[t][e].style.whiteSpace="pre-wrap":obj.records[t][e].style.whiteSpace="";e>0&&(obj.records[t][e-1].style.overflow=n?"hidden":""),obj.dispatch("onchange",el,obj.records[t]&&obj.records[t][e]?obj.records[t][e]:null,e,t,n,T.oldValue)}else var T={x:e,y:t,col:e,row:t};return T},obj.copyData=function(e,t){var n=obj.getData(!0,!0),o=obj.selectedContainer,a=parseInt(e.getAttribute("data-x")),d=parseInt(e.getAttribute("data-y")),E=parseInt(t.getAttribute("data-x")),u=parseInt(t.getAttribute("data-y")),s=[],m=!1;if(o[0]==a){if(d<o[1])var T=d-o[1];else T=1;var M=0}else M=a<o[0]?a-o[0]:1,T=0;for(var g=0,p=0,b=d;b<=u;b++)if(!obj.rows[b]||obj.rows[b].style.display!="none"){n[p]==null&&(p=0),g=0,o[0]!=a&&(M=a<o[0]?a-o[0]:1);for(var j=a;j<=E;j++){if(obj.records[b][j]&&!obj.records[b][j].classList.contains("readonly")&&obj.records[b][j].style.display!="none"&&m==0){if(!obj.selection.length&&obj.options.data[b][j]!=""){m=!0;continue}(n[p]==null||n[p][g]==null)&&(g=0);var v=n[p][g];if(v&&!n[1]&&obj.options.autoIncrement==1){if(obj.options.columns[j].type=="text"||obj.options.columns[j].type=="number")if((""+v).substr(0,1)=="="){var C=v.match(/([A-Z]+[0-9]+)/g);if(C){for(var A=[],S=0;S<C.length;S++){var D=jexcel.getIdFromColumnName(C[S],1);D[0]+=M,D[1]+=T,D[1]<0&&(D[1]=0);var F=jexcel.getColumnNameFromId([D[0],D[1]]);F!=C[S]&&(A[C[S]]=F)}A&&(v=obj.updateFormula(v,A))}}else v==Number(v)&&(v=Number(v)+T);else if(obj.options.columns[j].type=="calendar"){var N=new Date(v);N.setDate(N.getDate()+T),v=N.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(N.getMonth()+1))+"-"+jexcel.doubleDigitFormat(N.getDate())+" 00:00:00"}}s.push(obj.updateCell(j,b,v)),obj.updateFormulaChain(j,b,s)}g++,o[0]!=a&&M++}p++,T++}obj.setHistory({action:"setValue",records:s,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,s)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(e,t,n){if(e==1){if(obj.selectedCell&&(t>=obj.selectedCell[1]&&t<=obj.selectedCell[3]||n>=obj.selectedCell[1]&&n<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(t>=obj.selectedCell[0]&&t<=obj.selectedCell[2]||n>=obj.selectedCell[0]&&n<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(e){if(obj.highlighted.length){m=1;for(var t=0;t<obj.highlighted.length;t++){obj.highlighted[t].classList.remove("highlight"),obj.highlighted[t].classList.remove("highlight-left"),obj.highlighted[t].classList.remove("highlight-right"),obj.highlighted[t].classList.remove("highlight-top"),obj.highlighted[t].classList.remove("highlight-bottom"),obj.highlighted[t].classList.remove("highlight-selected");var n=parseInt(obj.highlighted[t].getAttribute("data-x")),o=parseInt(obj.highlighted[t].getAttribute("data-y"));if(obj.highlighted[t].getAttribute("data-merged"))var a=parseInt(obj.highlighted[t].getAttribute("colspan")),d=parseInt(obj.highlighted[t].getAttribute("rowspan")),E=a>0?n+(a-1):n,u=d>0?o+(d-1):o;else E=n,u=o;for(var s=n;s<=E;s++)obj.headers[s]&&obj.headers[s].classList.remove("selected");for(s=o;s<=u;s++)obj.rows[s]&&obj.rows[s].classList.remove("selected")}}else var m=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",e==1&&m==1&&obj.dispatch("onblur",el),m},obj.updateSelection=function(e,t,n){var o=e.getAttribute("data-x"),a=e.getAttribute("data-y");if(t)var d=t.getAttribute("data-x"),E=t.getAttribute("data-y");else d=o,E=a;obj.updateSelectionFromCoords(o,a,d,E,n)},obj.updateSelectionFromCoords=function(e,t,n,o,a){var d=obj.resetSelection();if(t==null&&(t=0,o=obj.rows.length-1),n==null&&(n=e),o==null&&(o=t),e>=obj.headers.length&&(e=obj.headers.length-1),t>=obj.rows.length&&(t=obj.rows.length-1),n>=obj.headers.length&&(n=obj.headers.length-1),o>=obj.rows.length&&(o=obj.rows.length-1),obj.selectedCell=[e,t,n,o],e!=null){if(obj.records[t][e]&&obj.records[t][e].classList.add("highlight-selected"),parseInt(e)<parseInt(n))var E=parseInt(e),u=parseInt(n);else E=parseInt(n),u=parseInt(e);if(parseInt(t)<parseInt(o))var s=parseInt(t),m=parseInt(o);else s=parseInt(o),m=parseInt(t);for(var T=E;T<=u;T++)for(var M=s;M<=m;M++)if(obj.records[M][T]&&obj.records[M][T].getAttribute("data-merged")){var g=parseInt(obj.records[M][T].getAttribute("data-x")),p=parseInt(obj.records[M][T].getAttribute("data-y")),b=parseInt(obj.records[M][T].getAttribute("colspan")),j=parseInt(obj.records[M][T].getAttribute("rowspan"));b>1&&(g<E&&(E=g),g+b>u&&(u=g+b-1)),j&&(p<s&&(s=p),p+j>m&&(m=p+j-1))}var v=null,C=null,A=null,S=null;for(M=s;M<=m;M++)obj.rows[M].style.display!="none"&&(A==null&&(A=M),S=M);for(T=E;T<=u;T++){for(M=s;M<=m;M++)obj.rows[M].style.display!="none"&&obj.records[M][T].style.display!="none"&&(obj.records[M][T].classList.add("highlight"),obj.highlighted.push(obj.records[M][T]));obj.options.columns[T].type!="hidden"&&(v==null&&(v=T),C=T)}for(v||(v=0),C||(C=0),T=v;T<=C;T++)obj.options.columns[T].type!="hidden"&&obj.colgroup[T].style&&obj.colgroup[T].style.display!="none"&&(obj.records[A]&&obj.records[A][T]&&obj.records[A][T].classList.add("highlight-top"),obj.records[S]&&obj.records[S][T]&&obj.records[S][T].classList.add("highlight-bottom"),obj.headers[T].classList.add("selected"));for(M=A;M<=S;M++)obj.rows[M]&&obj.rows[M].style.display!="none"&&(obj.records[M][v].classList.add("highlight-left"),obj.records[M][C].classList.add("highlight-right"),obj.rows[M].classList.add("selected"));obj.selectedContainer=[v,A,C,S]}d==0&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,v,A,C,S,a),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var e=0;e<obj.selection.length;e++)obj.selection[e].classList.remove("selection"),obj.selection[e].classList.remove("selection-left"),obj.selection[e].classList.remove("selection-right"),obj.selection[e].classList.remove("selection-top"),obj.selection[e].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(e,t){obj.removeCopySelection();var n=obj.selectedContainer[0],o=obj.selectedContainer[1],a=obj.selectedContainer[2],d=obj.selectedContainer[3];if(e!=null&&t!=null){if(e-a>0)var E=parseInt(a)+1,u=parseInt(e);else E=parseInt(e),u=parseInt(n)-1;if(t-d>0)var s=parseInt(d)+1,m=parseInt(t);else s=parseInt(t),m=parseInt(o)-1;u-E<=m-s?(E=parseInt(n),u=parseInt(a)):(s=parseInt(o),m=parseInt(d));for(var T=s;T<=m;T++)for(var M=E;M<=u;M++)obj.records[T][M]&&obj.rows[T].style.display!="none"&&obj.records[T][M].style.display!="none"&&(obj.records[T][M].classList.add("selection"),obj.records[s][M].classList.add("selection-top"),obj.records[m][M].classList.add("selection-bottom"),obj.records[T][E].classList.add("selection-left"),obj.records[T][u].classList.add("selection-right"),obj.selection.push(obj.records[T][M]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var e=obj.highlighted[obj.highlighted.length-1],t=e.getAttribute("data-x"),n=obj.content.getBoundingClientRect(),o=n.left,a=n.top,d=e.getBoundingClientRect(),E=d.left,u=d.top,s=d.width,m=d.height,T=E-o+obj.content.scrollLeft+s-4,M=u-a+obj.content.scrollTop+m-4;if(obj.corner.style.top=M+"px",obj.corner.style.left=T+"px",obj.options.freezeColumns){var g=obj.getFreezeWidth();t>obj.options.freezeColumns-1&&E-o+s<g?obj.corner.style.display="none":obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(e){var t=obj.content.getBoundingClientRect(),n=t.left,o=t.top,a=t.width,d=t.height,E=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),u=E.left,s=E.top,m=E.width,T=E.height;if(e==0||e==1)var M=u-n+obj.content.scrollLeft,g=s-o+obj.content.scrollTop-2;else M=u-n+obj.content.scrollLeft+m,g=s-o+obj.content.scrollTop+T;g>obj.content.scrollTop+30&&g<obj.content.scrollTop+d||(g<obj.content.scrollTop+30?obj.content.scrollTop=g-T:obj.content.scrollTop=g-(d-2));var p=obj.getFreezeWidth();M>obj.content.scrollLeft+p&&M<obj.content.scrollLeft+a||(M<obj.content.scrollLeft+30?(obj.content.scrollLeft=M,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):M<obj.content.scrollLeft+p?obj.content.scrollLeft=M-p-1:obj.content.scrollLeft=M-(a-20))},obj.getWidth=function(e){if(e===void 0)for(var t=[],n=0;n<obj.headers.length;n++)t.push(obj.options.columns[n].width);else typeof e=="object"&&(e=e.getAttribute("data-x")),t=obj.colgroup[e].getAttribute("width");return t},obj.setWidth=function(e,t,n){if(t){if(Array.isArray(e)){n||(n=[]);for(var o=0;o<e.length;o++){n[o]||(n[o]=obj.colgroup[e[o]].getAttribute("width"));var a=Array.isArray(t)&&t[o]?t[o]:t;obj.colgroup[e[o]].setAttribute("width",a),obj.options.columns[e[o]].width=a}}else n||(n=obj.colgroup[e].getAttribute("width")),obj.colgroup[e].setAttribute("width",t),obj.options.columns[e].width=t;obj.setHistory({action:"setWidth",column:e,oldValue:n,newValue:t}),obj.dispatch("onresizecolumn",el,e,t,n),obj.updateCornerPosition()}},obj.setHeight=function(e,t,n){t>0&&(typeof e=="object"&&(e=e.getAttribute("data-y")),n||(n=obj.rows[e].getAttribute("height"))||(n=obj.rows[e].getBoundingClientRect().height),t=parseInt(t),obj.rows[e].style.height=t+"px",obj.options.rows[e]||(obj.options.rows[e]={}),obj.options.rows[e].height=t,obj.setHistory({action:"setHeight",row:e,oldValue:n,newValue:t}),obj.dispatch("onresizerow",el,e,t,n),obj.updateCornerPosition())},obj.getHeight=function(e){if(e===void 0)for(var t=[],n=0;n<obj.rows.length;n++){var o=obj.rows[n].style.height;o&&(t[n]=o)}else typeof e=="object"&&(e=$(e).getAttribute("data-y")),t=obj.rows[e].style.height;return t},obj.setFooter=function(e){if(e&&(obj.options.footers=e),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var t=0;t<obj.options.footers.length;t++){if(obj.tfoot.children[t])var n=obj.tfoot.children[t];else{n=document.createElement("tr");var o=document.createElement("td");n.appendChild(o),obj.tfoot.appendChild(n)}for(var a=0;a<obj.headers.length;a++){if(obj.options.footers[t][a]||(obj.options.footers[t][a]=""),obj.tfoot.children[t].children[a+1])o=obj.tfoot.children[t].children[a+1];else{o=document.createElement("td"),n.appendChild(o);var d=obj.options.columns[a].align?obj.options.columns[a].align:"center";o.style.textAlign=d}o.textContent=obj.parseValue(+obj.records.length+a,t,obj.options.footers[t][a]),o.style.display=obj.colgroup[a].style.display}}}},obj.getHeader=function(e){return obj.headers[e].textContent},obj.setHeader=function(e,t){if(obj.headers[e]){var n=obj.headers[e].textContent;t||(t=prompt(obj.options.text.columnName,n)),t&&(obj.headers[e].textContent=t,obj.headers[e].setAttribute("title",t),obj.options.columns[e].title=t),obj.setHistory({action:"setHeader",column:e,oldValue:n,newValue:t}),obj.dispatch("onchangeheader",el,e,n,t)}},obj.getHeaders=function(e){for(var t=[],n=0;n<obj.headers.length;n++)t.push(obj.getHeader(n));return e?t:t.join(obj.options.csvDelimiter)},obj.getMeta=function(e,t){return e?t?obj.options.meta[e]&&obj.options.meta[e][t]?obj.options.meta[e][t]:null:obj.options.meta[e]?obj.options.meta[e]:null:obj.options.meta},obj.setMeta=function(e,t,n){if(obj.options.meta||(obj.options.meta={}),t&&n)obj.options.meta[e]||(obj.options.meta[e]={}),obj.options.meta[e][t]=n;else for(var o=Object.keys(e),a=0;a<o.length;a++){obj.options.meta[o[a]]||(obj.options.meta[o[a]]={});for(var d=Object.keys(e[o[a]]),E=0;E<d.length;E++)obj.options.meta[o[a]][d[E]]=e[o[a]][d[E]]}obj.dispatch("onchangemeta",el,e,t,n)},obj.updateMeta=function(e){if(obj.options.meta){for(var t={},n=Object.keys(obj.options.meta),o=0;o<n.length;o++)e[n[o]]?t[e[n[o]]]=obj.options.meta[n[o]]:t[n[o]]=obj.options.meta[n[o]];obj.options.meta=t}},obj.getStyle=function(e,t){if(e)return e=jexcel.getIdFromColumnName(e,!0),t?obj.records[e[1]][e[0]].style[t]:obj.records[e[1]][e[0]].getAttribute("style");for(var n={},o=obj.options.data[0].length,a=obj.options.data.length,d=0;d<a;d++)for(var E=0;E<o;E++){var u=t?obj.records[d][E].style[t]:obj.records[d][E].getAttribute("style");u&&(n[jexcel.getColumnNameFromId([E,d])]=u)}return n},obj.resetStyle=function(e,t){for(var n=Object.keys(e),o=0;o<n.length;o++){var a=jexcel.getIdFromColumnName(n[o],!0);obj.records[a[1]]&&obj.records[a[1]][a[0]]&&obj.records[a[1]][a[0]].setAttribute("style","")}obj.setStyle(e,null,null,null,t)},obj.setStyle=function(e,t,n,o,a){var d={},E={},u=function(v,C,A){var S=jexcel.getIdFromColumnName(v,!0);if(obj.records[S[1]]&&obj.records[S[1]][S[0]]&&(obj.records[S[1]][S[0]].classList.contains("readonly")==0||o)){var D=obj.records[S[1]][S[0]].style[C];D!=A||o?obj.records[S[1]][S[0]].style[C]=A:(A="",obj.records[S[1]][S[0]].style[C]=""),E[v]||(E[v]=[]),d[v]||(d[v]=[]),E[v].push([C+":"+D]),d[v].push([C+":"+A])}};if(t&&n)if(typeof e=="string")u(e,t,n);else for(var s=[],m=0;m<e.length;m++){var T=e[m].getAttribute("data-x"),M=e[m].getAttribute("data-y"),g=jexcel.getColumnNameFromId([T,M]);s[g]||(u(g,t,n),s[g]=!0)}else{var p=Object.keys(e);for(m=0;m<p.length;m++){var b=e[p[m]];typeof b=="string"&&(b=b.split(";"));for(var j=0;j<b.length;j++)typeof b[j]=="string"&&(b[j]=b[j].split(":")),b[j][0].trim()&&u(p[m],b[j][0].trim(),b[j][1])}}for(p=Object.keys(E),m=0;m<p.length;m++)E[p[m]]=E[p[m]].join(";");for(p=Object.keys(d),m=0;m<p.length;m++)d[p[m]]=d[p[m]].join(";");a||obj.setHistory({action:"setStyle",oldValue:E,newValue:d}),obj.dispatch("onchangestyle",el,e,t,n)},obj.getComments=function(e,t){if(e)return typeof e=="string"&&(e=jexcel.getIdFromColumnName(e,!0)),t?[obj.records[e[1]][e[0]].getAttribute("title"),obj.records[e[1]][e[0]].getAttribute("author")]:obj.records[e[1]][e[0]].getAttribute("title")||"";for(var n={},o=0;o<obj.options.data.length;o++)for(var a=0;a<obj.options.columns.length;a++){var d=obj.records[o][a].getAttribute("title");d&&(n[e=jexcel.getColumnNameFromId([a,o])]=d)}return n},obj.setComments=function(e,t,n){if(typeof e=="string")var o=jexcel.getIdFromColumnName(e,!0);else o=e;var a=obj.records[o[1]][o[0]].getAttribute("title"),d=[a,n=obj.records[o[1]][o[0]].getAttribute("data-author")];obj.records[o[1]][o[0]].setAttribute("title",t||""),obj.records[o[1]][o[0]].setAttribute("data-author",n||""),t?obj.records[o[1]][o[0]].classList.add("jexcel_comments"):obj.records[o[1]][o[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:e,newValue:[t,n],oldValue:d}),obj.dispatch("oncomments",el,t,a,o,o[0],o[1])},obj.getConfig=function(){var e=obj.options;return e.style=obj.getStyle(),e.mergeCells=obj.getMerge(),e.comments=obj.getComments(),e},obj.orderBy=function(e,t){if(e>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}t=t==null?obj.headers[e].classList.contains("arrow-down")?1:0:t?1:0;var n=[];if(obj.options.columns[e].type=="number"||obj.options.columns[e].type=="numeric"||obj.options.columns[e].type=="percentage"||obj.options.columns[e].type=="autonumber"||obj.options.columns[e].type=="color")for(var o=0;o<obj.options.data.length;o++)n[o]=[o,Number(obj.options.data[o][e])];else if(obj.options.columns[e].type=="calendar"||obj.options.columns[e].type=="checkbox"||obj.options.columns[e].type=="radio")for(o=0;o<obj.options.data.length;o++)n[o]=[o,obj.options.data[o][e]];else for(o=0;o<obj.options.data.length;o++)n[o]=[o,obj.records[o][e].textContent.toLowerCase()];typeof obj.options.sorting!="function"&&(obj.options.sorting=function(d){return function(E,u){var s=E[1],m=u[1];return d?s===""&&m!==""?1:s!==""&&m===""||s>m?-1:s<m?1:0:s===""&&m!==""?1:s!==""&&m===""?-1:s>m?1:s<m?-1:0}}),n=n.sort(obj.options.sorting(t));var a=[];for(o=0;o<n.length;o++)a[o]=n[o][0];return obj.setHistory({action:"orderBy",rows:a,column:e,order:t}),obj.updateOrderArrow(e,t),obj.updateOrder(a),obj.dispatch("onsort",el,e,t),!0}},obj.updateOrderArrow=function(e,t){for(var n=0;n<obj.headers.length;n++)obj.headers[n].classList.remove("arrow-up"),obj.headers[n].classList.remove("arrow-down");t?obj.headers[e].classList.add("arrow-up"):obj.headers[e].classList.add("arrow-down")},obj.updateOrder=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=obj.options.data[e[n]];for(obj.options.data=t,t=[],n=0;n<e.length;n++)t[n]=obj.records[e[n]];for(obj.records=t,t=[],n=0;n<e.length;n++)t[n]=obj.rows[e[n]];if(obj.rows=t,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(obj.options.lazyLoading==1)obj.loadPage(0);else for(n=0;n<obj.rows.length;n++)obj.tbody.appendChild(obj.rows[n])},obj.moveRow=function(e,t,n){if(Object.keys(obj.options.mergeCells).length>0){if(e>t)var o=1;else o=0;if(obj.isRowMerged(e).length||obj.isRowMerged(t,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}n||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])>=0?e>t?obj.tbody.insertBefore(obj.rows[e],obj.rows[t]):obj.tbody.insertBefore(obj.rows[e],obj.rows[t].nextSibling):obj.tbody.removeChild(obj.rows[e])),obj.rows.splice(t,0,obj.rows.splice(e,1)[0]),obj.records.splice(t,0,obj.records.splice(e,1)[0]),obj.options.data.splice(t,0,obj.options.data.splice(e,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,e,t)},obj.insertRow=function(e,t,n){if(obj.options.allowInsertRow==1){var o=[];if(e>0)var a=e;else a=1,e&&(o=e);n=!!n;var d=obj.options.data.length-1;if((t==null||t>=parseInt(d)||t<0)&&(t=d),obj.dispatch("onbeforeinsertrow",el,t,a,n)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var E=n?t:t+1,u=obj.records.splice(E),s=obj.options.data.splice(E),m=obj.rows.splice(E),T=[],M=[],g=[],p=E;p<a+E;p++){obj.options.data[p]=[];for(var b=0;b<obj.options.columns.length;b++)obj.options.data[p][b]=o[b]?o[b]:"";var j=obj.createRow(p,obj.options.data[p]);m[0]?Array.prototype.indexOf.call(obj.tbody.children,m[0])>=0&&obj.tbody.insertBefore(j,m[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])>=0&&obj.tbody.appendChild(j),T.push(obj.records[p]),M.push(obj.options.data[p]),g.push(j)}Array.prototype.push.apply(obj.records,u),Array.prototype.push.apply(obj.options.data,s),Array.prototype.push.apply(obj.rows,m),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:t,numOfRows:a,insertBefore:n,rowRecords:T,rowData:M,rowNode:g}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,t,a,T,n)}},obj.deleteRow=function(e,t){if(obj.options.allowDeleteRow==1)if(obj.options.allowDeletingAllRows==1||obj.options.data.length>1){if(e==null){var n=obj.getSelectedRows();n[0]?(e=parseInt(n[0].getAttribute("data-y")),t=n.length):(e=obj.options.data.length-1,t=1)}var o=obj.options.data.length-1;if((e==null||e>o||e<0)&&(e=o),t||(t=1),e+t>=obj.options.data.length&&(t=obj.options.data.length-e),obj.dispatch("onbeforedeleterow",el,e,t)===!1)return!1;if(parseInt(e)>-1){var a=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var d=e;d<e+t;d++)obj.isRowMerged(d,!1).length&&(a=!0);if(a){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(obj.options.allowDeletingAllRows==0&&o+1===t&&(t--,console.error("Jspreadsheet: It is not possible to delete the last row")),d=e;d<e+t;d++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[d])>=0&&(obj.rows[d].className="",obj.rows[d].parentNode.removeChild(obj.rows[d]));var E=obj.records.splice(e,t),u=obj.options.data.splice(e,t),s=obj.rows.splice(e,t);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,e,e+t-1),obj.setHistory({action:"deleteRow",rowNumber:e,numOfRows:t,insertBefore:1,rowRecords:E,rowData:u,rowNode:s}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,e,t,E)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(e,t){if(Object.keys(obj.options.mergeCells).length>0){if(e>t)var n=1;else n=0;if(obj.isColMerged(e).length||obj.isColMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((e=parseInt(e))>(t=parseInt(t))){obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t]),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t]);for(var o=0;o<obj.rows.length;o++)obj.rows[o].insertBefore(obj.records[o][e],obj.records[o][t])}else for(obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t].nextSibling),o=0;o<obj.rows.length;o++)obj.rows[o].insertBefore(obj.records[o][e],obj.records[o][t].nextSibling);for(obj.options.columns.splice(t,0,obj.options.columns.splice(e,1)[0]),obj.headers.splice(t,0,obj.headers.splice(e,1)[0]),obj.colgroup.splice(t,0,obj.colgroup.splice(e,1)[0]),o=0;o<obj.rows.length;o++)obj.options.data[o].splice(t,0,obj.options.data[o].splice(e,1)[0]),obj.records[o].splice(t,0,obj.records[o].splice(e,1)[0]);if(obj.options.footers)for(o=0;o<obj.options.footers.length;o++)obj.options.footers[o].splice(t,0,obj.options.footers[o].splice(e,1)[0]);obj.setHistory({action:"moveColumn",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,e,t)},obj.insertColumn=function(e,t,n,o){if(obj.options.allowInsertColumn==1){var a=[];if(e>0)var d=e;else d=1,e&&(a=e);n=!!n;var E=obj.options.columns.length-1;if((t==null||t>=parseInt(E)||t<0)&&(t=E),obj.dispatch("onbeforeinsertcolumn",el,t,d,n)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}o||(o=[]);for(var u=0;u<d;u++)o[u]||(o[u]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var s=n?t:t+1;obj.options.columns=jexcel.injectArray(obj.options.columns,s,o);for(var m=obj.headers.splice(s),T=obj.colgroup.splice(s),M=[],g=[],p=[],b=[],j=[],v=s;v<d+s;v++)obj.createCellHeader(v),obj.headerContainer.insertBefore(obj.headers[v],obj.headerContainer.children[v+1]),obj.colgroupContainer.insertBefore(obj.colgroup[v],obj.colgroupContainer.children[v+1]),M.push(obj.headers[v]),g.push(obj.colgroup[v]);if(obj.options.footers)for(var C=0;C<obj.options.footers.length;C++){for(j[C]=[],u=0;u<d;u++)j[C].push("");obj.options.footers[C].splice(s,0,j[C])}for(var A=0;A<obj.options.data.length;A++){var S=obj.options.data[A].splice(s),D=obj.records[A].splice(s);for(b[A]=[],p[A]=[],v=s;v<d+s;v++){var F=a[A]?a[A]:"";obj.options.data[A][v]=F;var N=obj.createCell(v,A,obj.options.data[A][v]);obj.records[A][v]=N,obj.rows[A]&&obj.rows[A].insertBefore(N,obj.rows[A].children[v+1]),b[A].push(F),p[A].push(N)}Array.prototype.push.apply(obj.options.data[A],S),Array.prototype.push.apply(obj.records[A],D)}if(Array.prototype.push.apply(obj.headers,m),Array.prototype.push.apply(obj.colgroup,T),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(C=0;C<obj.options.nestedHeaders.length;C++){var _=parseInt(obj.options.nestedHeaders[C][obj.options.nestedHeaders[C].length-1].colspan)+d;obj.options.nestedHeaders[C][obj.options.nestedHeaders[C].length-1].colspan=_,obj.thead.children[C].children[obj.thead.children[C].children.length-1].setAttribute("colspan",_);var G=obj.thead.children[C].children[obj.thead.children[C].children.length-1].getAttribute("data-column");for(G=G.split(","),v=s;v<d+s;v++)G.push(v);obj.thead.children[C].children[obj.thead.children[C].children.length-1].setAttribute("data-column",G)}else _=parseInt(obj.options.nestedHeaders[0].colspan)+d,obj.options.nestedHeaders[0].colspan=_,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",_);obj.setHistory({action:"insertColumn",columnNumber:t,numOfColumns:d,insertBefore:n,columns:o,headers:M,colgroup:g,records:p,footers:j,data:b}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,t,d,p,n)}},obj.deleteColumn=function(e,t){if(obj.options.allowDeleteColumn==1)if(obj.headers.length>1){if(e==null){var n=obj.getSelectedColumns(!0);n.length?(e=parseInt(n[0]),t=parseInt(n.length)):(e=obj.headers.length-1,t=1)}var o=obj.options.data[0].length-1;if((e==null||e>o||e<0)&&(e=o),t||(t=1),t>obj.options.data[0].length-e&&(t=obj.options.data[0].length-e),obj.dispatch("onbeforedeletecolumn",el,e,t)===!1)return!1;if(parseInt(e)>-1){var a=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var d=e;d<e+t;d++)obj.isColMerged(d,!1).length&&(a=!0);if(a){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var E=obj.options.columns.splice(e,t);for(d=e;d<e+t;d++)obj.colgroup[d].className="",obj.headers[d].className="",obj.colgroup[d].parentNode.removeChild(obj.colgroup[d]),obj.headers[d].parentNode.removeChild(obj.headers[d]);for(var u=obj.headers.splice(e,t),s=obj.colgroup.splice(e,t),m=[],T=[],M=[],g=0;g<obj.options.data.length;g++)for(d=e;d<e+t;d++)obj.records[g][d].className="",obj.records[g][d].parentNode.removeChild(obj.records[g][d]);for(g=0;g<obj.options.data.length;g++)T[g]=obj.options.data[g].splice(e,t),m[g]=obj.records[g].splice(e,t);if(obj.options.footers)for(g=0;g<obj.options.footers.length;g++)M[g]=obj.options.footers[g].splice(e,t);if(obj.conditionalSelectionUpdate(0,e,e+t-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var p=0;p<obj.options.nestedHeaders.length;p++){var b=parseInt(obj.options.nestedHeaders[p][obj.options.nestedHeaders[p].length-1].colspan)-t;obj.options.nestedHeaders[p][obj.options.nestedHeaders[p].length-1].colspan=b,obj.thead.children[p].children[obj.thead.children[p].children.length-1].setAttribute("colspan",b)}else b=parseInt(obj.options.nestedHeaders[0].colspan)-t,obj.options.nestedHeaders[0].colspan=b,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",b);obj.setHistory({action:"deleteColumn",columnNumber:e,numOfColumns:t,insertBefore:1,columns:E,headers:u,colgroup:s,records:m,footers:M,data:T}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,e,t,m)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(e){for(var t=[],n=0;n<obj.rows.length;n++)obj.rows[n].classList.contains("selected")&&(e?t.push(n):t.push(obj.rows[n]));return t},obj.getSelectedColumns=function(){for(var e=[],t=0;t<obj.headers.length;t++)obj.headers[t].classList.contains("selected")&&e.push(t);return e},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var e=0;e<obj.headers.length;e++)(d=obj.headers[e].getAttribute("data-x"))!=e&&(obj.headers[e].setAttribute("data-x",e),obj.headers[e].getAttribute("title")||(obj.headers[e].innerHTML=jexcel.getColumnName(e)));for(var t=0;t<obj.rows.length;t++)obj.rows[t]&&(E=obj.rows[t].getAttribute("data-y"))!=t&&(obj.rows[t].setAttribute("data-y",t),obj.rows[t].children[0].setAttribute("data-y",t),obj.rows[t].children[0].innerHTML=t+1);var n=[],o=[],a=function(p,b,j,v){if(p!=j&&obj.records[v][j].setAttribute("data-x",j),b!=v&&obj.records[v][j].setAttribute("data-y",v),p!=j||b!=v){var C=jexcel.getColumnNameFromId([p,b]),A=jexcel.getColumnNameFromId([j,v]);n[C]=A}};for(t=0;t<obj.records.length;t++)for(e=0;e<obj.records[0].length;e++)if(obj.records[t][e]){var d=obj.records[t][e].getAttribute("data-x"),E=obj.records[t][e].getAttribute("data-y");if(obj.records[t][e].getAttribute("data-merged")){var u=jexcel.getColumnNameFromId([d,E]),s=jexcel.getColumnNameFromId([e,t]);if(o[u]==null)if(u==s)o[u]=!1;else{var m=parseInt(e-d),T=parseInt(t-E);o[u]=[s,m,T]}}else a(d,E,e,t)}var M=Object.keys(o);if(M.length){for(e=0;e<M.length;e++)if(o[M[e]]){var g=jexcel.getIdFromColumnName(M[e],!0);for(a(d=g[0],E=g[1],d+o[M[e]][1],E+o[M[e]][2]),u=M[e],s=o[M[e]][0],t=0;t<obj.options.mergeCells[u][2].length;t++)d=parseInt(obj.options.mergeCells[u][2][t].getAttribute("data-x")),E=parseInt(obj.options.mergeCells[u][2][t].getAttribute("data-y")),obj.options.mergeCells[u][2][t].setAttribute("data-x",d+o[M[e]][1]),obj.options.mergeCells[u][2][t].setAttribute("data-y",E+o[M[e]][2]);obj.options.mergeCells[s]=obj.options.mergeCells[u],delete obj.options.mergeCells[u]}}obj.updateFormulas(n),obj.updateMeta(n),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var e=0,t=obj.rows.length-1;t>=0;t--){for(var n=!1,o=0;o<obj.headers.length;o++)obj.options.data[t][o]&&(n=!0);if(n)break;e++}obj.options.minSpareRows-e>0&&obj.insertRow(obj.options.minSpareRows-e)}if(obj.options.minSpareCols>0){var a=0;for(o=obj.headers.length-1;o>=0;o--){for(n=!1,t=0;t<obj.rows.length;t++)obj.options.data[t][o]&&(n=!0);if(n)break;a++}obj.options.minSpareCols-a>0&&obj.insertColumn(obj.options.minSpareCols-a)}if(typeof obj.options.updateTable=="function"){for(obj.options.detachForUpdates&&el.removeChild(obj.content),t=0;t<obj.rows.length;t++)for(o=0;o<obj.headers.length;o++)obj.options.updateTable(el,obj.records[t][o],o,t,obj.options.data[t][o],obj.records[t][o].textContent,jexcel.getColumnNameFromId([o,t]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(e){if(e=obj.getCell(e))return!!e.classList.contains("readonly")},obj.setReadOnly=function(e,t){(e=obj.getCell(e))&&(t?e.classList.add("readonly"):e.classList.remove("readonly"))},obj.showRow=function(e){obj.rows[e].style.display=""},obj.hideRow=function(e){obj.rows[e].style.display="none"},obj.showColumn=function(e){obj.headers[e].style.display="",obj.colgroup[e].style.display="",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="");for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(e){obj.headers[e].style.display="none",obj.colgroup[e].style.display="none",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="none");for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(e,t,n){var o=jexcel.getColumnNameFromId([e,t]);if(obj.formula[o]&&obj.formula[o].length>0)if(chainLoopProtection[o])obj.records[t][e].innerHTML="#ERROR",obj.formula[o]="";else{chainLoopProtection[o]=!0;for(var a=0;a<obj.formula[o].length;a++){var d=jexcel.getIdFromColumnName(obj.formula[o][a],!0),E=""+obj.options.data[d[1]][d[0]];E.substr(0,1)=="="?n.push(obj.updateCell(d[0],d[1],E,!0)):Object.keys(obj.formula)[a]=null,obj.updateFormulaChain(d[0],d[1],n)}}chainLoopProtection=[]},obj.updateFormulas=function(e){for(var t=0;t<obj.options.data.length;t++)for(var n=0;n<obj.options.data[0].length;n++)if((u=""+obj.options.data[t][n]).substr(0,1)=="="){var o=obj.updateFormula(u,e);o!=u&&(obj.options.data[t][n]=o)}var a=[],d=Object.keys(obj.formula);for(t=0;t<d.length;t++){var E=d[t],u=obj.formula[E];for(e[E]&&(E=e[E]),a[E]=[],n=0;n<u.length;n++){var s=u[n];e[s]&&(s=e[s]),a[E].push(s)}}obj.formula=a},obj.updateFormula=function(e,t){for(var n=/[A-Z]/,o=/[0-9]/,a="",d=null,E=null,u="",s=0;s<e.length;s++)n.exec(e[s])?(d=1,E=0,u+=e[s]):o.exec(e[s])?(E=d?1:0,u+=e[s]):(d&&E&&(u=t[u]?t[u]:u),a+=u,a+=e[s],d=0,E=0,u="");return u&&(d&&E&&(u=t[u]?t[u]:u),a+=u),a};var secureFormula=function(e){for(var t="",n=0,o=0;o<e.length;o++)e[o]=='"'&&(n=n==0?1:0),t+=n==1?e[o]:e[o].toUpperCase();return t};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(e){for(var t=0;t<e.length;t++){var n=[],o=e[t].split(":"),a=jexcel.getIdFromColumnName(o[0],!0),d=jexcel.getIdFromColumnName(o[1],!0);if(a[0]<=d[0])var E=a[0],u=d[0];else E=d[0],u=a[0];if(a[1]<=d[1])var s=a[1],m=d[1];else s=d[1],m=a[1];for(var T=s;T<=m;T++)for(var M=E;M<=u;M++)n.push(jexcel.getColumnNameFromId([M,T]));expression=expression.replace(e[t],n.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens){for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(obj.options.data[position[1]]!==void 0&&obj.options.data[position[1]][position[0]]!==void 0)var value=obj.options.data[position[1]][position[0]];else var value="";if((""+value).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),(""+value).trim()=="")formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&obj.options.autoCasting==1)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);obj.options.autoCasting==1&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(e){var res="#ERROR";console.log(e)}return res};return execute(expression,x,y)},obj.parseNumber=function(e,t){var n=t&&obj.options.columns[t].decimal?obj.options.columns[t].decimal:".",o=""+e;return(o=o.split(n))[0]=o[0].match(/[+-]?[0-9]/g),o[0]&&(o[0]=o[0].join("")),o[1]&&(o[1]=o[1].match(/[0-9]*/g).join("")),o[0]&&Number.isInteger(Number(o[0]))?o[1]?e=+(o[0]+"."+o[1]):e=+(o[0]+".00"):e=null,e},obj.row=function(e){},obj.col=function(e){},obj.up=function(e,t){if(e?obj.selectedCell[3]>0&&obj.up.visible(1,t?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)if(obj.selectedCell[1]==0||obj.selectedCell[3]==0)obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-n<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var o=obj.whichPage(obj.selectedCell[3]);o!=obj.pageNumber&&obj.page(o)}obj.updateScroll(1)},obj.up.visible=function(e,t){if(e==0)var n=parseInt(obj.selectedCell[0]),o=parseInt(obj.selectedCell[1]);else n=parseInt(obj.selectedCell[2]),o=parseInt(obj.selectedCell[3]);if(t==0){for(var a=0;a<o;a++)if(obj.records[a][n].style.display!="none"&&obj.rows[a].style.display!="none"){o=a;break}}else o=obj.up.get(n,o);e==0?(obj.selectedCell[0]=n,obj.selectedCell[1]=o):(obj.selectedCell[2]=n,obj.selectedCell[3]=o)},obj.up.get=function(e,t){e=parseInt(e);for(var n=(t=parseInt(t))-1;n>=0;n--)if(obj.records[n][e].style.display!="none"&&obj.rows[n].style.display!="none"){if(obj.records[n][e].getAttribute("data-merged")&&obj.records[n][e]==obj.records[t][e])continue;t=n;break}return t},obj.down=function(e,t){if(e?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,t?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var n=obj.whichPage(obj.selectedCell[3]);n!=obj.pageNumber&&obj.page(n)}obj.updateScroll(3)},obj.down.visible=function(e,t){if(e==0)var n=parseInt(obj.selectedCell[0]),o=parseInt(obj.selectedCell[1]);else n=parseInt(obj.selectedCell[2]),o=parseInt(obj.selectedCell[3]);if(t==0){for(var a=obj.rows.length-1;a>o;a--)if(obj.records[a][n].style.display!="none"&&obj.rows[a].style.display!="none"){o=a;break}}else o=obj.down.get(n,o);e==0?(obj.selectedCell[0]=n,obj.selectedCell[1]=o):(obj.selectedCell[2]=n,obj.selectedCell[3]=o)},obj.down.get=function(e,t){e=parseInt(e);for(var n=(t=parseInt(t))+1;n<obj.rows.length;n++)if(obj.records[n][e].style.display!="none"&&obj.rows[n].style.display!="none"){if(obj.records[n][e].getAttribute("data-merged")&&obj.records[n][e]==obj.records[t][e])continue;t=n;break}return t},obj.right=function(e,t){e?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,t?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(e,t){if(e==0)var n=parseInt(obj.selectedCell[0]),o=parseInt(obj.selectedCell[1]);else n=parseInt(obj.selectedCell[2]),o=parseInt(obj.selectedCell[3]);if(t==0){for(var a=obj.headers.length-1;a>n;a--)if(obj.records[o][a].style.display!="none"){n=a;break}}else n=obj.right.get(n,o);e==0?(obj.selectedCell[0]=n,obj.selectedCell[1]=o):(obj.selectedCell[2]=n,obj.selectedCell[3]=o)},obj.right.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var n=e+1;n<obj.headers.length;n++)if(obj.records[t][n].style.display!="none"){if(obj.records[t][n].getAttribute("data-merged")&&obj.records[t][n]==obj.records[t][e])continue;e=n;break}return e},obj.left=function(e,t){e?obj.selectedCell[2]>0&&obj.left.visible(1,t?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(e,t){if(e==0)var n=parseInt(obj.selectedCell[0]),o=parseInt(obj.selectedCell[1]);else n=parseInt(obj.selectedCell[2]),o=parseInt(obj.selectedCell[3]);if(t==0){for(var a=0;a<n;a++)if(obj.records[o][a].style.display!="none"){n=a;break}}else n=obj.left.get(n,o);e==0?(obj.selectedCell[0]=n,obj.selectedCell[1]=o):(obj.selectedCell[2]=n,obj.selectedCell[3]=o)},obj.left.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var n=e-1;n>=0;n--)if(obj.records[t][n].style.display!="none"){if(obj.records[t][n].getAttribute("data-merged")&&obj.records[t][n]==obj.records[t][e])continue;e=n;break}return e},obj.first=function(e,t){if(e?t?obj.selectedCell[3]=0:obj.left.visible(1,0):(t?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=0&&obj.selectedCell[3]!=0){if(obj.options.pagination>0){var n=obj.whichPage(obj.selectedCell[3]);n!=obj.pageNumber&&obj.page(n)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(e,t){if(e?t?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(t?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var n=obj.whichPage(obj.selectedCell[3]);n!=obj.pageNumber&&obj.page(n)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(e){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)t=obj.rows;else var t=obj.results;var n=100;e!=null&&e!=-1||(e=Math.ceil(t.length/n)-1);var o=e*n,a=e*n+n;a>t.length&&(a=t.length),(o=a-100)<0&&(o=0);for(var d=o;d<a;d++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[d]):obj.tbody.appendChild(obj.rows[t[d]]),obj.tbody.children.length>n&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)e=obj.rows;else var e=obj.results;var t=0;if(e.length>100){var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(n=e.indexOf(n)),n>0)for(var o=0;o<30;o++)(n-=1)>-1&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.insertBefore(obj.rows[n],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[e[n]],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),t=1))}return t},obj.loadDown=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)e=obj.rows;else var e=obj.results;var t=0;if(e.length>100){var n=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(n=e.indexOf(n)),n<obj.rows.length-1)for(var o=0;o<=30;o++)n<e.length&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[n]):obj.tbody.appendChild(obj.rows[e[n]]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),t=1)),n+=1}return t},obj.loadValidation=function(){if(obj.selectedCell){var e=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,t=parseInt(obj.selectedCell[3]/100),n=parseInt(obj.rows.length/100);if(e!=t&&t<=n&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(t),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(e){if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],e){var t=function(o){obj.results.indexOf(o)==-1&&obj.results.push(o)},n=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");n=new RegExp(n,"i"),obj.options.data.forEach(function(o,a){if(function(m,T,M){for(var g=0;g<m.length;g++)if((""+m[g]).toLowerCase().search(T)>=0||(""+obj.records[M][g].innerHTML).toLowerCase().search(T)>=0)return!0;return!1}(o,n,a)){var d=obj.isRowMerged(a);if(d.length)for(var E=0;E<d.length;E++)for(var u=jexcel.getIdFromColumnName(d[E],!0),s=0;s<obj.options.mergeCells[d[E]][1];s++)t(u[1]+s);else t(a)}})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var e,t=0;for(e=obj.options.lazyLoading==1?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var n=0;n<obj.rows.length;n++)!obj.results||obj.results.indexOf(n)>-1?(t<e&&(obj.tbody.appendChild(obj.rows[n]),t++),obj.rows[n].style.display=""):obj.rows[n].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),e},obj.whichPage=function(e){return obj.options.search!=1&&obj.options.filters!=1||!obj.results||(e=obj.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(obj.options.pagination))-1},obj.page=function(e){var t=obj.pageNumber;if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var o=parseInt(obj.options.pagination);e!=null&&e!=-1||(e=Math.ceil(n.length/o)-1),obj.pageNumber=e;var a=e*o,d=e*o+o;for(d>n.length&&(d=n.length),a<0&&(a=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var E=a;E<d;E++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[E]):obj.tbody.appendChild(obj.rows[n[E]]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,e,t)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)e=obj.rows.length;else var e=obj.results.length;if(e){var t=Math.ceil(e/obj.options.pagination);if(obj.pageNumber<6)var n=1,o=t<10?t:10;else t-obj.pageNumber<5?(o=t,(n=t-9)<1&&(n=1)):(n=obj.pageNumber-4,o=obj.pageNumber+5);n>1&&((d=document.createElement("div")).className="jexcel_page",d.innerHTML="<",d.title=1,obj.pagination.children[1].appendChild(d));for(var a=n;a<=o;a++){var d;(d=document.createElement("div")).className="jexcel_page",d.innerHTML=a,obj.pagination.children[1].appendChild(d),obj.pageNumber==a-1&&d.classList.add("jexcel_page_selected")}o<t&&((d=document.createElement("div")).className="jexcel_page",d.innerHTML=">",d.title=t,obj.pagination.children[1].appendChild(d)),obj.pagination.children[0].innerHTML=function(E){var u=Array.prototype.slice.call(arguments,1);return E.replace(/{(\d+)}/g,function(s,m){return u[m]!==void 0?u[m]:s})}(obj.options.text.showingPage,obj.pageNumber+1,t)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(e){if(obj.options.allowExport==0)console.error("Export not allowed");else{var t="";t+=obj.copy(!1,obj.options.csvDelimiter,!0,e,!0);var n=new Blob(["\uFEFF"+t],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,obj.options.csvFileName+".csv");else{var o=document.createElement("a"),a=URL.createObjectURL(n);o.href=a,o.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(o),o.click(),o.parentNode.removeChild(o)}}},obj.setHistory=function(e){if(obj.ignoreHistory!=1){var t=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,t+1),obj.history[t]=e}},obj.copy=function(e,t,n,o,a){t||(t="	");for(var d=new RegExp(t,"ig"),E=[],u=[],s=[],m=[],T=[],M=obj.options.data[0].length,g=obj.options.data.length,p="",b=!1,j="",v="",C=0,A=0,S=0,D=0,F=!0,N=0;N<g;N++)for(var _=0;_<M;_++)e&&!obj.records[N][_].classList.contains("highlight")||(S<=_&&(S=_),D<=N&&(D=N));if(M===S+1&&g===D+1&&(F=!1),a&&obj.options.includeHeadersOnDownload==1||!a&&obj.options.includeHeadersOnCopy==1&&!F||o){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)for(p=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],N=0;N<p.length;N++){var G=[];for(_=0;_<p[N].length;_++){var U=parseInt(p[N][_].colspan);G.push(p[N][_].title);for(var re=0;re<U-1;re++)G.push("")}v+=G.join(t)+`\r
`}b=!0}for(obj.style=[],N=0;N<g;N++){for(u=[],s=[],_=0;_<M;_++)if(!e||obj.records[N][_].classList.contains("highlight")){b==1&&E.push(obj.headers[_].textContent);var fe=obj.options.data[N][_];if(fe.match&&(fe.match(d)||fe.match(/,/g)||fe.match(/\n/)||fe.match(/\"/))&&(fe='"'+(fe=fe.replace(new RegExp('"',"g"),'""'))+'"'),u.push(fe),obj.options.columns[_].type=="checkbox"||obj.options.columns[_].type=="radio")var ae=fe;else(ae=obj.options.stripHTMLOnCopy==1?obj.records[N][_].textContent:obj.records[N][_].innerHTML).match&&(ae.match(d)||ae.match(/,/g)||ae.match(/\n/)||ae.match(/\"/))&&(ae='"'+(ae=ae.replace(new RegExp('"',"g"),'""'))+'"');s.push(ae),p=(p=obj.records[N][_].getAttribute("style")).replace("display: none;",""),obj.style.push(p||"")}u.length&&(b&&(C=u.length,m.push(E.join(t))),m.push(u.join(t))),s.length&&(A++,b&&(T.push(E.join(t)),b=!1),T.push(s.join(t)))}M==C&&g==A&&(j=v);var ye=j+m.join(`\r
`),Ne=j+T.join(`\r
`);if(n||(obj.options.copyCompatibility==1?obj.textarea.value=Ne:obj.textarea.value=ye,obj.textarea.select(),document.execCommand("copy")),obj.options.copyCompatibility==1?obj.data=Ne:obj.data=ye,obj.hashString=obj.hash(obj.data),!n){if(obj.removeCopyingSelection(),obj.highlighted)for(_=0;_<obj.highlighted.length;_++)obj.highlighted[_].classList.add("copying"),obj.highlighted[_].classList.contains("highlight-left")&&obj.highlighted[_].classList.add("copying-left"),obj.highlighted[_].classList.contains("highlight-right")&&obj.highlighted[_].classList.add("copying-right"),obj.highlighted[_].classList.contains("highlight-top")&&obj.highlighted[_].classList.add("copying-top"),obj.highlighted[_].classList.contains("highlight-bottom")&&obj.highlighted[_].classList.add("copying-bottom");obj.dispatch("oncopy",el,obj.options.copyCompatibility==1?T:m,obj.hashString)}return obj.data},obj.paste=function(e,t,n){var o=parseInt(e),a=parseInt(t),d=parseInt(obj.selectedCell[2]),E=parseInt(obj.selectedCell[3]),u=d-o+1,s=E-a+1;d<o&&(e=d.toString(),u=o-d+1),E<a&&(t=E.toString(),s=a-E+1);var m=obj.dispatch("onbeforepaste",el,n,e,t);if(m===!1)return!1;m&&(n=m);var T=obj.hash(n),M=T==obj.hashString?obj.style:null;if(obj.options.copyCompatibility==1&&T==obj.hashString&&(n=obj.data),n=obj.parseCSV(n,"	"),u>1&Number.isInteger(u/n[0].length)){M=null,p=u/n[0].length;var g=n.map(function(U,re){var fe=Array.apply(null,{length:p*U.length}).map(function(ae,ye){return U[ye%U.length]});return fe});n=g}if(s>1&Number.isInteger(s/n.length)){M=null;var p=s/n.length;g=Array.apply(null,{length:p*n.length}).map(function(U,re){return n[re%n.length]}),n=g}if(e!=null&&t!=null&&n){for(var b=0,j=0,v=[],C={},A={},S=0,D=parseInt(e),F=parseInt(t),N=null;N=n[j];){for(b=0,D=parseInt(e);N[b]!=null;){var _=obj.updateCell(D,F,N[b]);if(v.push(_),obj.updateFormulaChain(D,F,v),M&&M[S]){var G=jexcel.getColumnNameFromId([D,F]);C[G]=M[S],A[G]=obj.getStyle(G),obj.records[F][D].setAttribute("style",M[S]),S++}if(N[++b]!=null){if(D>=obj.headers.length-1){if(obj.options.allowInsertColumn!=1)break;obj.insertColumn()}D=obj.right.get(D,F)}}if(j++,n[j]){if(F>=obj.rows.length-1){if(obj.options.allowInsertRow!=1)break;obj.insertRow()}F=obj.down.get(e,F)}}obj.updateSelectionFromCoords(e,t,D,F),obj.setHistory({action:"setValue",records:v,selection:obj.selectedCell,newStyle:C,oldStyle:A}),obj.updateTable(),obj.dispatch("onpaste",el,n),obj.onafterchanges(el,v)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var e=document.querySelectorAll(".jexcel .copying"),t=0;t<e.length;t++)e[t].classList.remove("copying"),e[t].classList.remove("copying-left"),e[t].classList.remove("copying-right"),e[t].classList.remove("copying-top"),e[t].classList.remove("copying-bottom")},obj.historyProcessRow=function(e,t){var n=t.insertBefore?+t.rowNumber:t.rowNumber+1;if(obj.options.search==1&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),e==1){for(var o=t.numOfRows,a=n;a<o+n;a++)obj.rows[a].parentNode.removeChild(obj.rows[a]);obj.records.splice(n,o),obj.options.data.splice(n,o),obj.rows.splice(n,o),obj.conditionalSelectionUpdate(1,n,o+n-1)}else{obj.records=jexcel.injectArray(obj.records,n,t.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,n,t.rowData),obj.rows=jexcel.injectArray(obj.rows,n,t.rowNode);var d=0;for(a=n;a<t.numOfRows+n;a++)obj.tbody.insertBefore(t.rowNode[d],obj.tbody.children[a]),d++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(e,t){var n=t.insertBefore?t.columnNumber:t.columnNumber+1;if(e==1){var o=t.numOfColumns;obj.options.columns.splice(n,o);for(var a=n;a<o+n;a++)obj.headers[a].parentNode.removeChild(obj.headers[a]),obj.colgroup[a].parentNode.removeChild(obj.colgroup[a]);obj.headers.splice(n,o),obj.colgroup.splice(n,o);for(var d=0;d<t.data.length;d++){for(a=n;a<o+n;a++)obj.records[d][a].parentNode.removeChild(obj.records[d][a]);obj.records[d].splice(n,o),obj.options.data[d].splice(n,o)}if(obj.options.footers)for(d=0;d<obj.options.footers.length;d++)obj.options.footers[d].splice(n,o)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,n,t.columns),obj.headers=jexcel.injectArray(obj.headers,n,t.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,n,t.colgroup);var E=0;for(a=n;a<t.numOfColumns+n;a++)obj.headerContainer.insertBefore(t.headers[E],obj.headerContainer.children[a+1]),obj.colgroupContainer.insertBefore(t.colgroup[E],obj.colgroupContainer.children[a+1]),E++;for(d=0;d<t.data.length;d++)for(obj.options.data[d]=jexcel.injectArray(obj.options.data[d],n,t.data[d]),obj.records[d]=jexcel.injectArray(obj.records[d],n,t.records[d]),E=0,a=n;a<t.numOfColumns+n;a++)obj.rows[d].insertBefore(t.records[d][E],obj.rows[d].children[a+1]),E++;if(obj.options.footers)for(d=0;d<obj.options.footers.length;d++)obj.options.footers[d]=jexcel.injectArray(obj.options.footers[d],n,t.footers[d])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(d=0;d<obj.options.nestedHeaders.length;d++){if(e==1)var u=parseInt(obj.options.nestedHeaders[d][obj.options.nestedHeaders[d].length-1].colspan)-t.numOfColumns;else u=parseInt(obj.options.nestedHeaders[d][obj.options.nestedHeaders[d].length-1].colspan)+t.numOfColumns;obj.options.nestedHeaders[d][obj.options.nestedHeaders[d].length-1].colspan=u,obj.thead.children[d].children[obj.thead.children[d].children.length-1].setAttribute("colspan",u)}else u=e==1?parseInt(obj.options.nestedHeaders[0].colspan)-t.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+t.numOfColumns,obj.options.nestedHeaders[0].colspan=u,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",u);obj.updateTableReferences()},obj.undo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var n=[];if(obj.historyIndex>=0){var o=obj.history[obj.historyIndex--];if(o.action=="insertRow")obj.historyProcessRow(1,o);else if(o.action=="deleteRow")obj.historyProcessRow(0,o);else if(o.action=="insertColumn")obj.historyProcessColumn(1,o);else if(o.action=="deleteColumn")obj.historyProcessColumn(0,o);else if(o.action=="moveRow")obj.moveRow(o.newValue,o.oldValue);else if(o.action=="moveColumn")obj.moveColumn(o.newValue,o.oldValue);else if(o.action=="setMerge")obj.removeMerge(o.column,o.data);else if(o.action=="setStyle")obj.setStyle(o.oldValue,null,null,1);else if(o.action=="setWidth")obj.setWidth(o.column,o.oldValue);else if(o.action=="setHeight")obj.setHeight(o.row,o.oldValue);else if(o.action=="setHeader")obj.setHeader(o.column,o.oldValue);else if(o.action=="setComments")obj.setComments(o.column,o.oldValue[0],o.oldValue[1]);else if(o.action=="orderBy"){for(var a=[],d=0;d<o.rows.length;d++)a[o.rows[d]]=d;obj.updateOrderArrow(o.column,o.order?0:1),obj.updateOrder(a)}else if(o.action=="setValue"){for(var E=0;E<o.records.length;E++)n.push({x:o.records[E].x,y:o.records[E].y,newValue:o.records[E].oldValue}),o.oldStyle&&obj.resetStyle(o.oldStyle);obj.setValue(n),o.selection&&obj.updateSelectionFromCoords(o.selection[0],o.selection[1],o.selection[2],o.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onundo",el,o)},obj.redo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var n=obj.history[++obj.historyIndex];if(n.action=="insertRow")obj.historyProcessRow(0,n);else if(n.action=="deleteRow")obj.historyProcessRow(1,n);else if(n.action=="insertColumn")obj.historyProcessColumn(0,n);else if(n.action=="deleteColumn")obj.historyProcessColumn(1,n);else if(n.action=="moveRow")obj.moveRow(n.oldValue,n.newValue);else if(n.action=="moveColumn")obj.moveColumn(n.oldValue,n.newValue);else if(n.action=="setMerge")obj.setMerge(n.column,n.colspan,n.rowspan,1);else if(n.action=="setStyle")obj.setStyle(n.newValue,null,null,1);else if(n.action=="setWidth")obj.setWidth(n.column,n.newValue);else if(n.action=="setHeight")obj.setHeight(n.row,n.newValue);else if(n.action=="setHeader")obj.setHeader(n.column,n.newValue);else if(n.action=="setComments")obj.setComments(n.column,n.newValue[0],n.newValue[1]);else if(n.action=="orderBy")obj.updateOrderArrow(n.column,n.order),obj.updateOrder(n.rows);else if(n.action=="setValue"){obj.setValue(n.records);for(var o=0;o<n.records.length;o++)n.oldStyle&&obj.resetStyle(n.newStyle);n.selection&&obj.updateSelectionFromCoords(n.selection[0],n.selection[1],n.selection[2],n.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onredo",el,n)},obj.getDropDownValue=function(e,t){var n=[];if(obj.options.columns[e]&&obj.options.columns[e].source){for(var o=[],a=obj.options.columns[e].source,d=0;d<a.length;d++)typeof a[d]=="object"?o[a[d].id]=a[d].name:o[a[d]]=a[d];var E=Array.isArray(t)?t:(""+t).split(";");for(d=0;d<E.length;d++)typeof E[d]=="object"?n.push(o[E[d].id]):o[E[d]]&&n.push(o[E[d]])}else console.error("Invalid column");return n.length>0?n.join("; "):""},obj.parseCSV=function(e,t){(e=e.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(e.length-1)==9&&(e+="\0"),t=t||",";for(var n=[],o=!1,a=0,d=0,E=0;E<e.length;E++){var u=e[E],s=e[E+1];n[a]=n[a]||[],n[a][d]=n[a][d]||"",u=='"'&&o&&s=='"'?(n[a][d]+=u,++E):u!='"'?u!=t||o?u!="\r"||s!=`
`||o?u==`
`&&!o||u=="\r"&&!o?(++a,d=0):n[a][d]+=u:(++a,d=0,++E):++d:o=!o}return n},obj.hash=function(e){var t,n=0;if(e.length===0)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},obj.onafterchanges=function(e,t){obj.dispatch("onafterchanges",e,t)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,typeof jexcel.build=="function"&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(e){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(e){var t=obj.parseCSV(e,obj.options.csvDelimiter);if(obj.options.csvHeaders==1&&t.length>0)for(var n=t.shift(),o=0;o<n.length;o++)obj.options.columns[o]||(obj.options.columns[o]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),obj.options.columns[o].title===void 0&&(obj.options.columns[o].title=n[o]);obj.options.data=t,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.prepareTable()},options&&options.contextMenu!=null?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(e,t,n,o){var a=[];if(n==null)obj.options.allowInsertColumn==1&&a.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(t),1)}}),obj.options.allowInsertColumn==1&&a.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(t),0)}}),obj.options.allowDeleteColumn==1&&a.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(t))}}),obj.options.allowRenameColumn==1&&a.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(t)}}),obj.options.columnSorting==1&&(a.push({type:"line"}),a.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(t,0)}}),a.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(t,1)}}));else if(obj.options.allowInsertRow==1&&(a.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(n),1)}}),a.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(n))}})),obj.options.allowDeleteRow==1&&a.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(n))}}),t&&obj.options.allowComments==1){a.push({type:"line"});var d=obj.records[n][t].getAttribute("title")||"";a.push({title:d?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var E=prompt(obj.options.text.comments,d);E&&obj.setComments([t,n],E)}}),d&&a.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([t,n],"")}})}return a.push({type:"line"}),a.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&a.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(E){E&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],E)})}}),obj.options.allowExport&&a.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&a.push({title:obj.options.text.about,onclick:function(){obj.options.about===!0?alert(Version().print()):alert(obj.options.about)}}),a},obj.scrollControls=function(e){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),obj.options.lazyLoading!=1&&obj.options.tableOverflow!=1||obj.edition&&e.target.className.substr(0,9)!="jdropdown"&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(e){obj.options.lazyLoading==1&&jexcel.timeControlLoading==null&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var e=0;if(obj.options.freezeColumns>0)for(var t=0;t<obj.options.freezeColumns;t++)e+=parseInt(obj.options.columns[t].width);return e};var scrollLeft=0;return obj.updateFreezePosition=function(){var e=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var t=0;t<obj.options.freezeColumns;t++){t>0&&obj.options.columns[t-1].type!=="hidden"&&(e+=parseInt(obj.options.columns[t-1].width)),obj.headers[t].classList.add("jexcel_freezed"),obj.headers[t].style.left=e+"px";for(var n=0;n<obj.rows.length;n++)if(obj.rows[n]&&obj.records[n][t]){var o=scrollLeft+(t>0?obj.records[n][t-1].style.width:0)-51+"px";obj.records[n][t].classList.add("jexcel_freezed"),obj.records[n][t].style.left=o}}else for(t=0;t<obj.options.freezeColumns;t++)for(obj.headers[t].classList.remove("jexcel_freezed"),obj.headers[t].style.left="",n=0;n<obj.rows.length;n++)obj.records[n][t]&&(obj.records[n][t].classList.remove("jexcel_freezed"),obj.records[n][t].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};jexcel.setDictionary=function(e){jSuites.setDictionary(e)},jexcel.setExtensions=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)typeof e[t[n]]=="function"&&(jexcel[t[n]]=e[t[n]],jexcel.license&&typeof e[t[n]].license=="function"&&e[t[n]].license(jexcel.license))},formula!==void 0&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;let destroyEvents=function(e){e.removeEventListener("mouseup",jexcel.mouseUpControls),e.removeEventListener("mousedown",jexcel.mouseDownControls),e.removeEventListener("mousemove",jexcel.mouseMoveControls),e.removeEventListener("mouseover",jexcel.mouseOverControls),e.removeEventListener("dblclick",jexcel.doubleClickControls),e.removeEventListener("paste",jexcel.pasteControls),e.removeEventListener("contextmenu",jexcel.contextMenuControls),e.removeEventListener("touchstart",jexcel.touchStartControls),e.removeEventListener("touchend",jexcel.touchEndControls),e.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};var component;return jexcel.destroy=function(e,t){if(e.jexcel){var n=e.jexcel.options.root?e.jexcel.options.root:document;e.removeEventListener("DOMMouseScroll",e.jexcel.scrollControls),e.removeEventListener("mousewheel",e.jexcel.scrollControls),e.jexcel=null,e.innerHTML="",t&&(destroyEvents(n),jexcel=null)}},jexcel.build=function(e){destroyEvents(e),e.addEventListener("mouseup",jexcel.mouseUpControls),e.addEventListener("mousedown",jexcel.mouseDownControls),e.addEventListener("mousemove",jexcel.mouseMoveControls),e.addEventListener("mouseover",jexcel.mouseOverControls),e.addEventListener("dblclick",jexcel.doubleClickControls),e.addEventListener("paste",jexcel.pasteControls),e.addEventListener("contextmenu",jexcel.contextMenuControls),e.addEventListener("touchstart",jexcel.touchStartControls),e.addEventListener("touchend",jexcel.touchEndControls),e.addEventListener("touchcancel",jexcel.touchEndControls),e.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(e){if(jexcel.current){if(jexcel.current.edition)if(e.which==27)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),e.preventDefault();else if(e.which==13){if(jexcel.current.options.columns[jexcel.current.edition[2]].type=="calendar")jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if(!(jexcel.current.options.columns[jexcel.current.edition[2]].type=="dropdown"||jexcel.current.options.columns[jexcel.current.edition[2]].type=="autocomplete"))if((jexcel.current.options.wordWrap==1||jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap==1||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&e.altKey){var t=jexcel.current.edition[0].children[0],n=jexcel.current.edition[0].children[0].value,o=t.selectionStart;n=n.slice(0,o)+`
`+n.slice(o),t.value=n,t.focus(),t.selectionStart=o+1,t.selectionEnd=o+1}else jexcel.current.edition[0].children[0].blur()}else e.which==9&&(["calendar","html"].includes(jexcel.current.options.columns[jexcel.current.edition[2]].type)?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(e.which==37)jexcel.current.left(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==39)jexcel.current.right(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==38)jexcel.current.up(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==40)jexcel.current.down(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==36)jexcel.current.first(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==35)jexcel.current.last(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==46||e.which==8)jexcel.current.options.editable==1&&(jexcel.current.selectedRow?jexcel.current.options.allowDeleteRow==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?jexcel.current.options.allowDeleteColumn==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(e.which==13)e.shiftKey?jexcel.current.up():(jexcel.current.options.allowInsertRow==1&&jexcel.current.options.allowManualInsertRow==1&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),e.preventDefault();else if(e.which==9)e.shiftKey?jexcel.current.left():(jexcel.current.options.allowInsertColumn==1&&jexcel.current.options.allowManualInsertColumn==1&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),e.preventDefault();else if(!e.ctrlKey&&!e.metaKey||e.shiftKey){if(jexcel.current.selectedCell&&jexcel.current.options.editable==1){var a=jexcel.current.selectedCell[1],d=jexcel.current.selectedCell[0];jexcel.current.options.columns[d].type!="readonly"&&(e.keyCode==32?(e.preventDefault(),jexcel.current.options.columns[d].type=="checkbox"||jexcel.current.options.columns[d].type=="radio"?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[a][d],!0)):e.keyCode==113?jexcel.current.openEditor(jexcel.current.records[a][d],!1):(e.keyCode==8||e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=111||e.keyCode>=187&&e.keyCode<=190||(String.fromCharCode(e.keyCode)==e.key||String.fromCharCode(e.keyCode).toLowerCase()==e.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(e.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[a][d],!0),jexcel.current.options.columns[d].type=="calendar"&&e.preventDefault()))}}else e.which==65?(jexcel.current.selectAll(),e.preventDefault()):e.which==83?(jexcel.current.download(),e.preventDefault()):e.which==89?(jexcel.current.redo(),e.preventDefault()):e.which==90?(jexcel.current.undo(),e.preventDefault()):e.which==67?(jexcel.current.copy(!0),e.preventDefault()):e.which==88?(jexcel.current.options.editable==1?jexcel.cutControls():jexcel.copyControls(),e.preventDefault()):e.which==86&&jexcel.pasteControls();else e.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(e.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;var n=jexcel.getElement(e.target);if(n[0]?jexcel.current!=n[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=n[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&t==1){if(e.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(e.target.classList.contains("jexcel_corner"))jexcel.current.options.editable==1&&(jexcel.current.selectedCorner=!0);else{if(n[1]==1){if(p=e.target.getAttribute("data-x")){var o=e.target.getBoundingClientRect();if(jexcel.current.options.columnResize==1&&o.width-e.offsetX<6){jexcel.current.resizing={mousePosition:e.pageX,column:p,width:o.width},jexcel.current.headers[p].classList.add("resizing");for(var a=0;a<jexcel.current.records.length;a++)jexcel.current.records[a][p]&&jexcel.current.records[a][p].classList.add("resizing")}else if(jexcel.current.options.columnDrag==1&&o.height-e.offsetY<6)if(jexcel.current.isColMerged(p).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target,column:p,destination:p},jexcel.current.headers[p].classList.add("dragging"),a=0;a<jexcel.current.records.length;a++)jexcel.current.records[a][p]&&jexcel.current.records[a][p].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(e.shiftKey||e.ctrlKey))var d=jexcel.current.selectedHeader,E=p;else jexcel.current.selectedHeader==p&&jexcel.current.options.allowRenameColumn==1&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(p)},800)),jexcel.current.selectedHeader=p,d=p,E=p;jexcel.current.updateSelectionFromCoords(d,0,E,jexcel.current.options.data.length-1)}}else if(e.target.parentNode.classList.contains("jexcel_nested")){if(e.target.getAttribute("data-column"))var u=e.target.getAttribute("data-column").split(","),s=parseInt(u[0]),m=parseInt(u[u.length-1]);else s=0,m=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(s,0,m,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(n[1]==2){var T=e.target.getAttribute("data-y");if(e.target.classList.contains("jexcel_row"))o=e.target.getBoundingClientRect(),jexcel.current.options.rowResize==1&&o.height-e.offsetY<6?(jexcel.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:T,height:o.height},e.target.parentNode.classList.add("resizing")):jexcel.current.options.rowDrag==1&&o.width-e.offsetX<6?jexcel.current.isRowMerged(T).length?console.error("Jspreadsheet: This row is part of a merged cell"):jexcel.current.options.search==1&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target.parentNode,row:T,destination:T},e.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(e.shiftKey||e.ctrlKey)?(d=jexcel.current.selectedRow,E=T):(jexcel.current.selectedRow=T,d=T,E=T),jexcel.current.updateSelectionFromCoords(0,d,jexcel.current.options.data[0].length-1,E));else if(e.target.classList.contains("jclose")&&e.target.clientWidth-e.offsetX<50&&e.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var M=function(b){var j=b.getAttribute("data-x"),v=b.getAttribute("data-y");return j&&v?[j,v]:b.parentNode?M(b.parentNode):void 0},g=M(e.target);if(g){var p=g[0];T=g[1],jexcel.current.edition&&(jexcel.current.edition[2]==p&&jexcel.current.edition[3]==T||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(e.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],p,T):jexcel.current.updateSelectionFromCoords(p,T)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;e.target.classList.contains("jexcel_page")&&(e.target.textContent=="<"?jexcel.current.page(0):e.target.textContent==">"?jexcel.current.page(e.target.getAttribute("title")-1):jexcel.current.page(e.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(e){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var t=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),n=jexcel.current.getSelectedColumns();if(n.length>1){for(var o=[],a=0;a<n.length;a++)o.push(parseInt(jexcel.current.colgroup[n[a]].getAttribute("width")));o[n.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(n,t,o)}else jexcel.current.setWidth(jexcel.current.resizing.column,t,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var d=0;d<jexcel.current.records.length;d++)jexcel.current.records[d][jexcel.current.resizing.column]&&jexcel.current.records[d][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var E=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,E,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var u=e.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),d=0;d<jexcel.current.rows.length;d++)jexcel.current.records[d][jexcel.current.dragging.column]&&jexcel.current.records[d][jexcel.current.dragging.column].classList.remove("dragging");for(a=0;a<jexcel.current.headers.length;a++)jexcel.current.headers[a].classList.remove("dragging-left"),jexcel.current.headers[a].classList.remove("dragging-right");u&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var s=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<s&&(s-=1)}else s=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,s,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current)if(jexcel.isMouseAction==1){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var n=e.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+n>0){var o=jexcel.current.resizing.width+n;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",o),jexcel.current.updateCornerPosition()}}else{var a=e.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+a>0){var d=jexcel.current.resizing.height+a;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",d),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var E=e.target.getAttribute("data-x");if(E)if(jexcel.current.isColMerged(E).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var u=0;u<jexcel.current.headers.length;u++)jexcel.current.headers[u].classList.remove("dragging-left"),jexcel.current.headers[u].classList.remove("dragging-right");jexcel.current.dragging.column==E?jexcel.current.dragging.destination=parseInt(E):e.target.clientWidth/2>e.offsetX?(jexcel.current.dragging.column<E?jexcel.current.dragging.destination=parseInt(E)-1:jexcel.current.dragging.destination=parseInt(E),jexcel.current.headers[E].classList.add("dragging-left")):(jexcel.current.dragging.column<E?jexcel.current.dragging.destination=parseInt(E):jexcel.current.dragging.destination=parseInt(E)+1,jexcel.current.headers[E].classList.add("dragging-right"))}}else{var s=e.target.getAttribute("data-y");if(s)if(jexcel.current.isRowMerged(s).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var m=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode;jexcel.current.dragging.element!=m&&(e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,m),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var T=e.target.getAttribute("data-x"),M=e.target.getAttribute("data-y"),g=e.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className&&(e.target.parentNode.parentNode.classList.contains("resizable")&&(e.target&&T&&!M&&g.width-(e.clientX-g.left)<6?(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="col-resize"):e.target&&!T&&M&&g.height-(e.clientY-g.top)<6&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="row-resize")),e.target.parentNode.parentNode.classList.contains("draggable")&&(e.target&&!T&&M&&g.width-(e.clientX-g.left)<6||e.target&&T&&!M&&g.height-(e.clientY-g.top)<6)&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current&&jexcel.isMouseAction==1){var n=jexcel.getElement(e.target);if(n[0]){if(jexcel.current!=n[0].jexcel&&jexcel.current)return!1;var o=e.target.getAttribute("data-x"),a=e.target.getAttribute("data-y");if(!(jexcel.current.resizing||jexcel.current.dragging)){if(n[1]==1&&jexcel.current.selectedHeader){o=e.target.getAttribute("data-x");var d=jexcel.current.selectedHeader,E=o;jexcel.current.updateSelectionFromCoords(d,0,E,jexcel.current.options.data.length-1)}n[1]==2&&(e.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(d=jexcel.current.selectedRow,E=a,jexcel.current.updateSelectionFromCoords(0,d,jexcel.current.options.data[0].length-1,E)):jexcel.current.edition||o&&a&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(o,a):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],o,a)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(e){if(jexcel.current)if(e.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var t=jexcel.current.highlighted[0].getAttribute("data-x"),n=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,o=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),a=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[n][t],jexcel.current.records[a][o])}}else if(e.target.classList.contains("jexcel_column_filter")){var d=e.target.getAttribute("data-x");jexcel.current.openFilter(d)}else{var E=jexcel.getElement(e.target);if(E[1]==1&&jexcel.current.options.columnSorting==1&&(d=e.target.getAttribute("data-x"))&&jexcel.current.orderBy(d),E[1]==2&&jexcel.current.options.editable==1&&!jexcel.current.edition){var u=function(m){if(m.parentNode){var T=m.getAttribute("data-x"),M=m.getAttribute("data-y");return T&&M?m:u(m.parentNode)}},s=u(e.target);s&&s.classList.contains("highlight")&&jexcel.current.openEditor(s)}}},jexcel.copyControls=function(e){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(e){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),jexcel.current.options.editable==1&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(e){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||jexcel.current.options.editable==1&&(e&&e.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(e){if("buttons"in(e=e||window.event)?e.buttons:e.which||e.button,jexcel.current){if(jexcel.current.edition)e.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var t=e.target.getAttribute("data-x"),n=e.target.getAttribute("data-y");if(t||n){(t<parseInt(jexcel.current.selectedCell[0])||t>parseInt(jexcel.current.selectedCell[2])||n<parseInt(jexcel.current.selectedCell[1])||n>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(t,n,t,n);var o=jexcel.current.options.contextMenu(jexcel.current,t,n,e);jexcel.current.contextMenu.contextmenu.open(e,o),e.preventDefault()}}}},jexcel.touchStartControls=function(e){var t=jexcel.getElement(e.target);if(t[0]?jexcel.current!=t[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=t[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var n=e.target.getAttribute("data-x"),o=e.target.getAttribute("data-y");n&&o&&(jexcel.current.updateSelectionFromCoords(n,o),jexcel.timeControl=setTimeout(function(){jexcel.current.options.columns[n].type=="color"?jexcel.tmpElement=null:jexcel.tmpElement=e.target,jexcel.current.openEditor(e.target,!1,e)},500))}},jexcel.touchEndControls=function(e){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&jexcel.tmpElement.children[0].tagName=="INPUT"&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(e,t){var n=[];if(e.classList.contains("jexcel_tabs"))a=e.children[0],d=e.children[1];else{e.innerHTML="",e.classList.add("jexcel_tabs"),e.jexcel=[];var o=document.createElement("div"),a=e.appendChild(o),d=(o=document.createElement("div"),e.appendChild(o))}for(var E=[],u=[],s=0;s<t.length;s++){E[s]=document.createElement("div"),E[s].classList.add("jexcel_tab");var m=jexcel(E[s],t[s]);d.appendChild(E[s]),n[s]=e.jexcel.push(m),u[s]=document.createElement("div"),u[s].classList.add("jexcel_tab_link"),u[s].setAttribute("data-spreadsheet",e.jexcel.length-1),u[s].innerHTML=t[s].sheetName,u[s].onclick=function(){for(var M=0;M<a.children.length;M++)a.children[M].classList.remove("selected"),d.children[M].style.display="none";var g=this.getAttribute("data-spreadsheet");d.children[g].style.display="block",a.children[g].classList.add("selected")},a.appendChild(u[s])}for(var T=0;T<a.children.length;T++)a.children[T].classList.remove("selected"),d.children[T].style.display="none";return a.children[a.children.length-1].classList.add("selected"),d.children[a.children.length-1].style.display="block",n},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(e,t){var n,o=function(a){var d=[];return a.SheetNames.forEach(function(E){var u={rows:[],columns:[],data:[],style:{}};if(u.sheetName=E,(v=a.Sheets[E]["!cols"])&&v.length)for(var s=0;s<v.length;s++)u.columns[s]={},v[s]&&v[s].wpx&&(u.columns[s].width=v[s].wpx+"px");if((v=a.Sheets[E]["!rows"])&&v.length)for(s=0;s<v.length;s++)v[s]&&v[s].hpx&&(u.rows[s]={},u.rows[s].height=v[s].hpx+"px");if((v=a.Sheets[E]["!merges"])&&v.length>0)for(u.mergeCells=[],s=0;s<v.length;s++){var m=v[s].s.c,T=v[s].s.r,M=v[s].e.c,g=v[s].e.r,p=jexcel.getColumnNameFromId([m,T]);u.mergeCells[p]=[M-m+1,g-T+1]}var b=0,j=0,v=Object.keys(a.Sheets[E]);for(s=0;s<v.length;s++)if(v[s].substr(0,1)!="!"){var C=a.Sheets[E][v[s]],A=jexcel.getIdFromColumnName(v[s],!0);u.data[A[1]]||(u.data[A[1]]=[]),u.data[A[1]][A[0]]=C.f?"="+C.f:C.w,b<A[0]&&(b=A[0]),j<A[1]&&(j=A[1]),C.style&&Object.keys(C.style).length>0&&(u.style[v[s]]=C.style),C.s&&C.s.fgColor&&(u.style[v[s]]&&(u.style[v[s]]+=";"),u.style[v[s]]+="background-color:#"+C.s.fgColor.rgb)}for(var S=u.columns,D=0;D<=j;D++)for(s=0;s<=b;s++)u.data[D]||(u.data[D]=[]),u.data[D][s]||S<s&&(u.data[D][s]="");d.push(u)}),d};(n=new XMLHttpRequest).open("GET",e,!0),typeof Uint8Array<"u"?(n.responseType="arraybuffer",n.onload=function(a){var d=n.response,E=new Uint8Array(d),u=XLSX.read(E,{type:"array",cellFormula:!0,cellStyles:!0});t(o(u))}):(n.setRequestHeader("Accept-Charset","x-user-defined"),n.onreadystatechange=function(){if(n.readyState==4&&n.status==200){var a=convertResponseBodyToText(n.responseBody),d=XLSX.read(a,{type:"binary",cellFormula:!0,cellStyles:!0});t(o(d))}}),n.send()},jexcel.validLetter=function(e){return e.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))},jexcel.getColumnName=function(e){return jexcel.helpers.getColumnName(e)},jexcel.getIdFromColumnName=function(e,t){var n=/^[a-zA-Z]+/.exec(e);if(n){for(var o=0,a=0;a<n[0].length;a++)o+=parseInt(n[0].charCodeAt(a)-64)*Math.pow(26,n[0].length-1-a);--o<0&&(o=0);var d=parseInt(/[0-9]+$/.exec(e));d>0&&d--,e=t==1?[o,d]:o+"-"+d}return e},jexcel.getColumnNameFromId=function(e){return Array.isArray(e)||(e=e.split("-")),jexcel.getColumnName(parseInt(e[0]))+(parseInt(e[1])+1)},jexcel.getElement=function(e){var t=0,n=0;return function o(a){a.className&&a.classList.contains("jexcel_container")&&(n=a),a.tagName=="THEAD"?t=1:a.tagName=="TBODY"&&(t=2),a.parentNode&&(n||o(a.parentNode))}(e),[n,t]},jexcel.doubleDigitFormat=function(e){return(e=""+e).length==1&&(e="0"+e),e},jexcel.createFromTable=function(e,t){if(e.tagName=="TABLE"){t||(t={}),t.columns=[],t.data=[];var n=e.querySelectorAll("colgroup > col");if(n.length)for(var o=0;o<n.length;o++){if(!(a=n[o].style.width))var a=n[o].getAttribute("width");a&&(t.columns[o]||(t.columns[o]={}),t.columns[o].width=a)}var d=function(ye){var Ne=ye.getBoundingClientRect(),be=Ne.width>50?Ne.width:50;t.columns[o]||(t.columns[o]={}),ye.getAttribute("data-celltype")?t.columns[o].type=ye.getAttribute("data-celltype"):t.columns[o].type="text",t.columns[o].width=be+"px",t.columns[o].title=ye.innerHTML,t.columns[o].align=ye.style.textAlign||"center",(Ne=ye.getAttribute("name"))&&(t.columns[o].name=Ne),(Ne=ye.getAttribute("id"))&&(t.columns[o].id=Ne),(Ne=ye.getAttribute("data-mask"))&&(t.columns[o].mask=Ne)},E=[],u=e.querySelectorAll(":scope > thead > tr");if(u.length){for(var s=0;s<u.length-1;s++){var m=[];for(o=0;o<u[s].children.length;o++){var T={title:u[s].children[o].textContent,colspan:u[s].children[o].getAttribute("colspan")||1};m.push(T)}E.push(m)}for(u=u[u.length-1].children,o=0;o<u.length;o++)d(u[o])}var M=0,g={},p={},b={},j={},v=e.querySelectorAll(":scope > tr, :scope > tbody > tr");for(s=0;s<v.length;s++)if(t.data[M]=[],t.parseTableFirstRowAsHeader!=1||u.length||s!=0){for(o=0;o<v[s].children.length;o++){if(C=v[s].children[o].getAttribute("data-formula"))C.substr(0,1)!="="&&(C="="+C);else var C=v[s].children[o].innerHTML;t.data[M].push(C);var A=jexcel.getColumnNameFromId([o,s]),S=v[s].children[o].getAttribute("class");S&&(j[A]=S);var D=parseInt(v[s].children[o].getAttribute("colspan"))||0,F=parseInt(v[s].children[o].getAttribute("rowspan"))||0;(D||F)&&(g[A]=[D||1,F||1]),v[s].children[o].style&&v[s].children[o].style.display=="none"&&(v[s].children[o].style.display="");var N=v[s].children[o].getAttribute("style");N&&(b[A]=N),v[s].children[o].classList.contains("styleBold")&&(b[A]?b[A]+="; font-weight:bold;":b[A]="font-weight:bold;")}v[s].style&&v[s].style.height&&(p[s]={height:v[s].style.height}),M++}else for(o=0;o<v[s].children.length;o++)d(v[s].children[o]);if(Object.keys(E).length>0&&(t.nestedHeaders=E),Object.keys(b).length>0&&(t.style=b),Object.keys(g).length>0&&(t.mergeCells=g),Object.keys(p).length>0&&(t.rows=p),Object.keys(j).length>0&&(t.classes=j),(v=e.querySelectorAll("tfoot tr")).length){var _=[];for(s=0;s<v.length;s++){var G=[];for(o=0;o<v[s].children.length;o++)G.push(v[s].children[o].textContent);_.push(G)}Object.keys(_).length>0&&(t.footers=_)}if(t.parseTableAutoCellType==1){var U=[];for(o=0;o<t.columns.length;o++){var re=!0,fe=!0;for(U[o]=[],s=0;s<t.data.length;s++)C=t.data[s][o],U[o][C]||(U[o][C]=0),U[o][C]++,C.length>25&&(re=!1),C.length==10&&C.substr(4,1)=="-"&&C.substr(7,1)=="-"||(fe=!1);var ae=Object.keys(U[o]).length;fe?t.columns[o].type="calendar":re==1&&ae>1&&ae<=parseInt(.1*t.data.length)&&(t.columns[o].type="dropdown",t.columns[o].source=Object.keys(U[o]))}}return t}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(e){if(this.config.root)var t=this.config.root;else t=window;var n=0,o=t.getSelection();if(o&&o.rangeCount!==0){var a=o.getRangeAt(0),d=a.cloneRange();d.selectNodeContents(e),d.setEnd(a.endContainer,a.endOffset),n=d.toString().length}return n},invert:function(e){for(var t=[],n=Object.keys(e),o=0;o<n.length;o++)t[e[n[o]]]=n[o];return t},getColumnName:function(e){let t,n=e+1,o="";for(;n>0;)t=(n-1)%26,o=String.fromCharCode(65+t).toString()+o,n=parseInt((n-t)/26);return o},getColumnNameFromCoords:function(e,t){return component.getColumnName(parseInt(e))+(parseInt(t)+1)},getCoordsFromColumnName:function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,o=0;o<t[0].length;o++)n+=parseInt(t[0].charCodeAt(o)-64)*Math.pow(26,t[0].length-1-o);--n<0&&(n=0);var a=parseInt(/[0-9]+$/.exec(e))||null;return a>0&&a--,[n,a]}},createFromTable:function(){},injectArray:function(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))},parseCSV:function(e,t){t=t||",";for(var n=0,o=0,a=[[]],d=0,E=null,u=!1,s=!1,m=0;m<e.length;m++)if(a[o]||(a[o]=[]),a[o][n]||(a[o][n]=""),e[m]!="\r")if(e[m]!=`
`&&e[m]!=t||u!=0&&s!=1&&E){if(e[m]=='"'&&(u=!u),E===null){if((E=u)==1)continue}else if(E===!0&&!s&&e[m]=='"'){e[m+1]=='"'?(u=!0,a[o][n]+=e[m],m++):s=!0;continue}a[o][n]+=e[m]}else{if(E=null,u=!1,s=!1,a[o][n][0]=='"'){var T=a[o][n].trim();T[T.length-1]=='"'&&(a[o][n]=T.substr(1,T.length-2))}e[m]==`
`?(n=0,o++):++n>d&&(d=n)}for(var M=0;M<a.length;M++)for(m=0;m<=d;m++)a[M][m]===void 0&&(a[M][m]="");return a}},component),typeof jQuery<"u"&&function(e){e.fn.jspreadsheet=e.fn.jexcel=function(t){var n=e(this).get(0);return n.jexcel?Array.isArray(n.jexcel)?n.jexcel[t][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):n.jexcel[t].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(e(this).get(0),arguments[0])}}(jQuery),jexcel},module.exports=factory()}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(t!==void 0)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}var __webpack_exports__=__webpack_require__(44);jspreadsheet=__webpack_exports__}(),jspreadsheet})});var wp=jn(Yl=>{"use strict";var mm=jo(),vm=Symbol.for("react.element"),bm=Symbol.for("react.fragment"),jm=Object.prototype.hasOwnProperty,ym=mm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xm={key:!0,ref:!0,__self:!0,__source:!0};function xp(e,t,n){var o,a={},d=null,E=null;n!==void 0&&(d=""+n),t.key!==void 0&&(d=""+t.key),t.ref!==void 0&&(E=t.ref);for(o in t)jm.call(t,o)&&!xm.hasOwnProperty(o)&&(a[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps,t)a[o]===void 0&&(a[o]=t[o]);return{$$typeof:vm,type:e,key:d,ref:E,props:a,_owner:ym.current}}Yl.Fragment=bm;Yl.jsx=xp;Yl.jsxs=xp});var Fr=jn((Hm,Cp)=>{"use strict";Cp.exports=wp()});var Mp=kn(bp());var Qt=kn(jo()),di=kn(yp());var Gn=kn(Fr()),wm=({onAddRow:e,onAddColumn:t,onSave:n,onSaveAndClose:o,isModified:a,onToggleWrapAll:d,wrapAllChecked:E})=>(0,Gn.jsxs)("div",{className:"tableEditorButtons",children:[(0,Gn.jsx)("button",{onClick:e,children:"\u884C\u3092\u8FFD\u52A0"}),(0,Gn.jsx)("button",{onClick:t,children:"\u5217\u3092\u8FFD\u52A0"}),(0,Gn.jsx)("button",{onClick:n,disabled:!a,children:"Save"}),(0,Gn.jsx)("button",{onClick:o,disabled:!a,children:"Save & Close"}),(0,Gn.jsxs)("label",{style:{userSelect:"none",marginLeft:8},children:[(0,Gn.jsx)("input",{type:"checkbox",checked:E,onChange:d,style:{marginRight:4}}),"\u5168\u5217 wrap"]})]}),Ep=wm;function Ap(e){let t=e.split(`
`).map(d=>d.trim()).filter(d=>d&&d.startsWith("|")&&d.endsWith("|"));if(t.length<2)return{columns:[],data:[]};let o=t[0].slice(1,-1).split("|").map(d=>d.trim()).map((d,E)=>({name:d!==""?d:`__EMPTY__${E+1}`,header:d})),a=t.slice(2).map(d=>{let E=d.slice(1,-1).split("|").map(s=>s.trim()),u={};return o.forEach((s,m)=>{u[s.name]=(E[m]??"").replace(/<br\s*\/?>/gi,`
`)}),u});return{columns:o,data:a}}function ho(e,t){if(!e.length)return"";let n="|"+e.map(d=>d.header).join("|")+"|",o="|"+e.map(()=>"---").join("|")+"|",a=t.map(d=>"|"+e.map(E=>(d[E.name]??"").replace(/\n/g,"<br>")).join("|")+"|");return[n,o,...a].join(`
`)+`
`}var Au=kn(jo());function Sp({columnDefs:e,rowData:t,setMarkdown:n,setIsModified:o}){let a=(0,Au.useCallback)(()=>{let E=[...t,{}];n(ho(e,E)),o(!0)},[t,e,n,o]),d=(0,Au.useCallback)(()=>{let E=e.length+1,u=`col${E}`,s=`Column${E}`,m=[...e,{name:u,header:s,editable:!0}],T=t.length>0?t.map(M=>({...M,[u]:""})):[{[u]:""}];n(ho(m,T)),o(!0)},[e,t,n,o]);return{handleAddRow:a,handleAddColumn:d}}var Lp={};var go=kn(Fr()),Em={createEditor:function(e,t,n,o,a){let d=document.createElement("textarea");return d.value=t||"",d.style.width="100%",d.style.height="100%",d.addEventListener("keydown",function(E){E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),a.closeEditor(e,!0))}),{element:d,value:d.value}},getValue:function(e){return e?e.element?e.element.value:e.value!==void 0||e instanceof HTMLTextAreaElement?e.value:"":""},setValue:function(e,t){e&&(e.element?e.element.value=t:e instanceof HTMLTextAreaElement&&(e.value=t))},focus:function(e){e&&(e.element?e.element.focus():e instanceof HTMLTextAreaElement&&e.focus())},closeEditor:function(){},openEditor:function(e,t,n,o,a){return this.createEditor(e,t,n,o,a)}};typeof window<"u"&&!window.vscode&&typeof acquireVsCodeApi=="function"&&(window.vscode=acquireVsCodeApi());var Np=()=>{let e=(0,Qt.useRef)(null),t=(0,Qt.useRef)(null);di.default.editors=di.default.editors||{},di.default.editors.textarea=Em;let n=window.__INIT_MARKDOWN__||"",[o,a]=(0,Qt.useState)(n),[d,E]=(0,Qt.useState)(!1),{columns:u,data:s}=Qt.default.useMemo(()=>Ap(o),[o]);(0,Qt.useEffect)(()=>{if(!e.current)return;t.current&&(t.current.destroy(),t.current=null);let b=u.map(j=>({title:j.name,width:120,align:"left",wrap:!0,wordWrap:!0,type:"text"}));return t.current=(0,di.default)(e.current,{data:s,columns:b,minDimensions:[u.length||1,s.length||1],editable:!0,wordWrap:!0,allowInsertRow:!0,allowInsertColumn:!0,allowDeleteRow:!0,allowDeleteColumn:!0,onbeforechange:(j,v,C,A,S)=>S,onchange:()=>{E(!0),window.vscode&&typeof window.vscode.postMessage=="function"&&window.vscode.postMessage({type:"modified"})}}),E(!1),()=>{t.current&&(t.current.destroy(),t.current=null)}},[o]);let m=(0,Qt.useCallback)(()=>{if(!t.current)return;let b=t.current.options.columns||[],j=[];if(e.current){let F=e.current.querySelectorAll(".jexcel thead th");j=Array.from(F).map(N=>N.innerText.trim())}let v=b.map((F,N)=>({name:j[N]&&j[N].length>0?j[N]:`__EMPTY__${N+1}`,header:j[N]||F.title||""})),C=t.current.getData();console.log("save columnsForSave",v),console.log("save currentData",C);let S=(Array.isArray(C)?C:[]).map(F=>{let N={};return v.forEach((_,G)=>{N[_.name]=F[G]??""}),N}),D=ho(v,S);console.log("save md",D),window.vscode&&typeof window.vscode.postMessage=="function"&&(window.vscode.postMessage({type:"save",markdown:D}),window.vscode.postMessage({type:"saved"})),E(!1)},[]),T=(0,Qt.useCallback)(()=>{if(!t.current)return;let b=t.current.options.columns||[],j=[];if(e.current){let F=e.current.querySelectorAll(".jexcel thead th");j=Array.from(F).map(N=>N.innerText.trim())}let v=b.map((F,N)=>({name:j[N]&&j[N].length>0?j[N]:`__EMPTY__${N+1}`,header:j[N]||F.title||""})),C=t.current.getData();console.log("saveAndClose columnsForSave",v),console.log("saveAndClose currentData",C);let S=(Array.isArray(C)?C:[]).map(F=>{let N={};return v.forEach((_,G)=>{N[_.name]=F[G]??""}),N}),D=ho(v,S);console.log("saveAndClose md",D),window.vscode&&typeof window.vscode.postMessage=="function"&&window.vscode.postMessage({type:"saveAndClose",markdown:D}),E(!1)},[]);(0,Qt.useEffect)(()=>{let b=j=>{(j.metaKey||j.ctrlKey)&&j.key==="s"&&(j.preventDefault(),m())};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[m]),(0,Qt.useEffect)(()=>{a(n),E(!1)},[n]);let{handleAddRow:M,handleAddColumn:g}=Sp({columnDefs:u,rowData:s,setMarkdown:a,setIsModified:E}),p=()=>{if(!t.current)return;let b=t.current.options.columns,j=b.every(v=>v.wrap);b.forEach(v=>{v.wrap=!j}),t.current.refresh()};return(0,go.jsx)("div",{children:(0,go.jsxs)("div",{className:Lp.tableEditor,children:[(0,go.jsx)(Ep,{onAddRow:M,onAddColumn:g,onSave:m,onSaveAndClose:T,isModified:d,wrapAllChecked:u.length>0&&u.every(b=>b.wrap),onToggleWrapAll:p}),(0,go.jsx)("div",{ref:e,style:{width:"100%",minHeight:300}})]})})};var Ip=kn(Fr()),kp=document.getElementById("table-editor-root");kp&&(0,Mp.createRoot)(kp).render((0,Ip.jsx)(Np,{}));})();
/*! Bundled license information:

react/cjs/react.production.min.js:
  (**
   * @license React
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

scheduler/cjs/scheduler.production.min.js:
  (**
   * @license React
   * scheduler.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-dom/cjs/react-dom.production.min.js:
  (**
   * @license React
   * react-dom.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react/cjs/react-jsx-runtime.production.min.js:
  (**
   * @license React
   * react-jsx-runtime.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)
*/
//# sourceMappingURL=main.js.map
